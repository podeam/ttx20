(function(){const F=document.createElement("link").relList;if(F&&F.supports&&F.supports("modulepreload"))return;for(const J of document.querySelectorAll('link[rel="modulepreload"]'))$(J);new MutationObserver(J=>{for(const ce of J)if(ce.type==="childList")for(const B of ce.addedNodes)B.tagName==="LINK"&&B.rel==="modulepreload"&&$(B)}).observe(document,{childList:!0,subtree:!0});function Z(J){const ce={};return J.integrity&&(ce.integrity=J.integrity),J.referrerPolicy&&(ce.referrerPolicy=J.referrerPolicy),J.crossOrigin==="use-credentials"?ce.credentials="include":J.crossOrigin==="anonymous"?ce.credentials="omit":ce.credentials="same-origin",ce}function $(J){if(J.ep)return;J.ep=!0;const ce=Z(J);fetch(J.href,ce)}})();function Ng(S){return S&&S.__esModule&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S}var pg={exports:{}},ym={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jg;function R_(){if(Jg)return ym;Jg=1;var S=Symbol.for("react.transitional.element"),F=Symbol.for("react.fragment");function Z($,J,ce){var B=null;if(ce!==void 0&&(B=""+ce),J.key!==void 0&&(B=""+J.key),"key"in J){ce={};for(var h in J)h!=="key"&&(ce[h]=J[h])}else ce=J;return J=ce.ref,{$$typeof:S,type:$,key:B,ref:J!==void 0?J:null,props:ce}}return ym.Fragment=F,ym.jsx=Z,ym.jsxs=Z,ym}var ey;function I_(){return ey||(ey=1,pg.exports=R_()),pg.exports}var H=I_(),fg={exports:{}},wr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function O_(){if(ty)return wr;ty=1;var S=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),Z=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),ce=Symbol.for("react.consumer"),B=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),ge=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),Ve=Symbol.iterator;function Ee(qe){return qe===null||typeof qe!="object"?null:(qe=Ve&&qe[Ve]||qe["@@iterator"],typeof qe=="function"?qe:null)}var pe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Se=Object.assign,Ne={};function rt(qe,Ot,Ht){this.props=qe,this.context=Ot,this.refs=Ne,this.updater=Ht||pe}rt.prototype.isReactComponent={},rt.prototype.setState=function(qe,Ot){if(typeof qe!="object"&&typeof qe!="function"&&qe!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,qe,Ot,"setState")},rt.prototype.forceUpdate=function(qe){this.updater.enqueueForceUpdate(this,qe,"forceUpdate")};function Ie(){}Ie.prototype=rt.prototype;function Oe(qe,Ot,Ht){this.props=qe,this.context=Ot,this.refs=Ne,this.updater=Ht||pe}var We=Oe.prototype=new Ie;We.constructor=Oe,Se(We,rt.prototype),We.isPureReactComponent=!0;var ct=Array.isArray,Ke={H:null,A:null,T:null,S:null,V:null},pt=Object.prototype.hasOwnProperty;function Pt(qe,Ot,Ht,ii,di,Qi){return Ht=Qi.ref,{$$typeof:S,type:qe,key:Ot,ref:Ht!==void 0?Ht:null,props:Qi}}function Ue(qe,Ot){return Pt(qe.type,Ot,void 0,void 0,void 0,qe.props)}function zt(qe){return typeof qe=="object"&&qe!==null&&qe.$$typeof===S}function _t(qe){var Ot={"=":"=0",":":"=2"};return"$"+qe.replace(/[=:]/g,function(Ht){return Ot[Ht]})}var Dt=/\/+/g;function ri(qe,Ot){return typeof qe=="object"&&qe!==null&&qe.key!=null?_t(""+qe.key):Ot.toString(36)}function Yt(){}function yi(qe){switch(qe.status){case"fulfilled":return qe.value;case"rejected":throw qe.reason;default:switch(typeof qe.status=="string"?qe.then(Yt,Yt):(qe.status="pending",qe.then(function(Ot){qe.status==="pending"&&(qe.status="fulfilled",qe.value=Ot)},function(Ot){qe.status==="pending"&&(qe.status="rejected",qe.reason=Ot)})),qe.status){case"fulfilled":return qe.value;case"rejected":throw qe.reason}}throw qe}function wi(qe,Ot,Ht,ii,di){var Qi=typeof qe;(Qi==="undefined"||Qi==="boolean")&&(qe=null);var Ri=!1;if(qe===null)Ri=!0;else switch(Qi){case"bigint":case"string":case"number":Ri=!0;break;case"object":switch(qe.$$typeof){case S:case F:Ri=!0;break;case Te:return Ri=qe._init,wi(Ri(qe._payload),Ot,Ht,ii,di)}}if(Ri)return di=di(qe),Ri=ii===""?"."+ri(qe,0):ii,ct(di)?(Ht="",Ri!=null&&(Ht=Ri.replace(Dt,"$&/")+"/"),wi(di,Ot,Ht,"",function(Cr){return Cr})):di!=null&&(zt(di)&&(di=Ue(di,Ht+(di.key==null||qe&&qe.key===di.key?"":(""+di.key).replace(Dt,"$&/")+"/")+Ri)),Ot.push(di)),1;Ri=0;var _n=ii===""?".":ii+":";if(ct(qe))for(var Zr=0;Zr<qe.length;Zr++)ii=qe[Zr],Qi=_n+ri(ii,Zr),Ri+=wi(ii,Ot,Ht,Qi,di);else if(Zr=Ee(qe),typeof Zr=="function")for(qe=Zr.call(qe),Zr=0;!(ii=qe.next()).done;)ii=ii.value,Qi=_n+ri(ii,Zr++),Ri+=wi(ii,Ot,Ht,Qi,di);else if(Qi==="object"){if(typeof qe.then=="function")return wi(yi(qe),Ot,Ht,ii,di);throw Ot=String(qe),Error("Objects are not valid as a React child (found: "+(Ot==="[object Object]"?"object with keys {"+Object.keys(qe).join(", ")+"}":Ot)+"). If you meant to render a collection of children, use an array instead.")}return Ri}function gt(qe,Ot,Ht){if(qe==null)return qe;var ii=[],di=0;return wi(qe,ii,"","",function(Qi){return Ot.call(Ht,Qi,di++)}),ii}function It(qe){if(qe._status===-1){var Ot=qe._result;Ot=Ot(),Ot.then(function(Ht){(qe._status===0||qe._status===-1)&&(qe._status=1,qe._result=Ht)},function(Ht){(qe._status===0||qe._status===-1)&&(qe._status=2,qe._result=Ht)}),qe._status===-1&&(qe._status=0,qe._result=Ot)}if(qe._status===1)return qe._result.default;throw qe._result}var ti=typeof reportError=="function"?reportError:function(qe){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ot=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof qe=="object"&&qe!==null&&typeof qe.message=="string"?String(qe.message):String(qe),error:qe});if(!window.dispatchEvent(Ot))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",qe);return}console.error(qe)};function ki(){}return wr.Children={map:gt,forEach:function(qe,Ot,Ht){gt(qe,function(){Ot.apply(this,arguments)},Ht)},count:function(qe){var Ot=0;return gt(qe,function(){Ot++}),Ot},toArray:function(qe){return gt(qe,function(Ot){return Ot})||[]},only:function(qe){if(!zt(qe))throw Error("React.Children.only expected to receive a single React element child.");return qe}},wr.Component=rt,wr.Fragment=Z,wr.Profiler=J,wr.PureComponent=Oe,wr.StrictMode=$,wr.Suspense=oe,wr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ke,wr.__COMPILER_RUNTIME={__proto__:null,c:function(qe){return Ke.H.useMemoCache(qe)}},wr.cache=function(qe){return function(){return qe.apply(null,arguments)}},wr.cloneElement=function(qe,Ot,Ht){if(qe==null)throw Error("The argument must be a React element, but you passed "+qe+".");var ii=Se({},qe.props),di=qe.key,Qi=void 0;if(Ot!=null)for(Ri in Ot.ref!==void 0&&(Qi=void 0),Ot.key!==void 0&&(di=""+Ot.key),Ot)!pt.call(Ot,Ri)||Ri==="key"||Ri==="__self"||Ri==="__source"||Ri==="ref"&&Ot.ref===void 0||(ii[Ri]=Ot[Ri]);var Ri=arguments.length-2;if(Ri===1)ii.children=Ht;else if(1<Ri){for(var _n=Array(Ri),Zr=0;Zr<Ri;Zr++)_n[Zr]=arguments[Zr+2];ii.children=_n}return Pt(qe.type,di,void 0,void 0,Qi,ii)},wr.createContext=function(qe){return qe={$$typeof:B,_currentValue:qe,_currentValue2:qe,_threadCount:0,Provider:null,Consumer:null},qe.Provider=qe,qe.Consumer={$$typeof:ce,_context:qe},qe},wr.createElement=function(qe,Ot,Ht){var ii,di={},Qi=null;if(Ot!=null)for(ii in Ot.key!==void 0&&(Qi=""+Ot.key),Ot)pt.call(Ot,ii)&&ii!=="key"&&ii!=="__self"&&ii!=="__source"&&(di[ii]=Ot[ii]);var Ri=arguments.length-2;if(Ri===1)di.children=Ht;else if(1<Ri){for(var _n=Array(Ri),Zr=0;Zr<Ri;Zr++)_n[Zr]=arguments[Zr+2];di.children=_n}if(qe&&qe.defaultProps)for(ii in Ri=qe.defaultProps,Ri)di[ii]===void 0&&(di[ii]=Ri[ii]);return Pt(qe,Qi,void 0,void 0,null,di)},wr.createRef=function(){return{current:null}},wr.forwardRef=function(qe){return{$$typeof:h,render:qe}},wr.isValidElement=zt,wr.lazy=function(qe){return{$$typeof:Te,_payload:{_status:-1,_result:qe},_init:It}},wr.memo=function(qe,Ot){return{$$typeof:ge,type:qe,compare:Ot===void 0?null:Ot}},wr.startTransition=function(qe){var Ot=Ke.T,Ht={};Ke.T=Ht;try{var ii=qe(),di=Ke.S;di!==null&&di(Ht,ii),typeof ii=="object"&&ii!==null&&typeof ii.then=="function"&&ii.then(ki,ti)}catch(Qi){ti(Qi)}finally{Ke.T=Ot}},wr.unstable_useCacheRefresh=function(){return Ke.H.useCacheRefresh()},wr.use=function(qe){return Ke.H.use(qe)},wr.useActionState=function(qe,Ot,Ht){return Ke.H.useActionState(qe,Ot,Ht)},wr.useCallback=function(qe,Ot){return Ke.H.useCallback(qe,Ot)},wr.useContext=function(qe){return Ke.H.useContext(qe)},wr.useDebugValue=function(){},wr.useDeferredValue=function(qe,Ot){return Ke.H.useDeferredValue(qe,Ot)},wr.useEffect=function(qe,Ot,Ht){var ii=Ke.H;if(typeof Ht=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ii.useEffect(qe,Ot)},wr.useId=function(){return Ke.H.useId()},wr.useImperativeHandle=function(qe,Ot,Ht){return Ke.H.useImperativeHandle(qe,Ot,Ht)},wr.useInsertionEffect=function(qe,Ot){return Ke.H.useInsertionEffect(qe,Ot)},wr.useLayoutEffect=function(qe,Ot){return Ke.H.useLayoutEffect(qe,Ot)},wr.useMemo=function(qe,Ot){return Ke.H.useMemo(qe,Ot)},wr.useOptimistic=function(qe,Ot){return Ke.H.useOptimistic(qe,Ot)},wr.useReducer=function(qe,Ot,Ht){return Ke.H.useReducer(qe,Ot,Ht)},wr.useRef=function(qe){return Ke.H.useRef(qe)},wr.useState=function(qe){return Ke.H.useState(qe)},wr.useSyncExternalStore=function(qe,Ot,Ht){return Ke.H.useSyncExternalStore(qe,Ot,Ht)},wr.useTransition=function(){return Ke.H.useTransition()},wr.version="19.1.0",wr}var iy;function Em(){return iy||(iy=1,fg.exports=O_()),fg.exports}var be=Em(),mg={exports:{}},_m={},gg={exports:{}},yg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ry;function j_(){return ry||(ry=1,function(S){function F(gt,It){var ti=gt.length;gt.push(It);e:for(;0<ti;){var ki=ti-1>>>1,qe=gt[ki];if(0<J(qe,It))gt[ki]=It,gt[ti]=qe,ti=ki;else break e}}function Z(gt){return gt.length===0?null:gt[0]}function $(gt){if(gt.length===0)return null;var It=gt[0],ti=gt.pop();if(ti!==It){gt[0]=ti;e:for(var ki=0,qe=gt.length,Ot=qe>>>1;ki<Ot;){var Ht=2*(ki+1)-1,ii=gt[Ht],di=Ht+1,Qi=gt[di];if(0>J(ii,ti))di<qe&&0>J(Qi,ii)?(gt[ki]=Qi,gt[di]=ti,ki=di):(gt[ki]=ii,gt[Ht]=ti,ki=Ht);else if(di<qe&&0>J(Qi,ti))gt[ki]=Qi,gt[di]=ti,ki=di;else break e}}return It}function J(gt,It){var ti=gt.sortIndex-It.sortIndex;return ti!==0?ti:gt.id-It.id}if(S.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var ce=performance;S.unstable_now=function(){return ce.now()}}else{var B=Date,h=B.now();S.unstable_now=function(){return B.now()-h}}var oe=[],ge=[],Te=1,Ve=null,Ee=3,pe=!1,Se=!1,Ne=!1,rt=!1,Ie=typeof setTimeout=="function"?setTimeout:null,Oe=typeof clearTimeout=="function"?clearTimeout:null,We=typeof setImmediate<"u"?setImmediate:null;function ct(gt){for(var It=Z(ge);It!==null;){if(It.callback===null)$(ge);else if(It.startTime<=gt)$(ge),It.sortIndex=It.expirationTime,F(oe,It);else break;It=Z(ge)}}function Ke(gt){if(Ne=!1,ct(gt),!Se)if(Z(oe)!==null)Se=!0,pt||(pt=!0,ri());else{var It=Z(ge);It!==null&&wi(Ke,It.startTime-gt)}}var pt=!1,Pt=-1,Ue=5,zt=-1;function _t(){return rt?!0:!(S.unstable_now()-zt<Ue)}function Dt(){if(rt=!1,pt){var gt=S.unstable_now();zt=gt;var It=!0;try{e:{Se=!1,Ne&&(Ne=!1,Oe(Pt),Pt=-1),pe=!0;var ti=Ee;try{t:{for(ct(gt),Ve=Z(oe);Ve!==null&&!(Ve.expirationTime>gt&&_t());){var ki=Ve.callback;if(typeof ki=="function"){Ve.callback=null,Ee=Ve.priorityLevel;var qe=ki(Ve.expirationTime<=gt);if(gt=S.unstable_now(),typeof qe=="function"){Ve.callback=qe,ct(gt),It=!0;break t}Ve===Z(oe)&&$(oe),ct(gt)}else $(oe);Ve=Z(oe)}if(Ve!==null)It=!0;else{var Ot=Z(ge);Ot!==null&&wi(Ke,Ot.startTime-gt),It=!1}}break e}finally{Ve=null,Ee=ti,pe=!1}It=void 0}}finally{It?ri():pt=!1}}}var ri;if(typeof We=="function")ri=function(){We(Dt)};else if(typeof MessageChannel<"u"){var Yt=new MessageChannel,yi=Yt.port2;Yt.port1.onmessage=Dt,ri=function(){yi.postMessage(null)}}else ri=function(){Ie(Dt,0)};function wi(gt,It){Pt=Ie(function(){gt(S.unstable_now())},It)}S.unstable_IdlePriority=5,S.unstable_ImmediatePriority=1,S.unstable_LowPriority=4,S.unstable_NormalPriority=3,S.unstable_Profiling=null,S.unstable_UserBlockingPriority=2,S.unstable_cancelCallback=function(gt){gt.callback=null},S.unstable_forceFrameRate=function(gt){0>gt||125<gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ue=0<gt?Math.floor(1e3/gt):5},S.unstable_getCurrentPriorityLevel=function(){return Ee},S.unstable_next=function(gt){switch(Ee){case 1:case 2:case 3:var It=3;break;default:It=Ee}var ti=Ee;Ee=It;try{return gt()}finally{Ee=ti}},S.unstable_requestPaint=function(){rt=!0},S.unstable_runWithPriority=function(gt,It){switch(gt){case 1:case 2:case 3:case 4:case 5:break;default:gt=3}var ti=Ee;Ee=gt;try{return It()}finally{Ee=ti}},S.unstable_scheduleCallback=function(gt,It,ti){var ki=S.unstable_now();switch(typeof ti=="object"&&ti!==null?(ti=ti.delay,ti=typeof ti=="number"&&0<ti?ki+ti:ki):ti=ki,gt){case 1:var qe=-1;break;case 2:qe=250;break;case 5:qe=1073741823;break;case 4:qe=1e4;break;default:qe=5e3}return qe=ti+qe,gt={id:Te++,callback:It,priorityLevel:gt,startTime:ti,expirationTime:qe,sortIndex:-1},ti>ki?(gt.sortIndex=ti,F(ge,gt),Z(oe)===null&&gt===Z(ge)&&(Ne?(Oe(Pt),Pt=-1):Ne=!0,wi(Ke,ti-ki))):(gt.sortIndex=qe,F(oe,gt),Se||pe||(Se=!0,pt||(pt=!0,ri()))),gt},S.unstable_shouldYield=_t,S.unstable_wrapCallback=function(gt){var It=Ee;return function(){var ti=Ee;Ee=It;try{return gt.apply(this,arguments)}finally{Ee=ti}}}}(yg)),yg}var ny;function B_(){return ny||(ny=1,gg.exports=j_()),gg.exports}var _g={exports:{}},Ko={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ay;function N_(){if(ay)return Ko;ay=1;var S=Em();function F(oe){var ge="https://react.dev/errors/"+oe;if(1<arguments.length){ge+="?args[]="+encodeURIComponent(arguments[1]);for(var Te=2;Te<arguments.length;Te++)ge+="&args[]="+encodeURIComponent(arguments[Te])}return"Minified React error #"+oe+"; visit "+ge+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Z(){}var $={d:{f:Z,r:function(){throw Error(F(522))},D:Z,C:Z,L:Z,m:Z,X:Z,S:Z,M:Z},p:0,findDOMNode:null},J=Symbol.for("react.portal");function ce(oe,ge,Te){var Ve=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:J,key:Ve==null?null:""+Ve,children:oe,containerInfo:ge,implementation:Te}}var B=S.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(oe,ge){if(oe==="font")return"";if(typeof ge=="string")return ge==="use-credentials"?ge:""}return Ko.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,Ko.createPortal=function(oe,ge){var Te=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ge||ge.nodeType!==1&&ge.nodeType!==9&&ge.nodeType!==11)throw Error(F(299));return ce(oe,ge,null,Te)},Ko.flushSync=function(oe){var ge=B.T,Te=$.p;try{if(B.T=null,$.p=2,oe)return oe()}finally{B.T=ge,$.p=Te,$.d.f()}},Ko.preconnect=function(oe,ge){typeof oe=="string"&&(ge?(ge=ge.crossOrigin,ge=typeof ge=="string"?ge==="use-credentials"?ge:"":void 0):ge=null,$.d.C(oe,ge))},Ko.prefetchDNS=function(oe){typeof oe=="string"&&$.d.D(oe)},Ko.preinit=function(oe,ge){if(typeof oe=="string"&&ge&&typeof ge.as=="string"){var Te=ge.as,Ve=h(Te,ge.crossOrigin),Ee=typeof ge.integrity=="string"?ge.integrity:void 0,pe=typeof ge.fetchPriority=="string"?ge.fetchPriority:void 0;Te==="style"?$.d.S(oe,typeof ge.precedence=="string"?ge.precedence:void 0,{crossOrigin:Ve,integrity:Ee,fetchPriority:pe}):Te==="script"&&$.d.X(oe,{crossOrigin:Ve,integrity:Ee,fetchPriority:pe,nonce:typeof ge.nonce=="string"?ge.nonce:void 0})}},Ko.preinitModule=function(oe,ge){if(typeof oe=="string")if(typeof ge=="object"&&ge!==null){if(ge.as==null||ge.as==="script"){var Te=h(ge.as,ge.crossOrigin);$.d.M(oe,{crossOrigin:Te,integrity:typeof ge.integrity=="string"?ge.integrity:void 0,nonce:typeof ge.nonce=="string"?ge.nonce:void 0})}}else ge==null&&$.d.M(oe)},Ko.preload=function(oe,ge){if(typeof oe=="string"&&typeof ge=="object"&&ge!==null&&typeof ge.as=="string"){var Te=ge.as,Ve=h(Te,ge.crossOrigin);$.d.L(oe,Te,{crossOrigin:Ve,integrity:typeof ge.integrity=="string"?ge.integrity:void 0,nonce:typeof ge.nonce=="string"?ge.nonce:void 0,type:typeof ge.type=="string"?ge.type:void 0,fetchPriority:typeof ge.fetchPriority=="string"?ge.fetchPriority:void 0,referrerPolicy:typeof ge.referrerPolicy=="string"?ge.referrerPolicy:void 0,imageSrcSet:typeof ge.imageSrcSet=="string"?ge.imageSrcSet:void 0,imageSizes:typeof ge.imageSizes=="string"?ge.imageSizes:void 0,media:typeof ge.media=="string"?ge.media:void 0})}},Ko.preloadModule=function(oe,ge){if(typeof oe=="string")if(ge){var Te=h(ge.as,ge.crossOrigin);$.d.m(oe,{as:typeof ge.as=="string"&&ge.as!=="script"?ge.as:void 0,crossOrigin:Te,integrity:typeof ge.integrity=="string"?ge.integrity:void 0})}else $.d.m(oe)},Ko.requestFormReset=function(oe){$.d.r(oe)},Ko.unstable_batchedUpdates=function(oe,ge){return oe(ge)},Ko.useFormState=function(oe,ge,Te){return B.H.useFormState(oe,ge,Te)},Ko.useFormStatus=function(){return B.H.useHostTransitionStatus()},Ko.version="19.1.0",Ko}var sy;function F_(){if(sy)return _g.exports;sy=1;function S(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(S)}catch(F){console.error(F)}}return S(),_g.exports=N_(),_g.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy;function U_(){if(oy)return _m;oy=1;var S=B_(),F=Em(),Z=F_();function $(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function J(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function ce(i){var o=i,d=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(d=o.return),i=o.return;while(i)}return o.tag===3?d:null}function B(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function h(i){if(ce(i)!==i)throw Error($(188))}function oe(i){var o=i.alternate;if(!o){if(o=ce(i),o===null)throw Error($(188));return o!==i?null:i}for(var d=i,x=o;;){var k=d.return;if(k===null)break;var O=k.alternate;if(O===null){if(x=k.return,x!==null){d=x;continue}break}if(k.child===O.child){for(O=k.child;O;){if(O===d)return h(k),i;if(O===x)return h(k),o;O=O.sibling}throw Error($(188))}if(d.return!==x.return)d=k,x=O;else{for(var se=!1,xe=k.child;xe;){if(xe===d){se=!0,d=k,x=O;break}if(xe===x){se=!0,x=k,d=O;break}xe=xe.sibling}if(!se){for(xe=O.child;xe;){if(xe===d){se=!0,d=O,x=k;break}if(xe===x){se=!0,x=O,d=k;break}xe=xe.sibling}if(!se)throw Error($(189))}}if(d.alternate!==x)throw Error($(190))}if(d.tag!==3)throw Error($(188));return d.stateNode.current===d?i:o}function ge(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=ge(i),o!==null)return o;i=i.sibling}return null}var Te=Object.assign,Ve=Symbol.for("react.element"),Ee=Symbol.for("react.transitional.element"),pe=Symbol.for("react.portal"),Se=Symbol.for("react.fragment"),Ne=Symbol.for("react.strict_mode"),rt=Symbol.for("react.profiler"),Ie=Symbol.for("react.provider"),Oe=Symbol.for("react.consumer"),We=Symbol.for("react.context"),ct=Symbol.for("react.forward_ref"),Ke=Symbol.for("react.suspense"),pt=Symbol.for("react.suspense_list"),Pt=Symbol.for("react.memo"),Ue=Symbol.for("react.lazy"),zt=Symbol.for("react.activity"),_t=Symbol.for("react.memo_cache_sentinel"),Dt=Symbol.iterator;function ri(i){return i===null||typeof i!="object"?null:(i=Dt&&i[Dt]||i["@@iterator"],typeof i=="function"?i:null)}var Yt=Symbol.for("react.client.reference");function yi(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Yt?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Se:return"Fragment";case rt:return"Profiler";case Ne:return"StrictMode";case Ke:return"Suspense";case pt:return"SuspenseList";case zt:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case pe:return"Portal";case We:return(i.displayName||"Context")+".Provider";case Oe:return(i._context.displayName||"Context")+".Consumer";case ct:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Pt:return o=i.displayName||null,o!==null?o:yi(i.type)||"Memo";case Ue:o=i._payload,i=i._init;try{return yi(i(o))}catch{}}return null}var wi=Array.isArray,gt=F.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,It=Z.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ti={pending:!1,data:null,method:null,action:null},ki=[],qe=-1;function Ot(i){return{current:i}}function Ht(i){0>qe||(i.current=ki[qe],ki[qe]=null,qe--)}function ii(i,o){qe++,ki[qe]=i.current,i.current=o}var di=Ot(null),Qi=Ot(null),Ri=Ot(null),_n=Ot(null);function Zr(i,o){switch(ii(Ri,o),ii(Qi,i),ii(di,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?_e(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=_e(o),i=Je(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Ht(di),ii(di,i)}function Cr(){Ht(di),Ht(Qi),Ht(Ri)}function Pl(i){i.memoizedState!==null&&ii(_n,i);var o=di.current,d=Je(o,i.type);o!==d&&(ii(Qi,i),ii(di,d))}function aa(i){Qi.current===i&&(Ht(di),Ht(Qi)),_n.current===i&&(Ht(_n),we._currentValue=ti)}var hc=Object.prototype.hasOwnProperty,li=S.unstable_scheduleCallback,Ms=S.unstable_cancelCallback,Va=S.unstable_shouldYield,dc=S.unstable_requestPaint,qr=S.unstable_now,Ga=S.unstable_getCurrentPriorityLevel,va=S.unstable_ImmediatePriority,Ao=S.unstable_UserBlockingPriority,$a=S.unstable_NormalPriority,Ru=S.unstable_LowPriority,zl=S.unstable_IdlePriority,ba=S.log,pc=S.unstable_setDisableYieldValue,Ha=null,en=null;function sa(i){if(typeof ba=="function"&&pc(i),en&&typeof en.setStrictMode=="function")try{en.setStrictMode(Ha,i)}catch{}}var oa=Math.clz32?Math.clz32:lt,Mh=Math.log,Eo=Math.LN2;function lt(i){return i>>>=0,i===0?32:31-(Mh(i)/Eo|0)|0}var de=256,ye=4194304;function Me(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function je(i,o,d){var x=i.pendingLanes;if(x===0)return 0;var k=0,O=i.suspendedLanes,se=i.pingedLanes;i=i.warmLanes;var xe=x&134217727;return xe!==0?(x=xe&~O,x!==0?k=Me(x):(se&=xe,se!==0?k=Me(se):d||(d=xe&~i,d!==0&&(k=Me(d))))):(xe=x&~O,xe!==0?k=Me(xe):se!==0?k=Me(se):d||(d=x&~i,d!==0&&(k=Me(d)))),k===0?0:o!==0&&o!==k&&(o&O)===0&&(O=k&-k,d=o&-o,O>=d||O===32&&(d&4194048)!==0)?o:k}function Qe(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function nt(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yt(){var i=de;return de<<=1,(de&4194048)===0&&(de=256),i}function tt(){var i=ye;return ye<<=1,(ye&62914560)===0&&(ye=4194304),i}function Et(i){for(var o=[],d=0;31>d;d++)o.push(i);return o}function St(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ut(i,o,d,x,k,O){var se=i.pendingLanes;i.pendingLanes=d,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=d,i.entangledLanes&=d,i.errorRecoveryDisabledLanes&=d,i.shellSuspendCounter=0;var xe=i.entanglements,Xe=i.expirationTimes,Tt=i.hiddenUpdates;for(d=se&~d;0<d;){var Ft=31-oa(d),$t=1<<Ft;xe[Ft]=0,Xe[Ft]=-1;var Ct=Tt[Ft];if(Ct!==null)for(Tt[Ft]=null,Ft=0;Ft<Ct.length;Ft++){var At=Ct[Ft];At!==null&&(At.lane&=-536870913)}d&=~$t}x!==0&&jt(i,x,0),O!==0&&k===0&&i.tag!==0&&(i.suspendedLanes|=O&~(se&~o))}function jt(i,o,d){i.pendingLanes|=o,i.suspendedLanes&=~o;var x=31-oa(o);i.entangledLanes|=o,i.entanglements[x]=i.entanglements[x]|1073741824|d&4194090}function He(i,o){var d=i.entangledLanes|=o;for(i=i.entanglements;d;){var x=31-oa(d),k=1<<x;k&o|i[x]&o&&(i[x]|=o),d&=~k}}function ni(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Pi(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ci(){var i=It.p;return i!==0?i:(i=window.event,i===void 0?32:gi(i.type))}function ai(i,o){var d=It.p;try{return It.p=i,o()}finally{It.p=d}}var Ai=Math.random().toString(36).slice(2),tr="__reactFiber$"+Ai,Wi="__reactProps$"+Ai,ur="__reactContainer$"+Ai,bi="__reactEvents$"+Ai,fr="__reactListeners$"+Ai,Kn="__reactHandles$"+Ai,Wt="__reactResources$"+Ai,Cn="__reactMarker$"+Ai;function Ur(i){delete i[tr],delete i[Wi],delete i[bi],delete i[fr],delete i[Kn]}function es(i){var o=i[tr];if(o)return o;for(var d=i.parentNode;d;){if(o=d[ur]||d[tr]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(i=Na(i);i!==null;){if(d=i[tr])return d;i=Na(i)}return o}i=d,d=i.parentNode}return null}function Cs(i){if(i=i[tr]||i[ur]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function Jt(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error($(33))}function Fi(i){var o=i[Wt];return o||(o=i[Wt]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Mi(i){i[Cn]=!0}var Dr=new Set,Qc={};function wa(i,o){Zi(i,o),Zi(i+"Capture",o)}function Zi(i,o){for(Qc[i]=o,i=0;i<o.length;i++)Dr.add(o[i])}var Qo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ll={},fn={};function Iu(i){return hc.call(fn,i)?!0:hc.call(Ll,i)?!1:Qo.test(i)?fn[i]=!0:(Ll[i]=!0,!1)}function Jo(i,o,d){if(Iu(o))if(d===null)i.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var x=o.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+d)}}function hs(i,o,d){if(d===null)i.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+d)}}function ds(i,o,d,x){if(x===null)i.removeAttribute(d);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(d);return}i.setAttributeNS(o,d,""+x)}}var la,Vr;function fc(i){if(la===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);la=o&&o[1]||"",Vr=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+la+i+Vr}var Er=!1;function mc(i,o){if(!i||Er)return"";Er=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(o){var $t=function(){throw Error()};if(Object.defineProperty($t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($t,[])}catch(At){var Ct=At}Reflect.construct(i,[],$t)}else{try{$t.call()}catch(At){Ct=At}i.call($t.prototype)}}else{try{throw Error()}catch(At){Ct=At}($t=i())&&typeof $t.catch=="function"&&$t.catch(function(){})}}catch(At){if(At&&Ct&&typeof At.stack=="string")return[At.stack,Ct.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var k=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");k&&k.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var O=x.DetermineComponentFrameRoot(),se=O[0],xe=O[1];if(se&&xe){var Xe=se.split(`
`),Tt=xe.split(`
`);for(k=x=0;x<Xe.length&&!Xe[x].includes("DetermineComponentFrameRoot");)x++;for(;k<Tt.length&&!Tt[k].includes("DetermineComponentFrameRoot");)k++;if(x===Xe.length||k===Tt.length)for(x=Xe.length-1,k=Tt.length-1;1<=x&&0<=k&&Xe[x]!==Tt[k];)k--;for(;1<=x&&0<=k;x--,k--)if(Xe[x]!==Tt[k]){if(x!==1||k!==1)do if(x--,k--,0>k||Xe[x]!==Tt[k]){var Ft=`
`+Xe[x].replace(" at new "," at ");return i.displayName&&Ft.includes("<anonymous>")&&(Ft=Ft.replace("<anonymous>",i.displayName)),Ft}while(1<=x&&0<=k);break}}}finally{Er=!1,Error.prepareStackTrace=d}return(d=i?i.displayName||i.name:"")?fc(d):""}function Dl(i){switch(i.tag){case 26:case 27:case 5:return fc(i.type);case 16:return fc("Lazy");case 13:return fc("Suspense");case 19:return fc("SuspenseList");case 0:case 15:return mc(i.type,!1);case 11:return mc(i.type.render,!1);case 1:return mc(i.type,!0);case 31:return fc("Activity");default:return""}}function el(i){try{var o="";do o+=Dl(i),i=i.return;while(i);return o}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function ps(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function _d(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function yp(i){var o=_d(i)?"checked":"value",d=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),x=""+i[o];if(!i.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var k=d.get,O=d.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return k.call(this)},set:function(se){x=""+se,O.call(this,se)}}),Object.defineProperty(i,o,{enumerable:d.enumerable}),{getValue:function(){return x},setValue:function(se){x=""+se},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function ko(i){i._valueTracker||(i._valueTracker=yp(i))}function xd(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var d=o.getValue(),x="";return i&&(x=_d(i)?i.checked?"true":"false":i.value),i=x,i!==d?(o.setValue(i),!0):!1}function Ou(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var ju=/[\n"\\]/g;function As(i){return i.replace(ju,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function gc(i,o,d,x,k,O,se,xe){i.name="",se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"?i.type=se:i.removeAttribute("type"),o!=null?se==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+ps(o)):i.value!==""+ps(o)&&(i.value=""+ps(o)):se!=="submit"&&se!=="reset"||i.removeAttribute("value"),o!=null?Jc(i,se,ps(o)):d!=null?Jc(i,se,ps(d)):x!=null&&i.removeAttribute("value"),k==null&&O!=null&&(i.defaultChecked=!!O),k!=null&&(i.checked=k&&typeof k!="function"&&typeof k!="symbol"),xe!=null&&typeof xe!="function"&&typeof xe!="symbol"&&typeof xe!="boolean"?i.name=""+ps(xe):i.removeAttribute("name")}function Rl(i,o,d,x,k,O,se,xe){if(O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(i.type=O),o!=null||d!=null){if(!(O!=="submit"&&O!=="reset"||o!=null))return;d=d!=null?""+ps(d):"",o=o!=null?""+ps(o):d,xe||o===i.value||(i.value=o),i.defaultValue=o}x=x??k,x=typeof x!="function"&&typeof x!="symbol"&&!!x,i.checked=xe?i.checked:!!x,i.defaultChecked=!!x,se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"&&(i.name=se)}function Jc(i,o,d){o==="number"&&Ou(i.ownerDocument)===i||i.defaultValue===""+d||(i.defaultValue=""+d)}function Ws(i,o,d,x){if(i=i.options,o){o={};for(var k=0;k<d.length;k++)o["$"+d[k]]=!0;for(d=0;d<i.length;d++)k=o.hasOwnProperty("$"+i[d].value),i[d].selected!==k&&(i[d].selected=k),k&&x&&(i[d].defaultSelected=!0)}else{for(d=""+ps(d),o=null,k=0;k<i.length;k++){if(i[k].value===d){i[k].selected=!0,x&&(i[k].defaultSelected=!0);return}o!==null||i[k].disabled||(o=i[k])}o!==null&&(o.selected=!0)}}function Ch(i,o,d){if(o!=null&&(o=""+ps(o),o!==i.value&&(i.value=o),d==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=d!=null?""+ps(d):""}function Sa(i,o,d,x){if(o==null){if(x!=null){if(d!=null)throw Error($(92));if(wi(x)){if(1<x.length)throw Error($(93));x=x[0]}d=x}d==null&&(d=""),o=d}d=ps(o),i.defaultValue=d,x=i.textContent,x===d&&x!==""&&x!==null&&(i.value=x)}function fs(i,o){if(o){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=o;return}}i.textContent=o}var Po=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ar(i,o,d){var x=o.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?x?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":x?i.setProperty(o,d):typeof d!="number"||d===0||Po.has(o)?o==="float"?i.cssFloat=d:i[o]=(""+d).trim():i[o]=d+"px"}function zo(i,o,d){if(o!=null&&typeof o!="object")throw Error($(62));if(i=i.style,d!=null){for(var x in d)!d.hasOwnProperty(x)||o!=null&&o.hasOwnProperty(x)||(x.indexOf("--")===0?i.setProperty(x,""):x==="float"?i.cssFloat="":i[x]="");for(var k in o)x=o[k],o.hasOwnProperty(k)&&d[k]!==x&&ar(i,k,x)}else for(var O in o)o.hasOwnProperty(O)&&ar(i,O,o[O])}function ms(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function eu(i){return vd.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Za=null;function Es(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ui=null,Do=null;function Il(i){var o=Cs(i);if(o&&(i=o.stateNode)){var d=i[Wi]||null;e:switch(i=o.stateNode,o.type){case"input":if(gc(i,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),o=d.name,d.type==="radio"&&o!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+As(""+o)+'"][type="radio"]'),o=0;o<d.length;o++){var x=d[o];if(x!==i&&x.form===i.form){var k=x[Wi]||null;if(!k)throw Error($(90));gc(x,k.value,k.defaultValue,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name)}}for(o=0;o<d.length;o++)x=d[o],x.form===i.form&&xd(x)}break e;case"textarea":Ch(i,d.value,d.defaultValue);break e;case"select":o=d.value,o!=null&&Ws(i,!!d.multiple,o,!1)}}}var Bu=!1;function ca(i,o,d){if(Bu)return i(o,d);Bu=!0;try{var x=i(o);return x}finally{if(Bu=!1,(Ui!==null||Do!==null)&&(Dn(),Ui&&(o=Ui,i=Do,Do=Ui=null,Il(o),i)))for(o=0;o<i.length;o++)Il(i[o])}}function an(i,o){var d=i.stateNode;if(d===null)return null;var x=d[Wi]||null;if(x===null)return null;d=x[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(i=i.type,x=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!x;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error($(231,o,typeof d));return d}var Jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bn=!1;if(Jr)try{var kr={};Object.defineProperty(kr,"passive",{get:function(){Bn=!0}}),window.addEventListener("test",kr,kr),window.removeEventListener("test",kr,kr)}catch{Bn=!1}var ks=null,Vi=null,ua=null;function Oi(){if(ua)return ua;var i,o=Vi,d=o.length,x,k="value"in ks?ks.value:ks.textContent,O=k.length;for(i=0;i<d&&o[i]===k[i];i++);var se=d-i;for(x=1;x<=se&&o[d-x]===k[O-x];x++);return ua=k.slice(i,1<x?1-x:void 0)}function Gi(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Ps(){return!0}function Li(){return!1}function An(i){function o(d,x,k,O,se){this._reactName=d,this._targetInst=k,this.type=x,this.nativeEvent=O,this.target=se,this.currentTarget=null;for(var xe in i)i.hasOwnProperty(xe)&&(d=i[xe],this[xe]=d?d(O):O[xe]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?Ps:Li,this.isPropagationStopped=Li,this}return Te(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ps)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ps)},persist:function(){},isPersistent:Ps}),o}var En={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tl=An(En),ha=Te({},En,{view:0,detail:0}),Nu=An(ha),da,zs,il,Ol=Te({},ha,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==il&&(il&&i.type==="mousemove"?(da=i.screenX-il.screenX,zs=i.screenY-il.screenY):zs=da=0,il=i),da)},movementY:function(i){return"movementY"in i?i.movementY:zs}}),tu=An(Ol),Ks=Te({},Ol,{dataTransfer:0}),Vn=An(Ks),sn=Te({},ha,{relatedTarget:0}),Ta=An(sn),yc=Te({},En,{animationName:0,elapsedTime:0,pseudoElement:0}),Nn=An(yc),iu=Te({},En,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ro=An(iu),ru=Te({},En,{data:0}),Fu=An(ru),rl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ah={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ef(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Ah[i])?!!o[i]:!1}function kn(){return ef}var _c=Te({},ha,{key:function(i){if(i.key){var o=rl[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Gi(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Qs[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(i){return i.type==="keypress"?Gi(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Gi(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ts=An(_c),Ma=Te({},Ol,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uu=An(Ma),xc=Te({},ha,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn}),nu=An(xc),Eh=Te({},En,{propertyName:0,elapsedTime:0,pseudoElement:0}),bd=An(Eh),tf=Te({},Ol,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),rf=An(tf),nf=Te({},En,{newState:0,oldState:0}),kh=An(nf),Ph=[9,13,27,32],jl=Jr&&"CompositionEvent"in window,nl=null;Jr&&"documentMode"in document&&(nl=document.documentMode);var wd=Jr&&"TextEvent"in window&&!nl,Vu=Jr&&(!jl||nl&&8<nl&&11>=nl),Ls=" ",vc=!1;function Gu(i,o){switch(i){case"keyup":return Ph.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Io=!1;function _p(i,o){switch(i){case"compositionend":return bc(o);case"keypress":return o.which!==32?null:(vc=!0,Ls);case"textInput":return i=o.data,i===Ls&&vc?null:i;default:return null}}function $u(i,o){if(Io)return i==="compositionend"||!jl&&Gu(i,o)?(i=Oi(),ua=Vi=ks=null,Io=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Vu&&o.locale!=="ko"?null:o.data;default:return null}}var zh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function al(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!zh[i.type]:o==="textarea"}function Hu(i,o,d,x){Ui?Do?Do.push(x):Do=[x]:Ui=x,o=g(o,"onChange"),0<o.length&&(d=new tl("onChange","change",null,d,x),i.push({event:d,listeners:o}))}var sl=null,Zu=null;function qu(i){Jf(i,0)}function ol(i){var o=Jt(i);if(xd(o))return i}function ll(i,o){if(i==="change")return o}var Sd=!1;if(Jr){var Js;if(Jr){var Xu="oninput"in document;if(!Xu){var gs=document.createElement("div");gs.setAttribute("oninput","return;"),Xu=typeof gs.oninput=="function"}Js=Xu}else Js=!1;Sd=Js&&(!document.documentMode||9<document.documentMode)}function wc(){sl&&(sl.detachEvent("onpropertychange",Lh),Zu=sl=null)}function Lh(i){if(i.propertyName==="value"&&ol(Zu)){var o=[];Hu(o,Zu,i,Es(i)),ca(qu,o)}}function Bl(i,o,d){i==="focusin"?(wc(),sl=o,Zu=d,sl.attachEvent("onpropertychange",Lh)):i==="focusout"&&wc()}function Td(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ol(Zu)}function Dh(i,o){if(i==="click")return ol(o)}function af(i,o){if(i==="input"||i==="change")return ol(o)}function xp(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var pa=typeof Object.is=="function"?Object.is:xp;function au(i,o){if(pa(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var d=Object.keys(i),x=Object.keys(o);if(d.length!==x.length)return!1;for(x=0;x<d.length;x++){var k=d[x];if(!hc.call(o,k)||!pa(i[k],o[k]))return!1}return!0}function Md(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Rh(i,o){var d=Md(i);i=0;for(var x;d;){if(d.nodeType===3){if(x=i+d.textContent.length,i<=o&&x>=o)return{node:d,offset:o-i};i=x}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Md(d)}}function sr(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?sr(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Yu(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Ou(i.document);o instanceof i.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)i=o.contentWindow;else break;o=Ou(i.document)}return o}function Ds(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var Cd=Jr&&"documentMode"in document&&11>=document.documentMode,Nl=null,Fl=null,su=null,Wu=!1;function cl(i,o,d){var x=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Wu||Nl==null||Nl!==Ou(x)||(x=Nl,"selectionStart"in x&&Ds(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),su&&au(su,x)||(su=x,x=g(Fl,"onSelect"),0<x.length&&(o=new tl("onSelect","select",null,o,d),i.push({event:o,listeners:x}),o.target=Nl)))}function ul(i,o){var d={};return d[i.toLowerCase()]=o.toLowerCase(),d["Webkit"+i]="webkit"+o,d["Moz"+i]="moz"+o,d}var eo={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionrun:ul("Transition","TransitionRun"),transitionstart:ul("Transition","TransitionStart"),transitioncancel:ul("Transition","TransitionCancel"),transitionend:ul("Transition","TransitionEnd")},hl={},vp={};Jr&&(vp=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function Sc(i){if(hl[i])return hl[i];if(!eo[i])return i;var o=eo[i],d;for(d in o)if(o.hasOwnProperty(d)&&d in vp)return hl[i]=o[d];return i}var Ad=Sc("animationend"),bp=Sc("animationiteration"),Ed=Sc("animationstart"),Tc=Sc("transitionrun"),ou=Sc("transitionstart"),Ih=Sc("transitioncancel"),Mc=Sc("transitionend"),Oo=new Map,Cc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cc.push("scrollEnd");function fa(i,o){Oo.set(i,o),wa(o,[i])}var ma=new WeakMap;function ys(i,o){if(typeof i=="object"&&i!==null){var d=ma.get(i);return d!==void 0?d:(o={value:i,source:o,stack:el(o)},ma.set(i,o),o)}return{value:i,source:o,stack:el(o)}}var Ca=[],Ul=0,dl=0;function Aa(){for(var i=Ul,o=dl=Ul=0;o<i;){var d=Ca[o];Ca[o++]=null;var x=Ca[o];Ca[o++]=null;var k=Ca[o];Ca[o++]=null;var O=Ca[o];if(Ca[o++]=null,x!==null&&k!==null){var se=x.pending;se===null?k.next=k:(k.next=se.next,se.next=k),x.pending=k}O!==0&&kd(d,k,O)}}function Rs(i,o,d,x){Ca[Ul++]=i,Ca[Ul++]=o,Ca[Ul++]=d,Ca[Ul++]=x,dl|=x,i.lanes|=x,i=i.alternate,i!==null&&(i.lanes|=x)}function Ac(i,o,d,x){return Rs(i,o,d,x),to(i)}function Is(i,o){return Rs(i,null,null,o),to(i)}function kd(i,o,d){i.lanes|=d;var x=i.alternate;x!==null&&(x.lanes|=d);for(var k=!1,O=i.return;O!==null;)O.childLanes|=d,x=O.alternate,x!==null&&(x.childLanes|=d),O.tag===22&&(i=O.stateNode,i===null||i._visibility&1||(k=!0)),i=O,O=O.return;return i.tag===3?(O=i.stateNode,k&&o!==null&&(k=31-oa(d),i=O.hiddenUpdates,x=i[k],x===null?i[k]=[o]:x.push(o),o.lane=d|536870912),O):null}function to(i){if(50<Eu)throw Eu=0,Np=null,Error($(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var io={};function Pd(i,o,d,x){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ea(i,o,d,x){return new Pd(i,o,d,x)}function ir(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ga(i,o){var d=i.alternate;return d===null?(d=Ea(i.tag,o,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=o,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&65011712,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,o=i.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d.refCleanup=i.refCleanup,d}function qa(i,o){i.flags&=65011714;var d=i.alternate;return d===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=d.childLanes,i.lanes=d.lanes,i.child=d.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=d.memoizedProps,i.memoizedState=d.memoizedState,i.updateQueue=d.updateQueue,i.type=d.type,o=d.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Ar(i,o,d,x,k,O){var se=0;if(x=i,typeof i=="function")ir(i)&&(se=1);else if(typeof i=="string")se=w(i,d,di.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case zt:return i=Ea(31,d,o,k),i.elementType=zt,i.lanes=O,i;case Se:return ro(d.children,k,O,o);case Ne:se=8,k|=24;break;case rt:return i=Ea(12,d,o,k|2),i.elementType=rt,i.lanes=O,i;case Ke:return i=Ea(13,d,o,k),i.elementType=Ke,i.lanes=O,i;case pt:return i=Ea(19,d,o,k),i.elementType=pt,i.lanes=O,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Ie:case We:se=10;break e;case Oe:se=9;break e;case ct:se=11;break e;case Pt:se=14;break e;case Ue:se=16,x=null;break e}se=29,d=Error($(130,i===null?"null":typeof i,"")),x=null}return o=Ea(se,d,o,k),o.elementType=i,o.type=x,o.lanes=O,o}function ro(i,o,d,x){return i=Ea(7,i,x,o),i.lanes=d,i}function Oh(i,o,d){return i=Ea(6,i,null,o),i.lanes=d,i}function Ku(i,o,d){return o=Ea(4,i.children!==null?i.children:[],i.key,o),o.lanes=d,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var jo=[],Rr=0,Vl=null,Ec=0,ka=[],xi=0,no=null,is=1,_s="";function Xa(i,o){jo[Rr++]=Ec,jo[Rr++]=Vl,Vl=i,Ec=o}function qi(i,o,d){ka[xi++]=is,ka[xi++]=_s,ka[xi++]=no,no=i;var x=is;i=_s;var k=32-oa(x)-1;x&=~(1<<k),d+=1;var O=32-oa(o)+k;if(30<O){var se=k-k%5;O=(x&(1<<se)-1).toString(32),x>>=se,k-=se,is=1<<32-oa(o)+k|d<<k|x,_s=O+i}else is=1<<O|d<<k|x,_s=i}function Bo(i){i.return!==null&&(Xa(i,1),qi(i,1,0))}function Qu(i){for(;i===Vl;)Vl=jo[--Rr],jo[Rr]=null,Ec=jo[--Rr],jo[Rr]=null;for(;i===no;)no=ka[--xi],ka[xi]=null,_s=ka[--xi],ka[xi]=null,is=ka[--xi],ka[xi]=null}var xn=null,vn=null,Mr=!1,Ya=null,Os=!1,jh=Error($(519));function Gl(i){var o=Error($(418,""));throw js(ys(o,i)),jh}function pl(i){var o=i.stateNode,d=i.type,x=i.memoizedProps;switch(o[tr]=i,o[Wi]=x,d){case"dialog":br("cancel",o),br("close",o);break;case"iframe":case"object":case"embed":br("load",o);break;case"video":case"audio":for(d=0;d<rp.length;d++)br(rp[d],o);break;case"source":br("error",o);break;case"img":case"image":case"link":br("error",o),br("load",o);break;case"details":br("toggle",o);break;case"input":br("invalid",o),Rl(o,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),ko(o);break;case"select":br("invalid",o);break;case"textarea":br("invalid",o),Sa(o,x.value,x.defaultValue,x.children),ko(o)}d=x.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||o.textContent===""+d||x.suppressHydrationWarning===!0||N(o.textContent,d)?(x.popover!=null&&(br("beforetoggle",o),br("toggle",o)),x.onScroll!=null&&br("scroll",o),x.onScrollEnd!=null&&br("scrollend",o),x.onClick!=null&&(o.onclick=I),o=!0):o=!1,o||Gl(i)}function Ju(i){for(xn=i.return;xn;)switch(xn.tag){case 5:case 13:Os=!1;return;case 27:case 3:Os=!0;return;default:xn=xn.return}}function fl(i){if(i!==xn)return!1;if(!Mr)return Ju(i),Mr=!0,!1;var o=i.tag,d;if((d=o!==3&&o!==27)&&((d=o===5)&&(d=i.type,d=!(d!=="form"&&d!=="button")||$e(i.type,i.memoizedProps)),d=!d),d&&vn&&Gl(i),Ju(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(d=i.data,d==="/$"){if(o===0){vn=Bi(i.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++;i=i.nextSibling}vn=null}}else o===27?(o=vn,Gt(i.type)?(i=yr,yr=null,vn=i):vn=o):vn=xn?Bi(i.stateNode.nextSibling):null;return!0}function lu(){vn=xn=null,Mr=!1}function on(){var i=Ya;return i!==null&&(Vs===null?Vs=i:Vs.push.apply(Vs,i),Ya=null),i}function js(i){Ya===null?Ya=[i]:Ya.push(i)}var rs=Ot(null),No=null,ns=null;function xs(i,o,d){ii(rs,o._currentValue),o._currentValue=d}function as(i){i._currentValue=rs.current,Ht(rs)}function cu(i,o,d){for(;i!==null;){var x=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,x!==null&&(x.childLanes|=o)):x!==null&&(x.childLanes&o)!==o&&(x.childLanes|=o),i===d)break;i=i.return}}function $l(i,o,d,x){var k=i.child;for(k!==null&&(k.return=i);k!==null;){var O=k.dependencies;if(O!==null){var se=k.child;O=O.firstContext;e:for(;O!==null;){var xe=O;O=k;for(var Xe=0;Xe<o.length;Xe++)if(xe.context===o[Xe]){O.lanes|=d,xe=O.alternate,xe!==null&&(xe.lanes|=d),cu(O.return,d,i),x||(se=null);break e}O=xe.next}}else if(k.tag===18){if(se=k.return,se===null)throw Error($(341));se.lanes|=d,O=se.alternate,O!==null&&(O.lanes|=d),cu(se,d,i),se=null}else se=k.child;if(se!==null)se.return=k;else for(se=k;se!==null;){if(se===i){se=null;break}if(k=se.sibling,k!==null){k.return=se.return,se=k;break}se=se.return}k=se}}function Pa(i,o,d,x){i=null;for(var k=o,O=!1;k!==null;){if(!O){if((k.flags&524288)!==0)O=!0;else if((k.flags&262144)!==0)break}if(k.tag===10){var se=k.alternate;if(se===null)throw Error($(387));if(se=se.memoizedProps,se!==null){var xe=k.type;pa(k.pendingProps.value,se.value)||(i!==null?i.push(xe):i=[xe])}}else if(k===_n.current){if(se=k.alternate,se===null)throw Error($(387));se.memoizedState.memoizedState!==k.memoizedState.memoizedState&&(i!==null?i.push(we):i=[we])}k=k.return}i!==null&&$l(o,i,d,x),o.flags|=262144}function eh(i){for(i=i.firstContext;i!==null;){if(!pa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Hl(i){No=i,ns=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Pn(i){return Wa(No,i)}function Fo(i,o){return No===null&&Hl(i),Wa(i,o)}function Wa(i,o){var d=o._currentValue;if(o={context:o,memoizedValue:d,next:null},ns===null){if(i===null)throw Error($(308));ns=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else ns=ns.next=o;return d}var ao=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(d,x){i.push(x)}};this.abort=function(){o.aborted=!0,i.forEach(function(d){return d()})}},uu=S.unstable_scheduleCallback,wp=S.unstable_NormalPriority,zn={$$typeof:We,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zl(){return{controller:new ao,data:new Map,refCount:0}}function kc(i){i.refCount--,i.refCount===0&&uu(wp,function(){i.controller.abort()})}var ml=null,Bh=0,gl=0,yl=null;function so(i,o){if(ml===null){var d=ml=[];Bh=0,gl=Pu(),yl={status:"pending",value:void 0,then:function(x){d.push(x)}}}return Bh++,o.then(ss,ss),o}function ss(){if(--Bh===0&&ml!==null){yl!==null&&(yl.status="fulfilled");var i=ml;ml=null,gl=0,yl=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function oo(i,o){var d=[],x={status:"pending",value:null,reason:null,then:function(k){d.push(k)}};return i.then(function(){x.status="fulfilled",x.value=o;for(var k=0;k<d.length;k++)(0,d[k])(o)},function(k){for(x.status="rejected",x.reason=k,k=0;k<d.length;k++)(0,d[k])(void 0)}),x}var zd=gt.S;gt.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&so(i,o),zd!==null&&zd(i,o)};var bn=Ot(null);function _l(){var i=bn.current;return i!==null?i:Pr.pooledCache}function Nh(i,o){o===null?ii(bn,bn.current):ii(bn,o.pool)}function th(){var i=_l();return i===null?null:{parent:zn._currentValue,pool:i}}var ih=Error($(460)),hu=Error($(474)),ql=Error($(542)),vs={then:function(){}};function lo(i){return i=i.status,i==="fulfilled"||i==="rejected"}function si(){}function Fh(i,o,d){switch(d=i[d],d===void 0?i.push(o):d!==o&&(o.then(si,si),o=d),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,du(i),i;default:if(typeof o.status=="string")o.then(si,si);else{if(i=Pr,i!==null&&100<i.shellSuspendCounter)throw Error($(482));i=o,i.status="pending",i.then(function(x){if(o.status==="pending"){var k=o;k.status="fulfilled",k.value=x}},function(x){if(o.status==="pending"){var k=o;k.status="rejected",k.reason=x}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,du(i),i}throw co=o,ih}}var co=null;function rh(){if(co===null)throw Error($(459));var i=co;return co=null,i}function du(i){if(i===ih||i===ql)throw Error($(483))}var bs=!1;function nh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rr(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Uo(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function xl(i,o,d){var x=i.updateQueue;if(x===null)return null;if(x=x.shared,($r&2)!==0){var k=x.pending;return k===null?o.next=o:(o.next=k.next,k.next=o),x.pending=o,o=to(i),kd(i,null,d),o}return Rs(i,x,o,d),to(i)}function uo(i,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194048)!==0)){var x=o.lanes;x&=i.pendingLanes,d|=x,o.lanes=d,He(i,d)}}function ah(i,o){var d=i.updateQueue,x=i.alternate;if(x!==null&&(x=x.updateQueue,d===x)){var k=null,O=null;if(d=d.firstBaseUpdate,d!==null){do{var se={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};O===null?k=O=se:O=O.next=se,d=d.next}while(d!==null);O===null?k=O=o:O=O.next=o}else k=O=o;d={baseState:x.baseState,firstBaseUpdate:k,lastBaseUpdate:O,shared:x.shared,callbacks:x.callbacks},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=o:i.next=o,d.lastBaseUpdate=o}var Ld=!1;function Pc(){if(Ld){var i=yl;if(i!==null)throw i}}function Xl(i,o,d,x){Ld=!1;var k=i.updateQueue;bs=!1;var O=k.firstBaseUpdate,se=k.lastBaseUpdate,xe=k.shared.pending;if(xe!==null){k.shared.pending=null;var Xe=xe,Tt=Xe.next;Xe.next=null,se===null?O=Tt:se.next=Tt,se=Xe;var Ft=i.alternate;Ft!==null&&(Ft=Ft.updateQueue,xe=Ft.lastBaseUpdate,xe!==se&&(xe===null?Ft.firstBaseUpdate=Tt:xe.next=Tt,Ft.lastBaseUpdate=Xe))}if(O!==null){var $t=k.baseState;se=0,Ft=Tt=Xe=null,xe=O;do{var Ct=xe.lane&-536870913,At=Ct!==xe.lane;if(At?(Sr&Ct)===Ct:(x&Ct)===Ct){Ct!==0&&Ct===gl&&(Ld=!0),Ft!==null&&(Ft=Ft.next={lane:0,tag:xe.tag,payload:xe.payload,callback:null,next:null});e:{var Ni=i,Yi=xe;Ct=o;var nn=d;switch(Yi.tag){case 1:if(Ni=Yi.payload,typeof Ni=="function"){$t=Ni.call(nn,$t,Ct);break e}$t=Ni;break e;case 3:Ni.flags=Ni.flags&-65537|128;case 0:if(Ni=Yi.payload,Ct=typeof Ni=="function"?Ni.call(nn,$t,Ct):Ni,Ct==null)break e;$t=Te({},$t,Ct);break e;case 2:bs=!0}}Ct=xe.callback,Ct!==null&&(i.flags|=64,At&&(i.flags|=8192),At=k.callbacks,At===null?k.callbacks=[Ct]:At.push(Ct))}else At={lane:Ct,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null},Ft===null?(Tt=Ft=At,Xe=$t):Ft=Ft.next=At,se|=Ct;if(xe=xe.next,xe===null){if(xe=k.shared.pending,xe===null)break;At=xe,xe=At.next,At.next=null,k.lastBaseUpdate=At,k.shared.pending=null}}while(!0);Ft===null&&(Xe=$t),k.baseState=Xe,k.firstBaseUpdate=Tt,k.lastBaseUpdate=Ft,O===null&&(k.shared.lanes=0),qo|=se,i.lanes=se,i.memoizedState=$t}}function ho(i,o){if(typeof i!="function")throw Error($(191,i));i.call(o)}function pu(i,o){var d=i.callbacks;if(d!==null)for(i.callbacks=null,i=0;i<d.length;i++)ho(d[i],o)}var po=Ot(null),fo=Ot(0);function Uh(i,o){i=Ja,ii(fo,i),ii(po,o),Ja=i|o.baseLanes}function mo(){ii(fo,Ja),ii(po,po.current)}function Xr(){Ja=fo.current,Ht(po),Ht(fo)}var za=0,$i=null,Ir=null,mn=null,sh=!1,fu=!1,Yr=!1,zc=0,ui=0,Ti=null,oh=0;function Or(){throw Error($(321))}function Vo(i,o){if(o===null)return!1;for(var d=0;d<o.length&&d<i.length;d++)if(!pa(i[d],o[d]))return!1;return!0}function Fn(i,o,d,x,k,O){return za=O,$i=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,gt.H=i===null||i.memoizedState===null?Un:Go,Yr=!1,O=d(x,k),Yr=!1,fu&&(O=Qn(o,d,x,k)),Dd(i),O}function Dd(i){gt.H=ya;var o=Ir!==null&&Ir.next!==null;if(za=0,mn=Ir=$i=null,sh=!1,ui=0,Ti=null,o)throw Error($(300));i===null||Ia||(i=i.dependencies,i!==null&&eh(i)&&(Ia=!0))}function Qn(i,o,d,x){$i=i;var k=0;do{if(fu&&(Ti=null),ui=0,fu=!1,25<=k)throw Error($(301));if(k+=1,mn=Ir=null,i.updateQueue!=null){var O=i.updateQueue;O.lastEffect=null,O.events=null,O.stores=null,O.memoCache!=null&&(O.memoCache.index=0)}gt.H=Ss,O=o(d,x)}while(fu);return O}function go(){var i=gt.H,o=i.useState()[0];return o=typeof o.then=="function"?bl(o):o,i=i.useState()[0],(Ir!==null?Ir.memoizedState:null)!==i&&($i.flags|=1024),o}function vl(){var i=zc!==0;return zc=0,i}function Wr(i,o,d){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~d}function er(i){if(sh){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}sh=!1}za=0,mn=Ir=$i=null,fu=!1,ui=zc=0,Ti=null}function La(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mn===null?$i.memoizedState=mn=i:mn=mn.next=i,mn}function Kr(){if(Ir===null){var i=$i.alternate;i=i!==null?i.memoizedState:null}else i=Ir.next;var o=mn===null?$i.memoizedState:mn.next;if(o!==null)mn=o,Ir=i;else{if(i===null)throw $i.alternate===null?Error($(467)):Error($(310));Ir=i,i={memoizedState:Ir.memoizedState,baseState:Ir.baseState,baseQueue:Ir.baseQueue,queue:Ir.queue,next:null},mn===null?$i.memoizedState=mn=i:mn=mn.next=i}return mn}function yo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bl(i){var o=ui;return ui+=1,Ti===null&&(Ti=[]),i=Fh(Ti,i,o),o=$i,(mn===null?o.memoizedState:mn.next)===null&&(o=o.alternate,gt.H=o===null||o.memoizedState===null?Un:Go),i}function _o(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return bl(i);if(i.$$typeof===We)return Pn(i)}throw Error($(438,String(i)))}function ws(i){var o=null,d=$i.updateQueue;if(d!==null&&(o=d.memoCache),o==null){var x=$i.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(o={data:x.data.map(function(k){return k.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),d===null&&(d=yo(),$i.updateQueue=d),d.memoCache=o,d=o.data[o.index],d===void 0)for(d=o.data[o.index]=Array(i),x=0;x<i;x++)d[x]=_t;return o.index++,d}function Da(i,o){return typeof o=="function"?o(i):o}function mu(i){var o=Kr();return gu(o,Ir,i)}function gu(i,o,d){var x=i.queue;if(x===null)throw Error($(311));x.lastRenderedReducer=d;var k=i.baseQueue,O=x.pending;if(O!==null){if(k!==null){var se=k.next;k.next=O.next,O.next=se}o.baseQueue=k=O,x.pending=null}if(O=i.baseState,k===null)i.memoizedState=O;else{o=k.next;var xe=se=null,Xe=null,Tt=o,Ft=!1;do{var $t=Tt.lane&-536870913;if($t!==Tt.lane?(Sr&$t)===$t:(za&$t)===$t){var Ct=Tt.revertLane;if(Ct===0)Xe!==null&&(Xe=Xe.next={lane:0,revertLane:0,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null}),$t===gl&&(Ft=!0);else if((za&Ct)===Ct){Tt=Tt.next,Ct===gl&&(Ft=!0);continue}else $t={lane:0,revertLane:Tt.revertLane,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null},Xe===null?(xe=Xe=$t,se=O):Xe=Xe.next=$t,$i.lanes|=Ct,qo|=Ct;$t=Tt.action,Yr&&d(O,$t),O=Tt.hasEagerState?Tt.eagerState:d(O,$t)}else Ct={lane:$t,revertLane:Tt.revertLane,action:Tt.action,hasEagerState:Tt.hasEagerState,eagerState:Tt.eagerState,next:null},Xe===null?(xe=Xe=Ct,se=O):Xe=Xe.next=Ct,$i.lanes|=$t,qo|=$t;Tt=Tt.next}while(Tt!==null&&Tt!==o);if(Xe===null?se=O:Xe.next=xe,!pa(O,i.memoizedState)&&(Ia=!0,Ft&&(d=yl,d!==null)))throw d;i.memoizedState=O,i.baseState=se,i.baseQueue=Xe,x.lastRenderedState=O}return k===null&&(x.lanes=0),[i.memoizedState,x.dispatch]}function yu(i){var o=Kr(),d=o.queue;if(d===null)throw Error($(311));d.lastRenderedReducer=i;var x=d.dispatch,k=d.pending,O=o.memoizedState;if(k!==null){d.pending=null;var se=k=k.next;do O=i(O,se.action),se=se.next;while(se!==k);pa(O,o.memoizedState)||(Ia=!0),o.memoizedState=O,o.baseQueue===null&&(o.baseState=O),d.lastRenderedState=O}return[O,x]}function y(i,o,d){var x=$i,k=Kr(),O=Mr;if(O){if(d===void 0)throw Error($(407));d=d()}else d=o();var se=!pa((Ir||k).memoizedState,d);se&&(k.memoizedState=d,Ia=!0),k=k.queue;var xe=c.bind(null,x,k,i);if(it(2048,8,xe,[i]),k.getSnapshot!==o||se||mn!==null&&mn.memoizedState.tag&1){if(x.flags|=2048,De(9,Ge(),r.bind(null,x,k,d,o),null),Pr===null)throw Error($(349));O||(za&124)!==0||e(x,o,d)}return d}function e(i,o,d){i.flags|=16384,i={getSnapshot:o,value:d},o=$i.updateQueue,o===null?(o=yo(),$i.updateQueue=o,o.stores=[i]):(d=o.stores,d===null?o.stores=[i]:d.push(i))}function r(i,o,d,x){o.value=d,o.getSnapshot=x,f(o)&&_(i)}function c(i,o,d){return d(function(){f(o)&&_(i)})}function f(i){var o=i.getSnapshot;i=i.value;try{var d=o();return!pa(i,d)}catch{return!0}}function _(i){var o=Is(i,2);o!==null&&cs(o,i,2)}function M(i){var o=La();if(typeof i=="function"){var d=i;if(i=d(),Yr){sa(!0);try{d()}finally{sa(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:i},o}function P(i,o,d,x){return i.baseState=d,gu(i,Ir,typeof x=="function"?x:Da)}function L(i,o,d,x,k){if(Wl(i))throw Error($(485));if(i=o.action,i!==null){var O={payload:k,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(se){O.listeners.push(se)}};gt.T!==null?d(!0):O.isTransition=!1,x(O),d=o.pending,d===null?(O.next=o.pending=O,V(o,O)):(O.next=d.next,o.pending=d.next=O)}}function V(i,o){var d=o.action,x=o.payload,k=i.state;if(o.isTransition){var O=gt.T,se={};gt.T=se;try{var xe=d(k,x),Xe=gt.S;Xe!==null&&Xe(se,xe),q(i,o,xe)}catch(Tt){W(i,o,Tt)}finally{gt.T=O}}else try{O=d(k,x),q(i,o,O)}catch(Tt){W(i,o,Tt)}}function q(i,o,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(x){K(i,o,x)},function(x){return W(i,o,x)}):K(i,o,d)}function K(i,o,d){o.status="fulfilled",o.value=d,te(o),i.state=d,o=i.pending,o!==null&&(d=o.next,d===o?i.pending=null:(d=d.next,o.next=d,V(i,d)))}function W(i,o,d){var x=i.pending;if(i.pending=null,x!==null){x=x.next;do o.status="rejected",o.reason=d,te(o),o=o.next;while(o!==x)}i.action=null}function te(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function he(i,o){return o}function Ae(i,o){if(Mr){var d=Pr.formState;if(d!==null){e:{var x=$i;if(Mr){if(vn){t:{for(var k=vn,O=Os;k.nodeType!==8;){if(!O){k=null;break t}if(k=Bi(k.nextSibling),k===null){k=null;break t}}O=k.data,k=O==="F!"||O==="F"?k:null}if(k){vn=Bi(k.nextSibling),x=k.data==="F!";break e}}Gl(x)}x=!1}x&&(o=d[0])}}return d=La(),d.memoizedState=d.baseState=o,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:he,lastRenderedState:o},d.queue=x,d=wl.bind(null,$i,x),x.dispatch=d,x=M(!1),O=Bs.bind(null,$i,!1,x.queue),x=La(),k={state:o,dispatch:null,action:i,pending:null},x.queue=k,d=L.bind(null,$i,k,O,d),k.dispatch=d,x.memoizedState=i,[o,d,!1]}function Ce(i){var o=Kr();return ke(o,Ir,i)}function ke(i,o,d){if(o=gu(i,o,he)[0],i=mu(Da)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var x=bl(o)}catch(se){throw se===ih?ql:se}else x=o;o=Kr();var k=o.queue,O=k.dispatch;return d!==o.memoizedState&&($i.flags|=2048,De(9,Ge(),ze.bind(null,k,d),null)),[x,O,i]}function ze(i,o){i.action=o}function Le(i){var o=Kr(),d=Ir;if(d!==null)return ke(o,d,i);Kr(),o=o.memoizedState,d=Kr();var x=d.queue.dispatch;return d.memoizedState=i,[o,x,!1]}function De(i,o,d,x){return i={tag:i,create:d,deps:x,inst:o,next:null},o=$i.updateQueue,o===null&&(o=yo(),$i.updateQueue=o),d=o.lastEffect,d===null?o.lastEffect=i.next=i:(x=d.next,d.next=i,i.next=x,o.lastEffect=i),i}function Ge(){return{destroy:void 0,resource:void 0}}function Ye(){return Kr().memoizedState}function Re(i,o,d,x){var k=La();x=x===void 0?null:x,$i.flags|=i,k.memoizedState=De(1|o,Ge(),d,x)}function it(i,o,d,x){var k=Kr();x=x===void 0?null:x;var O=k.memoizedState.inst;Ir!==null&&x!==null&&Vo(x,Ir.memoizedState.deps)?k.memoizedState=De(o,O,d,x):($i.flags|=i,k.memoizedState=De(1|o,O,d,x))}function vt(i,o){Re(8390656,8,i,o)}function ot(i,o){it(2048,8,i,o)}function ft(i,o){return it(4,2,i,o)}function wt(i,o){return it(4,4,i,o)}function ei(i,o){if(typeof o=="function"){i=i();var d=o(i);return function(){typeof d=="function"?d():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Kt(i,o,d){d=d!=null?d.concat([i]):null,it(4,4,ei.bind(null,o,i),d)}function Lt(){}function pi(i,o){var d=Kr();o=o===void 0?null:o;var x=d.memoizedState;return o!==null&&Vo(o,x[1])?x[0]:(d.memoizedState=[i,o],i)}function Hi(i,o){var d=Kr();o=o===void 0?null:o;var x=d.memoizedState;if(o!==null&&Vo(o,x[1]))return x[0];if(x=i(),Yr){sa(!0);try{i()}finally{sa(!1)}}return d.memoizedState=[x,o],x}function xr(i,o,d){return d===void 0||(za&1073741824)!==0?i.memoizedState=o:(i.memoizedState=d,i=Fp(),$i.lanes|=i,qo|=i,d)}function Xi(i,o,d,x){return pa(d,o)?d:po.current!==null?(i=xr(i,d,x),pa(i,o)||(Ia=!0),i):(za&42)===0?(Ia=!0,i.memoizedState=d):(i=Fp(),$i.lanes|=i,qo|=i,o)}function jr(i,o,d,x,k){var O=It.p;It.p=O!==0&&8>O?O:8;var se=gt.T,xe={};gt.T=xe,Bs(i,!1,o,d);try{var Xe=k(),Tt=gt.S;if(Tt!==null&&Tt(xe,Xe),Xe!==null&&typeof Xe=="object"&&typeof Xe.then=="function"){var Ft=oo(Xe,x);Ka(i,o,Ft,Gs(i))}else Ka(i,o,x,Gs(i))}catch($t){Ka(i,o,{then:function(){},status:"rejected",reason:$t},Gs())}finally{It.p=O,gt.T=se}}function tn(){}function cr(i,o,d,x){if(i.tag!==5)throw Error($(476));var k=nr(i).queue;jr(i,k,o,ti,d===null?tn:function(){return Fr(i),d(x)})}function nr(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:ti,baseState:ti,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:ti},next:null};var d={};return o.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:d},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function Fr(i){var o=nr(i).next.queue;Ka(i,o,{},Gs())}function Gn(){return Pn(we)}function hr(){return Kr().memoizedState}function $n(){return Kr().memoizedState}function Jn(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var d=Gs();i=Uo(d);var x=xl(o,i,d);x!==null&&(cs(x,o,d),uo(x,o,d)),o={cache:Zl()},i.payload=o;return}o=o.return}}function Yl(i,o,d){var x=Gs();d={lane:x,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},Wl(i)?Kl(o,d):(d=Ac(i,o,d,x),d!==null&&(cs(d,i,x),Lc(d,o,x)))}function wl(i,o,d){var x=Gs();Ka(i,o,d,x)}function Ka(i,o,d,x){var k={lane:x,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(Wl(i))Kl(o,k);else{var O=i.alternate;if(i.lanes===0&&(O===null||O.lanes===0)&&(O=o.lastRenderedReducer,O!==null))try{var se=o.lastRenderedState,xe=O(se,d);if(k.hasEagerState=!0,k.eagerState=xe,pa(xe,se))return Rs(i,o,k,0),Pr===null&&Aa(),!1}catch{}finally{}if(d=Ac(i,o,k,x),d!==null)return cs(d,i,x),Lc(d,o,x),!0}return!1}function Bs(i,o,d,x){if(x={lane:2,revertLane:Pu(),action:x,hasEagerState:!1,eagerState:null,next:null},Wl(i)){if(o)throw Error($(479))}else o=Ac(i,d,x,2),o!==null&&cs(o,i,2)}function Wl(i){var o=i.alternate;return i===$i||o!==null&&o===$i}function Kl(i,o){fu=sh=!0;var d=i.pending;d===null?o.next=o:(o.next=d.next,d.next=o),i.pending=o}function Lc(i,o,d){if((d&4194048)!==0){var x=o.lanes;x&=i.pendingLanes,d|=x,o.lanes=d,He(i,d)}}var ya={readContext:Pn,use:_o,useCallback:Or,useContext:Or,useEffect:Or,useImperativeHandle:Or,useLayoutEffect:Or,useInsertionEffect:Or,useMemo:Or,useReducer:Or,useRef:Or,useState:Or,useDebugValue:Or,useDeferredValue:Or,useTransition:Or,useSyncExternalStore:Or,useId:Or,useHostTransitionStatus:Or,useFormState:Or,useActionState:Or,useOptimistic:Or,useMemoCache:Or,useCacheRefresh:Or},Un={readContext:Pn,use:_o,useCallback:function(i,o){return La().memoizedState=[i,o===void 0?null:o],i},useContext:Pn,useEffect:vt,useImperativeHandle:function(i,o,d){d=d!=null?d.concat([i]):null,Re(4194308,4,ei.bind(null,o,i),d)},useLayoutEffect:function(i,o){return Re(4194308,4,i,o)},useInsertionEffect:function(i,o){Re(4,2,i,o)},useMemo:function(i,o){var d=La();o=o===void 0?null:o;var x=i();if(Yr){sa(!0);try{i()}finally{sa(!1)}}return d.memoizedState=[x,o],x},useReducer:function(i,o,d){var x=La();if(d!==void 0){var k=d(o);if(Yr){sa(!0);try{d(o)}finally{sa(!1)}}}else k=o;return x.memoizedState=x.baseState=k,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:k},x.queue=i,i=i.dispatch=Yl.bind(null,$i,i),[x.memoizedState,i]},useRef:function(i){var o=La();return i={current:i},o.memoizedState=i},useState:function(i){i=M(i);var o=i.queue,d=wl.bind(null,$i,o);return o.dispatch=d,[i.memoizedState,d]},useDebugValue:Lt,useDeferredValue:function(i,o){var d=La();return xr(d,i,o)},useTransition:function(){var i=M(!1);return i=jr.bind(null,$i,i.queue,!0,!1),La().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,d){var x=$i,k=La();if(Mr){if(d===void 0)throw Error($(407));d=d()}else{if(d=o(),Pr===null)throw Error($(349));(Sr&124)!==0||e(x,o,d)}k.memoizedState=d;var O={value:d,getSnapshot:o};return k.queue=O,vt(c.bind(null,x,O,i),[i]),x.flags|=2048,De(9,Ge(),r.bind(null,x,O,d,o),null),d},useId:function(){var i=La(),o=Pr.identifierPrefix;if(Mr){var d=_s,x=is;d=(x&~(1<<32-oa(x)-1)).toString(32)+d,o="«"+o+"R"+d,d=zc++,0<d&&(o+="H"+d.toString(32)),o+="»"}else d=oh++,o="«"+o+"r"+d.toString(32)+"»";return i.memoizedState=o},useHostTransitionStatus:Gn,useFormState:Ae,useActionState:Ae,useOptimistic:function(i){var o=La();o.memoizedState=o.baseState=i;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=d,o=Bs.bind(null,$i,!0,d),d.dispatch=o,[i,o]},useMemoCache:ws,useCacheRefresh:function(){return La().memoizedState=Jn.bind(null,$i)}},Go={readContext:Pn,use:_o,useCallback:pi,useContext:Pn,useEffect:ot,useImperativeHandle:Kt,useInsertionEffect:ft,useLayoutEffect:wt,useMemo:Hi,useReducer:mu,useRef:Ye,useState:function(){return mu(Da)},useDebugValue:Lt,useDeferredValue:function(i,o){var d=Kr();return Xi(d,Ir.memoizedState,i,o)},useTransition:function(){var i=mu(Da)[0],o=Kr().memoizedState;return[typeof i=="boolean"?i:bl(i),o]},useSyncExternalStore:y,useId:hr,useHostTransitionStatus:Gn,useFormState:Ce,useActionState:Ce,useOptimistic:function(i,o){var d=Kr();return P(d,Ir,i,o)},useMemoCache:ws,useCacheRefresh:$n},Ss={readContext:Pn,use:_o,useCallback:pi,useContext:Pn,useEffect:ot,useImperativeHandle:Kt,useInsertionEffect:ft,useLayoutEffect:wt,useMemo:Hi,useReducer:yu,useRef:Ye,useState:function(){return yu(Da)},useDebugValue:Lt,useDeferredValue:function(i,o){var d=Kr();return Ir===null?xr(d,i,o):Xi(d,Ir.memoizedState,i,o)},useTransition:function(){var i=yu(Da)[0],o=Kr().memoizedState;return[typeof i=="boolean"?i:bl(i),o]},useSyncExternalStore:y,useId:hr,useHostTransitionStatus:Gn,useFormState:Le,useActionState:Le,useOptimistic:function(i,o){var d=Kr();return Ir!==null?P(d,Ir,i,o):(d.baseState=i,[i,d.queue.dispatch])},useMemoCache:ws,useCacheRefresh:$n},mr=null,Br=0;function ea(i){var o=Br;return Br+=1,mr===null&&(mr=[]),Fh(mr,i,o)}function gn(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function lh(i,o){throw o.$$typeof===Ve?Error($(525)):(i=Object.prototype.toString.call(o),Error($(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function Vh(i){var o=i._init;return o(i._payload)}function ch(i){function o(dt,st){if(i){var bt=dt.deletions;bt===null?(dt.deletions=[st],dt.flags|=16):bt.push(st)}}function d(dt,st){if(!i)return null;for(;st!==null;)o(dt,st),st=st.sibling;return null}function x(dt){for(var st=new Map;dt!==null;)dt.key!==null?st.set(dt.key,dt):st.set(dt.index,dt),dt=dt.sibling;return st}function k(dt,st){return dt=ga(dt,st),dt.index=0,dt.sibling=null,dt}function O(dt,st,bt){return dt.index=bt,i?(bt=dt.alternate,bt!==null?(bt=bt.index,bt<st?(dt.flags|=67108866,st):bt):(dt.flags|=67108866,st)):(dt.flags|=1048576,st)}function se(dt){return i&&dt.alternate===null&&(dt.flags|=67108866),dt}function xe(dt,st,bt,Vt){return st===null||st.tag!==6?(st=Oh(bt,dt.mode,Vt),st.return=dt,st):(st=k(st,bt),st.return=dt,st)}function Xe(dt,st,bt,Vt){var Ci=bt.type;return Ci===Se?Ft(dt,st,bt.props.children,Vt,bt.key):st!==null&&(st.elementType===Ci||typeof Ci=="object"&&Ci!==null&&Ci.$$typeof===Ue&&Vh(Ci)===st.type)?(st=k(st,bt.props),gn(st,bt),st.return=dt,st):(st=Ar(bt.type,bt.key,bt.props,null,dt.mode,Vt),gn(st,bt),st.return=dt,st)}function Tt(dt,st,bt,Vt){return st===null||st.tag!==4||st.stateNode.containerInfo!==bt.containerInfo||st.stateNode.implementation!==bt.implementation?(st=Ku(bt,dt.mode,Vt),st.return=dt,st):(st=k(st,bt.children||[]),st.return=dt,st)}function Ft(dt,st,bt,Vt,Ci){return st===null||st.tag!==7?(st=ro(bt,dt.mode,Vt,Ci),st.return=dt,st):(st=k(st,bt),st.return=dt,st)}function $t(dt,st,bt){if(typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint")return st=Oh(""+st,dt.mode,bt),st.return=dt,st;if(typeof st=="object"&&st!==null){switch(st.$$typeof){case Ee:return bt=Ar(st.type,st.key,st.props,null,dt.mode,bt),gn(bt,st),bt.return=dt,bt;case pe:return st=Ku(st,dt.mode,bt),st.return=dt,st;case Ue:var Vt=st._init;return st=Vt(st._payload),$t(dt,st,bt)}if(wi(st)||ri(st))return st=ro(st,dt.mode,bt,null),st.return=dt,st;if(typeof st.then=="function")return $t(dt,ea(st),bt);if(st.$$typeof===We)return $t(dt,Fo(dt,st),bt);lh(dt,st)}return null}function Ct(dt,st,bt,Vt){var Ci=st!==null?st.key:null;if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return Ci!==null?null:xe(dt,st,""+bt,Vt);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case Ee:return bt.key===Ci?Xe(dt,st,bt,Vt):null;case pe:return bt.key===Ci?Tt(dt,st,bt,Vt):null;case Ue:return Ci=bt._init,bt=Ci(bt._payload),Ct(dt,st,bt,Vt)}if(wi(bt)||ri(bt))return Ci!==null?null:Ft(dt,st,bt,Vt,null);if(typeof bt.then=="function")return Ct(dt,st,ea(bt),Vt);if(bt.$$typeof===We)return Ct(dt,st,Fo(dt,bt),Vt);lh(dt,bt)}return null}function At(dt,st,bt,Vt,Ci){if(typeof Vt=="string"&&Vt!==""||typeof Vt=="number"||typeof Vt=="bigint")return dt=dt.get(bt)||null,xe(st,dt,""+Vt,Ci);if(typeof Vt=="object"&&Vt!==null){switch(Vt.$$typeof){case Ee:return dt=dt.get(Vt.key===null?bt:Vt.key)||null,Xe(st,dt,Vt,Ci);case pe:return dt=dt.get(Vt.key===null?bt:Vt.key)||null,Tt(st,dt,Vt,Ci);case Ue:var Tr=Vt._init;return Vt=Tr(Vt._payload),At(dt,st,bt,Vt,Ci)}if(wi(Vt)||ri(Vt))return dt=dt.get(bt)||null,Ft(st,dt,Vt,Ci,null);if(typeof Vt.then=="function")return At(dt,st,bt,ea(Vt),Ci);if(Vt.$$typeof===We)return At(dt,st,bt,Fo(st,Vt),Ci);lh(st,Vt)}return null}function Ni(dt,st,bt,Vt){for(var Ci=null,Tr=null,Ii=st,Ki=st=0,pn=null;Ii!==null&&Ki<bt.length;Ki++){Ii.index>Ki?(pn=Ii,Ii=null):pn=Ii.sibling;var Lr=Ct(dt,Ii,bt[Ki],Vt);if(Lr===null){Ii===null&&(Ii=pn);break}i&&Ii&&Lr.alternate===null&&o(dt,Ii),st=O(Lr,st,Ki),Tr===null?Ci=Lr:Tr.sibling=Lr,Tr=Lr,Ii=pn}if(Ki===bt.length)return d(dt,Ii),Mr&&Xa(dt,Ki),Ci;if(Ii===null){for(;Ki<bt.length;Ki++)Ii=$t(dt,bt[Ki],Vt),Ii!==null&&(st=O(Ii,st,Ki),Tr===null?Ci=Ii:Tr.sibling=Ii,Tr=Ii);return Mr&&Xa(dt,Ki),Ci}for(Ii=x(Ii);Ki<bt.length;Ki++)pn=At(Ii,dt,Ki,bt[Ki],Vt),pn!==null&&(i&&pn.alternate!==null&&Ii.delete(pn.key===null?Ki:pn.key),st=O(pn,st,Ki),Tr===null?Ci=pn:Tr.sibling=pn,Tr=pn);return i&&Ii.forEach(function(bh){return o(dt,bh)}),Mr&&Xa(dt,Ki),Ci}function Yi(dt,st,bt,Vt){if(bt==null)throw Error($(151));for(var Ci=null,Tr=null,Ii=st,Ki=st=0,pn=null,Lr=bt.next();Ii!==null&&!Lr.done;Ki++,Lr=bt.next()){Ii.index>Ki?(pn=Ii,Ii=null):pn=Ii.sibling;var bh=Ct(dt,Ii,Lr.value,Vt);if(bh===null){Ii===null&&(Ii=pn);break}i&&Ii&&bh.alternate===null&&o(dt,Ii),st=O(bh,st,Ki),Tr===null?Ci=bh:Tr.sibling=bh,Tr=bh,Ii=pn}if(Lr.done)return d(dt,Ii),Mr&&Xa(dt,Ki),Ci;if(Ii===null){for(;!Lr.done;Ki++,Lr=bt.next())Lr=$t(dt,Lr.value,Vt),Lr!==null&&(st=O(Lr,st,Ki),Tr===null?Ci=Lr:Tr.sibling=Lr,Tr=Lr);return Mr&&Xa(dt,Ki),Ci}for(Ii=x(Ii);!Lr.done;Ki++,Lr=bt.next())Lr=At(Ii,dt,Ki,Lr.value,Vt),Lr!==null&&(i&&Lr.alternate!==null&&Ii.delete(Lr.key===null?Ki:Lr.key),st=O(Lr,st,Ki),Tr===null?Ci=Lr:Tr.sibling=Lr,Tr=Lr);return i&&Ii.forEach(function(dg){return o(dt,dg)}),Mr&&Xa(dt,Ki),Ci}function nn(dt,st,bt,Vt){if(typeof bt=="object"&&bt!==null&&bt.type===Se&&bt.key===null&&(bt=bt.props.children),typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case Ee:e:{for(var Ci=bt.key;st!==null;){if(st.key===Ci){if(Ci=bt.type,Ci===Se){if(st.tag===7){d(dt,st.sibling),Vt=k(st,bt.props.children),Vt.return=dt,dt=Vt;break e}}else if(st.elementType===Ci||typeof Ci=="object"&&Ci!==null&&Ci.$$typeof===Ue&&Vh(Ci)===st.type){d(dt,st.sibling),Vt=k(st,bt.props),gn(Vt,bt),Vt.return=dt,dt=Vt;break e}d(dt,st);break}else o(dt,st);st=st.sibling}bt.type===Se?(Vt=ro(bt.props.children,dt.mode,Vt,bt.key),Vt.return=dt,dt=Vt):(Vt=Ar(bt.type,bt.key,bt.props,null,dt.mode,Vt),gn(Vt,bt),Vt.return=dt,dt=Vt)}return se(dt);case pe:e:{for(Ci=bt.key;st!==null;){if(st.key===Ci)if(st.tag===4&&st.stateNode.containerInfo===bt.containerInfo&&st.stateNode.implementation===bt.implementation){d(dt,st.sibling),Vt=k(st,bt.children||[]),Vt.return=dt,dt=Vt;break e}else{d(dt,st);break}else o(dt,st);st=st.sibling}Vt=Ku(bt,dt.mode,Vt),Vt.return=dt,dt=Vt}return se(dt);case Ue:return Ci=bt._init,bt=Ci(bt._payload),nn(dt,st,bt,Vt)}if(wi(bt))return Ni(dt,st,bt,Vt);if(ri(bt)){if(Ci=ri(bt),typeof Ci!="function")throw Error($(150));return bt=Ci.call(bt),Yi(dt,st,bt,Vt)}if(typeof bt.then=="function")return nn(dt,st,ea(bt),Vt);if(bt.$$typeof===We)return nn(dt,st,Fo(dt,bt),Vt);lh(dt,bt)}return typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint"?(bt=""+bt,st!==null&&st.tag===6?(d(dt,st.sibling),Vt=k(st,bt),Vt.return=dt,dt=Vt):(d(dt,st),Vt=Oh(bt,dt.mode,Vt),Vt.return=dt,dt=Vt),se(dt)):d(dt,st)}return function(dt,st,bt,Vt){try{Br=0;var Ci=nn(dt,st,bt,Vt);return mr=null,Ci}catch(Ii){if(Ii===ih||Ii===ql)throw Ii;var Tr=Ea(29,Ii,null,dt.mode);return Tr.lanes=Vt,Tr.return=dt,Tr}finally{}}}var Ns=ch(!0),Dc=ch(!1),wn=Ot(null),Gr=null;function Ra(i){var o=i.alternate;ii(Sn,Sn.current&1),ii(wn,i),Gr===null&&(o===null||po.current!==null||o.memoizedState!==null)&&(Gr=i)}function uh(i){if(i.tag===22){if(ii(Sn,Sn.current),ii(wn,i),Gr===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(Gr=i)}}else Ln()}function Ln(){ii(Sn,Sn.current),ii(wn,wn.current)}function Qa(i){Ht(wn),Gr===i&&(Gr=null),Ht(Sn)}var Sn=Ot(0);function Ql(i){for(var o=i;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||Di(d)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Rd(i,o,d,x){o=i.memoizedState,d=d(x,o),d=d==null?o:Te({},o,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var Sl={enqueueSetState:function(i,o,d){i=i._reactInternals;var x=Gs(),k=Uo(x);k.payload=o,d!=null&&(k.callback=d),o=xl(i,k,x),o!==null&&(cs(o,i,x),uo(o,i,x))},enqueueReplaceState:function(i,o,d){i=i._reactInternals;var x=Gs(),k=Uo(x);k.tag=1,k.payload=o,d!=null&&(k.callback=d),o=xl(i,k,x),o!==null&&(cs(o,i,x),uo(o,i,x))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var d=Gs(),x=Uo(d);x.tag=2,o!=null&&(x.callback=o),o=xl(i,x,d),o!==null&&(cs(o,i,d),uo(o,i,d))}};function Jl(i,o,d,x,k,O,se){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(x,O,se):o.prototype&&o.prototype.isPureReactComponent?!au(d,x)||!au(k,O):!0}function Sp(i,o,d,x){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,x),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,x),o.state!==i&&Sl.enqueueReplaceState(o,o.state,null)}function Rc(i,o){var d=o;if("ref"in o){d={};for(var x in o)x!=="ref"&&(d[x]=o[x])}if(i=i.defaultProps){d===o&&(d=Te({},d));for(var k in i)d[k]===void 0&&(d[k]=i[k])}return d}var os=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function ec(i){os(i)}function sf(i){console.error(i)}function of(i){os(i)}function Tp(i,o){try{var d=i.onUncaughtError;d(o.value,{componentStack:o.stack})}catch(x){setTimeout(function(){throw x})}}function Gh(i,o,d){try{var x=i.onCaughtError;x(d.value,{componentStack:d.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(k){setTimeout(function(){throw k})}}function tc(i,o,d){return d=Uo(d),d.tag=3,d.payload={element:null},d.callback=function(){Tp(i,o)},d}function $h(i){return i=Uo(i),i.tag=3,i}function vr(i,o,d,x){var k=d.type.getDerivedStateFromError;if(typeof k=="function"){var O=x.value;i.payload=function(){return k(O)},i.callback=function(){Gh(o,d,x)}}var se=d.stateNode;se!==null&&typeof se.componentDidCatch=="function"&&(i.callback=function(){Gh(o,d,x),typeof k!="function"&&(Uc===null?Uc=new Set([this]):Uc.add(this));var xe=x.stack;this.componentDidCatch(x.value,{componentStack:xe!==null?xe:""})})}function Nf(i,o,d,x,k){if(d.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(o=d.alternate,o!==null&&Pa(o,d,k,!0),d=wn.current,d!==null){switch(d.tag){case 13:return Gr===null?xf():d.alternate===null&&un===0&&(un=3),d.flags&=-257,d.flags|=65536,d.lanes=k,x===vs?d.flags|=16384:(o=d.updateQueue,o===null?d.updateQueue=new Set([x]):o.add(x),Tf(i,x,k)),!1;case 22:return d.flags|=65536,x===vs?d.flags|=16384:(o=d.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([x])},d.updateQueue=o):(d=o.retryQueue,d===null?o.retryQueue=new Set([x]):d.add(x)),Tf(i,x,k)),!1}throw Error($(435,d.tag))}return Tf(i,x,k),xf(),!1}if(Mr)return o=wn.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=k,x!==jh&&(i=Error($(422),{cause:x}),js(ys(i,d)))):(x!==jh&&(o=Error($(423),{cause:x}),js(ys(o,d))),i=i.current.alternate,i.flags|=65536,k&=-k,i.lanes|=k,x=ys(x,d),k=tc(i.stateNode,x,k),ah(i,k),un!==4&&(un=2)),!1;var O=Error($(520),{cause:x});if(O=ys(O,d),Au===null?Au=[O]:Au.push(O),un!==4&&(un=2),o===null)return!0;x=ys(x,d),d=o;do{switch(d.tag){case 3:return d.flags|=65536,i=k&-k,d.lanes|=i,i=tc(d.stateNode,x,i),ah(d,i),!1;case 1:if(o=d.type,O=d.stateNode,(d.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(Uc===null||!Uc.has(O))))return d.flags|=65536,k&=-k,d.lanes|=k,k=$h(k),vr(k,i,d,x),ah(d,k),!1}d=d.return}while(d!==null);return!1}var Ic=Error($(461)),Ia=!1;function ln(i,o,d,x){o.child=i===null?Dc(o,null,d,x):Ns(o,i.child,d,x)}function Id(i,o,d,x,k){d=d.render;var O=o.ref;if("ref"in x){var se={};for(var xe in x)xe!=="ref"&&(se[xe]=x[xe])}else se=x;return Hl(o),x=Fn(i,o,d,se,O,k),xe=vl(),i!==null&&!Ia?(Wr(i,o,k),ic(i,o,k)):(Mr&&xe&&Bo(o),o.flags|=1,ln(i,o,x,k),o.child)}function _u(i,o,d,x,k){if(i===null){var O=d.type;return typeof O=="function"&&!ir(O)&&O.defaultProps===void 0&&d.compare===null?(o.tag=15,o.type=O,$o(i,o,O,x,k)):(i=Ar(d.type,null,x,o,o.mode,k),i.ref=o.ref,i.return=o,o.child=i)}if(O=i.child,!kp(i,k)){var se=O.memoizedProps;if(d=d.compare,d=d!==null?d:au,d(se,x)&&i.ref===o.ref)return ic(i,o,k)}return o.flags|=1,i=ga(O,x),i.ref=o.ref,i.return=o,o.child=i}function $o(i,o,d,x,k){if(i!==null){var O=i.memoizedProps;if(au(O,x)&&i.ref===o.ref)if(Ia=!1,o.pendingProps=x=O,kp(i,k))(i.flags&131072)!==0&&(Ia=!0);else return o.lanes=i.lanes,ic(i,o,k)}return jd(i,o,d,x,k)}function Od(i,o,d){var x=o.pendingProps,k=x.children,O=i!==null?i.memoizedState:null;if(x.mode==="hidden"){if((o.flags&128)!==0){if(x=O!==null?O.baseLanes|d:d,i!==null){for(k=o.child=i.child,O=0;k!==null;)O=O|k.lanes|k.childLanes,k=k.sibling;o.childLanes=O&~x}else o.childLanes=0,o.child=null;return Oa(i,o,x,d)}if((d&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&Nh(o,O!==null?O.cachePool:null),O!==null?Uh(o,O):mo(),uh(o);else return o.lanes=o.childLanes=536870912,Oa(i,o,O!==null?O.baseLanes|d:d,d)}else O!==null?(Nh(o,O.cachePool),Uh(o,O),Ln(),o.memoizedState=null):(i!==null&&Nh(o,null),mo(),Ln());return ln(i,o,k,d),o.child}function Oa(i,o,d,x){var k=_l();return k=k===null?null:{parent:zn._currentValue,pool:k},o.memoizedState={baseLanes:d,cachePool:k},i!==null&&Nh(o,null),mo(),uh(o),i!==null&&Pa(i,o,x,!0),null}function Mp(i,o){var d=o.ref;if(d===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error($(284));(i===null||i.ref!==d)&&(o.flags|=4194816)}}function jd(i,o,d,x,k){return Hl(o),d=Fn(i,o,d,x,void 0,k),x=vl(),i!==null&&!Ia?(Wr(i,o,k),ic(i,o,k)):(Mr&&x&&Bo(o),o.flags|=1,ln(i,o,d,k),o.child)}function Cp(i,o,d,x,k,O){return Hl(o),o.updateQueue=null,d=Qn(o,x,d,k),Dd(i),x=vl(),i!==null&&!Ia?(Wr(i,o,O),ic(i,o,O)):(Mr&&x&&Bo(o),o.flags|=1,ln(i,o,d,O),o.child)}function Hh(i,o,d,x,k){if(Hl(o),o.stateNode===null){var O=io,se=d.contextType;typeof se=="object"&&se!==null&&(O=Pn(se)),O=new d(x,O),o.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,O.updater=Sl,o.stateNode=O,O._reactInternals=o,O=o.stateNode,O.props=x,O.state=o.memoizedState,O.refs={},nh(o),se=d.contextType,O.context=typeof se=="object"&&se!==null?Pn(se):io,O.state=o.memoizedState,se=d.getDerivedStateFromProps,typeof se=="function"&&(Rd(o,d,se,x),O.state=o.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof O.getSnapshotBeforeUpdate=="function"||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(se=O.state,typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount(),se!==O.state&&Sl.enqueueReplaceState(O,O.state,null),Xl(o,x,O,k),Pc(),O.state=o.memoizedState),typeof O.componentDidMount=="function"&&(o.flags|=4194308),x=!0}else if(i===null){O=o.stateNode;var xe=o.memoizedProps,Xe=Rc(d,xe);O.props=Xe;var Tt=O.context,Ft=d.contextType;se=io,typeof Ft=="object"&&Ft!==null&&(se=Pn(Ft));var $t=d.getDerivedStateFromProps;Ft=typeof $t=="function"||typeof O.getSnapshotBeforeUpdate=="function",xe=o.pendingProps!==xe,Ft||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(xe||Tt!==se)&&Sp(o,O,x,se),bs=!1;var Ct=o.memoizedState;O.state=Ct,Xl(o,x,O,k),Pc(),Tt=o.memoizedState,xe||Ct!==Tt||bs?(typeof $t=="function"&&(Rd(o,d,$t,x),Tt=o.memoizedState),(Xe=bs||Jl(o,d,Xe,x,Ct,Tt,se))?(Ft||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(o.flags|=4194308)):(typeof O.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=x,o.memoizedState=Tt),O.props=x,O.state=Tt,O.context=se,x=Xe):(typeof O.componentDidMount=="function"&&(o.flags|=4194308),x=!1)}else{O=o.stateNode,rr(i,o),se=o.memoizedProps,Ft=Rc(d,se),O.props=Ft,$t=o.pendingProps,Ct=O.context,Tt=d.contextType,Xe=io,typeof Tt=="object"&&Tt!==null&&(Xe=Pn(Tt)),xe=d.getDerivedStateFromProps,(Tt=typeof xe=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(se!==$t||Ct!==Xe)&&Sp(o,O,x,Xe),bs=!1,Ct=o.memoizedState,O.state=Ct,Xl(o,x,O,k),Pc();var At=o.memoizedState;se!==$t||Ct!==At||bs||i!==null&&i.dependencies!==null&&eh(i.dependencies)?(typeof xe=="function"&&(Rd(o,d,xe,x),At=o.memoizedState),(Ft=bs||Jl(o,d,Ft,x,Ct,At,Xe)||i!==null&&i.dependencies!==null&&eh(i.dependencies))?(Tt||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(x,At,Xe),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(x,At,Xe)),typeof O.componentDidUpdate=="function"&&(o.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof O.componentDidUpdate!="function"||se===i.memoizedProps&&Ct===i.memoizedState||(o.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||se===i.memoizedProps&&Ct===i.memoizedState||(o.flags|=1024),o.memoizedProps=x,o.memoizedState=At),O.props=x,O.state=At,O.context=Xe,x=Ft):(typeof O.componentDidUpdate!="function"||se===i.memoizedProps&&Ct===i.memoizedState||(o.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||se===i.memoizedProps&&Ct===i.memoizedState||(o.flags|=1024),x=!1)}return O=x,Mp(i,o),x=(o.flags&128)!==0,O||x?(O=o.stateNode,d=x&&typeof d.getDerivedStateFromError!="function"?null:O.render(),o.flags|=1,i!==null&&x?(o.child=Ns(o,i.child,null,k),o.child=Ns(o,null,d,k)):ln(i,o,d,k),o.memoizedState=O.state,i=o.child):i=ic(i,o,k),i}function Ff(i,o,d,x){return lu(),o.flags|=256,ln(i,o,d,x),o.child}var Bd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Tl(i){return{baseLanes:i,cachePool:th()}}function Nd(i,o,d){return i=i!==null?i.childLanes&~d:0,o&&(i|=Xo),i}function Zh(i,o,d){var x=o.pendingProps,k=!1,O=(o.flags&128)!==0,se;if((se=O)||(se=i!==null&&i.memoizedState===null?!1:(Sn.current&2)!==0),se&&(k=!0,o.flags&=-129),se=(o.flags&32)!==0,o.flags&=-33,i===null){if(Mr){if(k?Ra(o):Ln(),Mr){var xe=vn,Xe;if(Xe=xe){e:{for(Xe=xe,xe=Os;Xe.nodeType!==8;){if(!xe){xe=null;break e}if(Xe=Bi(Xe.nextSibling),Xe===null){xe=null;break e}}xe=Xe}xe!==null?(o.memoizedState={dehydrated:xe,treeContext:no!==null?{id:is,overflow:_s}:null,retryLane:536870912,hydrationErrors:null},Xe=Ea(18,null,null,0),Xe.stateNode=xe,Xe.return=o,o.child=Xe,xn=o,vn=null,Xe=!0):Xe=!1}Xe||Gl(o)}if(xe=o.memoizedState,xe!==null&&(xe=xe.dehydrated,xe!==null))return Di(xe)?o.lanes=32:o.lanes=536870912,null;Qa(o)}return xe=x.children,x=x.fallback,k?(Ln(),k=o.mode,xe=xu({mode:"hidden",children:xe},k),x=ro(x,k,d,null),xe.return=o,x.return=o,xe.sibling=x,o.child=xe,k=o.child,k.memoizedState=Tl(d),k.childLanes=Nd(i,se,d),o.memoizedState=Bd,x):(Ra(o),Tn(o,xe))}if(Xe=i.memoizedState,Xe!==null&&(xe=Xe.dehydrated,xe!==null)){if(O)o.flags&256?(Ra(o),o.flags&=-257,o=hh(i,o,d)):o.memoizedState!==null?(Ln(),o.child=i.child,o.flags|=128,o=null):(Ln(),k=x.fallback,xe=o.mode,x=xu({mode:"visible",children:x.children},xe),k=ro(k,xe,d,null),k.flags|=2,x.return=o,k.return=o,x.sibling=k,o.child=x,Ns(o,i.child,null,d),x=o.child,x.memoizedState=Tl(d),x.childLanes=Nd(i,se,d),o.memoizedState=Bd,o=k);else if(Ra(o),Di(xe)){if(se=xe.nextSibling&&xe.nextSibling.dataset,se)var Tt=se.dgst;se=Tt,x=Error($(419)),x.stack="",x.digest=se,js({value:x,source:null,stack:null}),o=hh(i,o,d)}else if(Ia||Pa(i,o,d,!1),se=(d&i.childLanes)!==0,Ia||se){if(se=Pr,se!==null&&(x=d&-d,x=(x&42)!==0?1:ni(x),x=(x&(se.suspendedLanes|d))!==0?0:x,x!==0&&x!==Xe.retryLane))throw Xe.retryLane=x,Is(i,x),cs(se,i,x),Ic;xe.data==="$?"||xf(),o=hh(i,o,d)}else xe.data==="$?"?(o.flags|=192,o.child=i.child,o=null):(i=Xe.treeContext,vn=Bi(xe.nextSibling),xn=o,Mr=!0,Ya=null,Os=!1,i!==null&&(ka[xi++]=is,ka[xi++]=_s,ka[xi++]=no,is=i.id,_s=i.overflow,no=o),o=Tn(o,x.children),o.flags|=4096);return o}return k?(Ln(),k=x.fallback,xe=o.mode,Xe=i.child,Tt=Xe.sibling,x=ga(Xe,{mode:"hidden",children:x.children}),x.subtreeFlags=Xe.subtreeFlags&65011712,Tt!==null?k=ga(Tt,k):(k=ro(k,xe,d,null),k.flags|=2),k.return=o,x.return=o,x.sibling=k,o.child=x,x=k,k=o.child,xe=i.child.memoizedState,xe===null?xe=Tl(d):(Xe=xe.cachePool,Xe!==null?(Tt=zn._currentValue,Xe=Xe.parent!==Tt?{parent:Tt,pool:Tt}:Xe):Xe=th(),xe={baseLanes:xe.baseLanes|d,cachePool:Xe}),k.memoizedState=xe,k.childLanes=Nd(i,se,d),o.memoizedState=Bd,x):(Ra(o),d=i.child,i=d.sibling,d=ga(d,{mode:"visible",children:x.children}),d.return=o,d.sibling=null,i!==null&&(se=o.deletions,se===null?(o.deletions=[i],o.flags|=16):se.push(i)),o.child=d,o.memoizedState=null,d)}function Tn(i,o){return o=xu({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function xu(i,o){return i=Ea(22,i,null,o),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function hh(i,o,d){return Ns(o,i.child,null,d),i=Tn(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Ap(i,o,d){i.lanes|=o;var x=i.alternate;x!==null&&(x.lanes|=o),cu(i.return,o,d)}function Ep(i,o,d,x,k){var O=i.memoizedState;O===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:x,tail:d,tailMode:k}:(O.isBackwards=o,O.rendering=null,O.renderingStartTime=0,O.last=x,O.tail=d,O.tailMode=k)}function lf(i,o,d){var x=o.pendingProps,k=x.revealOrder,O=x.tail;if(ln(i,o,x.children,d),x=Sn.current,(x&2)!==0)x=x&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Ap(i,d,o);else if(i.tag===19)Ap(i,d,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}x&=1}switch(ii(Sn,x),k){case"forwards":for(d=o.child,k=null;d!==null;)i=d.alternate,i!==null&&Ql(i)===null&&(k=d),d=d.sibling;d=k,d===null?(k=o.child,o.child=null):(k=d.sibling,d.sibling=null),Ep(o,!1,k,d,O);break;case"backwards":for(d=null,k=o.child,o.child=null;k!==null;){if(i=k.alternate,i!==null&&Ql(i)===null){o.child=k;break}i=k.sibling,k.sibling=d,d=k,k=i}Ep(o,!0,d,null,O);break;case"together":Ep(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ic(i,o,d){if(i!==null&&(o.dependencies=i.dependencies),qo|=o.lanes,(d&o.childLanes)===0)if(i!==null){if(Pa(i,o,d,!1),(d&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error($(153));if(o.child!==null){for(i=o.child,d=ga(i,i.pendingProps),o.child=d,d.return=o;i.sibling!==null;)i=i.sibling,d=d.sibling=ga(i,i.pendingProps),d.return=o;d.sibling=null}return o.child}function kp(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&eh(i)))}function Uf(i,o,d){switch(o.tag){case 3:Zr(o,o.stateNode.containerInfo),xs(o,zn,i.memoizedState.cache),lu();break;case 27:case 5:Pl(o);break;case 4:Zr(o,o.stateNode.containerInfo);break;case 10:xs(o,o.type,o.memoizedProps.value);break;case 13:var x=o.memoizedState;if(x!==null)return x.dehydrated!==null?(Ra(o),o.flags|=128,null):(d&o.child.childLanes)!==0?Zh(i,o,d):(Ra(o),i=ic(i,o,d),i!==null?i.sibling:null);Ra(o);break;case 19:var k=(i.flags&128)!==0;if(x=(d&o.childLanes)!==0,x||(Pa(i,o,d,!1),x=(d&o.childLanes)!==0),k){if(x)return lf(i,o,d);o.flags|=128}if(k=o.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),ii(Sn,Sn.current),x)break;return null;case 22:case 23:return o.lanes=0,Od(i,o,d);case 24:xs(o,zn,i.memoizedState.cache)}return ic(i,o,d)}function vu(i,o,d){if(i!==null)if(i.memoizedProps!==o.pendingProps)Ia=!0;else{if(!kp(i,d)&&(o.flags&128)===0)return Ia=!1,Uf(i,o,d);Ia=(i.flags&131072)!==0}else Ia=!1,Mr&&(o.flags&1048576)!==0&&qi(o,Ec,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var x=o.elementType,k=x._init;if(x=k(x._payload),o.type=x,typeof x=="function")ir(x)?(i=Rc(x,i),o.tag=1,o=Hh(null,o,x,i,d)):(o.tag=0,o=jd(null,o,x,i,d));else{if(x!=null){if(k=x.$$typeof,k===ct){o.tag=11,o=Id(null,o,x,i,d);break e}else if(k===Pt){o.tag=14,o=_u(null,o,x,i,d);break e}}throw o=yi(x)||x,Error($(306,o,""))}}return o;case 0:return jd(i,o,o.type,o.pendingProps,d);case 1:return x=o.type,k=Rc(x,o.pendingProps),Hh(i,o,x,k,d);case 3:e:{if(Zr(o,o.stateNode.containerInfo),i===null)throw Error($(387));x=o.pendingProps;var O=o.memoizedState;k=O.element,rr(i,o),Xl(o,x,null,d);var se=o.memoizedState;if(x=se.cache,xs(o,zn,x),x!==O.cache&&$l(o,[zn],d,!0),Pc(),x=se.element,O.isDehydrated)if(O={element:x,isDehydrated:!1,cache:se.cache},o.updateQueue.baseState=O,o.memoizedState=O,o.flags&256){o=Ff(i,o,x,d);break e}else if(x!==k){k=ys(Error($(424)),o),js(k),o=Ff(i,o,x,d);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(vn=Bi(i.firstChild),xn=o,Mr=!0,Ya=null,Os=!0,d=Dc(o,null,x,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(lu(),x===k){o=ic(i,o,d);break e}ln(i,o,x,d)}o=o.child}return o;case 26:return Mp(i,o),i===null?(d=So(o.type,null,o.pendingProps,null))?o.memoizedState=d:Mr||(d=o.type,i=o.pendingProps,x=me(Ri.current).createElement(d),x[tr]=o,x[Wi]=i,Q(x,d,i),Mi(x),o.stateNode=x):o.memoizedState=So(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return Pl(o),i===null&&Mr&&(x=o.stateNode=_r(o.type,o.pendingProps,Ri.current),xn=o,Os=!0,k=vn,Gt(o.type)?(yr=k,vn=Bi(x.firstChild)):vn=k),ln(i,o,o.pendingProps.children,d),Mp(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&Mr&&((k=x=vn)&&(x=ji(x,o.type,o.pendingProps,Os),x!==null?(o.stateNode=x,xn=o,vn=Bi(x.firstChild),Os=!1,k=!0):k=!1),k||Gl(o)),Pl(o),k=o.type,O=o.pendingProps,se=i!==null?i.memoizedProps:null,x=O.children,$e(k,O)?x=null:se!==null&&$e(k,se)&&(o.flags|=32),o.memoizedState!==null&&(k=Fn(i,o,go,null,null,d),we._currentValue=k),Mp(i,o),ln(i,o,x,d),o.child;case 6:return i===null&&Mr&&((i=d=vn)&&(d=_i(d,o.pendingProps,Os),d!==null?(o.stateNode=d,xn=o,vn=null,i=!0):i=!1),i||Gl(o)),null;case 13:return Zh(i,o,d);case 4:return Zr(o,o.stateNode.containerInfo),x=o.pendingProps,i===null?o.child=Ns(o,null,x,d):ln(i,o,x,d),o.child;case 11:return Id(i,o,o.type,o.pendingProps,d);case 7:return ln(i,o,o.pendingProps,d),o.child;case 8:return ln(i,o,o.pendingProps.children,d),o.child;case 12:return ln(i,o,o.pendingProps.children,d),o.child;case 10:return x=o.pendingProps,xs(o,o.type,x.value),ln(i,o,x.children,d),o.child;case 9:return k=o.type._context,x=o.pendingProps.children,Hl(o),k=Pn(k),x=x(k),o.flags|=1,ln(i,o,x,d),o.child;case 14:return _u(i,o,o.type,o.pendingProps,d);case 15:return $o(i,o,o.type,o.pendingProps,d);case 19:return lf(i,o,d);case 31:return x=o.pendingProps,d=o.mode,x={mode:x.mode,children:x.children},i===null?(d=xu(x,d),d.ref=o.ref,o.child=d,d.return=o,o=d):(d=ga(i.child,x),d.ref=o.ref,o.child=d,d.return=o,o=d),o;case 22:return Od(i,o,d);case 24:return Hl(o),x=Pn(zn),i===null?(k=_l(),k===null&&(k=Pr,O=Zl(),k.pooledCache=O,O.refCount++,O!==null&&(k.pooledCacheLanes|=d),k=O),o.memoizedState={parent:x,cache:k},nh(o),xs(o,zn,k)):((i.lanes&d)!==0&&(rr(i,o),Xl(o,null,null,d),Pc()),k=i.memoizedState,O=o.memoizedState,k.parent!==x?(k={parent:x,cache:x},o.memoizedState=k,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=k),xs(o,zn,x)):(x=O.cache,xs(o,zn,x),x!==k.cache&&$l(o,[zn],d,!0))),ln(i,o,o.pendingProps.children,d),o.child;case 29:throw o.pendingProps}throw Error($(156,o.tag))}function rc(i){i.flags|=4}function cf(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!A(o)){if(o=wn.current,o!==null&&((Sr&4194048)===Sr?Gr!==null:(Sr&62914560)!==Sr&&(Sr&536870912)===0||o!==Gr))throw co=vs,hu;i.flags|=8192}}function Pp(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?tt():536870912,i.lanes|=o,yh|=o)}function qh(i,o){if(!Mr)switch(i.tailMode){case"hidden":o=i.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var x=null;d!==null;)d.alternate!==null&&(x=d),d=d.sibling;x===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:x.sibling=null}}function yn(i){var o=i.alternate!==null&&i.alternate.child===i.child,d=0,x=0;if(o)for(var k=i.child;k!==null;)d|=k.lanes|k.childLanes,x|=k.subtreeFlags&65011712,x|=k.flags&65011712,k.return=i,k=k.sibling;else for(k=i.child;k!==null;)d|=k.lanes|k.childLanes,x|=k.subtreeFlags,x|=k.flags,k.return=i,k=k.sibling;return i.subtreeFlags|=x,i.childLanes=d,o}function Fd(i,o,d){var x=o.pendingProps;switch(Qu(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yn(o),null;case 1:return yn(o),null;case 3:return d=o.stateNode,x=null,i!==null&&(x=i.memoizedState.cache),o.memoizedState.cache!==x&&(o.flags|=2048),as(zn),Cr(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(fl(o)?rc(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,on())),yn(o),null;case 26:return d=o.memoizedState,i===null?(rc(o),d!==null?(yn(o),cf(o,d)):(yn(o),o.flags&=-16777217)):d?d!==i.memoizedState?(rc(o),yn(o),cf(o,d)):(yn(o),o.flags&=-16777217):(i.memoizedProps!==x&&rc(o),yn(o),o.flags&=-16777217),null;case 27:aa(o),d=Ri.current;var k=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==x&&rc(o);else{if(!x){if(o.stateNode===null)throw Error($(166));return yn(o),null}i=di.current,fl(o)?pl(o):(i=_r(k,x,d),o.stateNode=i,rc(o))}return yn(o),null;case 5:if(aa(o),d=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==x&&rc(o);else{if(!x){if(o.stateNode===null)throw Error($(166));return yn(o),null}if(i=di.current,fl(o))pl(o);else{switch(k=me(Ri.current),i){case 1:i=k.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:i=k.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":i=k.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":i=k.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":i=k.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof x.is=="string"?k.createElement("select",{is:x.is}):k.createElement("select"),x.multiple?i.multiple=!0:x.size&&(i.size=x.size);break;default:i=typeof x.is=="string"?k.createElement(d,{is:x.is}):k.createElement(d)}}i[tr]=o,i[Wi]=x;e:for(k=o.child;k!==null;){if(k.tag===5||k.tag===6)i.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===o)break e;for(;k.sibling===null;){if(k.return===null||k.return===o)break e;k=k.return}k.sibling.return=k.return,k=k.sibling}o.stateNode=i;e:switch(Q(i,d,x),d){case"button":case"input":case"select":case"textarea":i=!!x.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&rc(o)}}return yn(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==x&&rc(o);else{if(typeof x!="string"&&o.stateNode===null)throw Error($(166));if(i=Ri.current,fl(o)){if(i=o.stateNode,d=o.memoizedProps,x=null,k=xn,k!==null)switch(k.tag){case 27:case 5:x=k.memoizedProps}i[tr]=o,i=!!(i.nodeValue===d||x!==null&&x.suppressHydrationWarning===!0||N(i.nodeValue,d)),i||Gl(o)}else i=me(i).createTextNode(x),i[tr]=o,o.stateNode=i}return yn(o),null;case 13:if(x=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(k=fl(o),x!==null&&x.dehydrated!==null){if(i===null){if(!k)throw Error($(318));if(k=o.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error($(317));k[tr]=o}else lu(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;yn(o),k=!1}else k=on(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=k),k=!0;if(!k)return o.flags&256?(Qa(o),o):(Qa(o),null)}if(Qa(o),(o.flags&128)!==0)return o.lanes=d,o;if(d=x!==null,i=i!==null&&i.memoizedState!==null,d){x=o.child,k=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(k=x.alternate.memoizedState.cachePool.pool);var O=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(O=x.memoizedState.cachePool.pool),O!==k&&(x.flags|=2048)}return d!==i&&d&&(o.child.flags|=8192),Pp(o,o.updateQueue),yn(o),null;case 4:return Cr(),i===null&&R(o.stateNode.containerInfo),yn(o),null;case 10:return as(o.type),yn(o),null;case 19:if(Ht(Sn),k=o.memoizedState,k===null)return yn(o),null;if(x=(o.flags&128)!==0,O=k.rendering,O===null)if(x)qh(k,!1);else{if(un!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(O=Ql(i),O!==null){for(o.flags|=128,qh(k,!1),i=O.updateQueue,o.updateQueue=i,Pp(o,i),o.subtreeFlags=0,i=d,d=o.child;d!==null;)qa(d,i),d=d.sibling;return ii(Sn,Sn.current&1|2),o.child}i=i.sibling}k.tail!==null&&qr()>Zd&&(o.flags|=128,x=!0,qh(k,!1),o.lanes=4194304)}else{if(!x)if(i=Ql(O),i!==null){if(o.flags|=128,x=!0,i=i.updateQueue,o.updateQueue=i,Pp(o,i),qh(k,!0),k.tail===null&&k.tailMode==="hidden"&&!O.alternate&&!Mr)return yn(o),null}else 2*qr()-k.renderingStartTime>Zd&&d!==536870912&&(o.flags|=128,x=!0,qh(k,!1),o.lanes=4194304);k.isBackwards?(O.sibling=o.child,o.child=O):(i=k.last,i!==null?i.sibling=O:o.child=O,k.last=O)}return k.tail!==null?(o=k.tail,k.rendering=o,k.tail=o.sibling,k.renderingStartTime=qr(),o.sibling=null,i=Sn.current,ii(Sn,x?i&1|2:i&1),o):(yn(o),null);case 22:case 23:return Qa(o),Xr(),x=o.memoizedState!==null,i!==null?i.memoizedState!==null!==x&&(o.flags|=8192):x&&(o.flags|=8192),x?(d&536870912)!==0&&(o.flags&128)===0&&(yn(o),o.subtreeFlags&6&&(o.flags|=8192)):yn(o),d=o.updateQueue,d!==null&&Pp(o,d.retryQueue),d=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),x=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(x=o.memoizedState.cachePool.pool),x!==d&&(o.flags|=2048),i!==null&&Ht(bn),null;case 24:return d=null,i!==null&&(d=i.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),as(zn),yn(o),null;case 25:return null;case 30:return null}throw Error($(156,o.tag))}function dh(i,o){switch(Qu(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return as(zn),Cr(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return aa(o),null;case 13:if(Qa(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error($(340));lu()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Ht(Sn),null;case 4:return Cr(),null;case 10:return as(o.type),null;case 22:case 23:return Qa(o),Xr(),i!==null&&Ht(bn),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return as(zn),null;case 25:return null;default:return null}}function zp(i,o){switch(Qu(o),o.tag){case 3:as(zn),Cr();break;case 26:case 27:case 5:aa(o);break;case 4:Cr();break;case 13:Qa(o);break;case 19:Ht(Sn);break;case 10:as(o.type);break;case 22:case 23:Qa(o),Xr(),i!==null&&Ht(bn);break;case 24:as(zn)}}function Ml(i,o){try{var d=o.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var k=x.next;d=k;do{if((d.tag&i)===i){x=void 0;var O=d.create,se=d.inst;x=O(),se.destroy=x}d=d.next}while(d!==k)}}catch(xe){Qr(o,o.return,xe)}}function Ho(i,o,d){try{var x=o.updateQueue,k=x!==null?x.lastEffect:null;if(k!==null){var O=k.next;x=O;do{if((x.tag&i)===i){var se=x.inst,xe=se.destroy;if(xe!==void 0){se.destroy=void 0,k=o;var Xe=d,Tt=xe;try{Tt()}catch(Ft){Qr(k,Xe,Ft)}}}x=x.next}while(x!==O)}}catch(Ft){Qr(o,o.return,Ft)}}function uf(i){var o=i.updateQueue;if(o!==null){var d=i.stateNode;try{pu(o,d)}catch(x){Qr(i,i.return,x)}}}function Xh(i,o,d){d.props=Rc(i.type,i.memoizedProps),d.state=i.memoizedState;try{d.componentWillUnmount()}catch(x){Qr(i,o,x)}}function Yh(i,o){try{var d=i.ref;if(d!==null){switch(i.tag){case 26:case 27:case 5:var x=i.stateNode;break;case 30:x=i.stateNode;break;default:x=i.stateNode}typeof d=="function"?i.refCleanup=d(x):d.current=x}}catch(k){Qr(i,o,k)}}function nc(i,o){var d=i.ref,x=i.refCleanup;if(d!==null)if(typeof x=="function")try{x()}catch(k){Qr(i,o,k)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(k){Qr(i,o,k)}else d.current=null}function Vf(i){var o=i.type,d=i.memoizedProps,x=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":d.autoFocus&&x.focus();break e;case"img":d.src?x.src=d.src:d.srcSet&&(x.srcset=d.srcSet)}}catch(k){Qr(i,i.return,k)}}function Ud(i,o,d){try{var x=i.stateNode;le(x,i.type,d,o),x[Wi]=o}catch(k){Qr(i,i.return,k)}}function bu(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Gt(i.type)||i.tag===4}function ph(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||bu(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Gt(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function hf(i,o,d){var x=i.tag;if(x===5||x===6)i=i.stateNode,o?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(i,o):(o=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,o.appendChild(i),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=I));else if(x!==4&&(x===27&&Gt(i.type)&&(d=i.stateNode,o=null),i=i.child,i!==null))for(hf(i,o,d),i=i.sibling;i!==null;)hf(i,o,d),i=i.sibling}function Vd(i,o,d){var x=i.tag;if(x===5||x===6)i=i.stateNode,o?d.insertBefore(i,o):d.appendChild(i);else if(x!==4&&(x===27&&Gt(i.type)&&(d=i.stateNode),i=i.child,i!==null))for(Vd(i,o,d),i=i.sibling;i!==null;)Vd(i,o,d),i=i.sibling}function Wh(i){var o=i.stateNode,d=i.memoizedProps;try{for(var x=i.type,k=o.attributes;k.length;)o.removeAttributeNode(k[0]);Q(o,x,d),o[tr]=i,o[Wi]=d}catch(O){Qr(i,i.return,O)}}var Oc=!1,or=!1,wu=!1,df=typeof WeakSet=="function"?WeakSet:Set,Hn=null;function Lp(i,o){if(i=i.containerInfo,ne=Nt,i=Yu(i),Ds(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var x=d.getSelection&&d.getSelection();if(x&&x.rangeCount!==0){d=x.anchorNode;var k=x.anchorOffset,O=x.focusNode;x=x.focusOffset;try{d.nodeType,O.nodeType}catch{d=null;break e}var se=0,xe=-1,Xe=-1,Tt=0,Ft=0,$t=i,Ct=null;t:for(;;){for(var At;$t!==d||k!==0&&$t.nodeType!==3||(xe=se+k),$t!==O||x!==0&&$t.nodeType!==3||(Xe=se+x),$t.nodeType===3&&(se+=$t.nodeValue.length),(At=$t.firstChild)!==null;)Ct=$t,$t=At;for(;;){if($t===i)break t;if(Ct===d&&++Tt===k&&(xe=se),Ct===O&&++Ft===x&&(Xe=se),(At=$t.nextSibling)!==null)break;$t=Ct,Ct=$t.parentNode}$t=At}d=xe===-1||Xe===-1?null:{start:xe,end:Xe}}else d=null}d=d||{start:0,end:0}}else d=null;for(ie={focusedElem:i,selectionRange:d},Nt=!1,Hn=o;Hn!==null;)if(o=Hn,i=o.child,(o.subtreeFlags&1024)!==0&&i!==null)i.return=o,Hn=i;else for(;Hn!==null;){switch(o=Hn,O=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&O!==null){i=void 0,d=o,k=O.memoizedProps,O=O.memoizedState,x=d.stateNode;try{var Ni=Rc(d.type,k,d.elementType===d.type);i=x.getSnapshotBeforeUpdate(Ni,O),x.__reactInternalSnapshotBeforeUpdate=i}catch(Yi){Qr(d,d.return,Yi)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,d=i.nodeType,d===9)oi(i);else if(d===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":oi(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error($(163))}if(i=o.sibling,i!==null){i.return=o.return,Hn=i;break}Hn=o.return}}function Kh(i,o,d){var x=d.flags;switch(d.tag){case 0:case 11:case 15:Us(i,d),x&4&&Ml(5,d);break;case 1:if(Us(i,d),x&4)if(i=d.stateNode,o===null)try{i.componentDidMount()}catch(se){Qr(d,d.return,se)}else{var k=Rc(d.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(k,o,i.__reactInternalSnapshotBeforeUpdate)}catch(se){Qr(d,d.return,se)}}x&64&&uf(d),x&512&&Yh(d,d.return);break;case 3:if(Us(i,d),x&64&&(i=d.updateQueue,i!==null)){if(o=null,d.child!==null)switch(d.child.tag){case 27:case 5:o=d.child.stateNode;break;case 1:o=d.child.stateNode}try{pu(i,o)}catch(se){Qr(d,d.return,se)}}break;case 27:o===null&&x&4&&Wh(d);case 26:case 5:Us(i,d),o===null&&x&4&&Vf(d),x&512&&Yh(d,d.return);break;case 12:Us(i,d);break;case 13:Us(i,d),x&4&&Gd(i,d),x&64&&(i=d.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(d=Xf.bind(null,d),lr(i,d))));break;case 22:if(x=d.memoizedState!==null||Oc,!x){o=o!==null&&o.memoizedState!==null||or,k=Oc;var O=or;Oc=x,(or=o)&&!O?Nc(i,d,(d.subtreeFlags&8772)!==0):Us(i,d),Oc=k,or=O}break;case 30:break;default:Us(i,d)}}function pf(i){var o=i.alternate;o!==null&&(i.alternate=null,pf(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&Ur(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var cn=null,ja=!1;function Zo(i,o,d){for(d=d.child;d!==null;)jc(i,o,d),d=d.sibling}function jc(i,o,d){if(en&&typeof en.onCommitFiberUnmount=="function")try{en.onCommitFiberUnmount(Ha,d)}catch{}switch(d.tag){case 26:or||nc(d,o),Zo(i,o,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:or||nc(d,o);var x=cn,k=ja;Gt(d.type)&&(cn=d.stateNode,ja=!1),Zo(i,o,d),dr(d.stateNode),cn=x,ja=k;break;case 5:or||nc(d,o);case 6:if(x=cn,k=ja,cn=null,Zo(i,o,d),cn=x,ja=k,cn!==null)if(ja)try{(cn.nodeType===9?cn.body:cn.nodeName==="HTML"?cn.ownerDocument.body:cn).removeChild(d.stateNode)}catch(O){Qr(d,o,O)}else try{cn.removeChild(d.stateNode)}catch(O){Qr(d,o,O)}break;case 18:cn!==null&&(ja?(i=cn,hi(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,d.stateNode),jn(i)):hi(cn,d.stateNode));break;case 4:x=cn,k=ja,cn=d.stateNode.containerInfo,ja=!0,Zo(i,o,d),cn=x,ja=k;break;case 0:case 11:case 14:case 15:or||Ho(2,d,o),or||Ho(4,d,o),Zo(i,o,d);break;case 1:or||(nc(d,o),x=d.stateNode,typeof x.componentWillUnmount=="function"&&Xh(d,o,x)),Zo(i,o,d);break;case 21:Zo(i,o,d);break;case 22:or=(x=or)||d.memoizedState!==null,Zo(i,o,d),or=x;break;default:Zo(i,o,d)}}function Gd(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{jn(i)}catch(d){Qr(o,o.return,d)}}function Qh(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new df),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new df),o;default:throw Error($(435,i.tag))}}function fh(i,o){var d=Qh(i);o.forEach(function(x){var k=Yf.bind(null,i,x);d.has(x)||(d.add(x),x.then(k,k))})}function ls(i,o){var d=o.deletions;if(d!==null)for(var x=0;x<d.length;x++){var k=d[x],O=i,se=o,xe=se;e:for(;xe!==null;){switch(xe.tag){case 27:if(Gt(xe.type)){cn=xe.stateNode,ja=!1;break e}break;case 5:cn=xe.stateNode,ja=!1;break e;case 3:case 4:cn=xe.stateNode.containerInfo,ja=!0;break e}xe=xe.return}if(cn===null)throw Error($(160));jc(O,se,k),cn=null,ja=!1,O=k.alternate,O!==null&&(O.return=null),k.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Bc(o,i),o=o.sibling}var Fs=null;function Bc(i,o){var d=i.alternate,x=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ls(o,i),xo(i),x&4&&(Ho(3,i,i.return),Ml(3,i),Ho(5,i,i.return));break;case 1:ls(o,i),xo(i),x&512&&(or||d===null||nc(d,d.return)),x&64&&Oc&&(i=i.updateQueue,i!==null&&(x=i.callbacks,x!==null&&(d=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=d===null?x:d.concat(x))));break;case 26:var k=Fs;if(ls(o,i),xo(i),x&512&&(or||d===null||nc(d,d.return)),x&4){var O=d!==null?d.memoizedState:null;if(x=i.memoizedState,d===null)if(x===null)if(i.stateNode===null){e:{x=i.type,d=i.memoizedProps,k=k.ownerDocument||k;t:switch(x){case"title":O=k.getElementsByTagName("title")[0],(!O||O[Cn]||O[tr]||O.namespaceURI==="http://www.w3.org/2000/svg"||O.hasAttribute("itemprop"))&&(O=k.createElement(x),k.head.insertBefore(O,k.querySelector("head > title"))),Q(O,x,d),O[tr]=i,Mi(O),x=O;break e;case"link":var se=m("link","href",k).get(x+(d.href||""));if(se){for(var xe=0;xe<se.length;xe++)if(O=se[xe],O.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&O.getAttribute("rel")===(d.rel==null?null:d.rel)&&O.getAttribute("title")===(d.title==null?null:d.title)&&O.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){se.splice(xe,1);break t}}O=k.createElement(x),Q(O,x,d),k.head.appendChild(O);break;case"meta":if(se=m("meta","content",k).get(x+(d.content||""))){for(xe=0;xe<se.length;xe++)if(O=se[xe],O.getAttribute("content")===(d.content==null?null:""+d.content)&&O.getAttribute("name")===(d.name==null?null:d.name)&&O.getAttribute("property")===(d.property==null?null:d.property)&&O.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&O.getAttribute("charset")===(d.charSet==null?null:d.charSet)){se.splice(xe,1);break t}}O=k.createElement(x),Q(O,x,d),k.head.appendChild(O);break;default:throw Error($(468,x))}O[tr]=i,Mi(O),x=O}i.stateNode=x}else v(k,i.type,i.stateNode);else i.stateNode=Rm(k,x,i.memoizedProps);else O!==x?(O===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):O.count--,x===null?v(k,i.type,i.stateNode):Rm(k,x,i.memoizedProps)):x===null&&i.stateNode!==null&&Ud(i,i.memoizedProps,d.memoizedProps)}break;case 27:ls(o,i),xo(i),x&512&&(or||d===null||nc(d,d.return)),d!==null&&x&4&&Ud(i,i.memoizedProps,d.memoizedProps);break;case 5:if(ls(o,i),xo(i),x&512&&(or||d===null||nc(d,d.return)),i.flags&32){k=i.stateNode;try{fs(k,"")}catch(At){Qr(i,i.return,At)}}x&4&&i.stateNode!=null&&(k=i.memoizedProps,Ud(i,k,d!==null?d.memoizedProps:k)),x&1024&&(wu=!0);break;case 6:if(ls(o,i),xo(i),x&4){if(i.stateNode===null)throw Error($(162));x=i.memoizedProps,d=i.stateNode;try{d.nodeValue=x}catch(At){Qr(i,i.return,At)}}break;case 3:if(l=null,k=Fs,Fs=hn(o.containerInfo),ls(o,i),Fs=k,xo(i),x&4&&d!==null&&d.memoizedState.isDehydrated)try{jn(o.containerInfo)}catch(At){Qr(i,i.return,At)}wu&&(wu=!1,Jh(i));break;case 4:x=Fs,Fs=hn(i.stateNode.containerInfo),ls(o,i),xo(i),Fs=x;break;case 12:ls(o,i),xo(i);break;case 13:ls(o,i),xo(i),i.child.flags&8192&&i.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(mf=qr()),x&4&&(x=i.updateQueue,x!==null&&(i.updateQueue=null,fh(i,x)));break;case 22:k=i.memoizedState!==null;var Xe=d!==null&&d.memoizedState!==null,Tt=Oc,Ft=or;if(Oc=Tt||k,or=Ft||Xe,ls(o,i),or=Ft,Oc=Tt,xo(i),x&8192)e:for(o=i.stateNode,o._visibility=k?o._visibility&-2:o._visibility|1,k&&(d===null||Xe||Oc||or||ac(i)),d=null,o=i;;){if(o.tag===5||o.tag===26){if(d===null){Xe=d=o;try{if(O=Xe.stateNode,k)se=O.style,typeof se.setProperty=="function"?se.setProperty("display","none","important"):se.display="none";else{xe=Xe.stateNode;var $t=Xe.memoizedProps.style,Ct=$t!=null&&$t.hasOwnProperty("display")?$t.display:null;xe.style.display=Ct==null||typeof Ct=="boolean"?"":(""+Ct).trim()}}catch(At){Qr(Xe,Xe.return,At)}}}else if(o.tag===6){if(d===null){Xe=o;try{Xe.stateNode.nodeValue=k?"":Xe.memoizedProps}catch(At){Qr(Xe,Xe.return,At)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;d===o&&(d=null),o=o.return}d===o&&(d=null),o.sibling.return=o.return,o=o.sibling}x&4&&(x=i.updateQueue,x!==null&&(d=x.retryQueue,d!==null&&(x.retryQueue=null,fh(i,d))));break;case 19:ls(o,i),xo(i),x&4&&(x=i.updateQueue,x!==null&&(i.updateQueue=null,fh(i,x)));break;case 30:break;case 21:break;default:ls(o,i),xo(i)}}function xo(i){var o=i.flags;if(o&2){try{for(var d,x=i.return;x!==null;){if(bu(x)){d=x;break}x=x.return}if(d==null)throw Error($(160));switch(d.tag){case 27:var k=d.stateNode,O=ph(i);Vd(i,O,k);break;case 5:var se=d.stateNode;d.flags&32&&(fs(se,""),d.flags&=-33);var xe=ph(i);Vd(i,xe,se);break;case 3:case 4:var Xe=d.stateNode.containerInfo,Tt=ph(i);hf(i,Tt,Xe);break;default:throw Error($(161))}}catch(Ft){Qr(i,i.return,Ft)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function Jh(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;Jh(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Us(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Kh(i,o.alternate,o),o=o.sibling}function ac(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:Ho(4,o,o.return),ac(o);break;case 1:nc(o,o.return);var d=o.stateNode;typeof d.componentWillUnmount=="function"&&Xh(o,o.return,d),ac(o);break;case 27:dr(o.stateNode);case 26:case 5:nc(o,o.return),ac(o);break;case 22:o.memoizedState===null&&ac(o);break;case 30:ac(o);break;default:ac(o)}i=i.sibling}}function Nc(i,o,d){for(d=d&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var x=o.alternate,k=i,O=o,se=O.flags;switch(O.tag){case 0:case 11:case 15:Nc(k,O,d),Ml(4,O);break;case 1:if(Nc(k,O,d),x=O,k=x.stateNode,typeof k.componentDidMount=="function")try{k.componentDidMount()}catch(Tt){Qr(x,x.return,Tt)}if(x=O,k=x.updateQueue,k!==null){var xe=x.stateNode;try{var Xe=k.shared.hiddenCallbacks;if(Xe!==null)for(k.shared.hiddenCallbacks=null,k=0;k<Xe.length;k++)ho(Xe[k],xe)}catch(Tt){Qr(x,x.return,Tt)}}d&&se&64&&uf(O),Yh(O,O.return);break;case 27:Wh(O);case 26:case 5:Nc(k,O,d),d&&x===null&&se&4&&Vf(O),Yh(O,O.return);break;case 12:Nc(k,O,d);break;case 13:Nc(k,O,d),d&&se&4&&Gd(k,O);break;case 22:O.memoizedState===null&&Nc(k,O,d),Yh(O,O.return);break;case 30:break;default:Nc(k,O,d)}o=o.sibling}}function ed(i,o){var d=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==d&&(i!=null&&i.refCount++,d!=null&&kc(d))}function ff(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&kc(i))}function sc(i,o,d,x){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Dp(i,o,d,x),o=o.sibling}function Dp(i,o,d,x){var k=o.flags;switch(o.tag){case 0:case 11:case 15:sc(i,o,d,x),k&2048&&Ml(9,o);break;case 1:sc(i,o,d,x);break;case 3:sc(i,o,d,x),k&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&kc(i)));break;case 12:if(k&2048){sc(i,o,d,x),i=o.stateNode;try{var O=o.memoizedProps,se=O.id,xe=O.onPostCommit;typeof xe=="function"&&xe(se,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Xe){Qr(o,o.return,Xe)}}else sc(i,o,d,x);break;case 13:sc(i,o,d,x);break;case 23:break;case 22:O=o.stateNode,se=o.alternate,o.memoizedState!==null?O._visibility&2?sc(i,o,d,x):$d(i,o):O._visibility&2?sc(i,o,d,x):(O._visibility|=2,td(i,o,d,x,(o.subtreeFlags&10256)!==0)),k&2048&&ed(se,o);break;case 24:sc(i,o,d,x),k&2048&&ff(o.alternate,o);break;default:sc(i,o,d,x)}}function td(i,o,d,x,k){for(k=k&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var O=i,se=o,xe=d,Xe=x,Tt=se.flags;switch(se.tag){case 0:case 11:case 15:td(O,se,xe,Xe,k),Ml(8,se);break;case 23:break;case 22:var Ft=se.stateNode;se.memoizedState!==null?Ft._visibility&2?td(O,se,xe,Xe,k):$d(O,se):(Ft._visibility|=2,td(O,se,xe,Xe,k)),k&&Tt&2048&&ed(se.alternate,se);break;case 24:td(O,se,xe,Xe,k),k&&Tt&2048&&ff(se.alternate,se);break;default:td(O,se,xe,Xe,k)}o=o.sibling}}function $d(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var d=i,x=o,k=x.flags;switch(x.tag){case 22:$d(d,x),k&2048&&ed(x.alternate,x);break;case 24:$d(d,x),k&2048&&ff(x.alternate,x);break;default:$d(d,x)}o=o.sibling}}var mh=8192;function oc(i){if(i.subtreeFlags&mh)for(i=i.child;i!==null;)gh(i),i=i.sibling}function gh(i){switch(i.tag){case 26:oc(i),i.flags&mh&&i.memoizedState!==null&&G(Fs,i.memoizedState,i.memoizedProps);break;case 5:oc(i);break;case 3:case 4:var o=Fs;Fs=hn(i.stateNode.containerInfo),oc(i),Fs=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=mh,mh=16777216,oc(i),mh=o):oc(i));break;default:oc(i)}}function Rp(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Su(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var x=o[d];Hn=x,Tu(x,i)}Rp(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Ip(i),i=i.sibling}function Ip(i){switch(i.tag){case 0:case 11:case 15:Su(i),i.flags&2048&&Ho(9,i,i.return);break;case 3:Su(i);break;case 12:Su(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,id(i)):Su(i);break;default:Su(i)}}function id(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var d=0;d<o.length;d++){var x=o[d];Hn=x,Tu(x,i)}Rp(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:Ho(8,o,o.return),id(o);break;case 22:d=o.stateNode,d._visibility&2&&(d._visibility&=-3,id(o));break;default:id(o)}i=i.sibling}}function Tu(i,o){for(;Hn!==null;){var d=Hn;switch(d.tag){case 0:case 11:case 15:Ho(8,d,o);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var x=d.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:kc(d.memoizedState.cache)}if(x=d.child,x!==null)x.return=d,Hn=x;else e:for(d=i;Hn!==null;){x=Hn;var k=x.sibling,O=x.return;if(pf(x),x===d){Hn=null;break e}if(k!==null){k.return=O,Hn=k;break e}Hn=O}}}var Op={getCacheForType:function(i){var o=Pn(zn),d=o.data.get(i);return d===void 0&&(d=i(),o.data.set(i,d)),d}},rd=typeof WeakMap=="function"?WeakMap:Map,$r=0,Pr=null,gr=null,Sr=0,zr=0,Zn=null,Fc=!1,Mu=!1,Hd=!1,Ja=0,un=0,qo=0,Cl=0,Cu=0,Xo=0,yh=0,Au=null,Vs=null,jp=!1,mf=0,Zd=1/0,nd=null,Uc=null,Ba=0,Al=null,ad=null,lc=0,gf=0,Bp=null,Gf=null,Eu=0,Np=null;function Gs(){if(($r&2)!==0&&Sr!==0)return Sr&-Sr;if(gt.T!==null){var i=gl;return i!==0?i:Pu()}return ci()}function Fp(){Xo===0&&(Xo=(Sr&536870912)===0||Mr?yt():536870912);var i=wn.current;return i!==null&&(i.flags|=32),Xo}function cs(i,o,d){(i===Pr&&(zr===2||zr===9)||i.cancelPendingCommit!==null)&&(od(i,0),cc(i,Sr,Xo,!1)),St(i,d),(($r&2)===0||i!==Pr)&&(i===Pr&&(($r&2)===0&&(Cl|=d),un===4&&cc(i,Sr,Xo,!1)),wo(i))}function sd(i,o,d){if(($r&6)!==0)throw Error($(327));var x=!d&&(o&124)===0&&(o&i.expiredLanes)===0||Qe(i,o),k=x?$f(i,o):Vp(i,o,!0),O=x;do{if(k===0){Mu&&!x&&cc(i,o,0,!1);break}else{if(d=i.current.alternate,O&&!yf(d)){k=Vp(i,o,!1),O=!1;continue}if(k===2){if(O=o,i.errorRecoveryDisabledLanes&O)var se=0;else se=i.pendingLanes&-536870913,se=se!==0?se:se&536870912?536870912:0;if(se!==0){o=se;e:{var xe=i;k=Au;var Xe=xe.current.memoizedState.isDehydrated;if(Xe&&(od(xe,se).flags|=256),se=Vp(xe,se,!1),se!==2){if(Hd&&!Xe){xe.errorRecoveryDisabledLanes|=O,Cl|=O,k=4;break e}O=Vs,Vs=k,O!==null&&(Vs===null?Vs=O:Vs.push.apply(Vs,O))}k=se}if(O=!1,k!==2)continue}}if(k===1){od(i,0),cc(i,o,0,!0);break}e:{switch(x=i,O=k,O){case 0:case 1:throw Error($(345));case 4:if((o&4194048)!==o)break;case 6:cc(x,o,Xo,!Fc);break e;case 2:Vs=null;break;case 3:case 5:break;default:throw Error($(329))}if((o&62914560)===o&&(k=mf+300-qr(),10<k)){if(cc(x,o,Xo,!Fc),je(x,0,!0)!==0)break e;x.timeoutHandle=at(Up.bind(null,x,d,Vs,nd,jp,o,Xo,Cl,yh,Fc,O,2,-0,0),k);break e}Up(x,d,Vs,nd,jp,o,Xo,Cl,yh,Fc,O,0,-0,0)}}break}while(!0);wo(i)}function Up(i,o,d,x,k,O,se,xe,Xe,Tt,Ft,$t,Ct,At){if(i.timeoutHandle=-1,$t=o.subtreeFlags,($t&8192||($t&16785408)===16785408)&&(z={stylesheets:null,count:0,unsuspend:j},gh(o),$t=Y(),$t!==null)){i.cancelPendingCommit=$t(Hf.bind(null,i,o,O,d,x,k,se,xe,Xe,Ft,1,Ct,At)),cc(i,O,se,!Tt);return}Hf(i,o,O,d,x,k,se,xe,Xe)}function yf(i){for(var o=i;;){var d=o.tag;if((d===0||d===11||d===15)&&o.flags&16384&&(d=o.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var x=0;x<d.length;x++){var k=d[x],O=k.getSnapshot;k=k.value;try{if(!pa(O(),k))return!1}catch{return!1}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function cc(i,o,d,x){o&=~Cu,o&=~Cl,i.suspendedLanes|=o,i.pingedLanes&=~o,x&&(i.warmLanes|=o),x=i.expirationTimes;for(var k=o;0<k;){var O=31-oa(k),se=1<<O;x[O]=-1,k&=~se}d!==0&&jt(i,d,o)}function Dn(){return($r&6)===0?(Jd(0),!1):!0}function qd(){if(gr!==null){if(zr===0)var i=gr.return;else i=gr,ns=No=null,er(i),mr=null,Br=0,i=gr;for(;i!==null;)zp(i.alternate,i),i=i.return;gr=null}}function od(i,o){var d=i.timeoutHandle;d!==-1&&(i.timeoutHandle=-1,mt(d)),d=i.cancelPendingCommit,d!==null&&(i.cancelPendingCommit=null,d()),qd(),Pr=i,gr=d=ga(i.current,null),Sr=o,zr=0,Zn=null,Fc=!1,Mu=Qe(i,o),Hd=!1,yh=Xo=Cu=Cl=qo=un=0,Vs=Au=null,jp=!1,(o&8)!==0&&(o|=o&32);var x=i.entangledLanes;if(x!==0)for(i=i.entanglements,x&=o;0<x;){var k=31-oa(x),O=1<<k;o|=i[k],x&=~O}return Ja=o,Aa(),d}function _f(i,o){$i=null,gt.H=ya,o===ih||o===ql?(o=rh(),zr=3):o===hu?(o=rh(),zr=4):zr=o===Ic?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Zn=o,gr===null&&(un=1,Tp(i,ys(o,i.current)))}function Vc(){var i=gt.H;return gt.H=ya,i===null?ya:i}function Xd(){var i=gt.A;return gt.A=Op,i}function xf(){un=4,Fc||(Sr&4194048)!==Sr&&wn.current!==null||(Mu=!0),(qo&134217727)===0&&(Cl&134217727)===0||Pr===null||cc(Pr,Sr,Xo,!1)}function Vp(i,o,d){var x=$r;$r|=2;var k=Vc(),O=Xd();(Pr!==i||Sr!==o)&&(nd=null,od(i,o)),o=!1;var se=un;e:do try{if(zr!==0&&gr!==null){var xe=gr,Xe=Zn;switch(zr){case 8:qd(),se=6;break e;case 3:case 2:case 9:case 6:wn.current===null&&(o=!0);var Tt=zr;if(zr=0,Zn=null,vo(i,xe,Xe,Tt),d&&Mu){se=0;break e}break;default:Tt=zr,zr=0,Zn=null,vo(i,xe,Xe,Tt)}}pm(),se=un;break}catch(Ft){_f(i,Ft)}while(!0);return o&&i.shellSuspendCounter++,ns=No=null,$r=x,gt.H=k,gt.A=O,gr===null&&(Pr=null,Sr=0,Aa()),se}function pm(){for(;gr!==null;)Yd(gr)}function $f(i,o){var d=$r;$r|=2;var x=Vc(),k=Xd();Pr!==i||Sr!==o?(nd=null,Zd=qr()+500,od(i,o)):Mu=Qe(i,o);e:do try{if(zr!==0&&gr!==null){o=gr;var O=Zn;t:switch(zr){case 1:zr=0,Zn=null,vo(i,o,O,1);break;case 2:case 9:if(lo(O)){zr=0,Zn=null,ld(o);break}o=function(){zr!==2&&zr!==9||Pr!==i||(zr=7),wo(i)},O.then(o,o);break e;case 3:zr=7;break e;case 4:zr=5;break e;case 7:lo(O)?(zr=0,Zn=null,ld(o)):(zr=0,Zn=null,vo(i,o,O,7));break;case 5:var se=null;switch(gr.tag){case 26:se=gr.memoizedState;case 5:case 27:var xe=gr;if(!se||A(se)){zr=0,Zn=null;var Xe=xe.sibling;if(Xe!==null)gr=Xe;else{var Tt=xe.return;Tt!==null?(gr=Tt,_h(Tt)):gr=null}break t}}zr=0,Zn=null,vo(i,o,O,5);break;case 6:zr=0,Zn=null,vo(i,o,O,6);break;case 8:qd(),un=6;break e;default:throw Error($(462))}}Gp();break}catch(Ft){_f(i,Ft)}while(!0);return ns=No=null,gt.H=x,gt.A=k,$r=d,gr!==null?0:(Pr=null,Sr=0,Aa(),un)}function Gp(){for(;gr!==null&&!Va();)Yd(gr)}function Yd(i){var o=vu(i.alternate,i,Ja);i.memoizedProps=i.pendingProps,o===null?_h(i):gr=o}function ld(i){var o=i,d=o.alternate;switch(o.tag){case 15:case 0:o=Cp(d,o,o.pendingProps,o.type,void 0,Sr);break;case 11:o=Cp(d,o,o.pendingProps,o.type.render,o.ref,Sr);break;case 5:er(o);default:zp(d,o),o=gr=qa(o,Ja),o=vu(d,o,Ja)}i.memoizedProps=i.pendingProps,o===null?_h(i):gr=o}function vo(i,o,d,x){ns=No=null,er(o),mr=null,Br=0;var k=o.return;try{if(Nf(i,k,o,d,Sr)){un=1,Tp(i,ys(d,i.current)),gr=null;return}}catch(O){if(k!==null)throw gr=k,O;un=1,Tp(i,ys(d,i.current)),gr=null;return}o.flags&32768?(Mr||x===1?i=!0:Mu||(Sr&536870912)!==0?i=!1:(Fc=i=!0,(x===2||x===9||x===3||x===6)&&(x=wn.current,x!==null&&x.tag===13&&(x.flags|=16384))),Wd(o,i)):_h(o)}function _h(i){var o=i;do{if((o.flags&32768)!==0){Wd(o,Fc);return}i=o.return;var d=Fd(o.alternate,o,Ja);if(d!==null){gr=d;return}if(o=o.sibling,o!==null){gr=o;return}gr=o=i}while(o!==null);un===0&&(un=5)}function Wd(i,o){do{var d=dh(i.alternate,i);if(d!==null){d.flags&=32767,gr=d;return}if(d=i.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!o&&(i=i.sibling,i!==null)){gr=i;return}gr=i=d}while(i!==null);un=6,gr=null}function Hf(i,o,d,x,k,O,se,xe,Xe){i.cancelPendingCommit=null;do Kd();while(Ba!==0);if(($r&6)!==0)throw Error($(327));if(o!==null){if(o===i.current)throw Error($(177));if(O=o.lanes|o.childLanes,O|=dl,ut(i,d,O,se,xe,Xe),i===Pr&&(gr=Pr=null,Sr=0),ad=o,Al=i,lc=d,gf=O,Bp=k,Gf=x,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,fm($a,function(){return Sf(),null})):(i.callbackNode=null,i.callbackPriority=0),x=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||x){x=gt.T,gt.T=null,k=It.p,It.p=2,se=$r,$r|=4;try{Lp(i,o,d)}finally{$r=se,It.p=k,gt.T=x}}Ba=1,vf(),bf(),$p()}}function vf(){if(Ba===1){Ba=0;var i=Al,o=ad,d=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||d){d=gt.T,gt.T=null;var x=It.p;It.p=2;var k=$r;$r|=4;try{Bc(o,i);var O=ie,se=Yu(i.containerInfo),xe=O.focusedElem,Xe=O.selectionRange;if(se!==xe&&xe&&xe.ownerDocument&&sr(xe.ownerDocument.documentElement,xe)){if(Xe!==null&&Ds(xe)){var Tt=Xe.start,Ft=Xe.end;if(Ft===void 0&&(Ft=Tt),"selectionStart"in xe)xe.selectionStart=Tt,xe.selectionEnd=Math.min(Ft,xe.value.length);else{var $t=xe.ownerDocument||document,Ct=$t&&$t.defaultView||window;if(Ct.getSelection){var At=Ct.getSelection(),Ni=xe.textContent.length,Yi=Math.min(Xe.start,Ni),nn=Xe.end===void 0?Yi:Math.min(Xe.end,Ni);!At.extend&&Yi>nn&&(se=nn,nn=Yi,Yi=se);var dt=Rh(xe,Yi),st=Rh(xe,nn);if(dt&&st&&(At.rangeCount!==1||At.anchorNode!==dt.node||At.anchorOffset!==dt.offset||At.focusNode!==st.node||At.focusOffset!==st.offset)){var bt=$t.createRange();bt.setStart(dt.node,dt.offset),At.removeAllRanges(),Yi>nn?(At.addRange(bt),At.extend(st.node,st.offset)):(bt.setEnd(st.node,st.offset),At.addRange(bt))}}}}for($t=[],At=xe;At=At.parentNode;)At.nodeType===1&&$t.push({element:At,left:At.scrollLeft,top:At.scrollTop});for(typeof xe.focus=="function"&&xe.focus(),xe=0;xe<$t.length;xe++){var Vt=$t[xe];Vt.element.scrollLeft=Vt.left,Vt.element.scrollTop=Vt.top}}Nt=!!ne,ie=ne=null}finally{$r=k,It.p=x,gt.T=d}}i.current=o,Ba=2}}function bf(){if(Ba===2){Ba=0;var i=Al,o=ad,d=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||d){d=gt.T,gt.T=null;var x=It.p;It.p=2;var k=$r;$r|=4;try{Kh(i,o.alternate,o)}finally{$r=k,It.p=x,gt.T=d}}Ba=3}}function $p(){if(Ba===4||Ba===3){Ba=0,dc();var i=Al,o=ad,d=lc,x=Gf;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Ba=5:(Ba=0,ad=Al=null,wf(i,i.pendingLanes));var k=i.pendingLanes;if(k===0&&(Uc=null),Pi(d),o=o.stateNode,en&&typeof en.onCommitFiberRoot=="function")try{en.onCommitFiberRoot(Ha,o,void 0,(o.current.flags&128)===128)}catch{}if(x!==null){o=gt.T,k=It.p,It.p=2,gt.T=null;try{for(var O=i.onRecoverableError,se=0;se<x.length;se++){var xe=x[se];O(xe.value,{componentStack:xe.stack})}}finally{gt.T=o,It.p=k}}(lc&3)!==0&&Kd(),wo(i),k=i.pendingLanes,(d&4194090)!==0&&(k&42)!==0?i===Np?Eu++:(Eu=0,Np=i):Eu=0,Jd(0)}}function wf(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,kc(o)))}function Kd(i){return vf(),bf(),$p(),Sf()}function Sf(){if(Ba!==5)return!1;var i=Al,o=gf;gf=0;var d=Pi(lc),x=gt.T,k=It.p;try{It.p=32>d?32:d,gt.T=null,d=Bp,Bp=null;var O=Al,se=lc;if(Ba=0,ad=Al=null,lc=0,($r&6)!==0)throw Error($(331));var xe=$r;if($r|=4,Ip(O.current),Dp(O,O.current,se,d),$r=xe,Jd(0,!1),en&&typeof en.onPostCommitFiberRoot=="function")try{en.onPostCommitFiberRoot(Ha,O)}catch{}return!0}finally{It.p=k,gt.T=x,wf(i,o)}}function Qd(i,o,d){o=ys(d,o),o=tc(i.stateNode,o,2),i=xl(i,o,2),i!==null&&(St(i,2),wo(i))}function Qr(i,o,d){if(i.tag===3)Qd(i,i,d);else for(;o!==null;){if(o.tag===3){Qd(o,i,d);break}else if(o.tag===1){var x=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Uc===null||!Uc.has(x))){i=ys(d,i),d=$h(2),x=xl(o,d,2),x!==null&&(vr(d,x,o,i),St(x,2),wo(x));break}}o=o.return}}function Tf(i,o,d){var x=i.pingCache;if(x===null){x=i.pingCache=new rd;var k=new Set;x.set(o,k)}else k=x.get(o),k===void 0&&(k=new Set,x.set(o,k));k.has(d)||(Hd=!0,k.add(d),i=Zf.bind(null,i,o,d),o.then(i,i))}function Zf(i,o,d){var x=i.pingCache;x!==null&&x.delete(o),i.pingedLanes|=i.suspendedLanes&d,i.warmLanes&=~d,Pr===i&&(Sr&d)===d&&(un===4||un===3&&(Sr&62914560)===Sr&&300>qr()-mf?($r&2)===0&&od(i,0):Cu|=d,yh===Sr&&(yh=0)),wo(i)}function qf(i,o){o===0&&(o=tt()),i=Is(i,o),i!==null&&(St(i,o),wo(i))}function Xf(i){var o=i.memoizedState,d=0;o!==null&&(d=o.retryLane),qf(i,d)}function Yf(i,o){var d=0;switch(i.tag){case 13:var x=i.stateNode,k=i.memoizedState;k!==null&&(d=k.retryLane);break;case 19:x=i.stateNode;break;case 22:x=i.stateNode._retryCache;break;default:throw Error($(314))}x!==null&&x.delete(o),qf(i,d)}function fm(i,o){return li(i,o)}var Hp=null,ku=null,Zp=!1,bo=!1,uc=!1,Gc=0;function wo(i){i!==ku&&i.next===null&&(ku===null?Hp=ku=i:ku=ku.next=i),bo=!0,Zp||(Zp=!0,qp())}function Jd(i,o){if(!uc&&bo){uc=!0;do for(var d=!1,x=Hp;x!==null;){if(i!==0){var k=x.pendingLanes;if(k===0)var O=0;else{var se=x.suspendedLanes,xe=x.pingedLanes;O=(1<<31-oa(42|i)+1)-1,O&=k&~(se&~xe),O=O&201326741?O&201326741|1:O?O|2:0}O!==0&&(d=!0,tp(x,O))}else O=Sr,O=je(x,x===Pr?O:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(O&3)===0||Qe(x,O)||(d=!0,tp(x,O));x=x.next}while(d);uc=!1}}function Wf(){ep()}function ep(){bo=Zp=!1;var i=0;Gc!==0&&(ht()&&(i=Gc),Gc=0);for(var o=qr(),d=null,x=Hp;x!==null;){var k=x.next,O=cd(x,o);O===0?(x.next=null,d===null?Hp=k:d.next=k,k===null&&(ku=d)):(d=x,(i!==0||(O&3)!==0)&&(bo=!0)),x=k}Jd(i)}function cd(i,o){for(var d=i.suspendedLanes,x=i.pingedLanes,k=i.expirationTimes,O=i.pendingLanes&-62914561;0<O;){var se=31-oa(O),xe=1<<se,Xe=k[se];Xe===-1?((xe&d)===0||(xe&x)!==0)&&(k[se]=nt(xe,o)):Xe<=o&&(i.expiredLanes|=xe),O&=~xe}if(o=Pr,d=Sr,d=je(i,i===o?d:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),x=i.callbackNode,d===0||i===o&&(zr===2||zr===9)||i.cancelPendingCommit!==null)return x!==null&&x!==null&&Ms(x),i.callbackNode=null,i.callbackPriority=0;if((d&3)===0||Qe(i,d)){if(o=d&-d,o===i.callbackPriority)return o;switch(x!==null&&Ms(x),Pi(d)){case 2:case 8:d=Ao;break;case 32:d=$a;break;case 268435456:d=zl;break;default:d=$a}return x=Kf.bind(null,i),d=li(d,x),i.callbackPriority=o,i.callbackNode=d,o}return x!==null&&x!==null&&Ms(x),i.callbackPriority=2,i.callbackNode=null,2}function Kf(i,o){if(Ba!==0&&Ba!==5)return i.callbackNode=null,i.callbackPriority=0,null;var d=i.callbackNode;if(Kd()&&i.callbackNode!==d)return null;var x=Sr;return x=je(i,i===Pr?x:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),x===0?null:(sd(i,x,o),cd(i,qr()),i.callbackNode!=null&&i.callbackNode===d?Kf.bind(null,i):null)}function tp(i,o){if(Kd())return null;sd(i,o,!0)}function qp(){Zt(function(){($r&6)!==0?li(va,Wf):ep()})}function Pu(){return Gc===0&&(Gc=yt()),Gc}function Mf(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:eu(""+i)}function ip(i,o){var d=o.ownerDocument.createElement("input");return d.name=o.name,d.value=o.value,i.id&&d.setAttribute("form",i.id),o.parentNode.insertBefore(d,o),i=new FormData(i),d.parentNode.removeChild(d),i}function Cf(i,o,d,x,k){if(o==="submit"&&d&&d.stateNode===k){var O=Mf((k[Wi]||null).action),se=x.submitter;se&&(o=(o=se[Wi]||null)?Mf(o.formAction):se.getAttribute("formAction"),o!==null&&(O=o,se=null));var xe=new tl("action","action",null,x,k);i.push({event:xe,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Gc!==0){var Xe=se?ip(k,se):new FormData(k);cr(d,{pending:!0,data:Xe,method:k.method,action:O},null,Xe)}}else typeof O=="function"&&(xe.preventDefault(),Xe=se?ip(k,se):new FormData(k),cr(d,{pending:!0,data:Xe,method:k.method,action:O},O,Xe))},currentTarget:k}]})}}for(var Xp=0;Xp<Cc.length;Xp++){var ud=Cc[Xp],Qf=ud.toLowerCase(),mm=ud[0].toUpperCase()+ud.slice(1);fa(Qf,"on"+mm)}fa(Ad,"onAnimationEnd"),fa(bp,"onAnimationIteration"),fa(Ed,"onAnimationStart"),fa("dblclick","onDoubleClick"),fa("focusin","onFocus"),fa("focusout","onBlur"),fa(Tc,"onTransitionRun"),fa(ou,"onTransitionStart"),fa(Ih,"onTransitionCancel"),fa(Mc,"onTransitionEnd"),Zi("onMouseEnter",["mouseout","mouseover"]),Zi("onMouseLeave",["mouseout","mouseover"]),Zi("onPointerEnter",["pointerout","pointerover"]),Zi("onPointerLeave",["pointerout","pointerover"]),wa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),wa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),wa("onBeforeInput",["compositionend","keypress","textInput","paste"]),wa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),wa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),wa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),np=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(rp));function Jf(i,o){o=(o&4)!==0;for(var d=0;d<i.length;d++){var x=i[d],k=x.event;x=x.listeners;e:{var O=void 0;if(o)for(var se=x.length-1;0<=se;se--){var xe=x[se],Xe=xe.instance,Tt=xe.currentTarget;if(xe=xe.listener,Xe!==O&&k.isPropagationStopped())break e;O=xe,k.currentTarget=Tt;try{O(k)}catch(Ft){os(Ft)}k.currentTarget=null,O=Xe}else for(se=0;se<x.length;se++){if(xe=x[se],Xe=xe.instance,Tt=xe.currentTarget,xe=xe.listener,Xe!==O&&k.isPropagationStopped())break e;O=xe,k.currentTarget=Tt;try{O(k)}catch(Ft){os(Ft)}k.currentTarget=null,O=Xe}}}}function br(i,o){var d=o[bi];d===void 0&&(d=o[bi]=new Set);var x=i+"__bubble";d.has(x)||(s(o,i,2,!1),d.add(x))}function Af(i,o,d){var x=0;o&&(x|=4),s(d,i,x,o)}var ap="_reactListening"+Math.random().toString(36).slice(2);function R(i){if(!i[ap]){i[ap]=!0,Dr.forEach(function(d){d!=="selectionchange"&&(np.has(d)||Af(d,!1,i),Af(d,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[ap]||(o[ap]=!0,Af("selectionchange",!1,o))}}function s(i,o,d,x){switch(gi(o)){case 2:var k=Mt;break;case 8:k=kt;break;default:k=qt}d=k.bind(null,o,d,i),k=void 0,!Bn||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(k=!0),x?k!==void 0?i.addEventListener(o,d,{capture:!0,passive:k}):i.addEventListener(o,d,!0):k!==void 0?i.addEventListener(o,d,{passive:k}):i.addEventListener(o,d,!1)}function u(i,o,d,x,k){var O=x;if((o&1)===0&&(o&2)===0&&x!==null)e:for(;;){if(x===null)return;var se=x.tag;if(se===3||se===4){var xe=x.stateNode.containerInfo;if(xe===k)break;if(se===4)for(se=x.return;se!==null;){var Xe=se.tag;if((Xe===3||Xe===4)&&se.stateNode.containerInfo===k)return;se=se.return}for(;xe!==null;){if(se=es(xe),se===null)return;if(Xe=se.tag,Xe===5||Xe===6||Xe===26||Xe===27){x=O=se;continue e}xe=xe.parentNode}}x=x.return}ca(function(){var Tt=O,Ft=Es(d),$t=[];e:{var Ct=Oo.get(i);if(Ct!==void 0){var At=tl,Ni=i;switch(i){case"keypress":if(Gi(d)===0)break e;case"keydown":case"keyup":At=ts;break;case"focusin":Ni="focus",At=Ta;break;case"focusout":Ni="blur",At=Ta;break;case"beforeblur":case"afterblur":At=Ta;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":At=tu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":At=Vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":At=nu;break;case Ad:case bp:case Ed:At=Nn;break;case Mc:At=bd;break;case"scroll":case"scrollend":At=Nu;break;case"wheel":At=rf;break;case"copy":case"cut":case"paste":At=Ro;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":At=Uu;break;case"toggle":case"beforetoggle":At=kh}var Yi=(o&4)!==0,nn=!Yi&&(i==="scroll"||i==="scrollend"),dt=Yi?Ct!==null?Ct+"Capture":null:Ct;Yi=[];for(var st=Tt,bt;st!==null;){var Vt=st;if(bt=Vt.stateNode,Vt=Vt.tag,Vt!==5&&Vt!==26&&Vt!==27||bt===null||dt===null||(Vt=an(st,dt),Vt!=null&&Yi.push(p(st,Vt,bt))),nn)break;st=st.return}0<Yi.length&&(Ct=new At(Ct,Ni,null,d,Ft),$t.push({event:Ct,listeners:Yi}))}}if((o&7)===0){e:{if(Ct=i==="mouseover"||i==="pointerover",At=i==="mouseout"||i==="pointerout",Ct&&d!==Za&&(Ni=d.relatedTarget||d.fromElement)&&(es(Ni)||Ni[ur]))break e;if((At||Ct)&&(Ct=Ft.window===Ft?Ft:(Ct=Ft.ownerDocument)?Ct.defaultView||Ct.parentWindow:window,At?(Ni=d.relatedTarget||d.toElement,At=Tt,Ni=Ni?es(Ni):null,Ni!==null&&(nn=ce(Ni),Yi=Ni.tag,Ni!==nn||Yi!==5&&Yi!==27&&Yi!==6)&&(Ni=null)):(At=null,Ni=Tt),At!==Ni)){if(Yi=tu,Vt="onMouseLeave",dt="onMouseEnter",st="mouse",(i==="pointerout"||i==="pointerover")&&(Yi=Uu,Vt="onPointerLeave",dt="onPointerEnter",st="pointer"),nn=At==null?Ct:Jt(At),bt=Ni==null?Ct:Jt(Ni),Ct=new Yi(Vt,st+"leave",At,d,Ft),Ct.target=nn,Ct.relatedTarget=bt,Vt=null,es(Ft)===Tt&&(Yi=new Yi(dt,st+"enter",Ni,d,Ft),Yi.target=bt,Yi.relatedTarget=nn,Vt=Yi),nn=Vt,At&&Ni)t:{for(Yi=At,dt=Ni,st=0,bt=Yi;bt;bt=b(bt))st++;for(bt=0,Vt=dt;Vt;Vt=b(Vt))bt++;for(;0<st-bt;)Yi=b(Yi),st--;for(;0<bt-st;)dt=b(dt),bt--;for(;st--;){if(Yi===dt||dt!==null&&Yi===dt.alternate)break t;Yi=b(Yi),dt=b(dt)}Yi=null}else Yi=null;At!==null&&T($t,Ct,At,Yi,!1),Ni!==null&&nn!==null&&T($t,nn,Ni,Yi,!0)}}e:{if(Ct=Tt?Jt(Tt):window,At=Ct.nodeName&&Ct.nodeName.toLowerCase(),At==="select"||At==="input"&&Ct.type==="file")var Ci=ll;else if(al(Ct))if(Sd)Ci=af;else{Ci=Td;var Tr=Bl}else At=Ct.nodeName,!At||At.toLowerCase()!=="input"||Ct.type!=="checkbox"&&Ct.type!=="radio"?Tt&&ms(Tt.elementType)&&(Ci=ll):Ci=Dh;if(Ci&&(Ci=Ci(i,Tt))){Hu($t,Ci,d,Ft);break e}Tr&&Tr(i,Ct,Tt),i==="focusout"&&Tt&&Ct.type==="number"&&Tt.memoizedProps.value!=null&&Jc(Ct,"number",Ct.value)}switch(Tr=Tt?Jt(Tt):window,i){case"focusin":(al(Tr)||Tr.contentEditable==="true")&&(Nl=Tr,Fl=Tt,su=null);break;case"focusout":su=Fl=Nl=null;break;case"mousedown":Wu=!0;break;case"contextmenu":case"mouseup":case"dragend":Wu=!1,cl($t,d,Ft);break;case"selectionchange":if(Cd)break;case"keydown":case"keyup":cl($t,d,Ft)}var Ii;if(jl)e:{switch(i){case"compositionstart":var Ki="onCompositionStart";break e;case"compositionend":Ki="onCompositionEnd";break e;case"compositionupdate":Ki="onCompositionUpdate";break e}Ki=void 0}else Io?Gu(i,d)&&(Ki="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(Ki="onCompositionStart");Ki&&(Vu&&d.locale!=="ko"&&(Io||Ki!=="onCompositionStart"?Ki==="onCompositionEnd"&&Io&&(Ii=Oi()):(ks=Ft,Vi="value"in ks?ks.value:ks.textContent,Io=!0)),Tr=g(Tt,Ki),0<Tr.length&&(Ki=new Fu(Ki,i,null,d,Ft),$t.push({event:Ki,listeners:Tr}),Ii?Ki.data=Ii:(Ii=bc(d),Ii!==null&&(Ki.data=Ii)))),(Ii=wd?_p(i,d):$u(i,d))&&(Ki=g(Tt,"onBeforeInput"),0<Ki.length&&(Tr=new Fu("onBeforeInput","beforeinput",null,d,Ft),$t.push({event:Tr,listeners:Ki}),Tr.data=Ii)),Cf($t,i,Tt,d,Ft)}Jf($t,o)})}function p(i,o,d){return{instance:i,listener:o,currentTarget:d}}function g(i,o){for(var d=o+"Capture",x=[];i!==null;){var k=i,O=k.stateNode;if(k=k.tag,k!==5&&k!==26&&k!==27||O===null||(k=an(i,d),k!=null&&x.unshift(p(i,k,O)),k=an(i,o),k!=null&&x.push(p(i,k,O))),i.tag===3)return x;i=i.return}return[]}function b(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function T(i,o,d,x,k){for(var O=o._reactName,se=[];d!==null&&d!==x;){var xe=d,Xe=xe.alternate,Tt=xe.stateNode;if(xe=xe.tag,Xe!==null&&Xe===x)break;xe!==5&&xe!==26&&xe!==27||Tt===null||(Xe=Tt,k?(Tt=an(d,O),Tt!=null&&se.unshift(p(d,Tt,Xe))):k||(Tt=an(d,O),Tt!=null&&se.push(p(d,Tt,Xe)))),d=d.return}se.length!==0&&i.push({event:o,listeners:se})}var C=/\r\n?/g,E=/\u0000|\uFFFD/g;function D(i){return(typeof i=="string"?i:""+i).replace(C,`
`).replace(E,"")}function N(i,o){return o=D(o),D(i)===o}function I(){}function U(i,o,d,x,k,O){switch(d){case"children":typeof x=="string"?o==="body"||o==="textarea"&&x===""||fs(i,x):(typeof x=="number"||typeof x=="bigint")&&o!=="body"&&fs(i,""+x);break;case"className":hs(i,"class",x);break;case"tabIndex":hs(i,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":hs(i,d,x);break;case"style":zo(i,x,O);break;case"data":if(o!=="object"){hs(i,"data",x);break}case"src":case"href":if(x===""&&(o!=="a"||d!=="href")){i.removeAttribute(d);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){i.removeAttribute(d);break}x=eu(""+x),i.setAttribute(d,x);break;case"action":case"formAction":if(typeof x=="function"){i.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof O=="function"&&(d==="formAction"?(o!=="input"&&U(i,o,"name",k.name,k,null),U(i,o,"formEncType",k.formEncType,k,null),U(i,o,"formMethod",k.formMethod,k,null),U(i,o,"formTarget",k.formTarget,k,null)):(U(i,o,"encType",k.encType,k,null),U(i,o,"method",k.method,k,null),U(i,o,"target",k.target,k,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){i.removeAttribute(d);break}x=eu(""+x),i.setAttribute(d,x);break;case"onClick":x!=null&&(i.onclick=I);break;case"onScroll":x!=null&&br("scroll",i);break;case"onScrollEnd":x!=null&&br("scrollend",i);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error($(61));if(d=x.__html,d!=null){if(k.children!=null)throw Error($(60));i.innerHTML=d}}break;case"multiple":i.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":i.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){i.removeAttribute("xlink:href");break}d=eu(""+x),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?i.setAttribute(d,""+x):i.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?i.setAttribute(d,""):i.removeAttribute(d);break;case"capture":case"download":x===!0?i.setAttribute(d,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?i.setAttribute(d,x):i.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?i.setAttribute(d,x):i.removeAttribute(d);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?i.removeAttribute(d):i.setAttribute(d,x);break;case"popover":br("beforetoggle",i),br("toggle",i),Jo(i,"popover",x);break;case"xlinkActuate":ds(i,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":ds(i,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":ds(i,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":ds(i,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":ds(i,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":ds(i,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":ds(i,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":ds(i,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":ds(i,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Jo(i,"is",x);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Lo.get(d)||d,Jo(i,d,x))}}function X(i,o,d,x,k,O){switch(d){case"style":zo(i,x,O);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error($(61));if(d=x.__html,d!=null){if(k.children!=null)throw Error($(60));i.innerHTML=d}}break;case"children":typeof x=="string"?fs(i,x):(typeof x=="number"||typeof x=="bigint")&&fs(i,""+x);break;case"onScroll":x!=null&&br("scroll",i);break;case"onScrollEnd":x!=null&&br("scrollend",i);break;case"onClick":x!=null&&(i.onclick=I);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qc.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(k=d.endsWith("Capture"),o=d.slice(2,k?d.length-7:void 0),O=i[Wi]||null,O=O!=null?O[d]:null,typeof O=="function"&&i.removeEventListener(o,O,k),typeof x=="function")){typeof O!="function"&&O!==null&&(d in i?i[d]=null:i.hasAttribute(d)&&i.removeAttribute(d)),i.addEventListener(o,x,k);break e}d in i?i[d]=x:x===!0?i.setAttribute(d,""):Jo(i,d,x)}}}function Q(i,o,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":br("error",i),br("load",i);var x=!1,k=!1,O;for(O in d)if(d.hasOwnProperty(O)){var se=d[O];if(se!=null)switch(O){case"src":x=!0;break;case"srcSet":k=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error($(137,o));default:U(i,o,O,se,d,null)}}k&&U(i,o,"srcSet",d.srcSet,d,null),x&&U(i,o,"src",d.src,d,null);return;case"input":br("invalid",i);var xe=O=se=k=null,Xe=null,Tt=null;for(x in d)if(d.hasOwnProperty(x)){var Ft=d[x];if(Ft!=null)switch(x){case"name":k=Ft;break;case"type":se=Ft;break;case"checked":Xe=Ft;break;case"defaultChecked":Tt=Ft;break;case"value":O=Ft;break;case"defaultValue":xe=Ft;break;case"children":case"dangerouslySetInnerHTML":if(Ft!=null)throw Error($(137,o));break;default:U(i,o,x,Ft,d,null)}}Rl(i,O,xe,Xe,Tt,se,k,!1),ko(i);return;case"select":br("invalid",i),x=se=O=null;for(k in d)if(d.hasOwnProperty(k)&&(xe=d[k],xe!=null))switch(k){case"value":O=xe;break;case"defaultValue":se=xe;break;case"multiple":x=xe;default:U(i,o,k,xe,d,null)}o=O,d=se,i.multiple=!!x,o!=null?Ws(i,!!x,o,!1):d!=null&&Ws(i,!!x,d,!0);return;case"textarea":br("invalid",i),O=k=x=null;for(se in d)if(d.hasOwnProperty(se)&&(xe=d[se],xe!=null))switch(se){case"value":x=xe;break;case"defaultValue":k=xe;break;case"children":O=xe;break;case"dangerouslySetInnerHTML":if(xe!=null)throw Error($(91));break;default:U(i,o,se,xe,d,null)}Sa(i,x,k,O),ko(i);return;case"option":for(Xe in d)if(d.hasOwnProperty(Xe)&&(x=d[Xe],x!=null))switch(Xe){case"selected":i.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:U(i,o,Xe,x,d,null)}return;case"dialog":br("beforetoggle",i),br("toggle",i),br("cancel",i),br("close",i);break;case"iframe":case"object":br("load",i);break;case"video":case"audio":for(x=0;x<rp.length;x++)br(rp[x],i);break;case"image":br("error",i),br("load",i);break;case"details":br("toggle",i);break;case"embed":case"source":case"link":br("error",i),br("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Tt in d)if(d.hasOwnProperty(Tt)&&(x=d[Tt],x!=null))switch(Tt){case"children":case"dangerouslySetInnerHTML":throw Error($(137,o));default:U(i,o,Tt,x,d,null)}return;default:if(ms(o)){for(Ft in d)d.hasOwnProperty(Ft)&&(x=d[Ft],x!==void 0&&X(i,o,Ft,x,d,void 0));return}}for(xe in d)d.hasOwnProperty(xe)&&(x=d[xe],x!=null&&U(i,o,xe,x,d,null))}function le(i,o,d,x){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var k=null,O=null,se=null,xe=null,Xe=null,Tt=null,Ft=null;for(At in d){var $t=d[At];if(d.hasOwnProperty(At)&&$t!=null)switch(At){case"checked":break;case"value":break;case"defaultValue":Xe=$t;default:x.hasOwnProperty(At)||U(i,o,At,null,x,$t)}}for(var Ct in x){var At=x[Ct];if($t=d[Ct],x.hasOwnProperty(Ct)&&(At!=null||$t!=null))switch(Ct){case"type":O=At;break;case"name":k=At;break;case"checked":Tt=At;break;case"defaultChecked":Ft=At;break;case"value":se=At;break;case"defaultValue":xe=At;break;case"children":case"dangerouslySetInnerHTML":if(At!=null)throw Error($(137,o));break;default:At!==$t&&U(i,o,Ct,At,x,$t)}}gc(i,se,xe,Xe,Tt,Ft,O,k);return;case"select":At=se=xe=Ct=null;for(O in d)if(Xe=d[O],d.hasOwnProperty(O)&&Xe!=null)switch(O){case"value":break;case"multiple":At=Xe;default:x.hasOwnProperty(O)||U(i,o,O,null,x,Xe)}for(k in x)if(O=x[k],Xe=d[k],x.hasOwnProperty(k)&&(O!=null||Xe!=null))switch(k){case"value":Ct=O;break;case"defaultValue":xe=O;break;case"multiple":se=O;default:O!==Xe&&U(i,o,k,O,x,Xe)}o=xe,d=se,x=At,Ct!=null?Ws(i,!!d,Ct,!1):!!x!=!!d&&(o!=null?Ws(i,!!d,o,!0):Ws(i,!!d,d?[]:"",!1));return;case"textarea":At=Ct=null;for(xe in d)if(k=d[xe],d.hasOwnProperty(xe)&&k!=null&&!x.hasOwnProperty(xe))switch(xe){case"value":break;case"children":break;default:U(i,o,xe,null,x,k)}for(se in x)if(k=x[se],O=d[se],x.hasOwnProperty(se)&&(k!=null||O!=null))switch(se){case"value":Ct=k;break;case"defaultValue":At=k;break;case"children":break;case"dangerouslySetInnerHTML":if(k!=null)throw Error($(91));break;default:k!==O&&U(i,o,se,k,x,O)}Ch(i,Ct,At);return;case"option":for(var Ni in d)if(Ct=d[Ni],d.hasOwnProperty(Ni)&&Ct!=null&&!x.hasOwnProperty(Ni))switch(Ni){case"selected":i.selected=!1;break;default:U(i,o,Ni,null,x,Ct)}for(Xe in x)if(Ct=x[Xe],At=d[Xe],x.hasOwnProperty(Xe)&&Ct!==At&&(Ct!=null||At!=null))switch(Xe){case"selected":i.selected=Ct&&typeof Ct!="function"&&typeof Ct!="symbol";break;default:U(i,o,Xe,Ct,x,At)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Yi in d)Ct=d[Yi],d.hasOwnProperty(Yi)&&Ct!=null&&!x.hasOwnProperty(Yi)&&U(i,o,Yi,null,x,Ct);for(Tt in x)if(Ct=x[Tt],At=d[Tt],x.hasOwnProperty(Tt)&&Ct!==At&&(Ct!=null||At!=null))switch(Tt){case"children":case"dangerouslySetInnerHTML":if(Ct!=null)throw Error($(137,o));break;default:U(i,o,Tt,Ct,x,At)}return;default:if(ms(o)){for(var nn in d)Ct=d[nn],d.hasOwnProperty(nn)&&Ct!==void 0&&!x.hasOwnProperty(nn)&&X(i,o,nn,void 0,x,Ct);for(Ft in x)Ct=x[Ft],At=d[Ft],!x.hasOwnProperty(Ft)||Ct===At||Ct===void 0&&At===void 0||X(i,o,Ft,Ct,x,At);return}}for(var dt in d)Ct=d[dt],d.hasOwnProperty(dt)&&Ct!=null&&!x.hasOwnProperty(dt)&&U(i,o,dt,null,x,Ct);for($t in x)Ct=x[$t],At=d[$t],!x.hasOwnProperty($t)||Ct===At||Ct==null&&At==null||U(i,o,$t,Ct,x,At)}var ne=null,ie=null;function me(i){return i.nodeType===9?i:i.ownerDocument}function _e(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Je(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function $e(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ze=null;function ht(){var i=window.event;return i&&i.type==="popstate"?i===Ze?!1:(Ze=i,!0):(Ze=null,!1)}var at=typeof setTimeout=="function"?setTimeout:void 0,mt=typeof clearTimeout=="function"?clearTimeout:void 0,Bt=typeof Promise=="function"?Promise:void 0,Zt=typeof queueMicrotask=="function"?queueMicrotask:typeof Bt<"u"?function(i){return Bt.resolve(null).then(i).catch(Qt)}:at;function Qt(i){setTimeout(function(){throw i})}function Gt(i){return i==="head"}function hi(i,o){var d=o,x=0,k=0;do{var O=d.nextSibling;if(i.removeChild(d),O&&O.nodeType===8)if(d=O.data,d==="/$"){if(0<x&&8>x){d=x;var se=i.ownerDocument;if(d&1&&dr(se.documentElement),d&2&&dr(se.body),d&4)for(d=se.head,dr(d),se=d.firstChild;se;){var xe=se.nextSibling,Xe=se.nodeName;se[Cn]||Xe==="SCRIPT"||Xe==="STYLE"||Xe==="LINK"&&se.rel.toLowerCase()==="stylesheet"||d.removeChild(se),se=xe}}if(k===0){i.removeChild(O),jn(o);return}k--}else d==="$"||d==="$?"||d==="$!"?k++:x=d.charCodeAt(0)-48;else x=0;d=O}while(d);jn(o)}function oi(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var d=o;switch(o=o.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":oi(d),Ur(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}i.removeChild(d)}}function ji(i,o,d,x){for(;i.nodeType===1;){var k=d;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!x&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(x){if(!i[Cn])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(O=i.getAttribute("rel"),O==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(O!==k.rel||i.getAttribute("href")!==(k.href==null||k.href===""?null:k.href)||i.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin)||i.getAttribute("title")!==(k.title==null?null:k.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(O=i.getAttribute("src"),(O!==(k.src==null?null:k.src)||i.getAttribute("type")!==(k.type==null?null:k.type)||i.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin))&&O&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var O=k.name==null?null:""+k.name;if(k.type==="hidden"&&i.getAttribute("name")===O)return i}else return i;if(i=Bi(i.nextSibling),i===null)break}return null}function _i(i,o,d){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!d||(i=Bi(i.nextSibling),i===null))return null;return i}function Di(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function lr(i,o){var d=i.ownerDocument;if(i.data!=="$?"||d.readyState==="complete")o();else{var x=function(){o(),d.removeEventListener("DOMContentLoaded",x)};d.addEventListener("DOMContentLoaded",x),i._reactRetry=x}}function Bi(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}var yr=null;function Na(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return i;o--}else d==="/$"&&o++}i=i.previousSibling}return null}function _r(i,o,d){switch(o=me(d),i){case"html":if(i=o.documentElement,!i)throw Error($(452));return i;case"head":if(i=o.head,!i)throw Error($(453));return i;case"body":if(i=o.body,!i)throw Error($(454));return i;default:throw Error($(451))}}function dr(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);Ur(i)}var fi=new Map,zi=new Set;function hn(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var pr=It.d;It.d={f:Hr,r:ta,D:Yo,C:us,L:Rn,m:xh,X:El,S:$c,M:vh};function Hr(){var i=pr.f(),o=Dn();return i||o}function ta(i){var o=Cs(i);o!==null&&o.tag===5&&o.type==="form"?Fr(o):pr.r(i)}var Ts=typeof document>"u"?null:document;function $s(i,o,d){var x=Ts;if(x&&typeof o=="string"&&o){var k=As(o);k='link[rel="'+i+'"][href="'+k+'"]',typeof d=="string"&&(k+='[crossorigin="'+d+'"]'),zi.has(k)||(zi.add(k),i={rel:i,crossOrigin:d,href:o},x.querySelector(k)===null&&(o=x.createElement("link"),Q(o,"link",i),Mi(o),x.head.appendChild(o)))}}function Yo(i){pr.D(i),$s("dns-prefetch",i,null)}function us(i,o){pr.C(i,o),$s("preconnect",i,o)}function Rn(i,o,d){pr.L(i,o,d);var x=Ts;if(x&&i&&o){var k='link[rel="preload"][as="'+As(o)+'"]';o==="image"&&d&&d.imageSrcSet?(k+='[imagesrcset="'+As(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(k+='[imagesizes="'+As(d.imageSizes)+'"]')):k+='[href="'+As(i)+'"]';var O=k;switch(o){case"style":O=To(i);break;case"script":O=hd(i)}fi.has(O)||(i=Te({rel:"preload",href:o==="image"&&d&&d.imageSrcSet?void 0:i,as:o},d),fi.set(O,i),x.querySelector(k)!==null||o==="style"&&x.querySelector(Hc(O))||o==="script"&&x.querySelector(sp(O))||(o=x.createElement("link"),Q(o,"link",i),Mi(o),x.head.appendChild(o)))}}function xh(i,o){pr.m(i,o);var d=Ts;if(d&&i){var x=o&&typeof o.as=="string"?o.as:"script",k='link[rel="modulepreload"][as="'+As(x)+'"][href="'+As(i)+'"]',O=k;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":O=hd(i)}if(!fi.has(O)&&(i=Te({rel:"modulepreload",href:i},o),fi.set(O,i),d.querySelector(k)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(sp(O)))return}x=d.createElement("link"),Q(x,"link",i),Mi(x),d.head.appendChild(x)}}}function $c(i,o,d){pr.S(i,o,d);var x=Ts;if(x&&i){var k=Fi(x).hoistableStyles,O=To(i);o=o||"default";var se=k.get(O);if(!se){var xe={loading:0,preload:null};if(se=x.querySelector(Hc(O)))xe.loading=5;else{i=Te({rel:"stylesheet",href:i,"data-precedence":o},d),(d=fi.get(O))&&t(i,d);var Xe=se=x.createElement("link");Mi(Xe),Q(Xe,"link",i),Xe._p=new Promise(function(Tt,Ft){Xe.onload=Tt,Xe.onerror=Ft}),Xe.addEventListener("load",function(){xe.loading|=1}),Xe.addEventListener("error",function(){xe.loading|=2}),xe.loading|=4,a(se,o,x)}se={type:"stylesheet",instance:se,count:1,state:xe},k.set(O,se)}}}function El(i,o){pr.X(i,o);var d=Ts;if(d&&i){var x=Fi(d).hoistableScripts,k=hd(i),O=x.get(k);O||(O=d.querySelector(sp(k)),O||(i=Te({src:i,async:!0},o),(o=fi.get(k))&&n(i,o),O=d.createElement("script"),Mi(O),Q(O,"link",i),d.head.appendChild(O)),O={type:"script",instance:O,count:1,state:null},x.set(k,O))}}function vh(i,o){pr.M(i,o);var d=Ts;if(d&&i){var x=Fi(d).hoistableScripts,k=hd(i),O=x.get(k);O||(O=d.querySelector(sp(k)),O||(i=Te({src:i,async:!0,type:"module"},o),(o=fi.get(k))&&n(i,o),O=d.createElement("script"),Mi(O),Q(O,"link",i),d.head.appendChild(O)),O={type:"script",instance:O,count:1,state:null},x.set(k,O))}}function So(i,o,d,x){var k=(k=Ri.current)?hn(k):null;if(!k)throw Error($(446));switch(i){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(o=To(d.href),d=Fi(k).hoistableStyles,x=d.get(o),x||(x={type:"style",instance:null,count:0,state:null},d.set(o,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){i=To(d.href);var O=Fi(k).hoistableStyles,se=O.get(i);if(se||(k=k.ownerDocument||k,se={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},O.set(i,se),(O=k.querySelector(Hc(i)))&&!O._p&&(se.instance=O,se.state.loading=5),fi.has(i)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},fi.set(i,d),O||gm(k,i,d,se.state))),o&&x===null)throw Error($(528,""));return se}if(o&&x!==null)throw Error($(529,""));return null;case"script":return o=d.async,d=d.src,typeof d=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=hd(d),d=Fi(k).hoistableScripts,x=d.get(o),x||(x={type:"script",instance:null,count:0,state:null},d.set(o,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error($(444,i))}}function To(i){return'href="'+As(i)+'"'}function Hc(i){return'link[rel="stylesheet"]['+i+"]"}function Yp(i){return Te({},i,{"data-precedence":i.precedence,precedence:null})}function gm(i,o,d,x){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?x.loading=1:(o=i.createElement("link"),x.preload=o,o.addEventListener("load",function(){return x.loading|=1}),o.addEventListener("error",function(){return x.loading|=2}),Q(o,"link",d),Mi(o),i.head.appendChild(o))}function hd(i){return'[src="'+As(i)+'"]'}function sp(i){return"script[async]"+i}function Rm(i,o,d){if(o.count++,o.instance===null)switch(o.type){case"style":var x=i.querySelector('style[data-href~="'+As(d.href)+'"]');if(x)return o.instance=x,Mi(x),x;var k=Te({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return x=(i.ownerDocument||i).createElement("style"),Mi(x),Q(x,"style",k),a(x,d.precedence,i),o.instance=x;case"stylesheet":k=To(d.href);var O=i.querySelector(Hc(k));if(O)return o.state.loading|=4,o.instance=O,Mi(O),O;x=Yp(d),(k=fi.get(k))&&t(x,k),O=(i.ownerDocument||i).createElement("link"),Mi(O);var se=O;return se._p=new Promise(function(xe,Xe){se.onload=xe,se.onerror=Xe}),Q(O,"link",x),o.state.loading|=4,a(O,d.precedence,i),o.instance=O;case"script":return O=hd(d.src),(k=i.querySelector(sp(O)))?(o.instance=k,Mi(k),k):(x=d,(k=fi.get(O))&&(x=Te({},d),n(x,k)),i=i.ownerDocument||i,k=i.createElement("script"),Mi(k),Q(k,"link",x),i.head.appendChild(k),o.instance=k);case"void":return null;default:throw Error($(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(x=o.instance,o.state.loading|=4,a(x,d.precedence,i));return o.instance}function a(i,o,d){for(var x=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),k=x.length?x[x.length-1]:null,O=k,se=0;se<x.length;se++){var xe=x[se];if(xe.dataset.precedence===o)O=xe;else if(O!==k)break}O?O.parentNode.insertBefore(i,O.nextSibling):(o=d.nodeType===9?d.head:d,o.insertBefore(i,o.firstChild))}function t(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function n(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var l=null;function m(i,o,d){if(l===null){var x=new Map,k=l=new Map;k.set(d,x)}else k=l,x=k.get(d),x||(x=new Map,k.set(d,x));if(x.has(i))return x;for(x.set(i,null),d=d.getElementsByTagName(i),k=0;k<d.length;k++){var O=d[k];if(!(O[Cn]||O[tr]||i==="link"&&O.getAttribute("rel")==="stylesheet")&&O.namespaceURI!=="http://www.w3.org/2000/svg"){var se=O.getAttribute(o)||"";se=i+se;var xe=x.get(se);xe?xe.push(O):x.set(se,[O])}}return x}function v(i,o,d){i=i.ownerDocument||i,i.head.insertBefore(d,o==="title"?i.querySelector("head > title"):null)}function w(i,o,d){if(d===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function A(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var z=null;function j(){}function G(i,o,d){if(z===null)throw Error($(475));var x=z;if(o.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var k=To(d.href),O=i.querySelector(Hc(k));if(O){i=O._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(x.count++,x=ee.bind(x),i.then(x,x)),o.state.loading|=4,o.instance=O,Mi(O);return}O=i.ownerDocument||i,d=Yp(d),(k=fi.get(k))&&t(d,k),O=O.createElement("link"),Mi(O);var se=O;se._p=new Promise(function(xe,Xe){se.onload=xe,se.onerror=Xe}),Q(O,"link",d),o.instance=O}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(x.count++,o=ee.bind(x),i.addEventListener("load",o),i.addEventListener("error",o))}}function Y(){if(z===null)throw Error($(475));var i=z;return i.stylesheets&&i.count===0&&ue(i,i.stylesheets),0<i.count?function(o){var d=setTimeout(function(){if(i.stylesheets&&ue(i,i.stylesheets),i.unsuspend){var x=i.unsuspend;i.unsuspend=null,x()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(d)}}:null}function ee(){if(this.count--,this.count===0){if(this.stylesheets)ue(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var ae=null;function ue(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,ae=new Map,o.forEach(fe,i),ae=null,ee.call(i))}function fe(i,o){if(!(o.state.loading&4)){var d=ae.get(i);if(d)var x=d.get(null);else{d=new Map,ae.set(i,d);for(var k=i.querySelectorAll("link[data-precedence],style[data-precedence]"),O=0;O<k.length;O++){var se=k[O];(se.nodeName==="LINK"||se.getAttribute("media")!=="not all")&&(d.set(se.dataset.precedence,se),x=se)}x&&d.set(null,x)}k=o.instance,se=k.getAttribute("data-precedence"),O=d.get(se)||x,O===x&&d.set(null,k),d.set(se,k),this.count++,x=ee.bind(this),k.addEventListener("load",x),k.addEventListener("error",x),O?O.parentNode.insertBefore(k,O.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(k,i.firstChild)),o.state.loading|=4}}var we={$$typeof:We,Provider:null,Consumer:null,_currentValue:ti,_currentValue2:ti,_threadCount:0};function Pe(i,o,d,x,k,O,se,xe){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Et(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Et(0),this.hiddenUpdates=Et(null),this.identifierPrefix=x,this.onUncaughtError=k,this.onCaughtError=O,this.onRecoverableError=se,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=xe,this.incompleteTransitions=new Map}function et(i,o,d,x,k,O,se,xe,Xe,Tt,Ft,$t){return i=new Pe(i,o,d,se,xe,Xe,Tt,$t),o=1,O===!0&&(o|=24),O=Ea(3,null,null,o),i.current=O,O.stateNode=i,o=Zl(),o.refCount++,i.pooledCache=o,o.refCount++,O.memoizedState={element:x,isDehydrated:d,cache:o},nh(O),i}function Be(i){return i?(i=io,i):io}function re(i,o,d,x,k,O){k=Be(k),x.context===null?x.context=k:x.pendingContext=k,x=Uo(o),x.payload={element:d},O=O===void 0?null:O,O!==null&&(x.callback=O),d=xl(i,x,o),d!==null&&(cs(d,i,o),uo(d,i,o))}function ve(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<o?d:o}}function Fe(i,o){ve(i,o),(i=i.alternate)&&ve(i,o)}function xt(i){if(i.tag===13){var o=Is(i,67108864);o!==null&&cs(o,i,67108864),Fe(i,67108864)}}var Nt=!0;function Mt(i,o,d,x){var k=gt.T;gt.T=null;var O=It.p;try{It.p=2,qt(i,o,d,x)}finally{It.p=O,gt.T=k}}function kt(i,o,d,x){var k=gt.T;gt.T=null;var O=It.p;try{It.p=8,qt(i,o,d,x)}finally{It.p=O,gt.T=k}}function qt(i,o,d,x){if(Nt){var k=Ut(x);if(k===null)u(i,o,x,Xt,d),Hs(i,x);else if(Mn(k,i,o,d,x))x.stopPropagation();else if(Hs(i,x),o&4&&-1<kl.indexOf(i)){for(;k!==null;){var O=Cs(k);if(O!==null)switch(O.tag){case 3:if(O=O.stateNode,O.current.memoizedState.isDehydrated){var se=Me(O.pendingLanes);if(se!==0){var xe=O;for(xe.pendingLanes|=2,xe.entangledLanes|=2;se;){var Xe=1<<31-oa(se);xe.entanglements[1]|=Xe,se&=~Xe}wo(O),($r&6)===0&&(Zd=qr()+500,Jd(0))}}break;case 13:xe=Is(O,2),xe!==null&&cs(xe,O,2),Dn(),Fe(O,2)}if(O=Ut(x),O===null&&u(i,o,x,Xt,d),O===k)break;k=O}k!==null&&x.stopPropagation()}else u(i,o,x,null,d)}}function Ut(i){return i=Es(i),Rt(i)}var Xt=null;function Rt(i){if(Xt=null,i=es(i),i!==null){var o=ce(i);if(o===null)i=null;else{var d=o.tag;if(d===13){if(i=B(o),i!==null)return i;i=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Xt=i,null}function gi(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ga()){case va:return 2;case Ao:return 8;case $a:case Ru:return 32;case zl:return 268435456;default:return 32}default:return 32}}var Ei=!1,Si=null,mi=null,Ji=null,rn=new Map,In=new Map,On=[],kl="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Hs(i,o){switch(i){case"focusin":case"focusout":Si=null;break;case"dragenter":case"dragleave":mi=null;break;case"mouseover":case"mouseout":Ji=null;break;case"pointerover":case"pointerout":rn.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":In.delete(o.pointerId)}}function qn(i,o,d,x,k,O){return i===null||i.nativeEvent!==O?(i={blockedOn:o,domEventName:d,eventSystemFlags:x,nativeEvent:O,targetContainers:[k]},o!==null&&(o=Cs(o),o!==null&&xt(o)),i):(i.eventSystemFlags|=x,o=i.targetContainers,k!==null&&o.indexOf(k)===-1&&o.push(k),i)}function Mn(i,o,d,x,k){switch(o){case"focusin":return Si=qn(Si,i,o,d,x,k),!0;case"dragenter":return mi=qn(mi,i,o,d,x,k),!0;case"mouseover":return Ji=qn(Ji,i,o,d,x,k),!0;case"pointerover":var O=k.pointerId;return rn.set(O,qn(rn.get(O)||null,i,o,d,x,k)),!0;case"gotpointercapture":return O=k.pointerId,In.set(O,qn(In.get(O)||null,i,o,d,x,k)),!0}return!1}function _a(i){var o=es(i.target);if(o!==null){var d=ce(o);if(d!==null){if(o=d.tag,o===13){if(o=B(d),o!==null){i.blockedOn=o,ai(i.priority,function(){if(d.tag===13){var x=Gs();x=ni(x);var k=Is(d,x);k!==null&&cs(k,d,x),Fe(d,x)}});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ia(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var d=Ut(i.nativeEvent);if(d===null){d=i.nativeEvent;var x=new d.constructor(d.type,d);Za=x,d.target.dispatchEvent(x),Za=null}else return o=Cs(d),o!==null&&xt(o),i.blockedOn=d,!1;o.shift()}return!0}function Fa(i,o,d){ia(i)&&d.delete(o)}function Zs(){Ei=!1,Si!==null&&ia(Si)&&(Si=null),mi!==null&&ia(mi)&&(mi=null),Ji!==null&&ia(Ji)&&(Ji=null),rn.forEach(Fa),In.forEach(Fa)}function qs(i,o){i.blockedOn===o&&(i.blockedOn=null,Ei||(Ei=!0,S.unstable_scheduleCallback(S.unstable_NormalPriority,Zs)))}var Xn=null;function Xs(i){Xn!==i&&(Xn=i,S.unstable_scheduleCallback(S.unstable_NormalPriority,function(){Xn===i&&(Xn=null);for(var o=0;o<i.length;o+=3){var d=i[o],x=i[o+1],k=i[o+2];if(typeof x!="function"){if(Rt(x||d)===null)continue;break}var O=Cs(d);O!==null&&(i.splice(o,3),o-=3,cr(O,{pending:!0,data:k,method:d.method,action:x},x,k))}}))}function jn(i){function o(Xe){return qs(Xe,i)}Si!==null&&qs(Si,i),mi!==null&&qs(mi,i),Ji!==null&&qs(Ji,i),rn.forEach(o),In.forEach(o);for(var d=0;d<On.length;d++){var x=On[d];x.blockedOn===i&&(x.blockedOn=null)}for(;0<On.length&&(d=On[0],d.blockedOn===null);)_a(d),d.blockedOn===null&&On.shift();if(d=(i.ownerDocument||i).$$reactFormReplay,d!=null)for(x=0;x<d.length;x+=3){var k=d[x],O=d[x+1],se=k[Wi]||null;if(typeof O=="function")se||Xs(d);else if(se){var xe=null;if(O&&O.hasAttribute("formAction")){if(k=O,se=O[Wi]||null)xe=se.formAction;else if(Rt(k)!==null)continue}else xe=se.action;typeof xe=="function"?d[x+1]=xe:(d.splice(x,3),x-=3),Xs(d)}}}function ra(i){this._internalRoot=i}Yn.prototype.render=ra.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error($(409));var d=o.current,x=Gs();re(d,x,i,o,null,null)},Yn.prototype.unmount=ra.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;re(i.current,2,null,i,null,null),Dn(),o[ur]=null}};function Yn(i){this._internalRoot=i}Yn.prototype.unstable_scheduleHydration=function(i){if(i){var o=ci();i={blockedOn:null,target:i,priority:o};for(var d=0;d<On.length&&o!==0&&o<On[d].priority;d++);On.splice(d,0,i),d===0&&_a(i)}};var Wn=F.version;if(Wn!=="19.1.0")throw Error($(527,Wn,"19.1.0"));It.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error($(188)):(i=Object.keys(i).join(","),Error($(268,i)));return i=oe(o),i=i!==null?ge(i):null,i=i===null?null:i.stateNode,i};var dn={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:gt,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wo.isDisabled&&Wo.supportsFiber)try{Ha=Wo.inject(dn),en=Wo}catch{}}return _m.createRoot=function(i,o){if(!J(i))throw Error($(299));var d=!1,x="",k=ec,O=sf,se=of,xe=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(x=o.identifierPrefix),o.onUncaughtError!==void 0&&(k=o.onUncaughtError),o.onCaughtError!==void 0&&(O=o.onCaughtError),o.onRecoverableError!==void 0&&(se=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(xe=o.unstable_transitionCallbacks)),o=et(i,1,!1,null,null,d,x,k,O,se,xe,null),i[ur]=o.current,R(i),new ra(o)},_m.hydrateRoot=function(i,o,d){if(!J(i))throw Error($(299));var x=!1,k="",O=ec,se=sf,xe=of,Xe=null,Tt=null;return d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(k=d.identifierPrefix),d.onUncaughtError!==void 0&&(O=d.onUncaughtError),d.onCaughtError!==void 0&&(se=d.onCaughtError),d.onRecoverableError!==void 0&&(xe=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(Xe=d.unstable_transitionCallbacks),d.formState!==void 0&&(Tt=d.formState)),o=et(i,1,!0,o,d??null,x,k,O,se,xe,Xe,Tt),o.context=Be(null),d=o.current,x=Gs(),x=ni(x),k=Uo(x),k.callback=null,xl(d,k,x),d=x,o.current.lanes=d,St(o,d),wo(o),i[ur]=o.current,R(i),new Yn(o)},_m.version="19.1.0",_m}var ly;function V_(){if(ly)return mg.exports;ly=1;function S(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(S)}catch(F){console.error(F)}}return S(),mg.exports=U_(),mg.exports}var G_=V_(),xm={},cy;function $_(){if(cy)return xm;cy=1,Object.defineProperty(xm,"__esModule",{value:!0}),xm.parse=B,xm.serialize=ge;const S=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,F=/^[\u0021-\u003A\u003C-\u007E]*$/,Z=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,$=/^[\u0020-\u003A\u003D-\u007E]*$/,J=Object.prototype.toString,ce=(()=>{const Ee=function(){};return Ee.prototype=Object.create(null),Ee})();function B(Ee,pe){const Se=new ce,Ne=Ee.length;if(Ne<2)return Se;const rt=(pe==null?void 0:pe.decode)||Te;let Ie=0;do{const Oe=Ee.indexOf("=",Ie);if(Oe===-1)break;const We=Ee.indexOf(";",Ie),ct=We===-1?Ne:We;if(Oe>ct){Ie=Ee.lastIndexOf(";",Oe-1)+1;continue}const Ke=h(Ee,Ie,Oe),pt=oe(Ee,Oe,Ke),Pt=Ee.slice(Ke,pt);if(Se[Pt]===void 0){let Ue=h(Ee,Oe+1,ct),zt=oe(Ee,ct,Ue);const _t=rt(Ee.slice(Ue,zt));Se[Pt]=_t}Ie=ct+1}while(Ie<Ne);return Se}function h(Ee,pe,Se){do{const Ne=Ee.charCodeAt(pe);if(Ne!==32&&Ne!==9)return pe}while(++pe<Se);return Se}function oe(Ee,pe,Se){for(;pe>Se;){const Ne=Ee.charCodeAt(--pe);if(Ne!==32&&Ne!==9)return pe+1}return Se}function ge(Ee,pe,Se){const Ne=(Se==null?void 0:Se.encode)||encodeURIComponent;if(!S.test(Ee))throw new TypeError(`argument name is invalid: ${Ee}`);const rt=Ne(pe);if(!F.test(rt))throw new TypeError(`argument val is invalid: ${pe}`);let Ie=Ee+"="+rt;if(!Se)return Ie;if(Se.maxAge!==void 0){if(!Number.isInteger(Se.maxAge))throw new TypeError(`option maxAge is invalid: ${Se.maxAge}`);Ie+="; Max-Age="+Se.maxAge}if(Se.domain){if(!Z.test(Se.domain))throw new TypeError(`option domain is invalid: ${Se.domain}`);Ie+="; Domain="+Se.domain}if(Se.path){if(!$.test(Se.path))throw new TypeError(`option path is invalid: ${Se.path}`);Ie+="; Path="+Se.path}if(Se.expires){if(!Ve(Se.expires)||!Number.isFinite(Se.expires.valueOf()))throw new TypeError(`option expires is invalid: ${Se.expires}`);Ie+="; Expires="+Se.expires.toUTCString()}if(Se.httpOnly&&(Ie+="; HttpOnly"),Se.secure&&(Ie+="; Secure"),Se.partitioned&&(Ie+="; Partitioned"),Se.priority)switch(typeof Se.priority=="string"?Se.priority.toLowerCase():void 0){case"low":Ie+="; Priority=Low";break;case"medium":Ie+="; Priority=Medium";break;case"high":Ie+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${Se.priority}`)}if(Se.sameSite)switch(typeof Se.sameSite=="string"?Se.sameSite.toLowerCase():Se.sameSite){case!0:case"strict":Ie+="; SameSite=Strict";break;case"lax":Ie+="; SameSite=Lax";break;case"none":Ie+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${Se.sameSite}`)}return Ie}function Te(Ee){if(Ee.indexOf("%")===-1)return Ee;try{return decodeURIComponent(Ee)}catch{return Ee}}function Ve(Ee){return J.call(Ee)==="[object Date]"}return xm}$_();var uy="popstate";function H_(S={}){function F($,J){let{pathname:ce,search:B,hash:h}=$.location;return zg("",{pathname:ce,search:B,hash:h},J.state&&J.state.usr||null,J.state&&J.state.key||"default")}function Z($,J){return typeof J=="string"?J:Tm(J)}return q_(F,Z,null,S)}function xa(S,F){if(S===!1||S===null||typeof S>"u")throw new Error(F)}function gd(S,F){if(!S){typeof console<"u"&&console.warn(F);try{throw new Error(F)}catch{}}}function Z_(){return Math.random().toString(36).substring(2,10)}function hy(S,F){return{usr:S.state,key:S.key,idx:F}}function zg(S,F,Z=null,$){return{pathname:typeof S=="string"?S:S.pathname,search:"",hash:"",...typeof F=="string"?sm(F):F,state:Z,key:F&&F.key||$||Z_()}}function Tm({pathname:S="/",search:F="",hash:Z=""}){return F&&F!=="?"&&(S+=F.charAt(0)==="?"?F:"?"+F),Z&&Z!=="#"&&(S+=Z.charAt(0)==="#"?Z:"#"+Z),S}function sm(S){let F={};if(S){let Z=S.indexOf("#");Z>=0&&(F.hash=S.substring(Z),S=S.substring(0,Z));let $=S.indexOf("?");$>=0&&(F.search=S.substring($),S=S.substring(0,$)),S&&(F.pathname=S)}return F}function q_(S,F,Z,$={}){let{window:J=document.defaultView,v5Compat:ce=!1}=$,B=J.history,h="POP",oe=null,ge=Te();ge==null&&(ge=0,B.replaceState({...B.state,idx:ge},""));function Te(){return(B.state||{idx:null}).idx}function Ve(){h="POP";let rt=Te(),Ie=rt==null?null:rt-ge;ge=rt,oe&&oe({action:h,location:Ne.location,delta:Ie})}function Ee(rt,Ie){h="PUSH";let Oe=zg(Ne.location,rt,Ie);ge=Te()+1;let We=hy(Oe,ge),ct=Ne.createHref(Oe);try{B.pushState(We,"",ct)}catch(Ke){if(Ke instanceof DOMException&&Ke.name==="DataCloneError")throw Ke;J.location.assign(ct)}ce&&oe&&oe({action:h,location:Ne.location,delta:1})}function pe(rt,Ie){h="REPLACE";let Oe=zg(Ne.location,rt,Ie);ge=Te();let We=hy(Oe,ge),ct=Ne.createHref(Oe);B.replaceState(We,"",ct),ce&&oe&&oe({action:h,location:Ne.location,delta:0})}function Se(rt){return X_(rt)}let Ne={get action(){return h},get location(){return S(J,B)},listen(rt){if(oe)throw new Error("A history only accepts one active listener");return J.addEventListener(uy,Ve),oe=rt,()=>{J.removeEventListener(uy,Ve),oe=null}},createHref(rt){return F(J,rt)},createURL:Se,encodeLocation(rt){let Ie=Se(rt);return{pathname:Ie.pathname,search:Ie.search,hash:Ie.hash}},push:Ee,replace:pe,go(rt){return B.go(rt)}};return Ne}function X_(S,F=!1){let Z="http://localhost";typeof window<"u"&&(Z=window.location.origin!=="null"?window.location.origin:window.location.href),xa(Z,"No window.location.(origin|href) available to create URL");let $=typeof S=="string"?S:Tm(S);return $=$.replace(/ $/,"%20"),!F&&$.startsWith("//")&&($=Z+$),new URL($,Z)}function $y(S,F,Z="/"){return Y_(S,F,Z,!1)}function Y_(S,F,Z,$){let J=typeof F=="string"?sm(F):F,ce=fp(J.pathname||"/",Z);if(ce==null)return null;let B=Hy(S);W_(B);let h=null;for(let oe=0;h==null&&oe<B.length;++oe){let ge=ox(ce);h=ax(B[oe],ge,$)}return h}function Hy(S,F=[],Z=[],$=""){let J=(ce,B,h)=>{let oe={relativePath:h===void 0?ce.path||"":h,caseSensitive:ce.caseSensitive===!0,childrenIndex:B,route:ce};oe.relativePath.startsWith("/")&&(xa(oe.relativePath.startsWith($),`Absolute route path "${oe.relativePath}" nested under path "${$}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),oe.relativePath=oe.relativePath.slice($.length));let ge=hp([$,oe.relativePath]),Te=Z.concat(oe);ce.children&&ce.children.length>0&&(xa(ce.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${ge}".`),Hy(ce.children,F,Te,ge)),!(ce.path==null&&!ce.index)&&F.push({path:ge,score:rx(ge,ce.index),routesMeta:Te})};return S.forEach((ce,B)=>{var h;if(ce.path===""||!((h=ce.path)!=null&&h.includes("?")))J(ce,B);else for(let oe of Zy(ce.path))J(ce,B,oe)}),F}function Zy(S){let F=S.split("/");if(F.length===0)return[];let[Z,...$]=F,J=Z.endsWith("?"),ce=Z.replace(/\?$/,"");if($.length===0)return J?[ce,""]:[ce];let B=Zy($.join("/")),h=[];return h.push(...B.map(oe=>oe===""?ce:[ce,oe].join("/"))),J&&h.push(...B),h.map(oe=>S.startsWith("/")&&oe===""?"/":oe)}function W_(S){S.sort((F,Z)=>F.score!==Z.score?Z.score-F.score:nx(F.routesMeta.map($=>$.childrenIndex),Z.routesMeta.map($=>$.childrenIndex)))}var K_=/^:[\w-]+$/,Q_=3,J_=2,ex=1,tx=10,ix=-2,dy=S=>S==="*";function rx(S,F){let Z=S.split("/"),$=Z.length;return Z.some(dy)&&($+=ix),F&&($+=J_),Z.filter(J=>!dy(J)).reduce((J,ce)=>J+(K_.test(ce)?Q_:ce===""?ex:tx),$)}function nx(S,F){return S.length===F.length&&S.slice(0,-1).every(($,J)=>$===F[J])?S[S.length-1]-F[F.length-1]:0}function ax(S,F,Z=!1){let{routesMeta:$}=S,J={},ce="/",B=[];for(let h=0;h<$.length;++h){let oe=$[h],ge=h===$.length-1,Te=ce==="/"?F:F.slice(ce.length)||"/",Ve=qm({path:oe.relativePath,caseSensitive:oe.caseSensitive,end:ge},Te),Ee=oe.route;if(!Ve&&ge&&Z&&!$[$.length-1].route.index&&(Ve=qm({path:oe.relativePath,caseSensitive:oe.caseSensitive,end:!1},Te)),!Ve)return null;Object.assign(J,Ve.params),B.push({params:J,pathname:hp([ce,Ve.pathname]),pathnameBase:hx(hp([ce,Ve.pathnameBase])),route:Ee}),Ve.pathnameBase!=="/"&&(ce=hp([ce,Ve.pathnameBase]))}return B}function qm(S,F){typeof S=="string"&&(S={path:S,caseSensitive:!1,end:!0});let[Z,$]=sx(S.path,S.caseSensitive,S.end),J=F.match(Z);if(!J)return null;let ce=J[0],B=ce.replace(/(.)\/+$/,"$1"),h=J.slice(1);return{params:$.reduce((ge,{paramName:Te,isOptional:Ve},Ee)=>{if(Te==="*"){let Se=h[Ee]||"";B=ce.slice(0,ce.length-Se.length).replace(/(.)\/+$/,"$1")}const pe=h[Ee];return Ve&&!pe?ge[Te]=void 0:ge[Te]=(pe||"").replace(/%2F/g,"/"),ge},{}),pathname:ce,pathnameBase:B,pattern:S}}function sx(S,F=!1,Z=!0){gd(S==="*"||!S.endsWith("*")||S.endsWith("/*"),`Route path "${S}" will be treated as if it were "${S.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${S.replace(/\*$/,"/*")}".`);let $=[],J="^"+S.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(B,h,oe)=>($.push({paramName:h,isOptional:oe!=null}),oe?"/?([^\\/]+)?":"/([^\\/]+)"));return S.endsWith("*")?($.push({paramName:"*"}),J+=S==="*"||S==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):Z?J+="\\/*$":S!==""&&S!=="/"&&(J+="(?:(?=\\/|$))"),[new RegExp(J,F?void 0:"i"),$]}function ox(S){try{return S.split("/").map(F=>decodeURIComponent(F).replace(/\//g,"%2F")).join("/")}catch(F){return gd(!1,`The URL path "${S}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${F}).`),S}}function fp(S,F){if(F==="/")return S;if(!S.toLowerCase().startsWith(F.toLowerCase()))return null;let Z=F.endsWith("/")?F.length-1:F.length,$=S.charAt(Z);return $&&$!=="/"?null:S.slice(Z)||"/"}function lx(S,F="/"){let{pathname:Z,search:$="",hash:J=""}=typeof S=="string"?sm(S):S;return{pathname:Z?Z.startsWith("/")?Z:cx(Z,F):F,search:dx($),hash:px(J)}}function cx(S,F){let Z=F.replace(/\/+$/,"").split("/");return S.split("/").forEach(J=>{J===".."?Z.length>1&&Z.pop():J!=="."&&Z.push(J)}),Z.length>1?Z.join("/"):"/"}function xg(S,F,Z,$){return`Cannot include a '${S}' character in a manually specified \`to.${F}\` field [${JSON.stringify($)}].  Please separate it out to the \`to.${Z}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ux(S){return S.filter((F,Z)=>Z===0||F.route.path&&F.route.path.length>0)}function qy(S){let F=ux(S);return F.map((Z,$)=>$===F.length-1?Z.pathname:Z.pathnameBase)}function Xy(S,F,Z,$=!1){let J;typeof S=="string"?J=sm(S):(J={...S},xa(!J.pathname||!J.pathname.includes("?"),xg("?","pathname","search",J)),xa(!J.pathname||!J.pathname.includes("#"),xg("#","pathname","hash",J)),xa(!J.search||!J.search.includes("#"),xg("#","search","hash",J)));let ce=S===""||J.pathname==="",B=ce?"/":J.pathname,h;if(B==null)h=Z;else{let Ve=F.length-1;if(!$&&B.startsWith("..")){let Ee=B.split("/");for(;Ee[0]==="..";)Ee.shift(),Ve-=1;J.pathname=Ee.join("/")}h=Ve>=0?F[Ve]:"/"}let oe=lx(J,h),ge=B&&B!=="/"&&B.endsWith("/"),Te=(ce||B===".")&&Z.endsWith("/");return!oe.pathname.endsWith("/")&&(ge||Te)&&(oe.pathname+="/"),oe}var hp=S=>S.join("/").replace(/\/\/+/g,"/"),hx=S=>S.replace(/\/+$/,"").replace(/^\/*/,"/"),dx=S=>!S||S==="?"?"":S.startsWith("?")?S:"?"+S,px=S=>!S||S==="#"?"":S.startsWith("#")?S:"#"+S;function fx(S){return S!=null&&typeof S.status=="number"&&typeof S.statusText=="string"&&typeof S.internal=="boolean"&&"data"in S}var Yy=["POST","PUT","PATCH","DELETE"];new Set(Yy);var mx=["GET",...Yy];new Set(mx);var om=be.createContext(null);om.displayName="DataRouter";var tg=be.createContext(null);tg.displayName="DataRouterState";var Wy=be.createContext({isTransitioning:!1});Wy.displayName="ViewTransition";var gx=be.createContext(new Map);gx.displayName="Fetchers";var yx=be.createContext(null);yx.displayName="Await";var yd=be.createContext(null);yd.displayName="Navigation";var km=be.createContext(null);km.displayName="Location";var gp=be.createContext({outlet:null,matches:[],isDataRoute:!1});gp.displayName="Route";var Fg=be.createContext(null);Fg.displayName="RouteError";function _x(S,{relative:F}={}){xa(Pm(),"useHref() may be used only in the context of a <Router> component.");let{basename:Z,navigator:$}=be.useContext(yd),{hash:J,pathname:ce,search:B}=zm(S,{relative:F}),h=ce;return Z!=="/"&&(h=ce==="/"?Z:hp([Z,ce])),$.createHref({pathname:h,search:B,hash:J})}function Pm(){return be.useContext(km)!=null}function Bf(){return xa(Pm(),"useLocation() may be used only in the context of a <Router> component."),be.useContext(km).location}var Ky="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Qy(S){be.useContext(yd).static||be.useLayoutEffect(S)}function Jy(){let{isDataRoute:S}=be.useContext(gp);return S?zx():xx()}function xx(){xa(Pm(),"useNavigate() may be used only in the context of a <Router> component.");let S=be.useContext(om),{basename:F,navigator:Z}=be.useContext(yd),{matches:$}=be.useContext(gp),{pathname:J}=Bf(),ce=JSON.stringify(qy($)),B=be.useRef(!1);return Qy(()=>{B.current=!0}),be.useCallback((oe,ge={})=>{if(gd(B.current,Ky),!B.current)return;if(typeof oe=="number"){Z.go(oe);return}let Te=Xy(oe,JSON.parse(ce),J,ge.relative==="path");S==null&&F!=="/"&&(Te.pathname=Te.pathname==="/"?F:hp([F,Te.pathname])),(ge.replace?Z.replace:Z.push)(Te,ge.state,ge)},[F,Z,ce,J,S])}be.createContext(null);function zm(S,{relative:F}={}){let{matches:Z}=be.useContext(gp),{pathname:$}=Bf(),J=JSON.stringify(qy(Z));return be.useMemo(()=>Xy(S,JSON.parse(J),$,F==="path"),[S,J,$,F])}function vx(S,F){return e_(S,F)}function e_(S,F,Z,$){var Ie;xa(Pm(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:J}=be.useContext(yd),{matches:ce}=be.useContext(gp),B=ce[ce.length-1],h=B?B.params:{},oe=B?B.pathname:"/",ge=B?B.pathnameBase:"/",Te=B&&B.route;{let Oe=Te&&Te.path||"";t_(oe,!Te||Oe.endsWith("*")||Oe.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${oe}" (under <Route path="${Oe}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Oe}"> to <Route path="${Oe==="/"?"*":`${Oe}/*`}">.`)}let Ve=Bf(),Ee;if(F){let Oe=typeof F=="string"?sm(F):F;xa(ge==="/"||((Ie=Oe.pathname)==null?void 0:Ie.startsWith(ge)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${ge}" but pathname "${Oe.pathname}" was given in the \`location\` prop.`),Ee=Oe}else Ee=Ve;let pe=Ee.pathname||"/",Se=pe;if(ge!=="/"){let Oe=ge.replace(/^\//,"").split("/");Se="/"+pe.replace(/^\//,"").split("/").slice(Oe.length).join("/")}let Ne=$y(S,{pathname:Se});gd(Te||Ne!=null,`No routes matched location "${Ee.pathname}${Ee.search}${Ee.hash}" `),gd(Ne==null||Ne[Ne.length-1].route.element!==void 0||Ne[Ne.length-1].route.Component!==void 0||Ne[Ne.length-1].route.lazy!==void 0,`Matched leaf route at location "${Ee.pathname}${Ee.search}${Ee.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let rt=Mx(Ne&&Ne.map(Oe=>Object.assign({},Oe,{params:Object.assign({},h,Oe.params),pathname:hp([ge,J.encodeLocation?J.encodeLocation(Oe.pathname).pathname:Oe.pathname]),pathnameBase:Oe.pathnameBase==="/"?ge:hp([ge,J.encodeLocation?J.encodeLocation(Oe.pathnameBase).pathname:Oe.pathnameBase])})),ce,Z,$);return F&&rt?be.createElement(km.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...Ee},navigationType:"POP"}},rt):rt}function bx(){let S=Px(),F=fx(S)?`${S.status} ${S.statusText}`:S instanceof Error?S.message:JSON.stringify(S),Z=S instanceof Error?S.stack:null,$="rgba(200,200,200, 0.5)",J={padding:"0.5rem",backgroundColor:$},ce={padding:"2px 4px",backgroundColor:$},B=null;return console.error("Error handled by React Router default ErrorBoundary:",S),B=be.createElement(be.Fragment,null,be.createElement("p",null,"💿 Hey developer 👋"),be.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",be.createElement("code",{style:ce},"ErrorBoundary")," or"," ",be.createElement("code",{style:ce},"errorElement")," prop on your route.")),be.createElement(be.Fragment,null,be.createElement("h2",null,"Unexpected Application Error!"),be.createElement("h3",{style:{fontStyle:"italic"}},F),Z?be.createElement("pre",{style:J},Z):null,B)}var wx=be.createElement(bx,null),Sx=class extends be.Component{constructor(S){super(S),this.state={location:S.location,revalidation:S.revalidation,error:S.error}}static getDerivedStateFromError(S){return{error:S}}static getDerivedStateFromProps(S,F){return F.location!==S.location||F.revalidation!=="idle"&&S.revalidation==="idle"?{error:S.error,location:S.location,revalidation:S.revalidation}:{error:S.error!==void 0?S.error:F.error,location:F.location,revalidation:S.revalidation||F.revalidation}}componentDidCatch(S,F){console.error("React Router caught the following error during render",S,F)}render(){return this.state.error!==void 0?be.createElement(gp.Provider,{value:this.props.routeContext},be.createElement(Fg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Tx({routeContext:S,match:F,children:Z}){let $=be.useContext(om);return $&&$.static&&$.staticContext&&(F.route.errorElement||F.route.ErrorBoundary)&&($.staticContext._deepestRenderedBoundaryId=F.route.id),be.createElement(gp.Provider,{value:S},Z)}function Mx(S,F=[],Z=null,$=null){if(S==null){if(!Z)return null;if(Z.errors)S=Z.matches;else if(F.length===0&&!Z.initialized&&Z.matches.length>0)S=Z.matches;else return null}let J=S,ce=Z==null?void 0:Z.errors;if(ce!=null){let oe=J.findIndex(ge=>ge.route.id&&(ce==null?void 0:ce[ge.route.id])!==void 0);xa(oe>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(ce).join(",")}`),J=J.slice(0,Math.min(J.length,oe+1))}let B=!1,h=-1;if(Z)for(let oe=0;oe<J.length;oe++){let ge=J[oe];if((ge.route.HydrateFallback||ge.route.hydrateFallbackElement)&&(h=oe),ge.route.id){let{loaderData:Te,errors:Ve}=Z,Ee=ge.route.loader&&!Te.hasOwnProperty(ge.route.id)&&(!Ve||Ve[ge.route.id]===void 0);if(ge.route.lazy||Ee){B=!0,h>=0?J=J.slice(0,h+1):J=[J[0]];break}}}return J.reduceRight((oe,ge,Te)=>{let Ve,Ee=!1,pe=null,Se=null;Z&&(Ve=ce&&ge.route.id?ce[ge.route.id]:void 0,pe=ge.route.errorElement||wx,B&&(h<0&&Te===0?(t_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Ee=!0,Se=null):h===Te&&(Ee=!0,Se=ge.route.hydrateFallbackElement||null)));let Ne=F.concat(J.slice(0,Te+1)),rt=()=>{let Ie;return Ve?Ie=pe:Ee?Ie=Se:ge.route.Component?Ie=be.createElement(ge.route.Component,null):ge.route.element?Ie=ge.route.element:Ie=oe,be.createElement(Tx,{match:ge,routeContext:{outlet:oe,matches:Ne,isDataRoute:Z!=null},children:Ie})};return Z&&(ge.route.ErrorBoundary||ge.route.errorElement||Te===0)?be.createElement(Sx,{location:Z.location,revalidation:Z.revalidation,component:pe,error:Ve,children:rt(),routeContext:{outlet:null,matches:Ne,isDataRoute:!0}}):rt()},null)}function Ug(S){return`${S} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Cx(S){let F=be.useContext(om);return xa(F,Ug(S)),F}function Ax(S){let F=be.useContext(tg);return xa(F,Ug(S)),F}function Ex(S){let F=be.useContext(gp);return xa(F,Ug(S)),F}function Vg(S){let F=Ex(S),Z=F.matches[F.matches.length-1];return xa(Z.route.id,`${S} can only be used on routes that contain a unique "id"`),Z.route.id}function kx(){return Vg("useRouteId")}function Px(){var $;let S=be.useContext(Fg),F=Ax("useRouteError"),Z=Vg("useRouteError");return S!==void 0?S:($=F.errors)==null?void 0:$[Z]}function zx(){let{router:S}=Cx("useNavigate"),F=Vg("useNavigate"),Z=be.useRef(!1);return Qy(()=>{Z.current=!0}),be.useCallback(async(J,ce={})=>{gd(Z.current,Ky),Z.current&&(typeof J=="number"?S.navigate(J):await S.navigate(J,{fromRouteId:F,...ce}))},[S,F])}var py={};function t_(S,F,Z){!F&&!py[S]&&(py[S]=!0,gd(!1,Z))}be.memo(Lx);function Lx({routes:S,future:F,state:Z}){return e_(S,void 0,Z,F)}function Rf(S){xa(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Dx({basename:S="/",children:F=null,location:Z,navigationType:$="POP",navigator:J,static:ce=!1}){xa(!Pm(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let B=S.replace(/^\/*/,"/"),h=be.useMemo(()=>({basename:B,navigator:J,static:ce,future:{}}),[B,J,ce]);typeof Z=="string"&&(Z=sm(Z));let{pathname:oe="/",search:ge="",hash:Te="",state:Ve=null,key:Ee="default"}=Z,pe=be.useMemo(()=>{let Se=fp(oe,B);return Se==null?null:{location:{pathname:Se,search:ge,hash:Te,state:Ve,key:Ee},navigationType:$}},[B,oe,ge,Te,Ve,Ee,$]);return gd(pe!=null,`<Router basename="${B}"> is not able to match the URL "${oe}${ge}${Te}" because it does not start with the basename, so the <Router> won't render anything.`),pe==null?null:be.createElement(yd.Provider,{value:h},be.createElement(km.Provider,{children:F,value:pe}))}function Rx({children:S,location:F}){return vx(Lg(S),F)}function Lg(S,F=[]){let Z=[];return be.Children.forEach(S,($,J)=>{if(!be.isValidElement($))return;let ce=[...F,J];if($.type===be.Fragment){Z.push.apply(Z,Lg($.props.children,ce));return}xa($.type===Rf,`[${typeof $.type=="string"?$.type:$.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xa(!$.props.index||!$.props.children,"An index route cannot have child routes.");let B={id:$.props.id||ce.join("-"),caseSensitive:$.props.caseSensitive,element:$.props.element,Component:$.props.Component,index:$.props.index,path:$.props.path,loader:$.props.loader,action:$.props.action,hydrateFallbackElement:$.props.hydrateFallbackElement,HydrateFallback:$.props.HydrateFallback,errorElement:$.props.errorElement,ErrorBoundary:$.props.ErrorBoundary,hasErrorBoundary:$.props.hasErrorBoundary===!0||$.props.ErrorBoundary!=null||$.props.errorElement!=null,shouldRevalidate:$.props.shouldRevalidate,handle:$.props.handle,lazy:$.props.lazy};$.props.children&&(B.children=Lg($.props.children,ce)),Z.push(B)}),Z}var Um="get",Vm="application/x-www-form-urlencoded";function ig(S){return S!=null&&typeof S.tagName=="string"}function Ix(S){return ig(S)&&S.tagName.toLowerCase()==="button"}function Ox(S){return ig(S)&&S.tagName.toLowerCase()==="form"}function jx(S){return ig(S)&&S.tagName.toLowerCase()==="input"}function Bx(S){return!!(S.metaKey||S.altKey||S.ctrlKey||S.shiftKey)}function Nx(S,F){return S.button===0&&(!F||F==="_self")&&!Bx(S)}var Im=null;function Fx(){if(Im===null)try{new FormData(document.createElement("form"),0),Im=!1}catch{Im=!0}return Im}var Ux=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function vg(S){return S!=null&&!Ux.has(S)?(gd(!1,`"${S}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Vm}"`),null):S}function Vx(S,F){let Z,$,J,ce,B;if(Ox(S)){let h=S.getAttribute("action");$=h?fp(h,F):null,Z=S.getAttribute("method")||Um,J=vg(S.getAttribute("enctype"))||Vm,ce=new FormData(S)}else if(Ix(S)||jx(S)&&(S.type==="submit"||S.type==="image")){let h=S.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let oe=S.getAttribute("formaction")||h.getAttribute("action");if($=oe?fp(oe,F):null,Z=S.getAttribute("formmethod")||h.getAttribute("method")||Um,J=vg(S.getAttribute("formenctype"))||vg(h.getAttribute("enctype"))||Vm,ce=new FormData(h,S),!Fx()){let{name:ge,type:Te,value:Ve}=S;if(Te==="image"){let Ee=ge?`${ge}.`:"";ce.append(`${Ee}x`,"0"),ce.append(`${Ee}y`,"0")}else ge&&ce.append(ge,Ve)}}else{if(ig(S))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');Z=Um,$=null,J=Vm,B=S}return ce&&J==="text/plain"&&(B=ce,ce=void 0),{action:$,method:Z.toLowerCase(),encType:J,formData:ce,body:B}}function Gg(S,F){if(S===!1||S===null||typeof S>"u")throw new Error(F)}async function Gx(S,F){if(S.id in F)return F[S.id];try{let Z=await import(S.module);return F[S.id]=Z,Z}catch(Z){return console.error(`Error loading route module \`${S.module}\`, reloading page...`),console.error(Z),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $x(S){return S==null?!1:S.href==null?S.rel==="preload"&&typeof S.imageSrcSet=="string"&&typeof S.imageSizes=="string":typeof S.rel=="string"&&typeof S.href=="string"}async function Hx(S,F,Z){let $=await Promise.all(S.map(async J=>{let ce=F.routes[J.route.id];if(ce){let B=await Gx(ce,Z);return B.links?B.links():[]}return[]}));return Yx($.flat(1).filter($x).filter(J=>J.rel==="stylesheet"||J.rel==="preload").map(J=>J.rel==="stylesheet"?{...J,rel:"prefetch",as:"style"}:{...J,rel:"prefetch"}))}function fy(S,F,Z,$,J,ce){let B=(oe,ge)=>Z[ge]?oe.route.id!==Z[ge].route.id:!0,h=(oe,ge)=>{var Te;return Z[ge].pathname!==oe.pathname||((Te=Z[ge].route.path)==null?void 0:Te.endsWith("*"))&&Z[ge].params["*"]!==oe.params["*"]};return ce==="assets"?F.filter((oe,ge)=>B(oe,ge)||h(oe,ge)):ce==="data"?F.filter((oe,ge)=>{var Ve;let Te=$.routes[oe.route.id];if(!Te||!Te.hasLoader)return!1;if(B(oe,ge)||h(oe,ge))return!0;if(oe.route.shouldRevalidate){let Ee=oe.route.shouldRevalidate({currentUrl:new URL(J.pathname+J.search+J.hash,window.origin),currentParams:((Ve=Z[0])==null?void 0:Ve.params)||{},nextUrl:new URL(S,window.origin),nextParams:oe.params,defaultShouldRevalidate:!0});if(typeof Ee=="boolean")return Ee}return!0}):[]}function Zx(S,F,{includeHydrateFallback:Z}={}){return qx(S.map($=>{let J=F.routes[$.route.id];if(!J)return[];let ce=[J.module];return J.clientActionModule&&(ce=ce.concat(J.clientActionModule)),J.clientLoaderModule&&(ce=ce.concat(J.clientLoaderModule)),Z&&J.hydrateFallbackModule&&(ce=ce.concat(J.hydrateFallbackModule)),J.imports&&(ce=ce.concat(J.imports)),ce}).flat(1))}function qx(S){return[...new Set(S)]}function Xx(S){let F={},Z=Object.keys(S).sort();for(let $ of Z)F[$]=S[$];return F}function Yx(S,F){let Z=new Set;return new Set(F),S.reduce(($,J)=>{let ce=JSON.stringify(Xx(J));return Z.has(ce)||(Z.add(ce),$.push({key:ce,link:J})),$},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Wx=new Set([100,101,204,205]);function Kx(S,F){let Z=typeof S=="string"?new URL(S,typeof window>"u"?"server://singlefetch/":window.location.origin):S;return Z.pathname==="/"?Z.pathname="_root.data":F&&fp(Z.pathname,F)==="/"?Z.pathname=`${F.replace(/\/$/,"")}/_root.data`:Z.pathname=`${Z.pathname.replace(/\/$/,"")}.data`,Z}function i_(){let S=be.useContext(om);return Gg(S,"You must render this element inside a <DataRouterContext.Provider> element"),S}function Qx(){let S=be.useContext(tg);return Gg(S,"You must render this element inside a <DataRouterStateContext.Provider> element"),S}var $g=be.createContext(void 0);$g.displayName="FrameworkContext";function r_(){let S=be.useContext($g);return Gg(S,"You must render this element inside a <HydratedRouter> element"),S}function Jx(S,F){let Z=be.useContext($g),[$,J]=be.useState(!1),[ce,B]=be.useState(!1),{onFocus:h,onBlur:oe,onMouseEnter:ge,onMouseLeave:Te,onTouchStart:Ve}=F,Ee=be.useRef(null);be.useEffect(()=>{if(S==="render"&&B(!0),S==="viewport"){let Ne=Ie=>{Ie.forEach(Oe=>{B(Oe.isIntersecting)})},rt=new IntersectionObserver(Ne,{threshold:.5});return Ee.current&&rt.observe(Ee.current),()=>{rt.disconnect()}}},[S]),be.useEffect(()=>{if($){let Ne=setTimeout(()=>{B(!0)},100);return()=>{clearTimeout(Ne)}}},[$]);let pe=()=>{J(!0)},Se=()=>{J(!1),B(!1)};return Z?S!=="intent"?[ce,Ee,{}]:[ce,Ee,{onFocus:vm(h,pe),onBlur:vm(oe,Se),onMouseEnter:vm(ge,pe),onMouseLeave:vm(Te,Se),onTouchStart:vm(Ve,pe)}]:[!1,Ee,{}]}function vm(S,F){return Z=>{S&&S(Z),Z.defaultPrevented||F(Z)}}function e0({page:S,...F}){let{router:Z}=i_(),$=be.useMemo(()=>$y(Z.routes,S,Z.basename),[Z.routes,S,Z.basename]);return $?be.createElement(i0,{page:S,matches:$,...F}):null}function t0(S){let{manifest:F,routeModules:Z}=r_(),[$,J]=be.useState([]);return be.useEffect(()=>{let ce=!1;return Hx(S,F,Z).then(B=>{ce||J(B)}),()=>{ce=!0}},[S,F,Z]),$}function i0({page:S,matches:F,...Z}){let $=Bf(),{manifest:J,routeModules:ce}=r_(),{basename:B}=i_(),{loaderData:h,matches:oe}=Qx(),ge=be.useMemo(()=>fy(S,F,oe,J,$,"data"),[S,F,oe,J,$]),Te=be.useMemo(()=>fy(S,F,oe,J,$,"assets"),[S,F,oe,J,$]),Ve=be.useMemo(()=>{if(S===$.pathname+$.search+$.hash)return[];let Se=new Set,Ne=!1;if(F.forEach(Ie=>{var We;let Oe=J.routes[Ie.route.id];!Oe||!Oe.hasLoader||(!ge.some(ct=>ct.route.id===Ie.route.id)&&Ie.route.id in h&&((We=ce[Ie.route.id])!=null&&We.shouldRevalidate)||Oe.hasClientLoader?Ne=!0:Se.add(Ie.route.id))}),Se.size===0)return[];let rt=Kx(S,B);return Ne&&Se.size>0&&rt.searchParams.set("_routes",F.filter(Ie=>Se.has(Ie.route.id)).map(Ie=>Ie.route.id).join(",")),[rt.pathname+rt.search]},[B,h,$,J,ge,F,S,ce]),Ee=be.useMemo(()=>Zx(Te,J),[Te,J]),pe=t0(Te);return be.createElement(be.Fragment,null,Ve.map(Se=>be.createElement("link",{key:Se,rel:"prefetch",as:"fetch",href:Se,...Z})),Ee.map(Se=>be.createElement("link",{key:Se,rel:"modulepreload",href:Se,...Z})),pe.map(({key:Se,link:Ne})=>be.createElement("link",{key:Se,...Ne})))}function r0(...S){return F=>{S.forEach(Z=>{typeof Z=="function"?Z(F):Z!=null&&(Z.current=F)})}}var n_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{n_&&(window.__reactRouterVersion="7.6.1")}catch{}function n0({basename:S,children:F,window:Z}){let $=be.useRef();$.current==null&&($.current=H_({window:Z,v5Compat:!0}));let J=$.current,[ce,B]=be.useState({action:J.action,location:J.location}),h=be.useCallback(oe=>{be.startTransition(()=>B(oe))},[B]);return be.useLayoutEffect(()=>J.listen(h),[J,h]),be.createElement(Dx,{basename:S,children:F,location:ce.location,navigationType:ce.action,navigator:J})}var a_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dp=be.forwardRef(function({onClick:F,discover:Z="render",prefetch:$="none",relative:J,reloadDocument:ce,replace:B,state:h,target:oe,to:ge,preventScrollReset:Te,viewTransition:Ve,...Ee},pe){let{basename:Se}=be.useContext(yd),Ne=typeof ge=="string"&&a_.test(ge),rt,Ie=!1;if(typeof ge=="string"&&Ne&&(rt=ge,n_))try{let zt=new URL(window.location.href),_t=ge.startsWith("//")?new URL(zt.protocol+ge):new URL(ge),Dt=fp(_t.pathname,Se);_t.origin===zt.origin&&Dt!=null?ge=Dt+_t.search+_t.hash:Ie=!0}catch{gd(!1,`<Link to="${ge}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Oe=_x(ge,{relative:J}),[We,ct,Ke]=Jx($,Ee),pt=l0(ge,{replace:B,state:h,target:oe,preventScrollReset:Te,relative:J,viewTransition:Ve});function Pt(zt){F&&F(zt),zt.defaultPrevented||pt(zt)}let Ue=be.createElement("a",{...Ee,...Ke,href:rt||Oe,onClick:Ie||ce?F:Pt,ref:r0(pe,ct),target:oe,"data-discover":!Ne&&Z==="render"?"true":void 0});return We&&!Ne?be.createElement(be.Fragment,null,Ue,be.createElement(e0,{page:Oe})):Ue});dp.displayName="Link";var a0=be.forwardRef(function({"aria-current":F="page",caseSensitive:Z=!1,className:$="",end:J=!1,style:ce,to:B,viewTransition:h,children:oe,...ge},Te){let Ve=zm(B,{relative:ge.relative}),Ee=Bf(),pe=be.useContext(tg),{navigator:Se,basename:Ne}=be.useContext(yd),rt=pe!=null&&p0(Ve)&&h===!0,Ie=Se.encodeLocation?Se.encodeLocation(Ve).pathname:Ve.pathname,Oe=Ee.pathname,We=pe&&pe.navigation&&pe.navigation.location?pe.navigation.location.pathname:null;Z||(Oe=Oe.toLowerCase(),We=We?We.toLowerCase():null,Ie=Ie.toLowerCase()),We&&Ne&&(We=fp(We,Ne)||We);const ct=Ie!=="/"&&Ie.endsWith("/")?Ie.length-1:Ie.length;let Ke=Oe===Ie||!J&&Oe.startsWith(Ie)&&Oe.charAt(ct)==="/",pt=We!=null&&(We===Ie||!J&&We.startsWith(Ie)&&We.charAt(Ie.length)==="/"),Pt={isActive:Ke,isPending:pt,isTransitioning:rt},Ue=Ke?F:void 0,zt;typeof $=="function"?zt=$(Pt):zt=[$,Ke?"active":null,pt?"pending":null,rt?"transitioning":null].filter(Boolean).join(" ");let _t=typeof ce=="function"?ce(Pt):ce;return be.createElement(dp,{...ge,"aria-current":Ue,className:zt,ref:Te,style:_t,to:B,viewTransition:h},typeof oe=="function"?oe(Pt):oe)});a0.displayName="NavLink";var s0=be.forwardRef(({discover:S="render",fetcherKey:F,navigate:Z,reloadDocument:$,replace:J,state:ce,method:B=Um,action:h,onSubmit:oe,relative:ge,preventScrollReset:Te,viewTransition:Ve,...Ee},pe)=>{let Se=h0(),Ne=d0(h,{relative:ge}),rt=B.toLowerCase()==="get"?"get":"post",Ie=typeof h=="string"&&a_.test(h),Oe=We=>{if(oe&&oe(We),We.defaultPrevented)return;We.preventDefault();let ct=We.nativeEvent.submitter,Ke=(ct==null?void 0:ct.getAttribute("formmethod"))||B;Se(ct||We.currentTarget,{fetcherKey:F,method:Ke,navigate:Z,replace:J,state:ce,relative:ge,preventScrollReset:Te,viewTransition:Ve})};return be.createElement("form",{ref:pe,method:rt,action:Ne,onSubmit:$?oe:Oe,...Ee,"data-discover":!Ie&&S==="render"?"true":void 0})});s0.displayName="Form";function o0(S){return`${S} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function s_(S){let F=be.useContext(om);return xa(F,o0(S)),F}function l0(S,{target:F,replace:Z,state:$,preventScrollReset:J,relative:ce,viewTransition:B}={}){let h=Jy(),oe=Bf(),ge=zm(S,{relative:ce});return be.useCallback(Te=>{if(Nx(Te,F)){Te.preventDefault();let Ve=Z!==void 0?Z:Tm(oe)===Tm(ge);h(S,{replace:Ve,state:$,preventScrollReset:J,relative:ce,viewTransition:B})}},[oe,h,ge,Z,$,F,S,J,ce,B])}var c0=0,u0=()=>`__${String(++c0)}__`;function h0(){let{router:S}=s_("useSubmit"),{basename:F}=be.useContext(yd),Z=kx();return be.useCallback(async($,J={})=>{let{action:ce,method:B,encType:h,formData:oe,body:ge}=Vx($,F);if(J.navigate===!1){let Te=J.fetcherKey||u0();await S.fetch(Te,Z,J.action||ce,{preventScrollReset:J.preventScrollReset,formData:oe,body:ge,formMethod:J.method||B,formEncType:J.encType||h,flushSync:J.flushSync})}else await S.navigate(J.action||ce,{preventScrollReset:J.preventScrollReset,formData:oe,body:ge,formMethod:J.method||B,formEncType:J.encType||h,replace:J.replace,state:J.state,fromRouteId:Z,flushSync:J.flushSync,viewTransition:J.viewTransition})},[S,F,Z])}function d0(S,{relative:F}={}){let{basename:Z}=be.useContext(yd),$=be.useContext(gp);xa($,"useFormAction must be used inside a RouteContext");let[J]=$.matches.slice(-1),ce={...zm(S||".",{relative:F})},B=Bf();if(S==null){ce.search=B.search;let h=new URLSearchParams(ce.search),oe=h.getAll("index");if(oe.some(Te=>Te==="")){h.delete("index"),oe.filter(Ve=>Ve).forEach(Ve=>h.append("index",Ve));let Te=h.toString();ce.search=Te?`?${Te}`:""}}return(!S||S===".")&&J.route.index&&(ce.search=ce.search?ce.search.replace(/^\?/,"?index&"):"?index"),Z!=="/"&&(ce.pathname=ce.pathname==="/"?Z:hp([Z,ce.pathname])),Tm(ce)}function p0(S,F={}){let Z=be.useContext(Wy);xa(Z!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:$}=s_("useViewTransitionState"),J=zm(S,{relative:F.relative});if(!Z.isTransitioning)return!1;let ce=fp(Z.currentLocation.pathname,$)||Z.currentLocation.pathname,B=fp(Z.nextLocation.pathname,$)||Z.nextLocation.pathname;return qm(J.pathname,B)!=null||qm(J.pathname,ce)!=null}[...Wx];const f0="_gamedashboard_1vefn_3",m0="_backgroundimage_1vefn_10",g0="_dashboardcontent_1vefn_19",y0="_dashboardgrid_1vefn_26",Om={gamedashboard:f0,backgroundimage:m0,dashboardcontent:g0,dashboardgrid:y0};var bg={exports:{}},wg={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var my;function _0(){if(my)return wg;my=1;var S=Em();function F(oe,ge){return oe===ge&&(oe!==0||1/oe===1/ge)||oe!==oe&&ge!==ge}var Z=typeof Object.is=="function"?Object.is:F,$=S.useSyncExternalStore,J=S.useRef,ce=S.useEffect,B=S.useMemo,h=S.useDebugValue;return wg.useSyncExternalStoreWithSelector=function(oe,ge,Te,Ve,Ee){var pe=J(null);if(pe.current===null){var Se={hasValue:!1,value:null};pe.current=Se}else Se=pe.current;pe=B(function(){function rt(Ke){if(!Ie){if(Ie=!0,Oe=Ke,Ke=Ve(Ke),Ee!==void 0&&Se.hasValue){var pt=Se.value;if(Ee(pt,Ke))return We=pt}return We=Ke}if(pt=We,Z(Oe,Ke))return pt;var Pt=Ve(Ke);return Ee!==void 0&&Ee(pt,Pt)?(Oe=Ke,pt):(Oe=Ke,We=Pt)}var Ie=!1,Oe,We,ct=Te===void 0?null:Te;return[function(){return rt(ge())},ct===null?void 0:function(){return rt(ct())}]},[ge,Te,Ve,Ee]);var Ne=$(oe,pe[0],pe[1]);return ce(function(){Se.hasValue=!0,Se.value=Ne},[Ne]),h(Ne),Ne},wg}var gy;function x0(){return gy||(gy=1,bg.exports=_0()),bg.exports}var v0=x0();function b0(S){S()}function w0(){let S=null,F=null;return{clear(){S=null,F=null},notify(){b0(()=>{let Z=S;for(;Z;)Z.callback(),Z=Z.next})},get(){const Z=[];let $=S;for(;$;)Z.push($),$=$.next;return Z},subscribe(Z){let $=!0;const J=F={callback:Z,next:null,prev:F};return J.prev?J.prev.next=J:S=J,function(){!$||S===null||($=!1,J.next?J.next.prev=J.prev:F=J.prev,J.prev?J.prev.next=J.next:S=J.next)}}}}var yy={notify(){},get:()=>[]};function S0(S,F){let Z,$=yy,J=0,ce=!1;function B(Ne){Te();const rt=$.subscribe(Ne);let Ie=!1;return()=>{Ie||(Ie=!0,rt(),Ve())}}function h(){$.notify()}function oe(){Se.onStateChange&&Se.onStateChange()}function ge(){return ce}function Te(){J++,Z||(Z=S.subscribe(oe),$=w0())}function Ve(){J--,Z&&J===0&&(Z(),Z=void 0,$.clear(),$=yy)}function Ee(){ce||(ce=!0,Te())}function pe(){ce&&(ce=!1,Ve())}const Se={addNestedSub:B,notifyNestedSubs:h,handleChangeWrapper:oe,isSubscribed:ge,trySubscribe:Ee,tryUnsubscribe:pe,getListeners:()=>$};return Se}var T0=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",M0=T0(),C0=()=>typeof navigator<"u"&&navigator.product==="ReactNative",A0=C0(),E0=()=>M0||A0?be.useLayoutEffect:be.useEffect,k0=E0(),Sg=Symbol.for("react-redux-context"),Tg=typeof globalThis<"u"?globalThis:{};function P0(){if(!be.createContext)return{};const S=Tg[Sg]??(Tg[Sg]=new Map);let F=S.get(be.createContext);return F||(F=be.createContext(null),S.set(be.createContext,F)),F}var Qp=P0();function z0(S){const{children:F,context:Z,serverState:$,store:J}=S,ce=be.useMemo(()=>{const oe=S0(J);return{store:J,subscription:oe,getServerState:$?()=>$:void 0}},[J,$]),B=be.useMemo(()=>J.getState(),[J]);k0(()=>{const{subscription:oe}=ce;return oe.onStateChange=oe.notifyNestedSubs,oe.trySubscribe(),B!==J.getState()&&oe.notifyNestedSubs(),()=>{oe.tryUnsubscribe(),oe.onStateChange=void 0}},[ce,B]);const h=Z||Qp;return be.createElement(h.Provider,{value:ce},F)}var lm=z0;function Hg(S=Qp){return function(){return be.useContext(S)}}var o_=Hg();function l_(S=Qp){const F=S===Qp?o_:Hg(S),Z=()=>{const{store:$}=F();return $};return Object.assign(Z,{withTypes:()=>Z}),Z}var L0=l_();function D0(S=Qp){const F=S===Qp?L0:l_(S),Z=()=>F().dispatch;return Object.assign(Z,{withTypes:()=>Z}),Z}var na=D0(),R0=(S,F)=>S===F;function I0(S=Qp){const F=S===Qp?o_:Hg(S),Z=($,J={})=>{const{equalityFn:ce=R0}=typeof J=="function"?{equalityFn:J}:J,B=F(),{store:h,subscription:oe,getServerState:ge}=B;be.useRef(!0);const Te=be.useCallback({[$.name](Ee){return $(Ee)}}[$.name],[$]),Ve=v0.useSyncExternalStoreWithSelector(oe.addNestedSub,h.getState,ge||h.getState,Te,ce);return be.useDebugValue(Ve),Ve};return Object.assign(Z,{withTypes:()=>Z}),Z}var vi=I0();function Co(S){return`Minified Redux error #${S}; visit https://redux.js.org/Errors?code=${S} for the full message or use the non-minified dev environment for full errors. `}var O0=typeof Symbol=="function"&&Symbol.observable||"@@observable",_y=O0,Mg=()=>Math.random().toString(36).substring(7).split("").join("."),j0={INIT:`@@redux/INIT${Mg()}`,REPLACE:`@@redux/REPLACE${Mg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Mg()}`},Xm=j0;function Zg(S){if(typeof S!="object"||S===null)return!1;let F=S;for(;Object.getPrototypeOf(F)!==null;)F=Object.getPrototypeOf(F);return Object.getPrototypeOf(S)===F||Object.getPrototypeOf(S)===null}function c_(S,F,Z){if(typeof S!="function")throw new Error(Co(2));if(typeof F=="function"&&typeof Z=="function"||typeof Z=="function"&&typeof arguments[3]=="function")throw new Error(Co(0));if(typeof F=="function"&&typeof Z>"u"&&(Z=F,F=void 0),typeof Z<"u"){if(typeof Z!="function")throw new Error(Co(1));return Z(c_)(S,F)}let $=S,J=F,ce=new Map,B=ce,h=0,oe=!1;function ge(){B===ce&&(B=new Map,ce.forEach((rt,Ie)=>{B.set(Ie,rt)}))}function Te(){if(oe)throw new Error(Co(3));return J}function Ve(rt){if(typeof rt!="function")throw new Error(Co(4));if(oe)throw new Error(Co(5));let Ie=!0;ge();const Oe=h++;return B.set(Oe,rt),function(){if(Ie){if(oe)throw new Error(Co(6));Ie=!1,ge(),B.delete(Oe),ce=null}}}function Ee(rt){if(!Zg(rt))throw new Error(Co(7));if(typeof rt.type>"u")throw new Error(Co(8));if(typeof rt.type!="string")throw new Error(Co(17));if(oe)throw new Error(Co(9));try{oe=!0,J=$(J,rt)}finally{oe=!1}return(ce=B).forEach(Oe=>{Oe()}),rt}function pe(rt){if(typeof rt!="function")throw new Error(Co(10));$=rt,Ee({type:Xm.REPLACE})}function Se(){const rt=Ve;return{subscribe(Ie){if(typeof Ie!="object"||Ie===null)throw new Error(Co(11));function Oe(){const ct=Ie;ct.next&&ct.next(Te())}return Oe(),{unsubscribe:rt(Oe)}},[_y](){return this}}}return Ee({type:Xm.INIT}),{dispatch:Ee,subscribe:Ve,getState:Te,replaceReducer:pe,[_y]:Se}}function B0(S){Object.keys(S).forEach(F=>{const Z=S[F];if(typeof Z(void 0,{type:Xm.INIT})>"u")throw new Error(Co(12));if(typeof Z(void 0,{type:Xm.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Co(13))})}function N0(S){const F=Object.keys(S),Z={};for(let ce=0;ce<F.length;ce++){const B=F[ce];typeof S[B]=="function"&&(Z[B]=S[B])}const $=Object.keys(Z);let J;try{B0(Z)}catch(ce){J=ce}return function(B={},h){if(J)throw J;let oe=!1;const ge={};for(let Te=0;Te<$.length;Te++){const Ve=$[Te],Ee=Z[Ve],pe=B[Ve],Se=Ee(pe,h);if(typeof Se>"u")throw h&&h.type,new Error(Co(14));ge[Ve]=Se,oe=oe||Se!==pe}return oe=oe||$.length!==Object.keys(B).length,oe?ge:B}}function Ym(...S){return S.length===0?F=>F:S.length===1?S[0]:S.reduce((F,Z)=>(...$)=>F(Z(...$)))}function F0(...S){return F=>(Z,$)=>{const J=F(Z,$);let ce=()=>{throw new Error(Co(15))};const B={getState:J.getState,dispatch:(oe,...ge)=>ce(oe,...ge)},h=S.map(oe=>oe(B));return ce=Ym(...h)(J.dispatch),{...J,dispatch:ce}}}function U0(S){return Zg(S)&&"type"in S&&typeof S.type=="string"}var u_=Symbol.for("immer-nothing"),xy=Symbol.for("immer-draftable"),Wc=Symbol.for("immer-state");function Th(S,...F){throw new Error(`[Immer] minified error nr: ${S}. Full error at: https://bit.ly/3cXEKWf`)}var am=Object.getPrototypeOf;function Of(S){return!!S&&!!S[Wc]}function mp(S){var F;return S?h_(S)||Array.isArray(S)||!!S[xy]||!!((F=S.constructor)!=null&&F[xy])||ng(S)||ag(S):!1}var V0=Object.prototype.constructor.toString();function h_(S){if(!S||typeof S!="object")return!1;const F=am(S);if(F===null)return!0;const Z=Object.hasOwnProperty.call(F,"constructor")&&F.constructor;return Z===Object?!0:typeof Z=="function"&&Function.toString.call(Z)===V0}function Wm(S,F){rg(S)===0?Reflect.ownKeys(S).forEach(Z=>{F(Z,S[Z],S)}):S.forEach((Z,$)=>F($,Z,S))}function rg(S){const F=S[Wc];return F?F.type_:Array.isArray(S)?1:ng(S)?2:ag(S)?3:0}function Dg(S,F){return rg(S)===2?S.has(F):Object.prototype.hasOwnProperty.call(S,F)}function d_(S,F,Z){const $=rg(S);$===2?S.set(F,Z):$===3?S.add(Z):S[F]=Z}function G0(S,F){return S===F?S!==0||1/S===1/F:S!==S&&F!==F}function ng(S){return S instanceof Map}function ag(S){return S instanceof Set}function If(S){return S.copy_||S.base_}function Rg(S,F){if(ng(S))return new Map(S);if(ag(S))return new Set(S);if(Array.isArray(S))return Array.prototype.slice.call(S);const Z=h_(S);if(F===!0||F==="class_only"&&!Z){const $=Object.getOwnPropertyDescriptors(S);delete $[Wc];let J=Reflect.ownKeys($);for(let ce=0;ce<J.length;ce++){const B=J[ce],h=$[B];h.writable===!1&&(h.writable=!0,h.configurable=!0),(h.get||h.set)&&($[B]={configurable:!0,writable:!0,enumerable:h.enumerable,value:S[B]})}return Object.create(am(S),$)}else{const $=am(S);if($!==null&&Z)return{...S};const J=Object.create($);return Object.assign(J,S)}}function qg(S,F=!1){return sg(S)||Of(S)||!mp(S)||(rg(S)>1&&(S.set=S.add=S.clear=S.delete=$0),Object.freeze(S),F&&Object.entries(S).forEach(([Z,$])=>qg($,!0))),S}function $0(){Th(2)}function sg(S){return Object.isFrozen(S)}var H0={};function jf(S){const F=H0[S];return F||Th(0,S),F}var Mm;function p_(){return Mm}function Z0(S,F){return{drafts_:[],parent_:S,immer_:F,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function vy(S,F){F&&(jf("Patches"),S.patches_=[],S.inversePatches_=[],S.patchListener_=F)}function Ig(S){Og(S),S.drafts_.forEach(q0),S.drafts_=null}function Og(S){S===Mm&&(Mm=S.parent_)}function by(S){return Mm=Z0(Mm,S)}function q0(S){const F=S[Wc];F.type_===0||F.type_===1?F.revoke_():F.revoked_=!0}function wy(S,F){F.unfinalizedDrafts_=F.drafts_.length;const Z=F.drafts_[0];return S!==void 0&&S!==Z?(Z[Wc].modified_&&(Ig(F),Th(4)),mp(S)&&(S=Km(F,S),F.parent_||Qm(F,S)),F.patches_&&jf("Patches").generateReplacementPatches_(Z[Wc].base_,S,F.patches_,F.inversePatches_)):S=Km(F,Z,[]),Ig(F),F.patches_&&F.patchListener_(F.patches_,F.inversePatches_),S!==u_?S:void 0}function Km(S,F,Z){if(sg(F))return F;const $=F[Wc];if(!$)return Wm(F,(J,ce)=>Sy(S,$,F,J,ce,Z)),F;if($.scope_!==S)return F;if(!$.modified_)return Qm(S,$.base_,!0),$.base_;if(!$.finalized_){$.finalized_=!0,$.scope_.unfinalizedDrafts_--;const J=$.copy_;let ce=J,B=!1;$.type_===3&&(ce=new Set(J),J.clear(),B=!0),Wm(ce,(h,oe)=>Sy(S,$,J,h,oe,Z,B)),Qm(S,J,!1),Z&&S.patches_&&jf("Patches").generatePatches_($,Z,S.patches_,S.inversePatches_)}return $.copy_}function Sy(S,F,Z,$,J,ce,B){if(Of(J)){const h=ce&&F&&F.type_!==3&&!Dg(F.assigned_,$)?ce.concat($):void 0,oe=Km(S,J,h);if(d_(Z,$,oe),Of(oe))S.canAutoFreeze_=!1;else return}else B&&Z.add(J);if(mp(J)&&!sg(J)){if(!S.immer_.autoFreeze_&&S.unfinalizedDrafts_<1)return;Km(S,J),(!F||!F.scope_.parent_)&&typeof $!="symbol"&&Object.prototype.propertyIsEnumerable.call(Z,$)&&Qm(S,J)}}function Qm(S,F,Z=!1){!S.parent_&&S.immer_.autoFreeze_&&S.canAutoFreeze_&&qg(F,Z)}function X0(S,F){const Z=Array.isArray(S),$={type_:Z?1:0,scope_:F?F.scope_:p_(),modified_:!1,finalized_:!1,assigned_:{},parent_:F,base_:S,draft_:null,copy_:null,revoke_:null,isManual_:!1};let J=$,ce=Xg;Z&&(J=[$],ce=Cm);const{revoke:B,proxy:h}=Proxy.revocable(J,ce);return $.draft_=h,$.revoke_=B,h}var Xg={get(S,F){if(F===Wc)return S;const Z=If(S);if(!Dg(Z,F))return Y0(S,Z,F);const $=Z[F];return S.finalized_||!mp($)?$:$===Cg(S.base_,F)?(Ag(S),S.copy_[F]=Bg($,S)):$},has(S,F){return F in If(S)},ownKeys(S){return Reflect.ownKeys(If(S))},set(S,F,Z){const $=f_(If(S),F);if($!=null&&$.set)return $.set.call(S.draft_,Z),!0;if(!S.modified_){const J=Cg(If(S),F),ce=J==null?void 0:J[Wc];if(ce&&ce.base_===Z)return S.copy_[F]=Z,S.assigned_[F]=!1,!0;if(G0(Z,J)&&(Z!==void 0||Dg(S.base_,F)))return!0;Ag(S),jg(S)}return S.copy_[F]===Z&&(Z!==void 0||F in S.copy_)||Number.isNaN(Z)&&Number.isNaN(S.copy_[F])||(S.copy_[F]=Z,S.assigned_[F]=!0),!0},deleteProperty(S,F){return Cg(S.base_,F)!==void 0||F in S.base_?(S.assigned_[F]=!1,Ag(S),jg(S)):delete S.assigned_[F],S.copy_&&delete S.copy_[F],!0},getOwnPropertyDescriptor(S,F){const Z=If(S),$=Reflect.getOwnPropertyDescriptor(Z,F);return $&&{writable:!0,configurable:S.type_!==1||F!=="length",enumerable:$.enumerable,value:Z[F]}},defineProperty(){Th(11)},getPrototypeOf(S){return am(S.base_)},setPrototypeOf(){Th(12)}},Cm={};Wm(Xg,(S,F)=>{Cm[S]=function(){return arguments[0]=arguments[0][0],F.apply(this,arguments)}});Cm.deleteProperty=function(S,F){return Cm.set.call(this,S,F,void 0)};Cm.set=function(S,F,Z){return Xg.set.call(this,S[0],F,Z,S[0])};function Cg(S,F){const Z=S[Wc];return(Z?If(Z):S)[F]}function Y0(S,F,Z){var J;const $=f_(F,Z);return $?"value"in $?$.value:(J=$.get)==null?void 0:J.call(S.draft_):void 0}function f_(S,F){if(!(F in S))return;let Z=am(S);for(;Z;){const $=Object.getOwnPropertyDescriptor(Z,F);if($)return $;Z=am(Z)}}function jg(S){S.modified_||(S.modified_=!0,S.parent_&&jg(S.parent_))}function Ag(S){S.copy_||(S.copy_=Rg(S.base_,S.scope_.immer_.useStrictShallowCopy_))}var W0=class{constructor(S){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(F,Z,$)=>{if(typeof F=="function"&&typeof Z!="function"){const ce=Z;Z=F;const B=this;return function(oe=ce,...ge){return B.produce(oe,Te=>Z.call(this,Te,...ge))}}typeof Z!="function"&&Th(6),$!==void 0&&typeof $!="function"&&Th(7);let J;if(mp(F)){const ce=by(this),B=Bg(F,void 0);let h=!0;try{J=Z(B),h=!1}finally{h?Ig(ce):Og(ce)}return vy(ce,$),wy(J,ce)}else if(!F||typeof F!="object"){if(J=Z(F),J===void 0&&(J=F),J===u_&&(J=void 0),this.autoFreeze_&&qg(J,!0),$){const ce=[],B=[];jf("Patches").generateReplacementPatches_(F,J,ce,B),$(ce,B)}return J}else Th(1,F)},this.produceWithPatches=(F,Z)=>{if(typeof F=="function")return(B,...h)=>this.produceWithPatches(B,oe=>F(oe,...h));let $,J;return[this.produce(F,Z,(B,h)=>{$=B,J=h}),$,J]},typeof(S==null?void 0:S.autoFreeze)=="boolean"&&this.setAutoFreeze(S.autoFreeze),typeof(S==null?void 0:S.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(S.useStrictShallowCopy)}createDraft(S){mp(S)||Th(8),Of(S)&&(S=K0(S));const F=by(this),Z=Bg(S,void 0);return Z[Wc].isManual_=!0,Og(F),Z}finishDraft(S,F){const Z=S&&S[Wc];(!Z||!Z.isManual_)&&Th(9);const{scope_:$}=Z;return vy($,F),wy(void 0,$)}setAutoFreeze(S){this.autoFreeze_=S}setUseStrictShallowCopy(S){this.useStrictShallowCopy_=S}applyPatches(S,F){let Z;for(Z=F.length-1;Z>=0;Z--){const J=F[Z];if(J.path.length===0&&J.op==="replace"){S=J.value;break}}Z>-1&&(F=F.slice(Z+1));const $=jf("Patches").applyPatches_;return Of(S)?$(S,F):this.produce(S,J=>$(J,F))}};function Bg(S,F){const Z=ng(S)?jf("MapSet").proxyMap_(S,F):ag(S)?jf("MapSet").proxySet_(S,F):X0(S,F);return(F?F.scope_:p_()).drafts_.push(Z),Z}function K0(S){return Of(S)||Th(10,S),m_(S)}function m_(S){if(!mp(S)||sg(S))return S;const F=S[Wc];let Z;if(F){if(!F.modified_)return F.base_;F.finalized_=!0,Z=Rg(S,F.scope_.immer_.useStrictShallowCopy_)}else Z=Rg(S,!0);return Wm(Z,($,J)=>{d_(Z,$,m_(J))}),F&&(F.finalized_=!1),Z}var Kc=new W0,g_=Kc.produce;Kc.produceWithPatches.bind(Kc);Kc.setAutoFreeze.bind(Kc);Kc.setUseStrictShallowCopy.bind(Kc);Kc.applyPatches.bind(Kc);Kc.createDraft.bind(Kc);Kc.finishDraft.bind(Kc);function y_(S){return({dispatch:Z,getState:$})=>J=>ce=>typeof ce=="function"?ce(Z,$,S):J(ce)}var Q0=y_(),J0=y_,ev=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Ym:Ym.apply(null,arguments)};function Ty(S,F){function Z(...$){if(F){let J=F(...$);if(!J)throw new Error(pp(0));return{type:S,payload:J.payload,..."meta"in J&&{meta:J.meta},..."error"in J&&{error:J.error}}}return{type:S,payload:$[0]}}return Z.toString=()=>`${S}`,Z.type=S,Z.match=$=>U0($)&&$.type===S,Z}var __=class Sm extends Array{constructor(...F){super(...F),Object.setPrototypeOf(this,Sm.prototype)}static get[Symbol.species](){return Sm}concat(...F){return super.concat.apply(this,F)}prepend(...F){return F.length===1&&Array.isArray(F[0])?new Sm(...F[0].concat(this)):new Sm(...F.concat(this))}};function My(S){return mp(S)?g_(S,()=>{}):S}function jm(S,F,Z){return S.has(F)?S.get(F):S.set(F,Z(F)).get(F)}function tv(S){return typeof S=="boolean"}var iv=()=>function(F){const{thunk:Z=!0,immutableCheck:$=!0,serializableCheck:J=!0,actionCreatorCheck:ce=!0}=F??{};let B=new __;return Z&&(tv(Z)?B.push(Q0):B.push(J0(Z.extraArgument))),B},rv="RTK_autoBatch",Cy=S=>F=>{setTimeout(F,S)},nv=(S={type:"raf"})=>F=>(...Z)=>{const $=F(...Z);let J=!0,ce=!1,B=!1;const h=new Set,oe=S.type==="tick"?queueMicrotask:S.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Cy(10):S.type==="callback"?S.queueNotification:Cy(S.timeout),ge=()=>{B=!1,ce&&(ce=!1,h.forEach(Te=>Te()))};return Object.assign({},$,{subscribe(Te){const Ve=()=>J&&Te(),Ee=$.subscribe(Ve);return h.add(Te),()=>{Ee(),h.delete(Te)}},dispatch(Te){var Ve;try{return J=!((Ve=Te==null?void 0:Te.meta)!=null&&Ve[rv]),ce=!J,ce&&(B||(B=!0,oe(ge))),$.dispatch(Te)}finally{J=!0}}})},av=S=>function(Z){const{autoBatch:$=!0}=Z??{};let J=new __(S);return $&&J.push(nv(typeof $=="object"?$:void 0)),J};function sv(S){const F=iv(),{reducer:Z=void 0,middleware:$,devTools:J=!0,preloadedState:ce=void 0,enhancers:B=void 0}=S||{};let h;if(typeof Z=="function")h=Z;else if(Zg(Z))h=N0(Z);else throw new Error(pp(1));let oe;typeof $=="function"?oe=$(F):oe=F();let ge=Ym;J&&(ge=ev({trace:!1,...typeof J=="object"&&J}));const Te=F0(...oe),Ve=av(Te);let Ee=typeof B=="function"?B(Ve):Ve();const pe=ge(...Ee);return c_(h,ce,pe)}function x_(S){const F={},Z=[];let $;const J={addCase(ce,B){const h=typeof ce=="string"?ce:ce.type;if(!h)throw new Error(pp(28));if(h in F)throw new Error(pp(29));return F[h]=B,J},addMatcher(ce,B){return Z.push({matcher:ce,reducer:B}),J},addDefaultCase(ce){return $=ce,J}};return S(J),[F,Z,$]}function ov(S){return typeof S=="function"}function lv(S,F){let[Z,$,J]=x_(F),ce;if(ov(S))ce=()=>My(S());else{const h=My(S);ce=()=>h}function B(h=ce(),oe){let ge=[Z[oe.type],...$.filter(({matcher:Te})=>Te(oe)).map(({reducer:Te})=>Te)];return ge.filter(Te=>!!Te).length===0&&(ge=[J]),ge.reduce((Te,Ve)=>{if(Ve)if(Of(Te)){const pe=Ve(Te,oe);return pe===void 0?Te:pe}else{if(mp(Te))return g_(Te,Ee=>Ve(Ee,oe));{const Ee=Ve(Te,oe);if(Ee===void 0){if(Te===null)return Te;throw Error("A case reducer on a non-draftable value must not return undefined")}return Ee}}return Te},h)}return B.getInitialState=ce,B}var cv=Symbol.for("rtk-slice-createasyncthunk");function uv(S,F){return`${S}/${F}`}function hv({creators:S}={}){var Z;const F=(Z=S==null?void 0:S.asyncThunk)==null?void 0:Z[cv];return function(J){const{name:ce,reducerPath:B=ce}=J;if(!ce)throw new Error(pp(11));const h=(typeof J.reducers=="function"?J.reducers(pv()):J.reducers)||{},oe=Object.keys(h),ge={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},Te={addCase(ct,Ke){const pt=typeof ct=="string"?ct:ct.type;if(!pt)throw new Error(pp(12));if(pt in ge.sliceCaseReducersByType)throw new Error(pp(13));return ge.sliceCaseReducersByType[pt]=Ke,Te},addMatcher(ct,Ke){return ge.sliceMatchers.push({matcher:ct,reducer:Ke}),Te},exposeAction(ct,Ke){return ge.actionCreators[ct]=Ke,Te},exposeCaseReducer(ct,Ke){return ge.sliceCaseReducersByName[ct]=Ke,Te}};oe.forEach(ct=>{const Ke=h[ct],pt={reducerName:ct,type:uv(ce,ct),createNotation:typeof J.reducers=="function"};mv(Ke)?yv(pt,Ke,Te,F):fv(pt,Ke,Te)});function Ve(){const[ct={},Ke=[],pt=void 0]=typeof J.extraReducers=="function"?x_(J.extraReducers):[J.extraReducers],Pt={...ct,...ge.sliceCaseReducersByType};return lv(J.initialState,Ue=>{for(let zt in Pt)Ue.addCase(zt,Pt[zt]);for(let zt of ge.sliceMatchers)Ue.addMatcher(zt.matcher,zt.reducer);for(let zt of Ke)Ue.addMatcher(zt.matcher,zt.reducer);pt&&Ue.addDefaultCase(pt)})}const Ee=ct=>ct,pe=new Map,Se=new WeakMap;let Ne;function rt(ct,Ke){return Ne||(Ne=Ve()),Ne(ct,Ke)}function Ie(){return Ne||(Ne=Ve()),Ne.getInitialState()}function Oe(ct,Ke=!1){function pt(Ue){let zt=Ue[ct];return typeof zt>"u"&&Ke&&(zt=jm(Se,pt,Ie)),zt}function Pt(Ue=Ee){const zt=jm(pe,Ke,()=>new WeakMap);return jm(zt,Ue,()=>{const _t={};for(const[Dt,ri]of Object.entries(J.selectors??{}))_t[Dt]=dv(ri,Ue,()=>jm(Se,Ue,Ie),Ke);return _t})}return{reducerPath:ct,getSelectors:Pt,get selectors(){return Pt(pt)},selectSlice:pt}}const We={name:ce,reducer:rt,actions:ge.actionCreators,caseReducers:ge.sliceCaseReducersByName,getInitialState:Ie,...Oe(B),injectInto(ct,{reducerPath:Ke,...pt}={}){const Pt=Ke??B;return ct.inject({reducerPath:Pt,reducer:rt},pt),{...We,...Oe(Pt,!0)}}};return We}}function dv(S,F,Z,$){function J(ce,...B){let h=F(ce);return typeof h>"u"&&$&&(h=Z()),S(h,...B)}return J.unwrapped=S,J}var cm=hv();function pv(){function S(F,Z){return{_reducerDefinitionType:"asyncThunk",payloadCreator:F,...Z}}return S.withTypes=()=>S,{reducer(F){return Object.assign({[F.name](...Z){return F(...Z)}}[F.name],{_reducerDefinitionType:"reducer"})},preparedReducer(F,Z){return{_reducerDefinitionType:"reducerWithPrepare",prepare:F,reducer:Z}},asyncThunk:S}}function fv({type:S,reducerName:F,createNotation:Z},$,J){let ce,B;if("reducer"in $){if(Z&&!gv($))throw new Error(pp(17));ce=$.reducer,B=$.prepare}else ce=$;J.addCase(S,ce).exposeCaseReducer(F,ce).exposeAction(F,B?Ty(S,B):Ty(S))}function mv(S){return S._reducerDefinitionType==="asyncThunk"}function gv(S){return S._reducerDefinitionType==="reducerWithPrepare"}function yv({type:S,reducerName:F},Z,$,J){if(!J)throw new Error(pp(18));const{payloadCreator:ce,fulfilled:B,pending:h,rejected:oe,settled:ge,options:Te}=Z,Ve=J(S,ce,Te);$.exposeAction(F,Ve),B&&$.addCase(Ve.fulfilled,B),h&&$.addCase(Ve.pending,h),oe&&$.addCase(Ve.rejected,oe),ge&&$.addMatcher(Ve.settled,ge),$.exposeCaseReducer(F,{fulfilled:B||Bm,pending:h||Bm,rejected:oe||Bm,settled:ge||Bm})}function Bm(){}function pp(S){return`Minified Redux Toolkit error #${S}; visit https://redux-toolkit.js.org/Errors?code=${S} for the full message or use the non-minified dev environment for full errors. `}const v_=cm({name:"country",initialState:{selectedCountry:"",countryName:""},reducers:{setCountry:(S,F)=>{if(S.selectedCountry==F.payload)S.selectedCountry="",S.countryName="";else switch(S.selectedCountry=F.payload,S.selectedCountry){case"EE":S.countryName="Estonia";break;case"LT":S.countryName="Lithuania";break;case"LV":S.countryName="Latvia";break}}}}),{setCountry:_v}=v_.actions,xv=v_.reducer,b_=cm({name:"ts",initialState:{selectedTs:"",selectedTsValue:""},reducers:{setTs:(S,F)=>{S.selectedTs=F.payload},setTsValue:(S,F)=>{S.selectedTsValue=F.payload}}}),{setTs:CT,setTsValue:AT}=b_.actions,vv=b_.reducer,w_=cm({name:"action",initialState:{selectedAction:0,selectedActionTemp:0,currentAction:{},selectedActions:[],typeNewGen:"",showConfirm:!1,showHistory:!1},reducers:{setActionTemp:(S,F)=>{S.selectedActionTemp=F.payload},setAction:(S,F)=>{S.selectedAction=F.payload},setCurrentAction:(S,F)=>{S.currentAction=F.payload},setTypeNewGen:(S,F)=>{S.typeNewGen=F.payload},addAction:(S,F)=>{S.selectedActions.includes(F.payload)||S.selectedActions.push(F.payload)},updateAction:(S,F)=>{const{id:Z,updates:$}=F.payload;Z!==-1&&(S.selectedActions[Z]={...S.selectedActions[Z],...$})},removeAction:(S,F)=>{const Z=F.payload;Z>=0&&Z<S.selectedActions.length&&S.selectedActions.splice(Z,1)},showHideConfirm:S=>{S.showConfirm=!S.showConfirm},showHideHistory:S=>{S.showHistory=!S.showHistory}}}),{setActionTemp:Jm,setAction:Gm,setTypeNewGen:bv,addAction:wv,updateAction:ET,removeAction:S_,setCurrentAction:Am,showHideConfirm:Sv,showHideHistory:Yg}=w_.actions,Tv=w_.reducer,T_=cm({name:"credits",initialState:{creditsInit:3e3,creditsRemaining:3e3,creditsSpent:0,creditsAttackInit:3e3,creditsAttackRemaining:3e3,creditsAttackSpent:0},reducers:{setCreditsRemaining:(S,F)=>{S.creditsRemaining=Number(S.creditsInit)-Number(F.payload)},setCreditsSpent:(S,F)=>{S.creditsSpent=Number(F.payload)},setCreditsAttackRemaining:(S,F)=>{S.creditsAttackRemaining=Number(S.creditsAttackInit)-Number(F.payload)},setCreditsAttackSpent:(S,F)=>{S.creditsAttackSpent=Number(F.payload)}}}),{setCreditsRemaining:Mv,setCreditsSpent:Cv,setCreditsAttackRemaining:kT,setCreditsAttackSpent:PT}=T_.actions,Av=T_.reducer,M_=cm({name:"defence",initialState:{actionNumber:1,step:1},reducers:{setActionNumber:(S,F)=>{S.actionNumber+=1},setStep:(S,F)=>{S.step+=1},setStep2:(S,F)=>{S.step=F.payload}}}),{setActionNumber:Ev,setStep:zT,setStep2:kv}=M_.actions,Pv=M_.reducer,C_=cm({name:"attackCurrentElement",initialState:{currentElementNode:"",currentElementCarrier:"",currentElementType:"",currentElementType2:"",currentElementPerc:0,selectedAttackActions:[],previousAttackActions:[],showConfirm:!1,showHistory:!1},reducers:{setAction:(S,F)=>{S.currentElementNode=F.payload.node,S.currentElementCarrier=F.payload.carrier,S.currentElementType=F.payload.type,S.currentElementType2=F.payload.type2},removeAction:S=>{S.currentElementNode="",S.currentElementCarrier="",S.currentElementType="",S.currentElementType2="",S.currentElementPerc=0},updateAction:(S,F)=>{S.currentElementPerc=F.payload},addAction:(S,F)=>{S.selectedAttackActions.includes(F.payload)||S.selectedAttackActions.push(F.payload)},deleteAction:(S,F)=>{const Z=F.payload;Z>=0&&Z<S.selectedAttackActions.length&&S.selectedAttackActions.splice(Z,1)},archiveCurrentActions:S=>{S.selectedAttackActions.length>0&&(S.previousAttackActions.push([...S.selectedAttackActions]),S.selectedAttackActions=[])},showHideConfirm:S=>{S.showConfirm=!S.showConfirm},showHideHistory:S=>{S.showHistory=!S.showHistory}}}),{setAction:Eg,removeAction:Ay,updateAction:zv,addAction:Lv,deleteAction:Dv,archiveCurrentActions:Rv,showHideConfirm:Iv,showHideHistory:Wg}=C_.actions,Ov=C_.reducer,um=sv({reducer:{country:xv,action:Tv,ts:vv,credits:Av,defence:Pv,attack:Ov}}),jv="_header_1vu1q_1",Bv="_nameBlock_1vu1q_31",Nv="_gameName_1vu1q_41",Fv="_gamePayoff_1vu1q_53",Uv="_gameRound_1vu1q_65",Vv="_roundNumber_1vu1q_77",Gv="_roundSuffix_1vu1q_87",$v="_roundType_1vu1q_97",Kp={header:jv,nameBlock:Bv,gameName:Nv,gamePayoff:Fv,gameRound:Uv,roundNumber:Vv,roundSuffix:Gv,roundType:$v},Hv=()=>H.jsxs("div",{className:Kp.nameBlock,children:[H.jsx("h1",{className:Kp.gameName,children:"SIMEX-BALTICS"}),H.jsx("p",{className:Kp.gamePayoff,children:"An EC JRC game to enhance power grid resilience"})]}),Zv=({round1:S,round2:F})=>H.jsxs("div",{className:Kp.gameRound,children:[H.jsx("span",{className:Kp.roundNumber,children:S}),H.jsx("span",{className:Kp.roundSuffix,children:"st"})," ",H.jsx("span",{className:Kp.roundType,children:F})]}),hm=({round1:S,round2:F})=>H.jsxs("header",{className:Kp.header,children:[H.jsx(Hv,{}),H.jsx(Zv,{round1:S,round2:F})]});var $m={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.0/LICENSE.txt
 */var qv=$m.exports,Ey;function Xv(){return Ey||(Ey=1,function(S,F){(function(Z,$){S.exports=$()})(qv,function(){var Z={},$={};function J(B,h,oe){if($[B]=oe,B==="index"){var ge="var sharedModule = {}; ("+$.shared+")(sharedModule); ("+$.worker+")(sharedModule);",Te={};return $.shared(Te),$.index(Z,Te),typeof window<"u"&&Z.setWorkerUrl(window.URL.createObjectURL(new Blob([ge],{type:"text/javascript"}))),Z}}J("shared",["exports"],function(B){function h(a,t,n,l){return new(n||(n=Promise))(function(m,v){function w(j){try{z(l.next(j))}catch(G){v(G)}}function A(j){try{z(l.throw(j))}catch(G){v(G)}}function z(j){var G;j.done?m(j.value):(G=j.value,G instanceof n?G:new n(function(Y){Y(G)})).then(w,A)}z((l=l.apply(a,t||[])).next())})}function oe(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ge,Te;function Ve(){if(Te)return ge;function a(t,n){this.x=t,this.y=n}return Te=1,ge=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,n){return this.clone()._rotateAround(t,n)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var n=t.x-this.x,l=t.y-this.y;return n*n+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)},_matMult:function(t){var n=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var n=Math.cos(t),l=Math.sin(t),m=l*this.x+n*this.y;return this.x=n*this.x-l*this.y,this.y=m,this},_rotateAround:function(t,n){var l=Math.cos(t),m=Math.sin(t),v=n.y+m*(this.x-n.x)+l*(this.y-n.y);return this.x=n.x+l*(this.x-n.x)-m*(this.y-n.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t},ge}typeof SuppressedError=="function"&&SuppressedError;var Ee,pe,Se=oe(Ve()),Ne=function(){if(pe)return Ee;function a(t,n,l,m){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=l,this.p2y=m}return pe=1,Ee=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,m=0;m<8;m++){var v=this.sampleCurveX(l)-t;if(Math.abs(v)<n)return l;var w=this.sampleCurveDerivativeX(l);if(Math.abs(w)<1e-6)break;l-=v/w}var A=0,z=1;for(l=t,m=0;m<20&&(v=this.sampleCurveX(l),!(Math.abs(v-t)<n));m++)t>v?A=l:z=l,l=.5*(z-A)+A;return l},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},Ee}(),rt=oe(Ne);let Ie,Oe;function We(){return Ie==null&&(Ie=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ie}function ct(){if(Oe==null&&(Oe=!1,We())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<5*5;l++){const m=4*l;t.fillStyle=`rgb(${m},${m+1},${m+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&n[l]!==l){Oe=!0;break}}}return Oe||!1}var Ke=1e-6,pt=typeof Float32Array<"u"?Float32Array:Array;function Pt(){var a=new pt(9);return pt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Ue(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function zt(){var a=new pt(3);return pt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function _t(a){return Math.hypot(a[0],a[1],a[2])}function Dt(a,t,n){var l=new pt(3);return l[0]=a,l[1]=t,l[2]=n,l}function ri(a,t,n){return a[0]=t[0]+n[0],a[1]=t[1]+n[1],a[2]=t[2]+n[2],a}function Yt(a,t,n){return a[0]=t[0]*n,a[1]=t[1]*n,a[2]=t[2]*n,a}function yi(a,t,n){var l=t[0],m=t[1],v=t[2],w=n[0],A=n[1],z=n[2];return a[0]=m*z-v*A,a[1]=v*w-l*z,a[2]=l*A-m*w,a}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)});var wi,gt=_t;function It(a,t,n){var l=t[0],m=t[1],v=t[2],w=t[3];return a[0]=n[0]*l+n[4]*m+n[8]*v+n[12]*w,a[1]=n[1]*l+n[5]*m+n[9]*v+n[13]*w,a[2]=n[2]*l+n[6]*m+n[10]*v+n[14]*w,a[3]=n[3]*l+n[7]*m+n[11]*v+n[15]*w,a}function ti(){var a=new pt(4);return pt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function ki(a,t,n,l){var m=.5*Math.PI/180;t*=m,n*=m,l*=m;var v=Math.sin(t),w=Math.cos(t),A=Math.sin(n),z=Math.cos(n),j=Math.sin(l),G=Math.cos(l);return a[0]=v*z*G-w*A*j,a[1]=w*A*G+v*z*j,a[2]=w*z*j-v*A*G,a[3]=w*z*G+v*A*j,a}function qe(){var a=new pt(2);return pt!=Float32Array&&(a[0]=0,a[1]=0),a}function Ot(a,t){var n=new pt(2);return n[0]=a,n[1]=t,n}zt(),wi=new pt(4),pt!=Float32Array&&(wi[0]=0,wi[1]=0,wi[2]=0,wi[3]=0),zt(),Dt(1,0,0),Dt(0,1,0),ti(),ti(),Pt(),qe();const Ht=8192;function ii(a,t,n){return t*(Ht/(a.tileSize*Math.pow(2,n-a.tileID.overscaledZ)))}function di(a,t){return(a%t+t)%t}function Qi(a,t,n){return a*(1-n)+t*n}function Ri(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,n=t*a;return 4*(a<.5?n:3*(a-t)+n-.75)}function _n(a,t,n,l){const m=new rt(a,t,n,l);return v=>m.solve(v)}const Zr=_n(.25,.1,.25,1);function Cr(a,t,n){return Math.min(n,Math.max(t,a))}function Pl(a,t,n){const l=n-t,m=((a-t)%l+l)%l+t;return m===t?n:m}function aa(a,...t){for(const n of t)for(const l in n)a[l]=n[l];return a}let hc=1;function li(a,t,n){const l={};for(const m in a)l[m]=t.call(this,a[m],m,a);return l}function Ms(a,t,n){const l={};for(const m in a)t.call(this,a[m],m,a)&&(l[m]=a[m]);return l}function Va(a){return Array.isArray(a)?a.map(Va):typeof a=="object"&&a?li(a,Va):a}const dc={};function qr(a){dc[a]||(typeof console<"u"&&console.warn(a),dc[a]=!0)}function Ga(a,t,n){return(n.y-a.y)*(t.x-a.x)>(t.y-a.y)*(n.x-a.x)}function va(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Ao=null;function $a(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Ru="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function zl(a,t,n,l,m){return h(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(a,{timestamp:0});try{const w=v==null?void 0:v.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const A=w.startsWith("BGR"),z=new Uint8ClampedArray(l*m*4);if(yield v.copyTo(z,function(j,G,Y,ee,ae){const ue=4*Math.max(1,0),fe=(Math.max(0,Y)-Y)*ee*4+ue,we=4*ee,Pe=Math.max(0,G),et=Math.max(0,Y);return{rect:{x:Pe,y:et,width:Math.min(j.width,G+ee)-Pe,height:Math.min(j.height,Y+ae)-et},layout:[{offset:fe,stride:we}]}}(a,t,n,l,m)),A)for(let j=0;j<z.length;j+=4){const G=z[j];z[j]=z[j+2],z[j+2]=G}return z}finally{v.close()}})}let ba,pc;function Ha(a,t,n,l){return a.addEventListener(t,n,l),{unsubscribe:()=>{a.removeEventListener(t,n,l)}}}function en(a){return a*Math.PI/180}function sa(a){return a/Math.PI*180}const oa={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Mh={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Eo="AbortError";function lt(){return new Error(Eo)}const de={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ye(a){return de.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const Me="global-dispatcher";class je extends Error{constructor(t,n,l,m){super(`AJAXError: ${n} (${t}): ${l}`),this.status=t,this.statusText=n,this.url=l,this.body=m}}const Qe=()=>va(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,nt=function(a,t){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const l=ye(a.url);if(l)return l(a,t);if(va(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:Me},t)}if(!(/^file:/.test(n=a.url)||/^file:/.test(Qe())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,m){return h(this,void 0,void 0,function*(){const v=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Qe(),signal:m.signal});let w,A;l.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");try{w=yield fetch(v)}catch(j){throw new je(0,j.message,l.url,new Blob)}if(!w.ok){const j=yield w.blob();throw new je(w.status,w.statusText,l.url,j)}A=l.type==="arrayBuffer"||l.type==="image"?w.arrayBuffer():l.type==="json"?w.json():w.text();const z=yield A;if(m.signal.aborted)throw lt();return{data:z,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}})}(a,t);if(va(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:Me},t)}var n;return function(l,m){return new Promise((v,w)=>{var A;const z=new XMLHttpRequest;z.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(z.responseType="arraybuffer");for(const j in l.headers)z.setRequestHeader(j,l.headers[j]);l.type==="json"&&(z.responseType="text",!((A=l.headers)===null||A===void 0)&&A.Accept||z.setRequestHeader("Accept","application/json")),z.withCredentials=l.credentials==="include",z.onerror=()=>{w(new Error(z.statusText))},z.onload=()=>{if(!m.signal.aborted)if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let j=z.response;if(l.type==="json")try{j=JSON.parse(z.response)}catch(G){return void w(G)}v({data:j,cacheControl:z.getResponseHeader("Cache-Control"),expires:z.getResponseHeader("Expires")})}else{const j=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});w(new je(z.status,z.statusText,l.url,j))}},m.signal.addEventListener("abort",()=>{z.abort(),w(lt())}),z.send(l.body)})}(a,t)};function yt(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const t=new URL(a),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function tt(a,t,n){n[a]&&n[a].indexOf(t)!==-1||(n[a]=n[a]||[],n[a].push(t))}function Et(a,t,n){if(n&&n[a]){const l=n[a].indexOf(t);l!==-1&&n[a].splice(l,1)}}class St{constructor(t,n={}){aa(this,n),this.type=t}}class ut extends St{constructor(t,n={}){super("error",aa({error:t},n))}}class jt{on(t,n){return this._listeners=this._listeners||{},tt(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return Et(t,n,this._listeners),Et(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},tt(t,n,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,n){typeof t=="string"&&(t=new St(t,n||{}));const l=t.type;if(this.listens(l)){t.target=this;const m=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const A of m)A.call(this,t);const v=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const A of v)Et(l,A,this._oneTimeListeners),A.call(this,t);const w=this._eventedParent;w&&(aa(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(t))}else t instanceof ut&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var He={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ni=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Pi(a,t){const n={};for(const l in a)l!=="ref"&&(n[l]=a[l]);return ni.forEach(l=>{l in t&&(n[l]=t[l])}),n}function ci(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let n=0;n<a.length;n++)if(!ci(a[n],t[n]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const n in a)if(!ci(a[n],t[n]))return!1;return!0}return a===t}function ai(a,t){a.push(t)}function Ai(a,t,n){ai(n,{command:"addSource",args:[a,t[a]]})}function tr(a,t,n){ai(t,{command:"removeSource",args:[a]}),n[a]=!0}function Wi(a,t,n,l){tr(a,n,l),Ai(a,t,n)}function ur(a,t,n){let l;for(l in a[n])if(Object.prototype.hasOwnProperty.call(a[n],l)&&l!=="data"&&!ci(a[n][l],t[n][l]))return!1;for(l in t[n])if(Object.prototype.hasOwnProperty.call(t[n],l)&&l!=="data"&&!ci(a[n][l],t[n][l]))return!1;return!0}function bi(a,t,n,l,m,v){a=a||{},t=t||{};for(const w in a)Object.prototype.hasOwnProperty.call(a,w)&&(ci(a[w],t[w])||n.push({command:v,args:[l,w,t[w],m]}));for(const w in t)Object.prototype.hasOwnProperty.call(t,w)&&!Object.prototype.hasOwnProperty.call(a,w)&&(ci(a[w],t[w])||n.push({command:v,args:[l,w,t[w],m]}))}function fr(a){return a.id}function Kn(a,t){return a[t.id]=t,a}class Wt{constructor(t,n,l,m){this.message=(t?`${t}: `:"")+l,m&&(this.identifier=m),n!=null&&n.__line__&&(this.line=n.__line__)}}function Cn(a,...t){for(const n of t)for(const l in n)a[l]=n[l];return a}class Ur extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class es{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[l,m]of n)this.bindings[l]=m}concat(t){return new es(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Cs={kind:"null"},Jt={kind:"number"},Fi={kind:"string"},Mi={kind:"boolean"},Dr={kind:"color"},Qc={kind:"projectionDefinition"},wa={kind:"object"},Zi={kind:"value"},Qo={kind:"collator"},Ll={kind:"formatted"},fn={kind:"padding"},Iu={kind:"colorArray"},Jo={kind:"numberArray"},hs={kind:"resolvedImage"},ds={kind:"variableAnchorOffsetCollection"};function la(a,t){return{kind:"array",itemType:a,N:t}}function Vr(a){if(a.kind==="array"){const t=Vr(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const fc=[Cs,Jt,Fi,Mi,Dr,Qc,Ll,wa,la(Zi),fn,Jo,Iu,hs,ds];function Er(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Er(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const n of fc)if(!Er(n,t))return null}}return`Expected ${Vr(a)} but found ${Vr(t)} instead.`}function mc(a,t){return t.some(n=>n.kind===a.kind)}function Dl(a,t){return t.some(n=>n==="null"?a===null:n==="array"?Array.isArray(a):n==="object"?a&&!Array.isArray(a)&&typeof a=="object":n===typeof a)}function el(a,t){return a.kind==="array"&&t.kind==="array"?a.itemType.kind===t.itemType.kind&&typeof a.N=="number":a.kind===t.kind}const ps=.96422,_d=.82521,yp=4/29,ko=6/29,xd=3*ko*ko,Ou=ko*ko*ko,ju=Math.PI/180,As=180/Math.PI;function gc(a){return(a%=360)<0&&(a+=360),a}function Rl([a,t,n,l]){let m,v;const w=Ws((.2225045*(a=Jc(a))+.7168786*(t=Jc(t))+.0606169*(n=Jc(n)))/1);a===t&&t===n?m=v=w:(m=Ws((.4360747*a+.3850649*t+.1430804*n)/ps),v=Ws((.0139322*a+.0971045*t+.7141733*n)/_d));const A=116*w-16;return[A<0?0:A,500*(m-w),200*(w-v),l]}function Jc(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Ws(a){return a>Ou?Math.pow(a,1/3):a/xd+yp}function Ch([a,t,n,l]){let m=(a+16)/116,v=isNaN(t)?m:m+t/500,w=isNaN(n)?m:m-n/200;return m=1*fs(m),v=ps*fs(v),w=_d*fs(w),[Sa(3.1338561*v-1.6168667*m-.4906146*w),Sa(-.9787684*v+1.9161415*m+.033454*w),Sa(.0719453*v-.2289914*m+1.4052427*w),l]}function Sa(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function fs(a){return a>ko?a*a*a:xd*(a-yp)}const Po=Object.hasOwn||function(a,t){return Object.prototype.hasOwnProperty.call(a,t)};function ar(a,t){return Po(a,t)?a[t]:void 0}function zo(a){return parseInt(a.padEnd(2,a),16)/255}function ms(a,t){return Lo(t?a/100:a,0,1)}function Lo(a,t,n){return Math.min(Math.max(t,a),n)}function vd(a){return!a.some(Number.isNaN)}const eu={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Za(a,t,n){return a+n*(t-a)}function Es(a,t,n){return a.map((l,m)=>Za(l,t[m],n))}class Ui{constructor(t,n,l,m=1,v=!0){this.r=t,this.g=n,this.b=l,this.a=m,v||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[t,n,l,m]))}static parse(t){if(t instanceof Ui)return t;if(typeof t!="string")return;const n=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=ar(eu,l);if(m){const[w,A,z]=m;return[w/255,A/255,z/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const w=l.length<6?1:2;let A=1;return[zo(l.slice(A,A+=w)),zo(l.slice(A,A+=w)),zo(l.slice(A,A+=w)),zo(l.slice(A,A+w)||"ff")]}if(l.startsWith("rgb")){const w=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[A,z,j,G,Y,ee,ae,ue,fe,we,Pe,et]=w,Be=[G||" ",ae||" ",we].join("");if(Be==="  "||Be==="  /"||Be===",,"||Be===",,,"){const re=[j,ee,fe].join(""),ve=re==="%%%"?100:re===""?255:0;if(ve){const Fe=[Lo(+z/ve,0,1),Lo(+Y/ve,0,1),Lo(+ue/ve,0,1),Pe?ms(+Pe,et):1];if(vd(Fe))return Fe}}return}}const v=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[w,A,z,j,G,Y,ee,ae,ue]=v,fe=[z||" ",G||" ",ee].join("");if(fe==="  "||fe==="  /"||fe===",,"||fe===",,,"){const we=[+A,Lo(+j,0,100),Lo(+Y,0,100),ae?ms(+ae,ue):1];if(vd(we))return function([Pe,et,Be,re]){function ve(Fe){const xt=(Fe+Pe/30)%12,Nt=et*Math.min(Be,1-Be);return Be-Nt*Math.max(-1,Math.min(xt-3,9-xt,1))}return Pe=gc(Pe),et/=100,Be/=100,[ve(0),ve(8),ve(4),re]}(we)}}}(t);return n?new Ui(...n,!1):void 0}get rgb(){const{r:t,g:n,b:l,a:m}=this,v=m||1/0;return this.overwriteGetter("rgb",[t/v,n/v,l/v,m])}get hcl(){return this.overwriteGetter("hcl",function(t){const[n,l,m,v]=Rl(t),w=Math.sqrt(l*l+m*m);return[Math.round(1e4*w)?gc(Math.atan2(m,l)*As):NaN,w,n,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Rl(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,l,m]=this.rgb;return`rgba(${[t,n,l].map(v=>Math.round(255*v)).join(",")},${m})`}static interpolate(t,n,l,m="rgb"){switch(m){case"rgb":{const[v,w,A,z]=Es(t.rgb,n.rgb,l);return new Ui(v,w,A,z,!1)}case"hcl":{const[v,w,A,z]=t.hcl,[j,G,Y,ee]=n.hcl;let ae,ue;if(isNaN(v)||isNaN(j))isNaN(v)?isNaN(j)?ae=NaN:(ae=j,A!==1&&A!==0||(ue=G)):(ae=v,Y!==1&&Y!==0||(ue=w));else{let Be=j-v;j>v&&Be>180?Be-=360:j<v&&v-j>180&&(Be+=360),ae=v+l*Be}const[fe,we,Pe,et]=function([Be,re,ve,Fe]){return Be=isNaN(Be)?0:Be*ju,Ch([ve,Math.cos(Be)*re,Math.sin(Be)*re,Fe])}([ae,ue??Za(w,G,l),Za(A,Y,l),Za(z,ee,l)]);return new Ui(fe,we,Pe,et,!1)}case"lab":{const[v,w,A,z]=Ch(Es(t.lab,n.lab,l));return new Ui(v,w,A,z,!1)}}}}Ui.black=new Ui(0,0,0,1),Ui.white=new Ui(1,1,1,1),Ui.transparent=new Ui(0,0,0,0),Ui.red=new Ui(1,0,0,1);class Do{constructor(t,n,l){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Il=["bottom","center","top"];class Bu{constructor(t,n,l,m,v,w){this.text=t,this.image=n,this.scale=l,this.fontStack=m,this.textColor=v,this.verticalAlign=w}}class ca{constructor(t){this.sections=t}static fromString(t){return new ca([new Bu(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof ca?t:ca.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class an{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof an)return t;if(typeof t=="number")return new an([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new an(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){return new an(Es(t.values,n.values,l))}}class Jr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Jr)return t;if(typeof t=="number")return new Jr([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new Jr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){return new Jr(Es(t.values,n.values,l))}}class Bn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Bn)return t;if(typeof t=="string"){const l=Ui.parse(t);return l?new Bn([l]):void 0}if(!Array.isArray(t))return;const n=[];for(const l of t){if(typeof l!="string")return;const m=Ui.parse(l);if(!m)return;n.push(m)}return new Bn(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l,m="rgb"){const v=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let w=0;w<t.values.length;w++)v.push(Ui.interpolate(t.values[w],n.values[w],l,m));return new Bn(v)}}class kr extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const ks=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Vi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Vi)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const l=t[n],m=t[n+1];if(typeof l!="string"||!ks.has(l)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new Vi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,l){const m=t.values,v=n.values;if(m.length!==v.length)throw new kr(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const w=[];for(let A=0;A<m.length;A+=2){if(m[A]!==v[A])throw new kr(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${m[A]}, to[${A}]: ${v[A]}`);w.push(m[A]);const[z,j]=m[A+1],[G,Y]=v[A+1];w.push([Za(z,G,l),Za(j,Y,l)])}return new Vi(w)}}class ua{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new ua({name:t,available:!1}):null}}class Oi{constructor(t,n,l){this.from=t,this.to=n,this.transition=l}static interpolate(t,n,l){return new Oi(t,n,l)}static parse(t){return t instanceof Oi?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Oi(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Oi(t.from,t.to,t.transition):typeof t=="string"?new Oi(t,t,1):void 0}}function Gi(a,t,n,l){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[a,t,n,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[a,t,n,l]:[a,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ps(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Oi||a instanceof Ui||a instanceof Do||a instanceof ca||a instanceof an||a instanceof Jr||a instanceof Bn||a instanceof Vi||a instanceof ua)return!0;if(Array.isArray(a)){for(const t of a)if(!Ps(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!Ps(a[t]))return!1;return!0}return!1}function Li(a){if(a===null)return Cs;if(typeof a=="string")return Fi;if(typeof a=="boolean")return Mi;if(typeof a=="number")return Jt;if(a instanceof Ui)return Dr;if(a instanceof Oi)return Qc;if(a instanceof Do)return Qo;if(a instanceof ca)return Ll;if(a instanceof an)return fn;if(a instanceof Jr)return Jo;if(a instanceof Bn)return Iu;if(a instanceof Vi)return ds;if(a instanceof ua)return hs;if(Array.isArray(a)){const t=a.length;let n;for(const l of a){const m=Li(l);if(n){if(n===m)continue;n=Zi;break}n=m}return la(n||Zi,t)}return wa}function An(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof Ui||a instanceof Oi||a instanceof ca||a instanceof an||a instanceof Jr||a instanceof Bn||a instanceof Vi||a instanceof ua?a.toString():JSON.stringify(a)}class En{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ps(t[1]))return n.error("invalid value");const l=t[1];let m=Li(l);const v=n.expectedType;return m.kind!=="array"||m.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(m=v),new En(m,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const tl={string:Fi,number:Jt,boolean:Mi,object:wa};class ha{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let l,m=1;const v=t[0];if(v==="array"){let A,z;if(t.length>2){const j=t[1];if(typeof j!="string"||!(j in tl)||j==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);A=tl[j],m++}else A=Zi;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);z=t[2],m++}l=la(A,z)}else{if(!tl[v])throw new Error(`Types doesn't contain name = ${v}`);l=tl[v]}const w=[];for(;m<t.length;m++){const A=n.parse(t[m],m,Zi);if(!A)return null;w.push(A)}return new ha(l,w)}evaluate(t){for(let n=0;n<this.args.length;n++){const l=this.args[n].evaluate(t);if(!Er(this.type,Li(l)))return l;if(n===this.args.length-1)throw new kr(`Expected value to be of type ${Vr(this.type)}, but found ${Vr(Li(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Nu={"to-boolean":Mi,"to-color":Dr,"to-number":Jt,"to-string":Fi};class da{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[0];if(!Nu[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return n.error("Expected one argument.");const m=Nu[l],v=[];for(let w=1;w<t.length;w++){const A=n.parse(t[w],w,Zi);if(!A)return null;v.push(A)}return new da(m,v)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,l;for(const m of this.args){if(n=m.evaluate(t),l=null,n instanceof Ui)return n;if(typeof n=="string"){const v=t.parseColor(n);if(v)return v}else if(Array.isArray(n)&&(l=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Gi(n[0],n[1],n[2],n[3]),!l))return new Ui(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new kr(l||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const l of this.args){n=l.evaluate(t);const m=an.parse(n);if(m)return m}throw new kr(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const l of this.args){n=l.evaluate(t);const m=Jr.parse(n);if(m)return m}throw new kr(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const l of this.args){n=l.evaluate(t);const m=Bn.parse(n);if(m)return m}throw new kr(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const l of this.args){n=l.evaluate(t);const m=Vi.parse(n);if(m)return m}throw new kr(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const l of this.args){if(n=l.evaluate(t),n===null)return 0;const m=Number(n);if(!isNaN(m))return m}throw new kr(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return ca.fromString(An(this.args[0].evaluate(t)));case"resolvedImage":return ua.fromString(An(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return An(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const zs=["Unknown","Point","LineString","Polygon"];class il{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?zs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=Ui.parse(t),this._parseColorCache.set(t,n)),n}}class Ol{constructor(t,n,l=[],m,v=new es,w=[]){this.registry=t,this.path=l,this.key=l.map(A=>`[${A}]`).join(""),this.scope=v,this.errors=w,this.expectedType=m,this._isConstant=n}parse(t,n,l,m,v={}){return n?this.concat(n,l,m)._parse(t,v):this._parse(t,v)}_parse(t,n){function l(m,v,w){return w==="assert"?new ha(v,[m]):w==="coerce"?new da(v,[m]):m}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=t[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[m];if(v){let w=v.parse(t,this);if(!w)return null;if(this.expectedType){const A=this.expectedType,z=w.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||z.kind!=="value"){if(A.kind==="projectionDefinition"&&["string","array"].includes(z.kind)||["color","formatted","resolvedImage"].includes(A.kind)&&["value","string"].includes(z.kind)||["padding","numberArray"].includes(A.kind)&&["value","number","array"].includes(z.kind)||A.kind==="colorArray"&&["value","string","array"].includes(z.kind)||A.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(z.kind))w=l(w,A,n.typeAnnotation||"coerce");else if(this.checkSubtype(A,z))return null}else w=l(w,A,n.typeAnnotation||"assert")}if(!(w instanceof En)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const A=new il;try{w=new En(w.type,w.evaluate(A))}catch(z){return this.error(z.message),null}}return w}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,l){const m=typeof t=="number"?this.path.concat(t):this.path,v=l?this.scope.concat(l):this.scope;return new Ol(this.registry,this._isConstant,m,n||null,v,this.errors)}error(t,...n){const l=`${this.key}${n.map(m=>`[${m}]`).join("")}`;this.errors.push(new Ur(l,t))}checkSubtype(t,n){const l=Er(t,n);return l&&this.error(l),l}}class tu{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let v=1;v<t.length-1;v+=2){const w=t[v];if(typeof w!="string")return n.error(`Expected string, but found ${typeof w} instead.`,v);if(/[^a-zA-Z0-9_]/.test(w))return n.error("Variable names must contain only alphanumeric characters or '_'.",v);const A=n.parse(t[v+1],v+1);if(!A)return null;l.push([w,A])}const m=n.parse(t[t.length-1],t.length-1,n.expectedType,l);return m?new tu(l,m):null}outputDefined(){return this.result.outputDefined()}}class Ks{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const l=t[1];return n.scope.has(l)?new Ks(l,n.scope.get(l)):n.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Vn{constructor(t,n,l){this.type=t,this.index=n,this.input=l}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Jt),m=n.parse(t[2],2,la(n.expectedType||Zi));return l&&m?new Vn(m.type.itemType,l,m):null}evaluate(t){const n=this.index.evaluate(t),l=this.input.evaluate(t);if(n<0)throw new kr(`Array index out of bounds: ${n} < 0.`);if(n>=l.length)throw new kr(`Array index out of bounds: ${n} > ${l.length-1}.`);if(n!==Math.floor(n))throw new kr(`Array index must be an integer, but found ${n} instead.`);return l[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class sn{constructor(t,n){this.type=Mi,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Zi),m=n.parse(t[2],2,Zi);return l&&m?mc(l.type,[Mi,Fi,Jt,Cs,Zi])?new sn(l,m):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vr(l.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!Dl(n,["boolean","string","number","null"]))throw new kr(`Expected first argument to be of type boolean, string, number or null, but found ${Vr(Li(n))} instead.`);if(!Dl(l,["string","array"]))throw new kr(`Expected second argument to be of type array or string, but found ${Vr(Li(l))} instead.`);return l.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Ta{constructor(t,n,l){this.type=Jt,this.needle=t,this.haystack=n,this.fromIndex=l}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Zi),m=n.parse(t[2],2,Zi);if(!l||!m)return null;if(!mc(l.type,[Mi,Fi,Jt,Cs,Zi]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vr(l.type)} instead`);if(t.length===4){const v=n.parse(t[3],3,Jt);return v?new Ta(l,m,v):null}return new Ta(l,m)}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!Dl(n,["boolean","string","number","null"]))throw new kr(`Expected first argument to be of type boolean, string, number or null, but found ${Vr(Li(n))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(t)),Dl(l,["string"])){const v=l.indexOf(n,m);return v===-1?-1:[...l.slice(0,v)].length}if(Dl(l,["array"]))return l.indexOf(n,m);throw new kr(`Expected second argument to be of type array or string, but found ${Vr(Li(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class yc{constructor(t,n,l,m,v,w){this.inputType=t,this.type=n,this.input=l,this.cases=m,this.outputs=v,this.otherwise=w}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let l,m;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);const v={},w=[];for(let j=2;j<t.length-1;j+=2){let G=t[j];const Y=t[j+1];Array.isArray(G)||(G=[G]);const ee=n.concat(j);if(G.length===0)return ee.error("Expected at least one branch label.");for(const ue of G){if(typeof ue!="number"&&typeof ue!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof ue=="number"&&Math.abs(ue)>Number.MAX_SAFE_INTEGER)return ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ue=="number"&&Math.floor(ue)!==ue)return ee.error("Numeric branch labels must be integer values.");if(l){if(ee.checkSubtype(l,Li(ue)))return null}else l=Li(ue);if(v[String(ue)]!==void 0)return ee.error("Branch labels must be unique.");v[String(ue)]=w.length}const ae=n.parse(Y,j,m);if(!ae)return null;m=m||ae.type,w.push(ae)}const A=n.parse(t[1],1,Zi);if(!A)return null;const z=n.parse(t[t.length-1],t.length-1,m);return z?A.type.kind!=="value"&&n.concat(1).checkSubtype(l,A.type)?null:new yc(l,m,A,v,w,z):null}evaluate(t){const n=this.input.evaluate(t);return(Li(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Nn{constructor(t,n,l){this.type=t,this.branches=n,this.otherwise=l}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);const m=[];for(let w=1;w<t.length-1;w+=2){const A=n.parse(t[w],w,Mi);if(!A)return null;const z=n.parse(t[w+1],w+1,l);if(!z)return null;m.push([A,z]),l=l||z.type}const v=n.parse(t[t.length-1],t.length-1,l);if(!v)return null;if(!l)throw new Error("Can't infer output type");return new Nn(l,m,v)}evaluate(t){for(const[n,l]of this.branches)if(n.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,l]of this.branches)t(n),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class iu{constructor(t,n,l,m){this.type=t,this.input=n,this.beginIndex=l,this.endIndex=m}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Zi),m=n.parse(t[2],2,Jt);if(!l||!m)return null;if(!mc(l.type,[la(Zi),Fi,Zi]))return n.error(`Expected first argument to be of type array or string, but found ${Vr(l.type)} instead`);if(t.length===4){const v=n.parse(t[3],3,Jt);return v?new iu(l.type,l,m,v):null}return new iu(l.type,l,m)}evaluate(t){const n=this.input.evaluate(t),l=this.beginIndex.evaluate(t);let m;if(this.endIndex&&(m=this.endIndex.evaluate(t)),Dl(n,["string"]))return[...n].slice(l,m).join("");if(Dl(n,["array"]))return n.slice(l,m);throw new kr(`Expected first argument to be of type array or string, but found ${Vr(Li(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Ro(a,t){const n=a.length-1;let l,m,v=0,w=n,A=0;for(;v<=w;)if(A=Math.floor((v+w)/2),l=a[A],m=a[A+1],l<=t){if(A===n||t<m)return A;v=A+1}else{if(!(l>t))throw new kr("Input is not a number.");w=A-1}return 0}class ru{constructor(t,n,l){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[m,v]of l)this.labels.push(m),this.outputs.push(v)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const l=n.parse(t[1],1,Jt);if(!l)return null;const m=[];let v=null;n.expectedType&&n.expectedType.kind!=="value"&&(v=n.expectedType);for(let w=1;w<t.length;w+=2){const A=w===1?-1/0:t[w],z=t[w+1],j=w,G=w+1;if(typeof A!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(m.length&&m[m.length-1][0]>=A)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const Y=n.parse(z,G,v);if(!Y)return null;v=v||Y.type,m.push([A,Y])}return new ru(v,l,m)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const m=this.input.evaluate(t);if(m<=n[0])return l[0].evaluate(t);const v=n.length;return m>=n[v-1]?l[v-1].evaluate(t):l[Ro(n,m)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Fu(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var rl,Qs,Ah=function(){if(Qs)return rl;function a(t,n,l,m){this.cx=3*t,this.bx=3*(l-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(m-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=l,this.p2y=m}return Qs=1,rl=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var l=t,m=0;m<8;m++){var v=this.sampleCurveX(l)-t;if(Math.abs(v)<n)return l;var w=this.sampleCurveDerivativeX(l);if(Math.abs(w)<1e-6)break;l-=v/w}var A=0,z=1;for(l=t,m=0;m<20&&(v=this.sampleCurveX(l),!(Math.abs(v-t)<n));m++)t>v?A=l:z=l,l=.5*(z-A)+A;return l},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},rl}(),ef=Fu(Ah);class kn{constructor(t,n,l,m,v){this.type=t,this.operator=n,this.interpolation=l,this.input=m,this.labels=[],this.outputs=[];for(const[w,A]of v)this.labels.push(w),this.outputs.push(A)}static interpolationFactor(t,n,l,m){let v=0;if(t.name==="exponential")v=_c(n,t.base,l,m);else if(t.name==="linear")v=_c(n,1,l,m);else if(t.name==="cubic-bezier"){const w=t.controlPoints;v=new ef(w[0],w[1],w[2],w[3]).solve(_c(n,1,l,m))}return v}static parse(t,n){let[l,m,v,...w]=t;if(!Array.isArray(m)||m.length===0)return n.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const j=m[1];if(typeof j!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:j}}else{if(m[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const j=m.slice(1);if(j.length!==4||j.some(G=>typeof G!="number"||G<0||G>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:j}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(v=n.parse(v,2,Jt),!v)return null;const A=[];let z=null;l!=="interpolate-hcl"&&l!=="interpolate-lab"||n.expectedType==Iu?n.expectedType&&n.expectedType.kind!=="value"&&(z=n.expectedType):z=Dr;for(let j=0;j<w.length;j+=2){const G=w[j],Y=w[j+1],ee=j+3,ae=j+4;if(typeof G!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(A.length&&A[A.length-1][0]>=G)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ee);const ue=n.parse(Y,ae,z);if(!ue)return null;z=z||ue.type,A.push([G,ue])}return el(z,Jt)||el(z,Qc)||el(z,Dr)||el(z,fn)||el(z,Jo)||el(z,Iu)||el(z,ds)||el(z,la(Jt))?new kn(z,l,m,v,A):n.error(`Type ${Vr(z)} is not interpolatable.`)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const m=this.input.evaluate(t);if(m<=n[0])return l[0].evaluate(t);const v=n.length;if(m>=n[v-1])return l[v-1].evaluate(t);const w=Ro(n,m),A=kn.interpolationFactor(this.interpolation,m,n[w],n[w+1]),z=l[w].evaluate(t),j=l[w+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Za(z,j,A);case"color":return Ui.interpolate(z,j,A);case"padding":return an.interpolate(z,j,A);case"colorArray":return Bn.interpolate(z,j,A);case"numberArray":return Jr.interpolate(z,j,A);case"variableAnchorOffsetCollection":return Vi.interpolate(z,j,A);case"array":return Es(z,j,A);case"projectionDefinition":return Oi.interpolate(z,j,A)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ui.interpolate(z,j,A,"hcl");case"colorArray":return Bn.interpolate(z,j,A,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ui.interpolate(z,j,A,"lab");case"colorArray":return Bn.interpolate(z,j,A,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function _c(a,t,n,l){const m=l-n,v=a-n;return m===0?0:t===1?v/m:(Math.pow(t,v)-1)/(Math.pow(t,m)-1)}const ts={color:Ui.interpolate,number:Za,padding:an.interpolate,numberArray:Jr.interpolate,colorArray:Bn.interpolate,variableAnchorOffsetCollection:Vi.interpolate,array:Es};class Ma{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let l=null;const m=n.expectedType;m&&m.kind!=="value"&&(l=m);const v=[];for(const A of t.slice(1)){const z=n.parse(A,1+v.length,l,void 0,{typeAnnotation:"omit"});if(!z)return null;l=l||z.type,v.push(z)}if(!l)throw new Error("No output type");const w=m&&v.some(A=>Er(m,A.type));return new Ma(w?Zi:l,v)}evaluate(t){let n,l=null,m=0;for(const v of this.args)if(m++,l=v.evaluate(t),l&&l instanceof ua&&!l.available&&(n||(n=l.name),l=null,m===this.args.length&&(l=n)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Uu(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function xc(a,t,n,l){return l.compare(t,n)===0}function nu(a,t,n){const l=a!=="=="&&a!=="!=";return class A_{constructor(v,w,A){this.type=Mi,this.lhs=v,this.rhs=w,this.collator=A,this.hasUntypedArgument=v.type.kind==="value"||w.type.kind==="value"}static parse(v,w){if(v.length!==3&&v.length!==4)return w.error("Expected two or three arguments.");const A=v[0];let z=w.parse(v[1],1,Zi);if(!z)return null;if(!Uu(A,z.type))return w.concat(1).error(`"${A}" comparisons are not supported for type '${Vr(z.type)}'.`);let j=w.parse(v[2],2,Zi);if(!j)return null;if(!Uu(A,j.type))return w.concat(2).error(`"${A}" comparisons are not supported for type '${Vr(j.type)}'.`);if(z.type.kind!==j.type.kind&&z.type.kind!=="value"&&j.type.kind!=="value")return w.error(`Cannot compare types '${Vr(z.type)}' and '${Vr(j.type)}'.`);l&&(z.type.kind==="value"&&j.type.kind!=="value"?z=new ha(j.type,[z]):z.type.kind!=="value"&&j.type.kind==="value"&&(j=new ha(z.type,[j])));let G=null;if(v.length===4){if(z.type.kind!=="string"&&j.type.kind!=="string"&&z.type.kind!=="value"&&j.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(G=w.parse(v[3],3,Qo),!G)return null}return new A_(z,j,G)}evaluate(v){const w=this.lhs.evaluate(v),A=this.rhs.evaluate(v);if(l&&this.hasUntypedArgument){const z=Li(w),j=Li(A);if(z.kind!==j.kind||z.kind!=="string"&&z.kind!=="number")throw new kr(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${z.kind}, ${j.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const z=Li(w),j=Li(A);if(z.kind!=="string"||j.kind!=="string")return t(v,w,A)}return this.collator?n(v,w,A,this.collator.evaluate(v)):t(v,w,A)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const Eh=nu("==",function(a,t,n){return t===n},xc),bd=nu("!=",function(a,t,n){return t!==n},function(a,t,n,l){return!xc(0,t,n,l)}),tf=nu("<",function(a,t,n){return t<n},function(a,t,n,l){return l.compare(t,n)<0}),rf=nu(">",function(a,t,n){return t>n},function(a,t,n,l){return l.compare(t,n)>0}),nf=nu("<=",function(a,t,n){return t<=n},function(a,t,n,l){return l.compare(t,n)<=0}),kh=nu(">=",function(a,t,n){return t>=n},function(a,t,n,l){return l.compare(t,n)>=0});class Ph{constructor(t,n,l){this.type=Qo,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");const m=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Mi);if(!m)return null;const v=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Mi);if(!v)return null;let w=null;return l.locale&&(w=n.parse(l.locale,1,Fi),!w)?null:new Ph(m,v,w)}evaluate(t){return new Do(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class jl{constructor(t,n,l,m,v){this.type=Fi,this.number=t,this.locale=n,this.currency=l,this.minFractionDigits=m,this.maxFractionDigits=v}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const l=n.parse(t[1],1,Jt);if(!l)return null;const m=t[2];if(typeof m!="object"||Array.isArray(m))return n.error("NumberFormat options argument must be an object.");let v=null;if(m.locale&&(v=n.parse(m.locale,1,Fi),!v))return null;let w=null;if(m.currency&&(w=n.parse(m.currency,1,Fi),!w))return null;let A=null;if(m["min-fraction-digits"]&&(A=n.parse(m["min-fraction-digits"],1,Jt),!A))return null;let z=null;return m["max-fraction-digits"]&&(z=n.parse(m["max-fraction-digits"],1,Jt),!z)?null:new jl(l,v,w,A,z)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class nl{constructor(t){this.type=Ll,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");const m=[];let v=!1;for(let w=1;w<=t.length-1;++w){const A=t[w];if(v&&typeof A=="object"&&!Array.isArray(A)){v=!1;let z=null;if(A["font-scale"]&&(z=n.parse(A["font-scale"],1,Jt),!z))return null;let j=null;if(A["text-font"]&&(j=n.parse(A["text-font"],1,la(Fi)),!j))return null;let G=null;if(A["text-color"]&&(G=n.parse(A["text-color"],1,Dr),!G))return null;let Y=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!Il.includes(A["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(Y=n.parse(A["vertical-align"],1,Fi),!Y)return null}const ee=m[m.length-1];ee.scale=z,ee.font=j,ee.textColor=G,ee.verticalAlign=Y}else{const z=n.parse(t[w],1,Zi);if(!z)return null;const j=z.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,m.push({content:z,scale:null,font:null,textColor:null,verticalAlign:null})}}return new nl(m)}evaluate(t){return new ca(this.sections.map(n=>{const l=n.content.evaluate(t);return Li(l)===hs?new Bu("",l,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new Bu(An(l),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class wd{constructor(t){this.type=hs,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const l=n.parse(t[1],1,Fi);return l?new wd(l):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),l=ua.fromString(n);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(n)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Vu{constructor(t){this.type=Jt,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=n.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Vr(l.type)} instead.`):new Vu(l):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new kr(`Expected value to be of type string or array, but found ${Vr(Li(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ls=8192;function vc(a,t){const n=(180+a[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,m=Math.pow(2,t.z);return[Math.round(n*m*Ls),Math.round(l*m*Ls)]}function Gu(a,t){const n=Math.pow(2,t.z);return[(m=(a[0]/Ls+t.x)/n,360*m-180),(l=(a[1]/Ls+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,m}function bc(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function Io(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function _p(a,t,n){const l=a[0]-t[0],m=a[1]-t[1],v=a[0]-n[0],w=a[1]-n[1];return l*w-v*m==0&&l*v<=0&&m*w<=0}function $u(a,t,n,l){return(m=[l[0]-n[0],l[1]-n[1]])[0]*(v=[t[0]-a[0],t[1]-a[1]])[1]-m[1]*v[0]!=0&&!(!qu(a,t,n,l)||!qu(n,l,a,t));var m,v}function zh(a,t,n){for(const l of n)for(let m=0;m<l.length-1;++m)if($u(a,t,l[m],l[m+1]))return!0;return!1}function al(a,t,n=!1){let l=!1;for(const A of t)for(let z=0;z<A.length-1;z++){if(_p(a,A[z],A[z+1]))return n;(v=A[z])[1]>(m=a)[1]!=(w=A[z+1])[1]>m[1]&&m[0]<(w[0]-v[0])*(m[1]-v[1])/(w[1]-v[1])+v[0]&&(l=!l)}var m,v,w;return l}function Hu(a,t){for(const n of t)if(al(a,n))return!0;return!1}function sl(a,t){for(const n of a)if(!al(n,t))return!1;for(let n=0;n<a.length-1;++n)if(zh(a[n],a[n+1],t))return!1;return!0}function Zu(a,t){for(const n of t)if(sl(a,n))return!0;return!1}function qu(a,t,n,l){const m=l[0]-n[0],v=l[1]-n[1],w=(a[0]-n[0])*v-m*(a[1]-n[1]),A=(t[0]-n[0])*v-m*(t[1]-n[1]);return w>0&&A<0||w<0&&A>0}function ol(a,t,n){const l=[];for(let m=0;m<a.length;m++){const v=[];for(let w=0;w<a[m].length;w++){const A=vc(a[m][w],n);bc(t,A),v.push(A)}l.push(v)}return l}function ll(a,t,n){const l=[];for(let m=0;m<a.length;m++){const v=ol(a[m],t,n);l.push(v)}return l}function Sd(a,t,n,l){if(a[0]<n[0]||a[0]>n[2]){const m=.5*l;let v=a[0]-n[0]>m?-l:n[0]-a[0]>m?l:0;v===0&&(v=a[0]-n[2]>m?-l:n[2]-a[0]>m?l:0),a[0]+=v}bc(t,a)}function Js(a,t,n,l){const m=Math.pow(2,l.z)*Ls,v=[l.x*Ls,l.y*Ls],w=[];for(const A of a)for(const z of A){const j=[z.x+v[0],z.y+v[1]];Sd(j,t,n,m),w.push(j)}return w}function Xu(a,t,n,l){const m=Math.pow(2,l.z)*Ls,v=[l.x*Ls,l.y*Ls],w=[];for(const z of a){const j=[];for(const G of z){const Y=[G.x+v[0],G.y+v[1]];bc(t,Y),j.push(Y)}w.push(j)}if(t[2]-t[0]<=m/2){(A=t)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const z of w)for(const j of z)Sd(j,t,n,m)}var A;return w}class gs{constructor(t,n){this.type=Mi,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ps(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const m=[];for(const v of l.features){const{type:w,coordinates:A}=v.geometry;w==="Polygon"&&m.push(A),w==="MultiPolygon"&&m.push(...A)}if(m.length)return new gs(l,{type:"MultiPolygon",coordinates:m})}else if(l.type==="Feature"){const m=l.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new gs(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new gs(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,l){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=n.canonicalID();if(l.type==="Polygon"){const A=ol(l.coordinates,v,w),z=Js(n.geometry(),m,v,w);if(!Io(m,v))return!1;for(const j of z)if(!al(j,A))return!1}if(l.type==="MultiPolygon"){const A=ll(l.coordinates,v,w),z=Js(n.geometry(),m,v,w);if(!Io(m,v))return!1;for(const j of z)if(!Hu(j,A))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,l){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=n.canonicalID();if(l.type==="Polygon"){const A=ol(l.coordinates,v,w),z=Xu(n.geometry(),m,v,w);if(!Io(m,v))return!1;for(const j of z)if(!sl(j,A))return!1}if(l.type==="MultiPolygon"){const A=ll(l.coordinates,v,w),z=Xu(n.geometry(),m,v,w);if(!Io(m,v))return!1;for(const j of z)if(!Zu(j,A))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let wc=class{constructor(a=[],t=(n,l)=>n<l?-1:n>l?1:0){if(this.data=a,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:t,compare:n}=this,l=t[a];for(;a>0;){const m=a-1>>1,v=t[m];if(n(l,v)>=0)break;t[a]=v,a=m}t[a]=l}_down(a){const{data:t,compare:n}=this,l=this.length>>1,m=t[a];for(;a<l;){let v=1+(a<<1);const w=v+1;if(w<this.length&&n(t[w],t[v])<0&&(v=w),n(t[v],m)>=0)break;t[a]=t[v],a=v}t[a]=m}};function Lh(a,t,n=0,l=a.length-1,m=Td){for(;l>n;){if(l-n>600){const z=l-n+1,j=t-n+1,G=Math.log(z),Y=.5*Math.exp(2*G/3),ee=.5*Math.sqrt(G*Y*(z-Y)/z)*(j-z/2<0?-1:1);Lh(a,t,Math.max(n,Math.floor(t-j*Y/z+ee)),Math.min(l,Math.floor(t+(z-j)*Y/z+ee)),m)}const v=a[t];let w=n,A=l;for(Bl(a,n,t),m(a[l],v)>0&&Bl(a,n,l);w<A;){for(Bl(a,w,A),w++,A--;m(a[w],v)<0;)w++;for(;m(a[A],v)>0;)A--}m(a[n],v)===0?Bl(a,n,A):(A++,Bl(a,A,l)),A<=t&&(n=A+1),t<=A&&(l=A-1)}}function Bl(a,t,n){const l=a[t];a[t]=a[n],a[n]=l}function Td(a,t){return a<t?-1:a>t?1:0}function Dh(a,t){if(a.length<=1)return[a];const n=[];let l,m;for(const v of a){const w=xp(v);w!==0&&(v.area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(l&&n.push(l),l=[v]):l.push(v))}if(l&&n.push(l),t>1)for(let v=0;v<n.length;v++)n[v].length<=t||(Lh(n[v],t,1,n[v].length-1,af),n[v]=n[v].slice(0,t));return n}function af(a,t){return t.area-a.area}function xp(a){let t=0;for(let n,l,m=0,v=a.length,w=v-1;m<v;w=m++)n=a[m],l=a[w],t+=(l.x-n.x)*(n.y+l.y);return t}const pa=1/298.257223563,au=pa*(2-pa),Md=Math.PI/180;class Rh{constructor(t){const n=6378.137*Md*1e3,l=Math.cos(t*Md),m=1/(1-au*(1-l*l)),v=Math.sqrt(m);this.kx=n*v*l,this.ky=n*v*m*(1-au)}distance(t,n){const l=this.wrap(t[0]-n[0])*this.kx,m=(t[1]-n[1])*this.ky;return Math.sqrt(l*l+m*m)}pointOnLine(t,n){let l,m,v,w,A=1/0;for(let z=0;z<t.length-1;z++){let j=t[z][0],G=t[z][1],Y=this.wrap(t[z+1][0]-j)*this.kx,ee=(t[z+1][1]-G)*this.ky,ae=0;Y===0&&ee===0||(ae=(this.wrap(n[0]-j)*this.kx*Y+(n[1]-G)*this.ky*ee)/(Y*Y+ee*ee),ae>1?(j=t[z+1][0],G=t[z+1][1]):ae>0&&(j+=Y/this.kx*ae,G+=ee/this.ky*ae)),Y=this.wrap(n[0]-j)*this.kx,ee=(n[1]-G)*this.ky;const ue=Y*Y+ee*ee;ue<A&&(A=ue,l=j,m=G,v=z,w=ae)}return{point:[l,m],index:v,t:Math.max(0,Math.min(1,w))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function sr(a,t){return t[0]-a[0]}function Yu(a){return a[1]-a[0]+1}function Ds(a,t){return a[1]>=a[0]&&a[1]<t}function Cd(a,t){if(a[0]>a[1])return[null,null];const n=Yu(a);if(t){if(n===2)return[a,null];const m=Math.floor(n/2);return[[a[0],a[0]+m],[a[0]+m,a[1]]]}if(n===1)return[a,null];const l=Math.floor(n/2)-1;return[[a[0],a[0]+l],[a[0]+l+1,a[1]]]}function Nl(a,t){if(!Ds(t,a.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)bc(n,a[l]);return n}function Fl(a){const t=[1/0,1/0,-1/0,-1/0];for(const n of a)for(const l of n)bc(t,l);return t}function su(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Wu(a,t,n){if(!su(a)||!su(t))return NaN;let l=0,m=0;return a[2]<t[0]&&(l=t[0]-a[2]),a[0]>t[2]&&(l=a[0]-t[2]),a[1]>t[3]&&(m=a[1]-t[3]),a[3]<t[1]&&(m=t[1]-a[3]),n.distance([0,0],[l,m])}function cl(a,t,n){const l=n.pointOnLine(t,a);return n.distance(a,l.point)}function ul(a,t,n,l,m){const v=Math.min(cl(a,[n,l],m),cl(t,[n,l],m)),w=Math.min(cl(n,[a,t],m),cl(l,[a,t],m));return Math.min(v,w)}function eo(a,t,n,l,m){if(!Ds(t,a.length)||!Ds(l,n.length))return 1/0;let v=1/0;for(let w=t[0];w<t[1];++w){const A=a[w],z=a[w+1];for(let j=l[0];j<l[1];++j){const G=n[j],Y=n[j+1];if($u(A,z,G,Y))return 0;v=Math.min(v,ul(A,z,G,Y,m))}}return v}function hl(a,t,n,l,m){if(!Ds(t,a.length)||!Ds(l,n.length))return NaN;let v=1/0;for(let w=t[0];w<=t[1];++w)for(let A=l[0];A<=l[1];++A)if(v=Math.min(v,m.distance(a[w],n[A])),v===0)return v;return v}function vp(a,t,n){if(al(a,t,!0))return 0;let l=1/0;for(const m of t){const v=m[0],w=m[m.length-1];if(v!==w&&(l=Math.min(l,cl(a,[w,v],n)),l===0))return l;const A=n.pointOnLine(m,a);if(l=Math.min(l,n.distance(a,A.point)),l===0)return l}return l}function Sc(a,t,n,l){if(!Ds(t,a.length))return NaN;for(let v=t[0];v<=t[1];++v)if(al(a[v],n,!0))return 0;let m=1/0;for(let v=t[0];v<t[1];++v){const w=a[v],A=a[v+1];for(const z of n)for(let j=0,G=z.length,Y=G-1;j<G;Y=j++){const ee=z[Y],ae=z[j];if($u(w,A,ee,ae))return 0;m=Math.min(m,ul(w,A,ee,ae,l))}}return m}function Ad(a,t){for(const n of a)for(const l of n)if(al(l,t,!0))return!0;return!1}function bp(a,t,n,l=1/0){const m=Fl(a),v=Fl(t);if(l!==1/0&&Wu(m,v,n)>=l)return l;if(Io(m,v)){if(Ad(a,t))return 0}else if(Ad(t,a))return 0;let w=1/0;for(const A of a)for(let z=0,j=A.length,G=j-1;z<j;G=z++){const Y=A[G],ee=A[z];for(const ae of t)for(let ue=0,fe=ae.length,we=fe-1;ue<fe;we=ue++){const Pe=ae[we],et=ae[ue];if($u(Y,ee,Pe,et))return 0;w=Math.min(w,ul(Y,ee,Pe,et,n))}}return w}function Ed(a,t,n,l,m,v){if(!v)return;const w=Wu(Nl(l,v),m,n);w<t&&a.push([w,v,[0,0]])}function Tc(a,t,n,l,m,v,w){if(!v||!w)return;const A=Wu(Nl(l,v),Nl(m,w),n);A<t&&a.push([A,v,w])}function ou(a,t,n,l,m=1/0){let v=Math.min(l.distance(a[0],n[0][0]),m);if(v===0)return v;const w=new wc([[0,[0,a.length-1],[0,0]]],sr),A=Fl(n);for(;w.length>0;){const z=w.pop();if(z[0]>=v)continue;const j=z[1],G=t?50:100;if(Yu(j)<=G){if(!Ds(j,a.length))return NaN;if(t){const Y=Sc(a,j,n,l);if(isNaN(Y)||Y===0)return Y;v=Math.min(v,Y)}else for(let Y=j[0];Y<=j[1];++Y){const ee=vp(a[Y],n,l);if(v=Math.min(v,ee),v===0)return 0}}else{const Y=Cd(j,t);Ed(w,v,l,a,A,Y[0]),Ed(w,v,l,a,A,Y[1])}}return v}function Ih(a,t,n,l,m,v=1/0){let w=Math.min(v,m.distance(a[0],n[0]));if(w===0)return w;const A=new wc([[0,[0,a.length-1],[0,n.length-1]]],sr);for(;A.length>0;){const z=A.pop();if(z[0]>=w)continue;const j=z[1],G=z[2],Y=t?50:100,ee=l?50:100;if(Yu(j)<=Y&&Yu(G)<=ee){if(!Ds(j,a.length)&&Ds(G,n.length))return NaN;let ae;if(t&&l)ae=eo(a,j,n,G,m),w=Math.min(w,ae);else if(t&&!l){const ue=a.slice(j[0],j[1]+1);for(let fe=G[0];fe<=G[1];++fe)if(ae=cl(n[fe],ue,m),w=Math.min(w,ae),w===0)return w}else if(!t&&l){const ue=n.slice(G[0],G[1]+1);for(let fe=j[0];fe<=j[1];++fe)if(ae=cl(a[fe],ue,m),w=Math.min(w,ae),w===0)return w}else ae=hl(a,j,n,G,m),w=Math.min(w,ae)}else{const ae=Cd(j,t),ue=Cd(G,l);Tc(A,w,m,a,n,ae[0],ue[0]),Tc(A,w,m,a,n,ae[0],ue[1]),Tc(A,w,m,a,n,ae[1],ue[0]),Tc(A,w,m,a,n,ae[1],ue[1])}}return w}function Mc(a){return a.type==="MultiPolygon"?a.coordinates.map(t=>({type:"Polygon",coordinates:t})):a.type==="MultiLineString"?a.coordinates.map(t=>({type:"LineString",coordinates:t})):a.type==="MultiPoint"?a.coordinates.map(t=>({type:"Point",coordinates:t})):[a]}class Oo{constructor(t,n){this.type=Jt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ps(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new Oo(l,l.features.map(m=>Mc(m.geometry)).flat());if(l.type==="Feature")return new Oo(l,Mc(l.geometry));if("type"in l&&"coordinates"in l)return new Oo(l,Mc(l))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,l){const m=n.geometry(),v=m.flat().map(z=>Gu([z.x,z.y],n.canonical));if(m.length===0)return NaN;const w=new Rh(v[0][1]);let A=1/0;for(const z of l){switch(z.type){case"Point":A=Math.min(A,Ih(v,!1,[z.coordinates],!1,w,A));break;case"LineString":A=Math.min(A,Ih(v,!1,z.coordinates,!0,w,A));break;case"Polygon":A=Math.min(A,ou(v,!1,z.coordinates,w,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,l){const m=n.geometry(),v=m.flat().map(z=>Gu([z.x,z.y],n.canonical));if(m.length===0)return NaN;const w=new Rh(v[0][1]);let A=1/0;for(const z of l){switch(z.type){case"Point":A=Math.min(A,Ih(v,!0,[z.coordinates],!1,w,A));break;case"LineString":A=Math.min(A,Ih(v,!0,z.coordinates,!0,w,A));break;case"Polygon":A=Math.min(A,ou(v,!0,z.coordinates,w,A))}if(A===0)return A}return A}(t,this.geometries);if(t.geometryType()==="Polygon")return function(n,l){const m=n.geometry();if(m.length===0||m[0].length===0)return NaN;const v=Dh(m,0).map(z=>z.map(j=>j.map(G=>Gu([G.x,G.y],n.canonical)))),w=new Rh(v[0][0][0][1]);let A=1/0;for(const z of l)for(const j of v){switch(z.type){case"Point":A=Math.min(A,ou([z.coordinates],!1,j,w,A));break;case"LineString":A=Math.min(A,ou(z.coordinates,!0,j,w,A));break;case"Polygon":A=Math.min(A,bp(j,z.coordinates,w,A))}if(A===0)return A}return A}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Cc{constructor(t){this.type=Zi,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=t[1];return l==null?n.error("Global state property must be defined."):typeof l!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new Cc(l)}evaluate(t){var n;const l=(n=t.globals)===null||n===void 0?void 0:n.globalState;return l&&Object.keys(l).length!==0?ar(l,this.key):null}eachChild(){}outputDefined(){return!1}}const fa={"==":Eh,"!=":bd,">":rf,"<":tf,">=":kh,"<=":nf,array:ha,at:Vn,boolean:ha,case:Nn,coalesce:Ma,collator:Ph,format:nl,image:wd,in:sn,"index-of":Ta,interpolate:kn,"interpolate-hcl":kn,"interpolate-lab":kn,length:Vu,let:tu,literal:En,match:yc,number:ha,"number-format":jl,object:ha,slice:iu,step:ru,string:ha,"to-boolean":da,"to-color":da,"to-number":da,"to-string":da,var:Ks,within:gs,distance:Oo,"global-state":Cc};class ma{constructor(t,n,l,m){this.name=t,this.type=n,this._evaluate=l,this.args=m}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const l=t[0],m=ma.definitions[l];if(!m)return n.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(m)?m[0]:m.type,w=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,A=w.filter(([j])=>!Array.isArray(j)||j.length===t.length-1);let z=null;for(const[j,G]of A){z=new Ol(n.registry,Aa,n.path,null,n.scope);const Y=[];let ee=!1;for(let ae=1;ae<t.length;ae++){const ue=t[ae],fe=Array.isArray(j)?j[ae-1]:j.type,we=z.parse(ue,1+Y.length,fe);if(!we){ee=!0;break}Y.push(we)}if(!ee)if(Array.isArray(j)&&j.length!==Y.length)z.error(`Expected ${j.length} arguments, but found ${Y.length} instead.`);else{for(let ae=0;ae<Y.length;ae++){const ue=Array.isArray(j)?j[ae]:j.type,fe=Y[ae];z.concat(ae+1).checkSubtype(ue,fe.type)}if(z.errors.length===0)return new ma(l,v,G,Y)}}if(A.length===1)n.errors.push(...z.errors);else{const j=(A.length?A:w).map(([Y])=>{return ee=Y,Array.isArray(ee)?`(${ee.map(Vr).join(", ")})`:`(${Vr(ee.type)}...)`;var ee}).join(" | "),G=[];for(let Y=1;Y<t.length;Y++){const ee=n.parse(t[Y],1+G.length);if(!ee)return null;G.push(Vr(ee.type))}n.error(`Expected arguments of type ${j}, but found (${G.join(", ")}) instead.`)}return null}static register(t,n){ma.definitions=n;for(const l in n)t[l]=ma}}function ys(a,[t,n,l,m]){t=t.evaluate(a),n=n.evaluate(a),l=l.evaluate(a);const v=m?m.evaluate(a):1,w=Gi(t,n,l,v);if(w)throw new kr(w);return new Ui(t/255,n/255,l/255,v,!1)}function Ca(a,t){return a in t}function Ul(a,t){const n=t[a];return n===void 0?null:n}function dl(a){return{type:a}}function Aa(a){if(a instanceof Ks)return Aa(a.boundExpression);if(a instanceof ma&&a.name==="error"||a instanceof Ph||a instanceof gs||a instanceof Oo||a instanceof Cc)return!1;const t=a instanceof da||a instanceof ha;let n=!0;return a.eachChild(l=>{n=t?n&&Aa(l):n&&l instanceof En}),!!n&&Rs(a)&&Is(a,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Rs(a){if(a instanceof ma&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof gs||a instanceof Oo)return!1;let t=!0;return a.eachChild(n=>{t&&!Rs(n)&&(t=!1)}),t}function Ac(a){if(a instanceof ma&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(n=>{t&&!Ac(n)&&(t=!1)}),t}function Is(a,t){if(a instanceof ma&&t.indexOf(a.name)>=0)return!1;let n=!0;return a.eachChild(l=>{n&&!Is(l,t)&&(n=!1)}),n}function kd(a){return{result:"success",value:a}}function to(a){return{result:"error",value:a}}function io(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Pd(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Ea(a){return!!a.expression&&a.expression.interpolated}function ir(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ga(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)&&Li(a)===wa}function qa(a){return a}function Ar(a,t){const n=a.stops&&typeof a.stops[0][0]=="object",l=n||!(n||a.property!==void 0),m=a.type||(Ea(t)?"exponential":"interval"),v=function(G){switch(G.type){case"color":return Ui.parse;case"padding":return an.parse;case"numberArray":return Jr.parse;case"colorArray":return Bn.parse;default:return null}}(t);if(v&&((a=Cn({},a)).stops&&(a.stops=a.stops.map(G=>[G[0],v(G[1])])),a.default=v(a.default?a.default:t.default)),a.colorSpace&&(w=a.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var w;const A=function(G){switch(G){case"exponential":return jo;case"interval":return Ku;case"categorical":return Oh;case"identity":return Rr;default:throw new Error(`Unknown function type "${G}"`)}}(m);let z,j;if(m==="categorical"){z=Object.create(null);for(const G of a.stops)z[G[0]]=G[1];j=typeof a.stops[0][0]}if(n){const G={},Y=[];for(let ue=0;ue<a.stops.length;ue++){const fe=a.stops[ue],we=fe[0].zoom;G[we]===void 0&&(G[we]={zoom:we,type:a.type,property:a.property,default:a.default,stops:[]},Y.push(we)),G[we].stops.push([fe[0].value,fe[1]])}const ee=[];for(const ue of Y)ee.push([G[ue].zoom,Ar(G[ue],t)]);const ae={name:"linear"};return{kind:"composite",interpolationType:ae,interpolationFactor:kn.interpolationFactor.bind(void 0,ae),zoomStops:ee.map(ue=>ue[0]),evaluate:({zoom:ue},fe)=>jo({stops:ee,base:a.base},t,ue).evaluate(ue,fe)}}if(l){const G=m==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:G,interpolationFactor:kn.interpolationFactor.bind(void 0,G),zoomStops:a.stops.map(Y=>Y[0]),evaluate:({zoom:Y})=>A(a,t,Y,z,j)}}return{kind:"source",evaluate(G,Y){const ee=Y&&Y.properties?Y.properties[a.property]:void 0;return ee===void 0?ro(a.default,t.default):A(a,t,ee,z,j)}}}function ro(a,t,n){return a!==void 0?a:t!==void 0?t:n!==void 0?n:void 0}function Oh(a,t,n,l,m){return ro(typeof n===m?l[n]:void 0,a.default,t.default)}function Ku(a,t,n){if(ir(n)!=="number")return ro(a.default,t.default);const l=a.stops.length;if(l===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[l-1][0])return a.stops[l-1][1];const m=Ro(a.stops.map(v=>v[0]),n);return a.stops[m][1]}function jo(a,t,n){const l=a.base!==void 0?a.base:1;if(ir(n)!=="number")return ro(a.default,t.default);const m=a.stops.length;if(m===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[m-1][0])return a.stops[m-1][1];const v=Ro(a.stops.map(G=>G[0]),n),w=function(G,Y,ee,ae){const ue=ae-ee,fe=G-ee;return ue===0?0:Y===1?fe/ue:(Math.pow(Y,fe)-1)/(Math.pow(Y,ue)-1)}(n,l,a.stops[v][0],a.stops[v+1][0]),A=a.stops[v][1],z=a.stops[v+1][1],j=ts[t.type]||qa;return typeof A.evaluate=="function"?{evaluate(...G){const Y=A.evaluate.apply(void 0,G),ee=z.evaluate.apply(void 0,G);if(Y!==void 0&&ee!==void 0)return j(Y,ee,w,a.colorSpace)}}:j(A,z,w,a.colorSpace)}function Rr(a,t,n){switch(t.type){case"color":n=Ui.parse(n);break;case"formatted":n=ca.fromString(n.toString());break;case"resolvedImage":n=ua.fromString(n.toString());break;case"padding":n=an.parse(n);break;case"colorArray":n=Bn.parse(n);break;case"numberArray":n=Jr.parse(n);break;default:ir(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return ro(n,a.default,t.default)}ma.register(fa,{error:[{kind:"error"},[Fi],(a,[t])=>{throw new kr(t.evaluate(a))}],typeof:[Fi,[Zi],(a,[t])=>Vr(Li(t.evaluate(a)))],"to-rgba":[la(Jt,4),[Dr],(a,[t])=>{const[n,l,m,v]=t.evaluate(a).rgb;return[255*n,255*l,255*m,v]}],rgb:[Dr,[Jt,Jt,Jt],ys],rgba:[Dr,[Jt,Jt,Jt,Jt],ys],has:{type:Mi,overloads:[[[Fi],(a,[t])=>Ca(t.evaluate(a),a.properties())],[[Fi,wa],(a,[t,n])=>Ca(t.evaluate(a),n.evaluate(a))]]},get:{type:Zi,overloads:[[[Fi],(a,[t])=>Ul(t.evaluate(a),a.properties())],[[Fi,wa],(a,[t,n])=>Ul(t.evaluate(a),n.evaluate(a))]]},"feature-state":[Zi,[Fi],(a,[t])=>Ul(t.evaluate(a),a.featureState||{})],properties:[wa,[],a=>a.properties()],"geometry-type":[Fi,[],a=>a.geometryType()],id:[Zi,[],a=>a.id()],zoom:[Jt,[],a=>a.globals.zoom],"heatmap-density":[Jt,[],a=>a.globals.heatmapDensity||0],elevation:[Jt,[],a=>a.globals.elevation||0],"line-progress":[Jt,[],a=>a.globals.lineProgress||0],accumulated:[Zi,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Jt,dl(Jt),(a,t)=>{let n=0;for(const l of t)n+=l.evaluate(a);return n}],"*":[Jt,dl(Jt),(a,t)=>{let n=1;for(const l of t)n*=l.evaluate(a);return n}],"-":{type:Jt,overloads:[[[Jt,Jt],(a,[t,n])=>t.evaluate(a)-n.evaluate(a)],[[Jt],(a,[t])=>-t.evaluate(a)]]},"/":[Jt,[Jt,Jt],(a,[t,n])=>t.evaluate(a)/n.evaluate(a)],"%":[Jt,[Jt,Jt],(a,[t,n])=>t.evaluate(a)%n.evaluate(a)],ln2:[Jt,[],()=>Math.LN2],pi:[Jt,[],()=>Math.PI],e:[Jt,[],()=>Math.E],"^":[Jt,[Jt,Jt],(a,[t,n])=>Math.pow(t.evaluate(a),n.evaluate(a))],sqrt:[Jt,[Jt],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[Jt,[Jt],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[Jt,[Jt],(a,[t])=>Math.log(t.evaluate(a))],log2:[Jt,[Jt],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[Jt,[Jt],(a,[t])=>Math.sin(t.evaluate(a))],cos:[Jt,[Jt],(a,[t])=>Math.cos(t.evaluate(a))],tan:[Jt,[Jt],(a,[t])=>Math.tan(t.evaluate(a))],asin:[Jt,[Jt],(a,[t])=>Math.asin(t.evaluate(a))],acos:[Jt,[Jt],(a,[t])=>Math.acos(t.evaluate(a))],atan:[Jt,[Jt],(a,[t])=>Math.atan(t.evaluate(a))],min:[Jt,dl(Jt),(a,t)=>Math.min(...t.map(n=>n.evaluate(a)))],max:[Jt,dl(Jt),(a,t)=>Math.max(...t.map(n=>n.evaluate(a)))],abs:[Jt,[Jt],(a,[t])=>Math.abs(t.evaluate(a))],round:[Jt,[Jt],(a,[t])=>{const n=t.evaluate(a);return n<0?-Math.round(-n):Math.round(n)}],floor:[Jt,[Jt],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[Jt,[Jt],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[Mi,[Fi,Zi],(a,[t,n])=>a.properties()[t.value]===n.value],"filter-id-==":[Mi,[Zi],(a,[t])=>a.id()===t.value],"filter-type-==":[Mi,[Fi],(a,[t])=>a.geometryType()===t.value],"filter-<":[Mi,[Fi,Zi],(a,[t,n])=>{const l=a.properties()[t.value],m=n.value;return typeof l==typeof m&&l<m}],"filter-id-<":[Mi,[Zi],(a,[t])=>{const n=a.id(),l=t.value;return typeof n==typeof l&&n<l}],"filter->":[Mi,[Fi,Zi],(a,[t,n])=>{const l=a.properties()[t.value],m=n.value;return typeof l==typeof m&&l>m}],"filter-id->":[Mi,[Zi],(a,[t])=>{const n=a.id(),l=t.value;return typeof n==typeof l&&n>l}],"filter-<=":[Mi,[Fi,Zi],(a,[t,n])=>{const l=a.properties()[t.value],m=n.value;return typeof l==typeof m&&l<=m}],"filter-id-<=":[Mi,[Zi],(a,[t])=>{const n=a.id(),l=t.value;return typeof n==typeof l&&n<=l}],"filter->=":[Mi,[Fi,Zi],(a,[t,n])=>{const l=a.properties()[t.value],m=n.value;return typeof l==typeof m&&l>=m}],"filter-id->=":[Mi,[Zi],(a,[t])=>{const n=a.id(),l=t.value;return typeof n==typeof l&&n>=l}],"filter-has":[Mi,[Zi],(a,[t])=>t.value in a.properties()],"filter-has-id":[Mi,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Mi,[la(Fi)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[Mi,[la(Zi)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[Mi,[Fi,la(Zi)],(a,[t,n])=>n.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[Mi,[Fi,la(Zi)],(a,[t,n])=>function(l,m,v,w){for(;v<=w;){const A=v+w>>1;if(m[A]===l)return!0;m[A]>l?w=A-1:v=A+1}return!1}(a.properties()[t.value],n.value,0,n.value.length-1)],all:{type:Mi,overloads:[[[Mi,Mi],(a,[t,n])=>t.evaluate(a)&&n.evaluate(a)],[dl(Mi),(a,t)=>{for(const n of t)if(!n.evaluate(a))return!1;return!0}]]},any:{type:Mi,overloads:[[[Mi,Mi],(a,[t,n])=>t.evaluate(a)||n.evaluate(a)],[dl(Mi),(a,t)=>{for(const n of t)if(n.evaluate(a))return!0;return!1}]]},"!":[Mi,[Mi],(a,[t])=>!t.evaluate(a)],"is-supported-script":[Mi,[Fi],(a,[t])=>{const n=a.globals&&a.globals.isSupportedScript;return!n||n(t.evaluate(a))}],upcase:[Fi,[Fi],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[Fi,[Fi],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[Fi,dl(Zi),(a,t)=>t.map(n=>An(n.evaluate(a))).join("")],"resolved-locale":[Fi,[Qo],(a,[t])=>t.evaluate(a).resolvedLocale()]});class Vl{constructor(t,n){this.expression=t,this._warningHistory={},this._evaluator=new il,this._defaultValue=n?function(l){if(l.type==="color"&&ga(l.default))return new Ui(0,0,0,0);switch(l.type){case"color":return Ui.parse(l.default)||null;case"padding":return an.parse(l.default)||null;case"numberArray":return Jr.parse(l.default)||null;case"colorArray":return Bn.parse(l.default)||null;case"variableAnchorOffsetCollection":return Vi.parse(l.default)||null;case"projectionDefinition":return Oi.parse(l.default)||null;default:return l.default===void 0?null:l.default}}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,l,m,v,w){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=m,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(t,n,l,m,v,w){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=m,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new kr(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function Ec(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in fa}function ka(a,t){const n=new Ol(fa,Aa,[],t?function(m){const v={color:Dr,string:Fi,number:Jt,enum:Fi,boolean:Mi,formatted:Ll,padding:fn,numberArray:Jo,colorArray:Iu,projectionDefinition:Qc,resolvedImage:hs,variableAnchorOffsetCollection:ds};return m.type==="array"?la(v[m.value]||Zi,m.length):v[m.type]}(t):void 0),l=n.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?kd(new Vl(l,t)):to(n.errors)}class xi{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!Ac(n.expression),this.globalStateRefs=qi(n.expression)}evaluateWithoutErrorHandling(t,n,l,m,v,w){return this._styleExpression.evaluateWithoutErrorHandling(t,n,l,m,v,w)}evaluate(t,n,l,m,v,w){return this._styleExpression.evaluate(t,n,l,m,v,w)}}class no{constructor(t,n,l,m){this.kind=t,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!Ac(n.expression),this.globalStateRefs=qi(n.expression),this.interpolationType=m}evaluateWithoutErrorHandling(t,n,l,m,v,w){return this._styleExpression.evaluateWithoutErrorHandling(t,n,l,m,v,w)}evaluate(t,n,l,m,v,w){return this._styleExpression.evaluate(t,n,l,m,v,w)}interpolationFactor(t,n,l){return this.interpolationType?kn.interpolationFactor(this.interpolationType,t,n,l):0}}function is(a,t){const n=ka(a,t);if(n.result==="error")return n;const l=n.value.expression,m=Rs(l);if(!m&&!io(t))return to([new Ur("","data expressions not supported")]);const v=Is(l,["zoom"]);if(!v&&!Pd(t))return to([new Ur("","zoom expressions not supported")]);const w=Xa(l);return w||v?w instanceof Ur?to([w]):w instanceof kn&&!Ea(t)?to([new Ur("",'"interpolate" expressions cannot be used with this property')]):kd(w?new no(m?"camera":"composite",n.value,w.labels,w instanceof kn?w.interpolation:void 0):new xi(m?"constant":"source",n.value)):to([new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class _s{constructor(t,n){this._parameters=t,this._specification=n,Cn(this,Ar(this._parameters,this._specification))}static deserialize(t){return new _s(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Xa(a){let t=null;if(a instanceof tu)t=Xa(a.result);else if(a instanceof Ma){for(const n of a.args)if(t=Xa(n),t)break}else(a instanceof ru||a instanceof kn)&&a.input instanceof ma&&a.input.name==="zoom"&&(t=a);return t instanceof Ur||a.eachChild(n=>{const l=Xa(n);l instanceof Ur?t=l:!t&&l?t=new Ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new Ur("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function qi(a,t=new Set){return a instanceof Cc&&t.add(a.key),a.eachChild(n=>{qi(n,t)}),t}function Bo(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!Bo(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Qu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function xn(a){if(a==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Bo(a)||(a=Ya(a));const t=ka(a,Qu);if(t.result==="error")throw new Error(t.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,l,m)=>t.value.evaluate(n,l,{},m),needGeometry:Mr(a),getGlobalStateRefs:()=>qi(t.value.expression)}}function vn(a,t){return a<t?-1:a>t?1:0}function Mr(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(Mr(a[t]))return!0;return!1}function Ya(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?Os(a[1],a[2],"=="):t==="!="?pl(Os(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Os(a[1],a[2],t):t==="any"?(n=a.slice(1),["any"].concat(n.map(Ya))):t==="all"?["all"].concat(a.slice(1).map(Ya)):t==="none"?["all"].concat(a.slice(1).map(Ya).map(pl)):t==="in"?jh(a[1],a.slice(2)):t==="!in"?pl(jh(a[1],a.slice(2))):t==="has"?Gl(a[1]):t!=="!has"||pl(Gl(a[1]));var n}function Os(a,t,n){switch(a){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,a,t]}}function jh(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",a,["literal",t.sort(vn)]]:["filter-in-small",a,["literal",t]]}}function Gl(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function pl(a){return["!",a]}function Ju(a){const t=typeof a;if(t==="number"||t==="boolean"||t==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let m="[";for(const v of a)m+=`${Ju(v)},`;return`${m}]`}const n=Object.keys(a).sort();let l="{";for(let m=0;m<n.length;m++)l+=`${JSON.stringify(n[m])}:${Ju(a[n[m]])},`;return`${l}}`}function fl(a){let t="";for(const n of ni)t+=`/${Ju(a[n])}`;return t}function lu(a){const t=a.value;return t?[new Wt(a.key,t,"constants have been deprecated as of v8")]:[]}function on(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function js(a){if(Array.isArray(a))return a.map(js);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const n in a)t[n]=js(a[n]);return t}return on(a)}function rs(a){const t=a.key,n=a.value,l=a.valueSpec||{},m=a.objectElementValidators||{},v=a.style,w=a.styleSpec,A=a.validateSpec;let z=[];const j=ir(n);if(j!=="object")return[new Wt(t,n,`object expected, ${j} found`)];for(const G in n){const Y=G.split(".")[0],ee=ar(l,Y)||l["*"];let ae;if(ar(m,Y))ae=m[Y];else if(ar(l,Y))ae=A;else if(m["*"])ae=m["*"];else{if(!l["*"]){z.push(new Wt(t,n[G],`unknown property "${G}"`));continue}ae=A}z=z.concat(ae({key:(t&&`${t}.`)+G,value:n[G],valueSpec:ee,style:v,styleSpec:w,object:n,objectKey:G,validateSpec:A},n))}for(const G in l)m[G]||l[G].required&&l[G].default===void 0&&n[G]===void 0&&z.push(new Wt(t,n,`missing required property "${G}"`));return z}function No(a){const t=a.value,n=a.valueSpec,l=a.style,m=a.styleSpec,v=a.key,w=a.arrayElementValidator||a.validateSpec;if(ir(t)!=="array")return[new Wt(v,t,`array expected, ${ir(t)} found`)];if(n.length&&t.length!==n.length)return[new Wt(v,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new Wt(v,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let A={type:n.value,values:n.values};m.$version<7&&(A.function=n.function),ir(n.value)==="object"&&(A=n.value);let z=[];for(let j=0;j<t.length;j++)z=z.concat(w({array:t,arrayIndex:j,value:t[j],valueSpec:A,validateSpec:a.validateSpec,style:l,styleSpec:m,key:`${v}[${j}]`}));return z}function ns(a){const t=a.key,n=a.value,l=a.valueSpec;let m=ir(n);return m==="number"&&n!=n&&(m="NaN"),m!=="number"?[new Wt(t,n,`number expected, ${m} found`)]:"minimum"in l&&n<l.minimum?[new Wt(t,n,`${n} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&n>l.maximum?[new Wt(t,n,`${n} is greater than the maximum value ${l.maximum}`)]:[]}function xs(a){const t=a.valueSpec,n=on(a.value.type);let l,m,v,w={};const A=n!=="categorical"&&a.value.property===void 0,z=!A,j=ir(a.value.stops)==="array"&&ir(a.value.stops[0])==="array"&&ir(a.value.stops[0][0])==="object",G=rs({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(ae){if(n==="identity")return[new Wt(ae.key,ae.value,'identity function may not have a "stops" property')];let ue=[];const fe=ae.value;return ue=ue.concat(No({key:ae.key,value:fe,valueSpec:ae.valueSpec,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:Y})),ir(fe)==="array"&&fe.length===0&&ue.push(new Wt(ae.key,fe,"array must have at least one stop")),ue},default:function(ae){return ae.validateSpec({key:ae.key,value:ae.value,valueSpec:t,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec})}}});return n==="identity"&&A&&G.push(new Wt(a.key,a.value,'missing required property "property"')),n==="identity"||a.value.stops||G.push(new Wt(a.key,a.value,'missing required property "stops"')),n==="exponential"&&a.valueSpec.expression&&!Ea(a.valueSpec)&&G.push(new Wt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(z&&!io(a.valueSpec)?G.push(new Wt(a.key,a.value,"property functions not supported")):A&&!Pd(a.valueSpec)&&G.push(new Wt(a.key,a.value,"zoom functions not supported"))),n!=="categorical"&&!j||a.value.property!==void 0||G.push(new Wt(a.key,a.value,'"property" property is required')),G;function Y(ae){let ue=[];const fe=ae.value,we=ae.key;if(ir(fe)!=="array")return[new Wt(we,fe,`array expected, ${ir(fe)} found`)];if(fe.length!==2)return[new Wt(we,fe,`array length 2 expected, length ${fe.length} found`)];if(j){if(ir(fe[0])!=="object")return[new Wt(we,fe,`object expected, ${ir(fe[0])} found`)];if(fe[0].zoom===void 0)return[new Wt(we,fe,"object stop key must have zoom")];if(fe[0].value===void 0)return[new Wt(we,fe,"object stop key must have value")];if(v&&v>on(fe[0].zoom))return[new Wt(we,fe[0].zoom,"stop zoom values must appear in ascending order")];on(fe[0].zoom)!==v&&(v=on(fe[0].zoom),m=void 0,w={}),ue=ue.concat(rs({key:`${we}[0]`,value:fe[0],valueSpec:{zoom:{}},validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:ns,value:ee}}))}else ue=ue.concat(ee({key:`${we}[0]`,value:fe[0],validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec},fe));return Ec(js(fe[1]))?ue.concat([new Wt(`${we}[1]`,fe[1],"expressions are not allowed in function stops.")]):ue.concat(ae.validateSpec({key:`${we}[1]`,value:fe[1],valueSpec:t,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec}))}function ee(ae,ue){const fe=ir(ae.value),we=on(ae.value),Pe=ae.value!==null?ae.value:ue;if(l){if(fe!==l)return[new Wt(ae.key,Pe,`${fe} stop domain type must match previous stop domain type ${l}`)]}else l=fe;if(fe!=="number"&&fe!=="string"&&fe!=="boolean")return[new Wt(ae.key,Pe,"stop domain value must be a number, string, or boolean")];if(fe!=="number"&&n!=="categorical"){let et=`number expected, ${fe} found`;return io(t)&&n===void 0&&(et+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Wt(ae.key,Pe,et)]}return n!=="categorical"||fe!=="number"||isFinite(we)&&Math.floor(we)===we?n!=="categorical"&&fe==="number"&&m!==void 0&&we<m?[new Wt(ae.key,Pe,"stop domain values must appear in ascending order")]:(m=we,n==="categorical"&&we in w?[new Wt(ae.key,Pe,"stop domain values must be unique")]:(w[we]=!0,[])):[new Wt(ae.key,Pe,`integer expected, found ${we}`)]}}function as(a){const t=(a.expressionContext==="property"?is:ka)(js(a.value),a.valueSpec);if(t.result==="error")return t.value.map(l=>new Wt(`${a.key}${l.key}`,a.value,l.message));const n=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!n.outputDefined())return[new Wt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Ac(n))return[new Wt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Ac(n))return[new Wt(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Is(n,["zoom","feature-state"]))return[new Wt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Rs(n))return[new Wt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cu(a){const t=a.key,n=a.value,l=ir(n);return l!=="string"?[new Wt(t,n,`color expected, ${l} found`)]:Ui.parse(String(n))?[]:[new Wt(t,n,`color expected, "${n}" found`)]}function $l(a){const t=a.key,n=a.value,l=a.valueSpec,m=[];return Array.isArray(l.values)?l.values.indexOf(on(n))===-1&&m.push(new Wt(t,n,`expected one of [${l.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(l.values).indexOf(on(n))===-1&&m.push(new Wt(t,n,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(n)} found`)),m}function Pa(a){return Bo(js(a.value))?as(Cn({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):eh(a)}function eh(a){const t=a.value,n=a.key;if(ir(t)!=="array")return[new Wt(n,t,`array expected, ${ir(t)} found`)];const l=a.styleSpec;let m,v=[];if(t.length<1)return[new Wt(n,t,"filter array must have at least 1 element")];switch(v=v.concat($l({key:`${n}[0]`,value:t[0],valueSpec:l.filter_operator,style:a.style,styleSpec:a.styleSpec})),on(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&on(t[1])==="$type"&&v.push(new Wt(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&v.push(new Wt(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(m=ir(t[1]),m!=="string"&&v.push(new Wt(`${n}[1]`,t[1],`string expected, ${m} found`)));for(let w=2;w<t.length;w++)m=ir(t[w]),on(t[1])==="$type"?v=v.concat($l({key:`${n}[${w}]`,value:t[w],valueSpec:l.geometry_type,style:a.style,styleSpec:a.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&v.push(new Wt(`${n}[${w}]`,t[w],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let w=1;w<t.length;w++)v=v.concat(eh({key:`${n}[${w}]`,value:t[w],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":m=ir(t[1]),t.length!==2?v.push(new Wt(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):m!=="string"&&v.push(new Wt(`${n}[1]`,t[1],`string expected, ${m} found`))}return v}function Hl(a,t){const n=a.key,l=a.validateSpec,m=a.style,v=a.styleSpec,w=a.value,A=a.objectKey,z=v[`${t}_${a.layerType}`];if(!z)return[];const j=A.match(/^(.*)-transition$/);if(t==="paint"&&j&&z[j[1]]&&z[j[1]].transition)return l({key:n,value:w,valueSpec:v.transition,style:m,styleSpec:v});const G=a.valueSpec||z[A];if(!G)return[new Wt(n,w,`unknown property "${A}"`)];let Y;if(ir(w)==="string"&&io(G)&&!G.tokens&&(Y=/^{([^}]+)}$/.exec(w)))return[new Wt(n,w,`"${A}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Y[1])} }\`.`)];const ee=[];return a.layerType==="symbol"&&(A==="text-field"&&m&&!m.glyphs&&ee.push(new Wt(n,w,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&ga(js(w))&&on(w.type)==="identity"&&ee.push(new Wt(n,w,'"text-font" does not support identity functions'))),ee.concat(l({key:a.key,value:w,valueSpec:G,style:m,styleSpec:v,expressionContext:"property",propertyType:t,propertyKey:A}))}function Pn(a){return Hl(a,"paint")}function Fo(a){return Hl(a,"layout")}function Wa(a){let t=[];const n=a.value,l=a.key,m=a.style,v=a.styleSpec;if(ir(n)!=="object")return[new Wt(l,n,`object expected, ${ir(n)} found`)];n.type||n.ref||t.push(new Wt(l,n,'either "type" or "ref" is required'));let w=on(n.type);const A=on(n.ref);if(n.id){const z=on(n.id);for(let j=0;j<a.arrayIndex;j++){const G=m.layers[j];on(G.id)===z&&t.push(new Wt(l,n.id,`duplicate layer id "${n.id}", previously used at line ${G.id.__line__}`))}}if("ref"in n){let z;["type","source","source-layer","filter","layout"].forEach(j=>{j in n&&t.push(new Wt(l,n[j],`"${j}" is prohibited for ref layers`))}),m.layers.forEach(j=>{on(j.id)===A&&(z=j)}),z?z.ref?t.push(new Wt(l,n.ref,"ref cannot reference another ref layer")):w=on(z.type):t.push(new Wt(l,n.ref,`ref layer "${A}" not found`))}else if(w!=="background")if(n.source){const z=m.sources&&m.sources[n.source],j=z&&on(z.type);z?j==="vector"&&w==="raster"?t.push(new Wt(l,n.source,`layer "${n.id}" requires a raster source`)):j!=="raster-dem"&&w==="hillshade"||j!=="raster-dem"&&w==="color-relief"?t.push(new Wt(l,n.source,`layer "${n.id}" requires a raster-dem source`)):j==="raster"&&w!=="raster"?t.push(new Wt(l,n.source,`layer "${n.id}" requires a vector source`)):j!=="vector"||n["source-layer"]?j==="raster-dem"&&w!=="hillshade"&&w!=="color-relief"?t.push(new Wt(l,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):w!=="line"||!n.paint||!n.paint["line-gradient"]||j==="geojson"&&z.lineMetrics||t.push(new Wt(l,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Wt(l,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new Wt(l,n.source,`source "${n.source}" not found`))}else t.push(new Wt(l,n,'missing required property "source"'));return t=t.concat(rs({key:l,value:n,valueSpec:v.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${l}.type`,value:n.type,valueSpec:v.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:n,objectKey:"type"}),filter:Pa,layout:z=>rs({layer:n,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":j=>Fo(Cn({layerType:w},j))}}),paint:z=>rs({layer:n,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":j=>Pn(Cn({layerType:w},j))}})}})),t}function ao(a){const t=a.value,n=a.key,l=ir(t);return l!=="string"?[new Wt(n,t,`string expected, ${l} found`)]:[]}const uu={promoteId:function({key:a,value:t}){if(ir(t)==="string")return ao({key:a,value:t});{const n=[];for(const l in t)n.push(...ao({key:`${a}.${l}`,value:t[l]}));return n}}};function wp(a){const t=a.value,n=a.key,l=a.styleSpec,m=a.style,v=a.validateSpec;if(!t.type)return[new Wt(n,t,'"type" is required')];const w=on(t.type);let A;switch(w){case"vector":case"raster":return A=rs({key:n,value:t,valueSpec:l[`source_${w.replace("-","_")}`],style:a.style,styleSpec:l,objectElementValidators:uu,validateSpec:v}),A;case"raster-dem":return A=function(z){var j;const G=(j=z.sourceName)!==null&&j!==void 0?j:"",Y=z.value,ee=z.styleSpec,ae=ee.source_raster_dem,ue=z.style;let fe=[];const we=ir(Y);if(Y===void 0)return fe;if(we!=="object")return fe.push(new Wt("source_raster_dem",Y,`object expected, ${we} found`)),fe;const Pe=on(Y.encoding)==="custom",et=["redFactor","greenFactor","blueFactor","baseShift"],Be=z.value.encoding?`"${z.value.encoding}"`:"Default";for(const re in Y)!Pe&&et.includes(re)?fe.push(new Wt(re,Y[re],`In "${G}": "${re}" is only valid when "encoding" is set to "custom". ${Be} encoding found`)):ae[re]?fe=fe.concat(z.validateSpec({key:re,value:Y[re],valueSpec:ae[re],validateSpec:z.validateSpec,style:ue,styleSpec:ee})):fe.push(new Wt(re,Y[re],`unknown property "${re}"`));return fe}({sourceName:n,value:t,style:a.style,styleSpec:l,validateSpec:v}),A;case"geojson":if(A=rs({key:n,value:t,valueSpec:l.source_geojson,style:m,styleSpec:l,validateSpec:v,objectElementValidators:uu}),t.cluster)for(const z in t.clusterProperties){const[j,G]=t.clusterProperties[z],Y=typeof j=="string"?[j,["accumulated"],["get",z]]:j;A.push(...as({key:`${n}.${z}.map`,value:G,expressionContext:"cluster-map"})),A.push(...as({key:`${n}.${z}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return A;case"video":return rs({key:n,value:t,valueSpec:l.source_video,style:m,validateSpec:v,styleSpec:l});case"image":return rs({key:n,value:t,valueSpec:l.source_image,style:m,validateSpec:v,styleSpec:l});case"canvas":return[new Wt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return $l({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function zn(a){const t=a.value,n=a.styleSpec,l=n.light,m=a.style;let v=[];const w=ir(t);if(t===void 0)return v;if(w!=="object")return v=v.concat([new Wt("light",t,`object expected, ${w} found`)]),v;for(const A in t){const z=A.match(/^(.*)-transition$/);v=v.concat(z&&l[z[1]]&&l[z[1]].transition?a.validateSpec({key:A,value:t[A],valueSpec:n.transition,validateSpec:a.validateSpec,style:m,styleSpec:n}):l[A]?a.validateSpec({key:A,value:t[A],valueSpec:l[A],validateSpec:a.validateSpec,style:m,styleSpec:n}):[new Wt(A,t[A],`unknown property "${A}"`)])}return v}function Zl(a){const t=a.value,n=a.styleSpec,l=n.sky,m=a.style,v=ir(t);if(t===void 0)return[];if(v!=="object")return[new Wt("sky",t,`object expected, ${v} found`)];let w=[];for(const A in t)w=w.concat(l[A]?a.validateSpec({key:A,value:t[A],valueSpec:l[A],style:m,styleSpec:n}):[new Wt(A,t[A],`unknown property "${A}"`)]);return w}function kc(a){const t=a.value,n=a.styleSpec,l=n.terrain,m=a.style;let v=[];const w=ir(t);if(t===void 0)return v;if(w!=="object")return v=v.concat([new Wt("terrain",t,`object expected, ${w} found`)]),v;for(const A in t)v=v.concat(l[A]?a.validateSpec({key:A,value:t[A],valueSpec:l[A],validateSpec:a.validateSpec,style:m,styleSpec:n}):[new Wt(A,t[A],`unknown property "${A}"`)]);return v}function ml(a){let t=[];const n=a.value,l=a.key;if(Array.isArray(n)){const m=[],v=[];for(const w in n)n[w].id&&m.includes(n[w].id)&&t.push(new Wt(l,n,`all the sprites' ids must be unique, but ${n[w].id} is duplicated`)),m.push(n[w].id),n[w].url&&v.includes(n[w].url)&&t.push(new Wt(l,n,`all the sprites' URLs must be unique, but ${n[w].url} is duplicated`)),v.push(n[w].url),t=t.concat(rs({key:`${l}[${w}]`,value:n[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return t}return ao({key:l,value:n})}function Bh(a){return t=a.value,t&&t.constructor===Object?[]:[new Wt(a.key,a.value,`object expected, ${ir(a.value)} found`)];var t}const gl={"*":()=>[],array:No,boolean:function(a){const t=a.value,n=a.key,l=ir(t);return l!=="boolean"?[new Wt(n,t,`boolean expected, ${l} found`)]:[]},number:ns,color:cu,constants:lu,enum:$l,filter:Pa,function:xs,layer:Wa,object:rs,source:wp,light:zn,sky:Zl,terrain:kc,projection:function(a){const t=a.value,n=a.styleSpec,l=n.projection,m=a.style,v=ir(t);if(t===void 0)return[];if(v!=="object")return[new Wt("projection",t,`object expected, ${v} found`)];let w=[];for(const A in t)w=w.concat(l[A]?a.validateSpec({key:A,value:t[A],valueSpec:l[A],style:m,styleSpec:n}):[new Wt(A,t[A],`unknown property "${A}"`)]);return w},projectionDefinition:function(a){const t=a.key;let n=a.value;n=n instanceof String?n.valueOf():n;const l=ir(n);return l!=="array"||function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"}(n)||function(m){return!!["interpolate","step","literal"].includes(m[0])}(n)?["array","string"].includes(l)?[]:[new Wt(t,n,`projection expected, invalid type "${l}" found`)]:[new Wt(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:ao,formatted:function(a){return ao(a).length===0?[]:as(a)},resolvedImage:function(a){return ao(a).length===0?[]:as(a)},padding:function(a){const t=a.key,n=a.value;if(ir(n)==="array"){if(n.length<1||n.length>4)return[new Wt(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const l={type:"number"};let m=[];for(let v=0;v<n.length;v++)m=m.concat(a.validateSpec({key:`${t}[${v}]`,value:n[v],validateSpec:a.validateSpec,valueSpec:l}));return m}return ns({key:t,value:n,valueSpec:{}})},numberArray:function(a){const t=a.key,n=a.value;if(ir(n)==="array"){const l={type:"number"};if(n.length<1)return[new Wt(t,n,"array length at least 1 expected, length 0 found")];let m=[];for(let v=0;v<n.length;v++)m=m.concat(a.validateSpec({key:`${t}[${v}]`,value:n[v],validateSpec:a.validateSpec,valueSpec:l}));return m}return ns({key:t,value:n,valueSpec:{}})},colorArray:function(a){const t=a.key,n=a.value;if(ir(n)==="array"){if(n.length<1)return[new Wt(t,n,"array length at least 1 expected, length 0 found")];let l=[];for(let m=0;m<n.length;m++)l=l.concat(cu({key:`${t}[${m}]`,value:n[m]}));return l}return cu({key:t,value:n})},variableAnchorOffsetCollection:function(a){const t=a.key,n=a.value,l=ir(n),m=a.styleSpec;if(l!=="array"||n.length<1||n.length%2!=0)return[new Wt(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let w=0;w<n.length;w+=2)v=v.concat($l({key:`${t}[${w}]`,value:n[w],valueSpec:m.layout_symbol["text-anchor"]})),v=v.concat(No({key:`${t}[${w+1}]`,value:n[w+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:m}));return v},sprite:ml,state:Bh};function yl(a){const t=a.value,n=a.valueSpec,l=a.styleSpec;return a.validateSpec=yl,n.expression&&ga(on(t))?xs(a):n.expression&&Ec(js(t))?as(a):n.type&&gl[n.type]?gl[n.type](a):rs(Cn({},a,{valueSpec:n.type?l[n.type]:n}))}function so(a){const t=a.value,n=a.key,l=ao(a);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Wt(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Wt(n,t,'"glyphs" url must include a "{range}" token'))),l}function ss(a,t=He){let n=[];return n=n.concat(yl({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,validateSpec:yl,objectElementValidators:{glyphs:so,"*":()=>[]}})),a.constants&&(n=n.concat(lu({key:"constants",value:a.constants}))),zd(n)}function oo(a){return function(t){return a({...t,validateSpec:yl})}}function zd(a){return[].concat(a).sort((t,n)=>t.line-n.line)}function bn(a){return function(...t){return zd(a.apply(this,t))}}ss.source=bn(oo(wp)),ss.sprite=bn(oo(ml)),ss.glyphs=bn(oo(so)),ss.light=bn(oo(zn)),ss.sky=bn(oo(Zl)),ss.terrain=bn(oo(kc)),ss.state=bn(oo(Bh)),ss.layer=bn(oo(Wa)),ss.filter=bn(oo(Pa)),ss.paintProperty=bn(oo(Pn)),ss.layoutProperty=bn(oo(Fo));const _l=ss,Nh=_l.light,th=_l.sky,ih=_l.paintProperty,hu=_l.layoutProperty;function ql(a,t){let n=!1;if(t&&t.length)for(const l of t)a.fire(new ut(new Error(l.message))),n=!0;return n}class vs{constructor(t,n,l){const m=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const w=new Int32Array(this.arrayBuffer);t=w[0],this.d=(n=w[1])+2*(l=w[2]);for(let z=0;z<this.d*this.d;z++){const j=w[3+z],G=w[3+z+1];m.push(j===G?null:w.subarray(j,G))}const A=w[3+m.length+1];this.keys=w.subarray(w[3+m.length],A),this.bboxes=w.subarray(A),this.insert=this._insertReadonly}else{this.d=n+2*l;for(let w=0;w<this.d*this.d;w++)m.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=l,this.scale=n/t,this.uid=0;const v=l/n*t;this.min=-v,this.max=t+v}insert(t,n,l,m,v){this._forEachCell(n,l,m,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(m),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,l,m,v,w){this.cells[v].push(w)}query(t,n,l,m,v){const w=this.min,A=this.max;if(t<=w&&n<=w&&A<=l&&A<=m&&!v)return Array.prototype.slice.call(this.keys);{const z=[];return this._forEachCell(t,n,l,m,this._queryCell,z,{},v),z}}_queryCell(t,n,l,m,v,w,A,z){const j=this.cells[v];if(j!==null){const G=this.keys,Y=this.bboxes;for(let ee=0;ee<j.length;ee++){const ae=j[ee];if(A[ae]===void 0){const ue=4*ae;(z?z(Y[ue+0],Y[ue+1],Y[ue+2],Y[ue+3]):t<=Y[ue+2]&&n<=Y[ue+3]&&l>=Y[ue+0]&&m>=Y[ue+1])?(A[ae]=!0,w.push(G[ae])):A[ae]=!1}}}}_forEachCell(t,n,l,m,v,w,A,z){const j=this._convertToCellCoord(t),G=this._convertToCellCoord(n),Y=this._convertToCellCoord(l),ee=this._convertToCellCoord(m);for(let ae=j;ae<=Y;ae++)for(let ue=G;ue<=ee;ue++){const fe=this.d*ue+ae;if((!z||z(this._convertFromCellCoord(ae),this._convertFromCellCoord(ue),this._convertFromCellCoord(ae+1),this._convertFromCellCoord(ue+1)))&&v.call(this,t,n,l,m,fe,w,A,z))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let l=0;for(let w=0;w<this.cells.length;w++)l+=this.cells[w].length;const m=new Int32Array(n+l+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let v=n;for(let w=0;w<t.length;w++){const A=t[w];m[3+w]=v,m.set(A,v),v+=A.length}return m[3+t.length]=v,m.set(this.keys,v),v+=this.keys.length,m[3+t.length+1]=v,m.set(this.bboxes,v),v+=this.bboxes.length,m.buffer}static serialize(t,n){const l=t.toArrayBuffer();return n&&n.push(l),{buffer:l}}static deserialize(t){return new vs(t.buffer)}}const lo={};function si(a,t,n={}){if(lo[a])throw new Error(`${a} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),lo[a]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}si("Object",Object),si("Set",Set),si("TransferableGridIndex",vs),si("Color",Ui),si("Error",Error),si("AJAXError",je),si("ResolvedImage",ua),si("StylePropertyFunction",_s),si("StyleExpression",Vl,{omit:["_evaluator"]}),si("ZoomDependentExpression",no),si("ZoomConstantExpression",xi),si("CompoundExpression",ma,{omit:["_evaluate"]});for(const a in fa)fa[a]._classRegistryKey||si(`Expression_${a}`,fa[a]);function Fh(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function co(a){return a.$name||a.constructor._classRegistryKey}function rh(a){return!function(t){if(t===null||typeof t!="object")return!1;const n=co(t);return!(!n||n==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Fh(a)||$a(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function du(a,t){if(rh(a))return(Fh(a)||$a(a))&&t&&t.push(a),ArrayBuffer.isView(a)&&t&&t.push(a.buffer),a instanceof ImageData&&t&&t.push(a.data.buffer),a;if(Array.isArray(a)){const v=[];for(const w of a)v.push(du(w,t));return v}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const n=co(a);if(!n)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!lo[n])throw new Error(`${n} is not registered.`);const{klass:l}=lo[n],m=l.serialize?l.serialize(a,t):{};if(l.serialize){if(t&&m===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in a){if(!a.hasOwnProperty(v)||lo[n].omit.indexOf(v)>=0)continue;const w=a[v];m[v]=lo[n].shallow.indexOf(v)>=0?w:du(w,t)}a instanceof Error&&(m.message=a.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(m.$name=n),m}function bs(a){if(rh(a))return a;if(Array.isArray(a))return a.map(bs);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const t=co(a)||"Object";if(!lo[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=lo[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(a);const l=Object.create(n.prototype);for(const m of Object.keys(a)){if(m==="$name")continue;const v=a[m];l[m]=lo[t].shallow.indexOf(m)>=0?v:bs(v)}return l}class nh{constructor(){this.first=!0}update(t,n){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const rr={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Hangul Syllables":a=>a>=44032&&a<=55215,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Uo(a){for(const t of a)if(Xl(t.charCodeAt(0)))return!0;return!1}function xl(a){for(const t of a)if(!Ld(t.charCodeAt(0)))return!1;return!0}function uo(a){const t=a.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(t.join("|"),"u")}const ah=uo(["Arab","Dupl","Mong","Ougr","Syrc"]);function Ld(a){return!ah.test(String.fromCodePoint(a))}const Pc=uo(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Xl(a){return!(a!==746&&a!==747&&(a<4352||!(rr["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||rr["CJK Compatibility"](a)||rr["CJK Strokes"](a)||!(!rr["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||rr["Enclosed CJK Letters and Months"](a)||rr["Ideographic Description Characters"](a)||rr.Kanbun(a)||rr.Katakana(a)&&a!==12540||!(!rr["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!rr["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||rr["Vertical Forms"](a)||rr["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Pc.test(String.fromCodePoint(a)))))}function ho(a){return!(Xl(a)||function(t){return!!(rr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||rr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||rr["Letterlike Symbols"](t)||rr["Number Forms"](t)||rr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||rr["Control Pictures"](t)&&t!==9251||rr["Optical Character Recognition"](t)||rr["Enclosed Alphanumerics"](t)||rr["Geometric Shapes"](t)||rr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||rr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||rr["CJK Symbols and Punctuation"](t)||rr.Katakana(t)||rr["Private Use Area"](t)||rr["CJK Compatibility Forms"](t)||rr["Small Form Variants"](t)||rr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}const pu=uo(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function po(a){return pu.test(String.fromCodePoint(a))}function fo(a,t){return!(!t&&po(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||rr.Khmer(a))}function Uh(a){for(const t of a)if(po(t.charCodeAt(0)))return!0;return!1}const mo=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(mo.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,t){return h(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const n=a.pluginURL,l=new Promise(v=>{this.loadScriptResolve=v});t(n);const m=new Promise(v=>setTimeout(()=>v(),this.TIMEOUT));if(yield Promise.race([l,m]),this.isParsed()){const v={pluginStatus:"loaded",pluginURL:n};return this.setState(v),v}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)})}};class Xr{constructor(t,n){this.zoom=t,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new nh,this.transition=n.transition||{},this.globalState=n.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new nh,this.transition={},this.globalState={})}isSupportedScript(t){return function(n,l){for(const m of n)if(!fo(m.charCodeAt(0),l))return!1;return!0}(t,mo.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*n}}}class za{constructor(t,n){this.property=t,this.value=n,this.expression=function(l,m){if(ga(l))return new _s(l,m);if(Ec(l)){const v=is(l,m);if(v.result==="error")throw new Error(v.value.map(w=>`${w.key}: ${w.message}`).join(", "));return v.value}{let v=l;return m.type==="color"&&typeof l=="string"?v=Ui.parse(l):m.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?m.type!=="numberArray"||typeof l!="number"&&!Array.isArray(l)?m.type!=="colorArray"||typeof l!="string"&&!Array.isArray(l)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(l)?v=Vi.parse(l):m.type==="projectionDefinition"&&typeof l=="string"&&(v=Oi.parse(l)):v=Bn.parse(l):v=Jr.parse(l):v=an.parse(l),{globalStateRefs:new Set,kind:"constant",evaluate:()=>v}}}(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,n,l){return this.property.possiblyEvaluate(this,t,n,l)}}class $i{constructor(t){this.property=t,this.value=new za(t,void 0)}transitioned(t,n){return new mn(this.property,this.value,n,aa({},t.transition,this.transition),t.now)}untransitioned(){return new mn(this.property,this.value,null,{},0)}}class Ir{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Va(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new $i(this._values[t].property)),this._values[t].value=new za(this._values[t].property,n===null?void 0:Va(n))}getTransition(t){return Va(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new $i(this._values[t].property)),this._values[t].transition=Va(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l);const m=this.getTransition(n);m!==void 0&&(t[`${n}-transition`]=m)}return t}transitioned(t,n){const l=new sh(this._properties);for(const m of Object.keys(this._values))l._values[m]=this._values[m].transitioned(t,n._values[m]);return l}untransitioned(){const t=new sh(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class mn{constructor(t,n,l,m,v){this.property=t,this.value=n,this.begin=v+m.delay||0,this.end=this.begin+m.duration||0,t.specification.transition&&(m.delay||m.duration)&&(this.prior=l)}possiblyEvaluate(t,n,l){const m=t.now||0,v=this.value.possiblyEvaluate(t,n,l),w=this.prior;if(w){if(m>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(m<this.begin)return w.possiblyEvaluate(t,n,l);{const A=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(t,n,l),v,Ri(A))}}return v}}class sh{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,l){const m=new zc(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(t,n,l);return m}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class fu{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Va(this._values[t].value)}setValue(t,n){this._values[t]=new za(this._values[t].property,n===null?void 0:Va(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l)}return t}possiblyEvaluate(t,n,l){const m=new zc(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(t,n,l);return m}}class Yr{constructor(t,n,l){this.property=t,this.value=n,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,l,m){return this.property.evaluate(this.value,this.parameters,t,n,l,m)}}class zc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class ui{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,l){const m=ts[this.specification.type];return m?m(t,n,l):t}}class Ti{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,l,m){return new Yr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},l,m)}:t.expression,n)}interpolate(t,n,l){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Yr(this,{kind:"constant",value:void 0},t.parameters);const m=ts[this.specification.type];if(m){const v=m(t.value.value,n.value.value,l);return new Yr(this,{kind:"constant",value:v},t.parameters)}return t}evaluate(t,n,l,m,v,w){return t.kind==="constant"?t.value:t.evaluate(n,l,m,v,w)}}class oh extends Ti{possiblyEvaluate(t,n,l,m){if(t.value===void 0)return new Yr(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const v=t.expression.evaluate(n,null,{},l,m),w=t.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,A=this._calculate(w,w,w,n);return new Yr(this,{kind:"constant",value:A},n)}if(t.expression.kind==="camera"){const v=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new Yr(this,{kind:"constant",value:v},n)}return new Yr(this,t.expression,n)}evaluate(t,n,l,m,v,w){if(t.kind==="source"){const A=t.evaluate(n,l,m,v,w);return this._calculate(A,A,A,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},l,m),t.evaluate({zoom:Math.floor(n.zoom)},l,m),t.evaluate({zoom:Math.floor(n.zoom)+1},l,m),n):t.value}_calculate(t,n,l,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class Or{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,m){if(t.value!==void 0){if(t.expression.kind==="constant"){const v=t.expression.evaluate(n,null,{},l,m);return this._calculate(v,v,v,n)}return this._calculate(t.expression.evaluate(new Xr(Math.floor(n.zoom-1),n)),t.expression.evaluate(new Xr(Math.floor(n.zoom),n)),t.expression.evaluate(new Xr(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,l,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class Vo{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,m){return!!t.expression.evaluate(n,null,{},l,m)}interpolate(){return!1}}class Fn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const l=t[n];l.specification.overridable&&this.overridableProperties.push(n);const m=this.defaultPropertyValues[n]=new za(l,void 0),v=this.defaultTransitionablePropertyValues[n]=new $i(l);this.defaultTransitioningPropertyValues[n]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=m.possiblyEvaluate({})}}}si("DataDrivenProperty",Ti),si("DataConstantProperty",ui),si("CrossFadedDataDrivenProperty",oh),si("CrossFadedProperty",Or),si("ColorRampProperty",Vo);const Dd="-transition";class Qn extends jt{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=xn(t.filter)),n.layout&&(this._unevaluatedLayout=new fu(n.layout)),n.paint)){this._transitionablePaint=new Ir(n.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new zc(n.paint)}}setFilter(t){this.filter=t,this._featureFilter=xn(t)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const l=this._unevaluatedLayout._values[n];for(const m of l.getGlobalStateRefs())t.add(m)}for(const n of this._featureFilter.getGlobalStateRefs())t.add(n);return t}setLayoutProperty(t,n,l={}){n!=null&&this._validate(hu,`layers.${this.id}.layout.${t}`,t,n,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(Dd)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,l={}){if(n!=null&&this._validate(ih,`layers.${this.id}.paint.${t}`,t,n,l))return!1;if(t.endsWith(Dd))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const m=this._transitionablePaint._values[t],v=m.property.specification["property-type"]==="cross-faded-data-driven",w=m.value.isDataDriven(),A=m.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const z=this._transitionablePaint._values[t].value;return z.isDataDriven()||w||v||this._handleOverridablePaintPropertyUpdate(t,A,z)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Ms(t,(n,l)=>!(n===void 0||l==="layout"&&!Object.keys(n).length||l==="paint"&&!Object.keys(n).length))}_validate(t,n,l,m,v={}){return(!v||v.validate!==!1)&&ql(this,t.call(_l,{key:n,layerType:this.type,objectKey:l,value:m,styleSpec:He,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Yr&&io(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const go={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class vl{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Wr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function er(a,t=1){let n=0,l=0;return{members:a.map(m=>{const v=go[m.type].BYTES_PER_ELEMENT,w=n=La(n,Math.max(t,v)),A=m.components||1;return l=Math.max(l,v),n+=v*A,{name:m.name,type:m.type,components:A,offset:w}}),size:La(n,Math.max(l,t)),alignment:t}}function La(a,t){return Math.ceil(a/t)*t}class Kr extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const m=2*t;return this.int16[m+0]=n,this.int16[m+1]=l,t}}Kr.prototype.bytesPerElement=4,si("StructArrayLayout2i4",Kr);class yo extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l)}emplace(t,n,l,m){const v=3*t;return this.int16[v+0]=n,this.int16[v+1]=l,this.int16[v+2]=m,t}}yo.prototype.bytesPerElement=6,si("StructArrayLayout3i6",yo);class bl extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,m){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,l,m)}emplace(t,n,l,m,v){const w=4*t;return this.int16[w+0]=n,this.int16[w+1]=l,this.int16[w+2]=m,this.int16[w+3]=v,t}}bl.prototype.bytesPerElement=8,si("StructArrayLayout4i8",bl);class _o extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w){const A=this.length;return this.resize(A+1),this.emplace(A,t,n,l,m,v,w)}emplace(t,n,l,m,v,w,A){const z=6*t;return this.int16[z+0]=n,this.int16[z+1]=l,this.int16[z+2]=m,this.int16[z+3]=v,this.int16[z+4]=w,this.int16[z+5]=A,t}}_o.prototype.bytesPerElement=12,si("StructArrayLayout2i4i12",_o);class ws extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w){const A=this.length;return this.resize(A+1),this.emplace(A,t,n,l,m,v,w)}emplace(t,n,l,m,v,w,A){const z=4*t,j=8*t;return this.int16[z+0]=n,this.int16[z+1]=l,this.uint8[j+4]=m,this.uint8[j+5]=v,this.uint8[j+6]=w,this.uint8[j+7]=A,t}}ws.prototype.bytesPerElement=8,si("StructArrayLayout2i4ub8",ws);class Da extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const m=2*t;return this.float32[m+0]=n,this.float32[m+1]=l,t}}Da.prototype.bytesPerElement=8,si("StructArrayLayout2f8",Da);class mu extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w,A,z,j,G){const Y=this.length;return this.resize(Y+1),this.emplace(Y,t,n,l,m,v,w,A,z,j,G)}emplace(t,n,l,m,v,w,A,z,j,G,Y){const ee=10*t;return this.uint16[ee+0]=n,this.uint16[ee+1]=l,this.uint16[ee+2]=m,this.uint16[ee+3]=v,this.uint16[ee+4]=w,this.uint16[ee+5]=A,this.uint16[ee+6]=z,this.uint16[ee+7]=j,this.uint16[ee+8]=G,this.uint16[ee+9]=Y,t}}mu.prototype.bytesPerElement=20,si("StructArrayLayout10ui20",mu);class gu extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w,A,z,j,G,Y,ee){const ae=this.length;return this.resize(ae+1),this.emplace(ae,t,n,l,m,v,w,A,z,j,G,Y,ee)}emplace(t,n,l,m,v,w,A,z,j,G,Y,ee,ae){const ue=12*t;return this.int16[ue+0]=n,this.int16[ue+1]=l,this.int16[ue+2]=m,this.int16[ue+3]=v,this.uint16[ue+4]=w,this.uint16[ue+5]=A,this.uint16[ue+6]=z,this.uint16[ue+7]=j,this.int16[ue+8]=G,this.int16[ue+9]=Y,this.int16[ue+10]=ee,this.int16[ue+11]=ae,t}}gu.prototype.bytesPerElement=24,si("StructArrayLayout4i4ui4i24",gu);class yu extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l)}emplace(t,n,l,m){const v=3*t;return this.float32[v+0]=n,this.float32[v+1]=l,this.float32[v+2]=m,t}}yu.prototype.bytesPerElement=12,si("StructArrayLayout3f12",yu);class y extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}y.prototype.bytesPerElement=4,si("StructArrayLayout1ul4",y);class e extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w,A,z,j){const G=this.length;return this.resize(G+1),this.emplace(G,t,n,l,m,v,w,A,z,j)}emplace(t,n,l,m,v,w,A,z,j,G){const Y=10*t,ee=5*t;return this.int16[Y+0]=n,this.int16[Y+1]=l,this.int16[Y+2]=m,this.int16[Y+3]=v,this.int16[Y+4]=w,this.int16[Y+5]=A,this.uint32[ee+3]=z,this.uint16[Y+8]=j,this.uint16[Y+9]=G,t}}e.prototype.bytesPerElement=20,si("StructArrayLayout6i1ul2ui20",e);class r extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w){const A=this.length;return this.resize(A+1),this.emplace(A,t,n,l,m,v,w)}emplace(t,n,l,m,v,w,A){const z=6*t;return this.int16[z+0]=n,this.int16[z+1]=l,this.int16[z+2]=m,this.int16[z+3]=v,this.int16[z+4]=w,this.int16[z+5]=A,t}}r.prototype.bytesPerElement=12,si("StructArrayLayout2i2i2i12",r);class c extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,m,v)}emplace(t,n,l,m,v,w){const A=4*t,z=8*t;return this.float32[A+0]=n,this.float32[A+1]=l,this.float32[A+2]=m,this.int16[z+6]=v,this.int16[z+7]=w,t}}c.prototype.bytesPerElement=16,si("StructArrayLayout2f1f2i16",c);class f extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w){const A=this.length;return this.resize(A+1),this.emplace(A,t,n,l,m,v,w)}emplace(t,n,l,m,v,w,A){const z=16*t,j=4*t,G=8*t;return this.uint8[z+0]=n,this.uint8[z+1]=l,this.float32[j+1]=m,this.float32[j+2]=v,this.int16[G+6]=w,this.int16[G+7]=A,t}}f.prototype.bytesPerElement=16,si("StructArrayLayout2ub2f2i16",f);class _ extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l)}emplace(t,n,l,m){const v=3*t;return this.uint16[v+0]=n,this.uint16[v+1]=l,this.uint16[v+2]=m,t}}_.prototype.bytesPerElement=6,si("StructArrayLayout3ui6",_);class M extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w,A,z,j,G,Y,ee,ae,ue,fe,we,Pe){const et=this.length;return this.resize(et+1),this.emplace(et,t,n,l,m,v,w,A,z,j,G,Y,ee,ae,ue,fe,we,Pe)}emplace(t,n,l,m,v,w,A,z,j,G,Y,ee,ae,ue,fe,we,Pe,et){const Be=24*t,re=12*t,ve=48*t;return this.int16[Be+0]=n,this.int16[Be+1]=l,this.uint16[Be+2]=m,this.uint16[Be+3]=v,this.uint32[re+2]=w,this.uint32[re+3]=A,this.uint32[re+4]=z,this.uint16[Be+10]=j,this.uint16[Be+11]=G,this.uint16[Be+12]=Y,this.float32[re+7]=ee,this.float32[re+8]=ae,this.uint8[ve+36]=ue,this.uint8[ve+37]=fe,this.uint8[ve+38]=we,this.uint32[re+10]=Pe,this.int16[Be+22]=et,t}}M.prototype.bytesPerElement=48,si("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",M);class P extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,m,v,w,A,z,j,G,Y,ee,ae,ue,fe,we,Pe,et,Be,re,ve,Fe,xt,Nt,Mt,kt,qt,Ut){const Xt=this.length;return this.resize(Xt+1),this.emplace(Xt,t,n,l,m,v,w,A,z,j,G,Y,ee,ae,ue,fe,we,Pe,et,Be,re,ve,Fe,xt,Nt,Mt,kt,qt,Ut)}emplace(t,n,l,m,v,w,A,z,j,G,Y,ee,ae,ue,fe,we,Pe,et,Be,re,ve,Fe,xt,Nt,Mt,kt,qt,Ut,Xt){const Rt=32*t,gi=16*t;return this.int16[Rt+0]=n,this.int16[Rt+1]=l,this.int16[Rt+2]=m,this.int16[Rt+3]=v,this.int16[Rt+4]=w,this.int16[Rt+5]=A,this.int16[Rt+6]=z,this.int16[Rt+7]=j,this.uint16[Rt+8]=G,this.uint16[Rt+9]=Y,this.uint16[Rt+10]=ee,this.uint16[Rt+11]=ae,this.uint16[Rt+12]=ue,this.uint16[Rt+13]=fe,this.uint16[Rt+14]=we,this.uint16[Rt+15]=Pe,this.uint16[Rt+16]=et,this.uint16[Rt+17]=Be,this.uint16[Rt+18]=re,this.uint16[Rt+19]=ve,this.uint16[Rt+20]=Fe,this.uint16[Rt+21]=xt,this.uint16[Rt+22]=Nt,this.uint32[gi+12]=Mt,this.float32[gi+13]=kt,this.float32[gi+14]=qt,this.uint16[Rt+30]=Ut,this.uint16[Rt+31]=Xt,t}}P.prototype.bytesPerElement=64,si("StructArrayLayout8i15ui1ul2f2ui64",P);class L extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}L.prototype.bytesPerElement=4,si("StructArrayLayout1f4",L);class V extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l)}emplace(t,n,l,m){const v=3*t;return this.uint16[6*t+0]=n,this.float32[v+1]=l,this.float32[v+2]=m,t}}V.prototype.bytesPerElement=12,si("StructArrayLayout1ui2f12",V);class q extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l)}emplace(t,n,l,m){const v=4*t;return this.uint32[2*t+0]=n,this.uint16[v+2]=l,this.uint16[v+3]=m,t}}q.prototype.bytesPerElement=8,si("StructArrayLayout1ul2ui8",q);class K extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const m=2*t;return this.uint16[m+0]=n,this.uint16[m+1]=l,t}}K.prototype.bytesPerElement=4,si("StructArrayLayout2ui4",K);class W extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}W.prototype.bytesPerElement=2,si("StructArrayLayout1ui2",W);class te extends Wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,m){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,l,m)}emplace(t,n,l,m,v){const w=4*t;return this.float32[w+0]=n,this.float32[w+1]=l,this.float32[w+2]=m,this.float32[w+3]=v,t}}te.prototype.bytesPerElement=16,si("StructArrayLayout4f16",te);class he extends vl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Se(this.anchorPointX,this.anchorPointY)}}he.prototype.size=20;class Ae extends e{get(t){return new he(this,t)}}si("CollisionBoxArray",Ae);class Ce extends vl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ce.prototype.size=48;class ke extends M{get(t){return new Ce(this,t)}}si("PlacedSymbolArray",ke);class ze extends vl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ze.prototype.size=64;class Le extends P{get(t){return new ze(this,t)}}si("SymbolInstanceArray",Le);class De extends L{getoffsetX(t){return this.float32[1*t+0]}}si("GlyphOffsetArray",De);class Ge extends yo{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}si("SymbolLineVertexArray",Ge);class Ye extends vl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ye.prototype.size=12;class Re extends V{get(t){return new Ye(this,t)}}si("TextAnchorOffsetArray",Re);class it extends vl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}it.prototype.size=8;class vt extends q{get(t){return new it(this,t)}}si("FeatureIndexArray",vt);class ot extends Kr{}class ft extends Kr{}class wt extends Kr{}class ei extends _o{}class Kt extends ws{}class Lt extends Da{}class pi extends mu{}class Hi extends gu{}class xr extends yu{}class Xi extends y{}class jr extends r{}class tn extends f{}class cr extends _{}class nr extends K{}const Fr=er([{name:"a_pos",components:2,type:"Int16"}],4),{members:Gn}=Fr;class hr{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,l,m){const v=this.segments[this.segments.length-1];return t>hr.MAX_VERTEX_ARRAY_LENGTH&&qr(`Max vertices per segment is ${hr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${hr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!v||v.vertexLength+t>hr.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==m?this.createNewSegment(n,l,m):v}createNewSegment(t,n,l){const m={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return l!==void 0&&(m.sortKey=l),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(t,n,l){return this.prepareSegment(0,t,n,l)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,l,m){return new hr([{vertexOffset:t,primitiveOffset:n,vertexLength:l,primitiveLength:m,vaos:{},sortKey:0}])}}function $n(a,t){return 256*(a=Cr(Math.floor(a),0,255))+Cr(Math.floor(t),0,255)}hr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,si("SegmentVector",hr);const Jn=er([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Yl,wl,Ka,Bs={exports:{}},Wl={exports:{}},Kl={exports:{}},Lc=function(){if(Ka)return Bs.exports;Ka=1;var a=(Yl||(Yl=1,Wl.exports=function(n,l){var m,v,w,A,z,j,G,Y;for(v=n.length-(m=3&n.length),w=l,z=3432918353,j=461845907,Y=0;Y<v;)G=255&n.charCodeAt(Y)|(255&n.charCodeAt(++Y))<<8|(255&n.charCodeAt(++Y))<<16|(255&n.charCodeAt(++Y))<<24,++Y,w=27492+(65535&(A=5*(65535&(w=(w^=G=(65535&(G=(G=(65535&G)*z+(((G>>>16)*z&65535)<<16)&4294967295)<<15|G>>>17))*j+(((G>>>16)*j&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(G=0,m){case 3:G^=(255&n.charCodeAt(Y+2))<<16;case 2:G^=(255&n.charCodeAt(Y+1))<<8;case 1:w^=G=(65535&(G=(G=(65535&(G^=255&n.charCodeAt(Y)))*z+(((G>>>16)*z&65535)<<16)&4294967295)<<15|G>>>17))*j+(((G>>>16)*j&65535)<<16)&4294967295}return w^=n.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}),Wl.exports),t=(wl||(wl=1,Kl.exports=function(n,l){for(var m,v=n.length,w=l^v,A=0;v>=4;)m=1540483477*(65535&(m=255&n.charCodeAt(A)|(255&n.charCodeAt(++A))<<8|(255&n.charCodeAt(++A))<<16|(255&n.charCodeAt(++A))<<24))+((1540483477*(m>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),v-=4,++A;switch(v){case 3:w^=(255&n.charCodeAt(A+2))<<16;case 2:w^=(255&n.charCodeAt(A+1))<<8;case 1:w=1540483477*(65535&(w^=255&n.charCodeAt(A)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}),Kl.exports);return Bs.exports=a,Bs.exports.murmur3=a,Bs.exports.murmur2=t,Bs.exports}(),ya=oe(Lc);class Un{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,l,m){this.ids.push(Go(t)),this.positions.push(n,l,m)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Go(t);let l=0,m=this.ids.length-1;for(;l<m;){const w=l+m>>1;this.ids[w]>=n?m=w:l=w+1}const v=[];for(;this.ids[l]===n;)v.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return v}static serialize(t,n){const l=new Float64Array(t.ids),m=new Uint32Array(t.positions);return Ss(l,m,0,l.length-1),n&&n.push(l.buffer,m.buffer),{ids:l,positions:m}}static deserialize(t){const n=new Un;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function Go(a){const t=+a;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:ya(String(a))}function Ss(a,t,n,l){for(;n<l;){const m=a[n+l>>1];let v=n-1,w=l+1;for(;;){do v++;while(a[v]<m);do w--;while(a[w]>m);if(v>=w)break;mr(a,v,w),mr(t,3*v,3*w),mr(t,3*v+1,3*w+1),mr(t,3*v+2,3*w+2)}w-n<l-w?(Ss(a,t,n,w),n=w+1):(Ss(a,t,w+1,l),l=w)}}function mr(a,t,n){const l=a[t];a[t]=a[n],a[n]=l}si("FeaturePositionMap",Un);class Br{constructor(t,n){this.gl=t.gl,this.location=n}}class ea extends Br{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class gn extends Br{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class lh extends Br{constructor(t,n){super(t,n),this.current=Ui.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Vh=new Float32Array(16);function ch(a){return[$n(255*a.r,255*a.g),$n(255*a.b,255*a.a)]}class Ns{constructor(t,n,l){this.value=t,this.uniformNames=n.map(m=>`u_${m}`),this.type=l}setUniform(t,n,l){t.set(l.constantOr(this.value))}getBinding(t,n,l){return this.type==="color"?new lh(t,n):new ea(t,n)}}class Dc{constructor(t,n){this.uniformNames=n.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,l,m){const v=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&t.set(v)}getBinding(t,n,l){return l.substr(0,9)==="u_pattern"?new gn(t,n):new ea(t,n)}}class wn{constructor(t,n,l,m){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(t,n,l,m,v){const w=this.paintVertexArray.length,A=this.expression.evaluate(new Xr(0),n,{},m,[],v);this.paintVertexArray.resize(t),this._setPaintValue(w,t,A)}updatePaintArray(t,n,l,m){const v=this.expression.evaluate({zoom:0},l,m);this._setPaintValue(t,n,v)}_setPaintValue(t,n,l){if(this.type==="color"){const m=ch(l);for(let v=t;v<n;v++)this.paintVertexArray.emplace(v,m[0],m[1])}else{for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gr{constructor(t,n,l,m,v,w){this.expression=t,this.uniformNames=n.map(A=>`u_${A}_t`),this.type=l,this.useIntegerZoom=m,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=n.map(A=>({name:`a_${A}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(t,n,l,m,v){const w=this.expression.evaluate(new Xr(this.zoom),n,{},m,[],v),A=this.expression.evaluate(new Xr(this.zoom+1),n,{},m,[],v),z=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(z,t,w,A)}updatePaintArray(t,n,l,m){const v=this.expression.evaluate({zoom:this.zoom},l,m),w=this.expression.evaluate({zoom:this.zoom+1},l,m);this._setPaintValue(t,n,v,w)}_setPaintValue(t,n,l,m){if(this.type==="color"){const v=ch(l),w=ch(m);for(let A=t;A<n;A++)this.paintVertexArray.emplace(A,v[0],v[1],w[0],w[1])}else{for(let v=t;v<n;v++)this.paintVertexArray.emplace(v,l,m);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(m))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const l=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,m=Cr(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(m)}getBinding(t,n,l){return new ea(t,n)}}class Ra{constructor(t,n,l,m,v,w){this.expression=t,this.type=n,this.useIntegerZoom=l,this.zoom=m,this.layerId=w,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(t,n,l){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(m,t,n.patterns&&n.patterns[this.layerId],l)}updatePaintArray(t,n,l,m,v){this._setPaintValues(t,n,l.patterns&&l.patterns[this.layerId],v)}_setPaintValues(t,n,l,m){if(!m||!l)return;const{min:v,mid:w,max:A}=l,z=m[v],j=m[w],G=m[A];if(z&&j&&G)for(let Y=t;Y<n;Y++)this.zoomInPaintVertexArray.emplace(Y,j.tl[0],j.tl[1],j.br[0],j.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],j.pixelRatio,z.pixelRatio),this.zoomOutPaintVertexArray.emplace(Y,j.tl[0],j.tl[1],j.br[0],j.br[1],G.tl[0],G.tl[1],G.br[0],G.br[1],j.pixelRatio,G.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Jn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Jn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class uh{constructor(t,n,l){this.binders={},this._buffers=[];const m=[];for(const v in t.paint._values){if(!l(v))continue;const w=t.paint.get(v);if(!(w instanceof Yr&&io(w.property.specification)))continue;const A=Qa(v,t.type),z=w.value,j=w.property.specification.type,G=w.property.useIntegerZoom,Y=w.property.specification["property-type"],ee=Y==="cross-faded"||Y==="cross-faded-data-driven";if(z.kind==="constant")this.binders[v]=ee?new Dc(z.value,A):new Ns(z.value,A,j),m.push(`/u_${v}`);else if(z.kind==="source"||ee){const ae=Sn(v,j,"source");this.binders[v]=ee?new Ra(z,j,G,n,ae,t.id):new wn(z,A,j,ae),m.push(`/a_${v}`)}else{const ae=Sn(v,j,"composite");this.binders[v]=new Gr(z,A,j,G,n,ae),m.push(`/z_${v}`)}}this.cacheKey=m.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof wn||n instanceof Gr?n.maxValue:0}populatePaintArrays(t,n,l,m,v){for(const w in this.binders){const A=this.binders[w];(A instanceof wn||A instanceof Gr||A instanceof Ra)&&A.populatePaintArray(t,n,l,m,v)}}setConstantPatternPositions(t,n){for(const l in this.binders){const m=this.binders[l];m instanceof Dc&&m.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,l,m,v){let w=!1;for(const A in t){const z=n.getPositions(A);for(const j of z){const G=l.feature(j.index);for(const Y in this.binders){const ee=this.binders[Y];if((ee instanceof wn||ee instanceof Gr||ee instanceof Ra)&&ee.expression.isStateDependent===!0){const ae=m.paint.get(Y);ee.expression=ae.value,ee.updatePaintArray(j.start,j.end,G,t[A],v),w=!0}}}}return w}defines(){const t=[];for(const n in this.binders){const l=this.binders[n];(l instanceof Ns||l instanceof Dc)&&t.push(...l.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof wn||l instanceof Gr)for(let m=0;m<l.paintVertexAttributes.length;m++)t.push(l.paintVertexAttributes[m].name);else if(l instanceof Ra)for(let m=0;m<Jn.members.length;m++)t.push(Jn.members[m].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof Ns||l instanceof Dc||l instanceof Gr)for(const m of l.uniformNames)t.push(m)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const l=[];for(const m in this.binders){const v=this.binders[m];if(v instanceof Ns||v instanceof Dc||v instanceof Gr){for(const w of v.uniformNames)if(n[w]){const A=v.getBinding(t,n[w],w);l.push({name:w,property:m,binding:A})}}}return l}setUniforms(t,n,l,m){for(const{name:v,property:w,binding:A}of n)this.binders[w].setUniform(A,m,l.get(w),v)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const l=this.binders[n];if(t&&l instanceof Ra){const m=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(l instanceof wn||l instanceof Gr)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const n in this.binders){const l=this.binders[n];(l instanceof wn||l instanceof Gr||l instanceof Ra)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof wn||n instanceof Gr||n instanceof Ra)&&n.destroy()}}}class Ln{constructor(t,n,l=()=>!0){this.programConfigurations={};for(const m of t)this.programConfigurations[m.id]=new uh(m,n,l);this.needsUpload=!1,this._featureMap=new Un,this._bufferOffset=0}populatePaintArrays(t,n,l,m,v,w){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(t,n,m,v,w);n.id!==void 0&&this._featureMap.add(n.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,l,m){for(const v of l)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(t,this._featureMap,n,v,m)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Qa(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}function Sn(a,t,n){const l={color:{source:Da,composite:te},number:{source:L,composite:Da}},m=function(v){return{"line-pattern":{source:pi,composite:pi},"fill-pattern":{source:pi,composite:pi},"fill-extrusion-pattern":{source:pi,composite:pi}}[v]}(a);return m&&m[n]||l[t][n]}si("ConstantBinder",Ns),si("CrossFadedConstantBinder",Dc),si("SourceExpressionBinder",wn),si("CrossFadedCompositeBinder",Ra),si("CompositeExpressionBinder",Gr),si("ProgramConfiguration",uh,{omit:["_buffers"]}),si("ProgramConfigurationSet",Ln);const Ql=Math.pow(2,14)-1,Rd=-Ql-1;function Sl(a){const t=Ht/a.extent,n=a.loadGeometry();for(let l=0;l<n.length;l++){const m=n[l];for(let v=0;v<m.length;v++){const w=m[v],A=Math.round(w.x*t),z=Math.round(w.y*t);w.x=Cr(A,Rd,Ql),w.y=Cr(z,Rd,Ql),(A<w.x||A>w.x+1||z<w.y||z>w.y+1)&&qr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Jl(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?Sl(a):[]}}const Sp=-32768;function Rc(a,t,n,l,m){a.emplaceBack(Sp+8*t+l,Sp+8*n+m)}class os{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ft,this.indexArray=new cr,this.segments=new hr,this.programConfigurations=new Ln(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l){const m=this.layers[0],v=[];let w=null,A=!1,z=m.type==="heatmap";if(m.type==="circle"){const G=m;w=G.layout.get("circle-sort-key"),A=!w.isConstant(),z=z||G.paint.get("circle-pitch-alignment")==="map"}const j=z?n.subdivisionGranularity.circle:1;for(const{feature:G,id:Y,index:ee,sourceLayerIndex:ae}of t){const ue=this.layers[0]._featureFilter.needGeometry,fe=Jl(G,ue);if(!this.layers[0]._featureFilter.filter(new Xr(this.zoom,{globalState:this.globalState}),fe,l))continue;const we=A?w.evaluate(fe,{},l):void 0,Pe={id:Y,properties:G.properties,type:G.type,sourceLayerIndex:ae,index:ee,geometry:ue?fe.geometry:Sl(G),patterns:{},sortKey:we};v.push(Pe)}A&&v.sort((G,Y)=>G.sortKey-Y.sortKey);for(const G of v){const{geometry:Y,index:ee,sourceLayerIndex:ae}=G,ue=t[ee].feature;this.addFeature(G,Y,ee,l,j),n.featureIndex.insert(ue,Y,ee,ae,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Gn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,l,m,v=1){let w;switch(v){case 1:w=[0,7];break;case 3:w=[0,2,5,7];break;case 5:w=[0,1,3,4,6,7];break;case 7:w=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${v}; valid values are 1, 3, 5, 7.`)}const A=w.length;for(const z of n)for(const j of z){const G=j.x,Y=j.y;if(G<0||G>=Ht||Y<0||Y>=Ht)continue;const ee=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,t.sortKey),ae=ee.vertexLength;for(let ue=0;ue<A;ue++)for(let fe=0;fe<A;fe++)Rc(this.layoutVertexArray,G,Y,w[fe],w[ue]);for(let ue=0;ue<A-1;ue++)for(let fe=0;fe<A-1;fe++){const we=ae+ue*A+fe,Pe=ae+(ue+1)*A+fe;this.indexArray.emplaceBack(we,Pe+1,we+1),this.indexArray.emplaceBack(we,Pe,Pe+1)}ee.vertexLength+=A*A,ee.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},m)}}function ec(a,t){for(let n=0;n<a.length;n++)if(Ic(t,a[n]))return!0;for(let n=0;n<t.length;n++)if(Ic(a,t[n]))return!0;return!!Gh(a,t)}function sf(a,t,n){return!!Ic(a,t)||!!$h(t,a,n)}function of(a,t){if(a.length===1)return Nf(t,a[0]);for(let n=0;n<t.length;n++){const l=t[n];for(let m=0;m<l.length;m++)if(Ic(a,l[m]))return!0}for(let n=0;n<a.length;n++)if(Nf(t,a[n]))return!0;for(let n=0;n<t.length;n++)if(Gh(a,t[n]))return!0;return!1}function Tp(a,t,n){if(a.length>1){if(Gh(a,t))return!0;for(let l=0;l<t.length;l++)if($h(t[l],a,n))return!0}for(let l=0;l<a.length;l++)if($h(a[l],t,n))return!0;return!1}function Gh(a,t){if(a.length===0||t.length===0)return!1;for(let n=0;n<a.length-1;n++){const l=a[n],m=a[n+1];for(let v=0;v<t.length-1;v++)if(tc(l,m,t[v],t[v+1]))return!0}return!1}function tc(a,t,n,l){return Ga(a,n,l)!==Ga(t,n,l)&&Ga(a,t,n)!==Ga(a,t,l)}function $h(a,t,n){const l=n*n;if(t.length===1)return a.distSqr(t[0])<l;for(let m=1;m<t.length;m++)if(vr(a,t[m-1],t[m])<l)return!0;return!1}function vr(a,t,n){const l=t.distSqr(n);if(l===0)return a.distSqr(t);const m=((a.x-t.x)*(n.x-t.x)+(a.y-t.y)*(n.y-t.y))/l;return a.distSqr(m<0?t:m>1?n:n.sub(t)._mult(m)._add(t))}function Nf(a,t){let n,l,m,v=!1;for(let w=0;w<a.length;w++){n=a[w];for(let A=0,z=n.length-1;A<n.length;z=A++)l=n[A],m=n[z],l.y>t.y!=m.y>t.y&&t.x<(m.x-l.x)*(t.y-l.y)/(m.y-l.y)+l.x&&(v=!v)}return v}function Ic(a,t){let n=!1;for(let l=0,m=a.length-1;l<a.length;m=l++){const v=a[l],w=a[m];v.y>t.y!=w.y>t.y&&t.x<(w.x-v.x)*(t.y-v.y)/(w.y-v.y)+v.x&&(n=!n)}return n}function Ia(a,t,n){const l=n[0],m=n[2];if(a.x<l.x&&t.x<l.x||a.x>m.x&&t.x>m.x||a.y<l.y&&t.y<l.y||a.y>m.y&&t.y>m.y)return!1;const v=Ga(a,t,n[0]);return v!==Ga(a,t,n[1])||v!==Ga(a,t,n[2])||v!==Ga(a,t,n[3])}function ln(a,t,n){const l=t.paint.get(a).value;return l.kind==="constant"?l.value:n.programConfigurations.get(t.id).getMaxValue(a)}function Id(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function _u(a,t,n,l,m){if(!t[0]&&!t[1])return a;const v=Se.convert(t)._mult(m);n==="viewport"&&v._rotate(-l);const w=[];for(let A=0;A<a.length;A++)w.push(a[A].sub(v));return w}let $o,Od;si("CircleBucket",os,{omit:["layers"]});var Oa={get paint(){return Od=Od||new Fn({"circle-radius":new Ti(He.paint_circle["circle-radius"]),"circle-color":new Ti(He.paint_circle["circle-color"]),"circle-blur":new Ti(He.paint_circle["circle-blur"]),"circle-opacity":new Ti(He.paint_circle["circle-opacity"]),"circle-translate":new ui(He.paint_circle["circle-translate"]),"circle-translate-anchor":new ui(He.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ui(He.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ui(He.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ti(He.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ti(He.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ti(He.paint_circle["circle-stroke-opacity"])})},get layout(){return $o=$o||new Fn({"circle-sort-key":new Ti(He.layout_circle["circle-sort-key"])})}};class Mp extends Qn{constructor(t){super(t,Oa)}createBucket(t){return new os(t)}queryRadius(t){const n=t;return ln("circle-radius",this,n)+ln("circle-stroke-width",this,n)+Id(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:m,transform:v,pixelsToTileUnits:w,unwrappedTileID:A,getElevation:z}){const j=_u(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-v.bearingInRadians,w),G=this.paint.get("circle-radius").evaluate(n,l)+this.paint.get("circle-stroke-width").evaluate(n,l),Y=this.paint.get("circle-pitch-alignment")==="map",ee=Y?j:function(ue,fe,we,Pe){return ue.map(et=>jd(et,fe,we,Pe))}(j,v,A,z),ae=Y?G*w:G;for(const ue of m)for(const fe of ue){const we=Y?fe:jd(fe,v,A,z);let Pe=ae;const et=v.projectTileCoordinates(fe.x,fe.y,A,z).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Pe*=et/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Pe*=v.cameraToCenterDistance/et),sf(ee,we,Pe))return!0}return!1}}function jd(a,t,n,l){const m=t.projectTileCoordinates(a.x,a.y,n,l).point;return new Se((.5*m.x+.5)*t.width,(.5*-m.y+.5)*t.height)}class Cp extends os{}let Hh;si("HeatmapBucket",Cp,{omit:["layers"]});var Ff={get paint(){return Hh=Hh||new Fn({"heatmap-radius":new Ti(He.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ti(He.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ui(He.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vo(He.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ui(He.paint_heatmap["heatmap-opacity"])})}};function Bd(a,{width:t,height:n},l,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==t*n*l)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${t*n*l}`)}else m=new Uint8Array(t*n*l);return a.width=t,a.height=n,a.data=m,a}function Tl(a,{width:t,height:n},l){if(t===a.width&&n===a.height)return;const m=Bd({},{width:t,height:n},l);Nd(a,m,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,t),height:Math.min(a.height,n)},l),a.width=t,a.height=n,a.data=m.data}function Nd(a,t,n,l,m,v){if(m.width===0||m.height===0)return t;if(m.width>a.width||m.height>a.height||n.x>a.width-m.width||n.y>a.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>t.width||m.height>t.height||l.x>t.width-m.width||l.y>t.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const w=a.data,A=t.data;if(w===A)throw new Error("srcData equals dstData, so image is already copied");for(let z=0;z<m.height;z++){const j=((n.y+z)*a.width+n.x)*v,G=((l.y+z)*t.width+l.x)*v;for(let Y=0;Y<m.width*v;Y++)A[G+Y]=w[j+Y]}return t}class Zh{constructor(t,n){Bd(this,t,1,n)}resize(t){Tl(this,t,1)}clone(){return new Zh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,m,v){Nd(t,n,l,m,v,1)}}class Tn{constructor(t,n){Bd(this,t,4,n)}resize(t){Tl(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Tn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,m,v){Nd(t,n,l,m,v,4)}setPixel(t,n,l){const m=4*(t*this.width+n);this.data[m+0]=Math.round(255*l.r/l.a),this.data[m+1]=Math.round(255*l.g/l.a),this.data[m+2]=Math.round(255*l.b/l.a),this.data[m+3]=Math.round(255*l.a)}}function xu(a){const t={},n=a.resolution||256,l=a.clips?a.clips.length:1,m=a.image||new Tn({width:n,height:l});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const v=(w,A,z)=>{t[a.evaluationKey]=z;const j=a.expression.evaluate(t);m.setPixel(w/4/n,A/4,j)};if(a.clips)for(let w=0,A=0;w<l;++w,A+=4*n)for(let z=0,j=0;z<n;z++,j+=4){const G=z/(n-1),{start:Y,end:ee}=a.clips[w];v(A,j,Y*(1-G)+ee*G)}else for(let w=0,A=0;w<n;w++,A+=4)v(0,A,w/(n-1));return m}si("AlphaImage",Zh),si("RGBAImage",Tn);const hh="big-fb";class Ap extends Qn{createBucket(t){return new Cp(t)}constructor(t){super(t,Ff),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xu({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(hh)&&this.heatmapFbos.delete(hh)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ep;var lf={get paint(){return Ep=Ep||new Fn({"hillshade-illumination-direction":new ui(He.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new ui(He.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new ui(He.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ui(He.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ui(He.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ui(He.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ui(He.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new ui(He.paint_hillshade["hillshade-method"])})}};class ic extends Qn{constructor(t){super(t,lf),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,l=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values;const v=Math.max(t.length,n.length,l.length,m.length);t=t.concat(Array(v-t.length).fill(t.at(-1))),n=n.concat(Array(v-n.length).fill(n.at(-1))),l=l.concat(Array(v-l.length).fill(l.at(-1))),m=m.concat(Array(v-m.length).fill(m.at(-1)));const w=n.map(en);return{directionRadians:t.map(en),altitudeRadians:w,shadowColor:m,highlightColor:l}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let kp;var Uf={get paint(){return kp=kp||new Fn({"color-relief-opacity":new ui(He["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Vo(He["paint_color-relief"]["color-relief-color"])})}};class vu{constructor(t,n,l,m){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(n,m)}update(t,n,l){const{width:m,height:v}=t,w=!(this.size&&this.size[0]===m&&this.size[1]===v||l),{context:A}=this,{gl:z}=A;if(this.useMipmap=!!(n&&n.useMipmap),z.bindTexture(z.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===z.RGBA&&(!n||n.premultiply!==!1)),w)this.size=[m,v],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||$a(t)?z.texImage2D(z.TEXTURE_2D,0,this.format,this.format,z.UNSIGNED_BYTE,t):z.texImage2D(z.TEXTURE_2D,0,this.format,m,v,0,this.format,z.UNSIGNED_BYTE,t.data);else{const{x:j,y:G}=l||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||$a(t)?z.texSubImage2D(z.TEXTURE_2D,0,j,G,z.RGBA,z.UNSIGNED_BYTE,t):z.texSubImage2D(z.TEXTURE_2D,0,j,G,m,v,z.RGBA,z.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&z.generateMipmap(z.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,n,l){const{context:m}=this,{gl:v}=m;v.bindTexture(v.TEXTURE_2D,this.texture),l!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=v.LINEAR),t!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,t),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,l||t),this.filter=t),n!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,n),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class rc{constructor(t,n,l,m=1,v=1,w=1,A=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void qr(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const z=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=v,this.blueFactor=w,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let j=0;j<z;j++)this.data[this._idx(-1,j)]=this.data[this._idx(0,j)],this.data[this._idx(z,j)]=this.data[this._idx(z-1,j)],this.data[this._idx(j,-1)]=this.data[this._idx(j,0)],this.data[this._idx(j,z)]=this.data[this._idx(j,z-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(z,-1)]=this.data[this._idx(z-1,0)],this.data[this._idx(-1,z)]=this.data[this._idx(0,z-1)],this.data[this._idx(z,z)]=this.data[this._idx(z-1,z-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let j=0;j<z;j++)for(let G=0;G<z;G++){const Y=this.get(j,G);Y>this.max&&(this.max=Y),Y<this.min&&(this.min=Y)}}get(t,n){const l=new Uint8Array(this.data.buffer),m=4*this._idx(t,n);return this.unpack(l[m],l[m+1],l[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,l){return t*this.redFactor+n*this.greenFactor+l*this.blueFactor-this.baseShift}pack(t){return cf(t,this.getUnpackVector())}getPixels(){return new Tn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let m=n*this.dim,v=n*this.dim+this.dim,w=l*this.dim,A=l*this.dim+this.dim;switch(n){case-1:m=v-1;break;case 1:v=m+1}switch(l){case-1:w=A-1;break;case 1:A=w+1}const z=-n*this.dim,j=-l*this.dim;for(let G=w;G<A;G++)for(let Y=m;Y<v;Y++)this.data[this._idx(Y,G)]=t.data[this._idx(Y+z,G+j)]}}function cf(a,t){const n=t[0],l=t[1],m=t[2],v=t[3],w=Math.min(n,l,m),A=Math.round((a+v)/w);return{r:Math.floor(A*w/n)%256,g:Math.floor(A*w/l)%256,b:Math.floor(A*w/m)%256}}si("DEMData",rc);class Pp extends Qn{constructor(t){super(t,Uf)}_createColorRamp(t){const n={elevationStops:[],colorStops:[]},l=this._transitionablePaint._values["color-relief-color"].value.expression;if(l instanceof xi&&l._styleExpression.expression instanceof kn){this.colorRampExpression=l;const w=l._styleExpression.expression;n.elevationStops=w.labels,n.colorStops=[];for(const A of n.elevationStops)n.colorStops.push(w.evaluate({globals:{elevation:A}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[Ui.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=t)return n;const m={elevationStops:[],colorStops:[]},v=(n.elevationStops.length-1)/(t-1);for(let w=0;w<n.elevationStops.length-.5;w+=v)m.elevationStops.push(n.elevationStops[Math.round(w)]),m.colorStops.push(n.colorStops[Math.round(w)]);return qr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,n,l){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const m=this._createColorRamp(n),v=new Tn({width:m.colorStops.length,height:1}),w=new Tn({width:m.colorStops.length,height:1});for(let A=0;A<m.elevationStops.length;A++){const z=cf(m.elevationStops[A],l);w.setPixel(0,A,new Ui(z.r/255,z.g/255,z.b/255,1)),v.setPixel(0,A,m.colorStops[A])}return this.colorRampTextures={elevationTexture:new vu(t,w,t.gl.RGBA),colorTexture:new vu(t,v,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const qh=er([{name:"a_pos",components:2,type:"Int16"}],4),{members:yn}=qh;function Fd(a,t,n){const l=n.patternDependencies;let m=!1;for(const v of t){const w=v.paint.get(`${a}-pattern`);w.isConstant()||(m=!0);const A=w.constantOr(null);A&&(m=!0,l[A.to]=!0,l[A.from]=!0)}return m}function dh(a,t,n,l,m){const v=m.patternDependencies;for(const w of t){const A=w.paint.get(`${a}-pattern`).value;if(A.kind!=="constant"){let z=A.evaluate({zoom:l-1},n,{},m.availableImages),j=A.evaluate({zoom:l},n,{},m.availableImages),G=A.evaluate({zoom:l+1},n,{},m.availableImages);z=z&&z.name?z.name:z,j=j&&j.name?j.name:j,G=G&&G.name?G.name:G,v[z]=!0,v[j]=!0,v[G]=!0,n.patterns[w.id]={min:z,mid:j,max:G}}}return n}function zp(a,t,n,l,m){let v;if(m===function(w,A,z,j){let G=0;for(let Y=A,ee=z-j;Y<z;Y+=j)G+=(w[ee]-w[Y])*(w[Y+1]+w[ee+1]),ee=Y;return G}(a,t,n,l)>0)for(let w=t;w<n;w+=l)v=cn(w/l|0,a[w],a[w+1],v);else for(let w=n-l;w>=t;w-=l)v=cn(w/l|0,a[w],a[w+1],v);return v&&wu(v,v.next)&&(ja(v),v=v.next),v}function Ml(a,t){if(!a)return a;t||(t=a);let n,l=a;do if(n=!1,l.steiner||!wu(l,l.next)&&or(l.prev,l,l.next)!==0)l=l.next;else{if(ja(l),l=t=l.prev,l===l.next)break;n=!0}while(n||l!==t);return t}function Ho(a,t,n,l,m,v,w){if(!a)return;!w&&v&&function(z,j,G,Y){let ee=z;do ee.z===0&&(ee.z=ph(ee.x,ee.y,j,G,Y)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==z);ee.prevZ.nextZ=null,ee.prevZ=null,function(ae){let ue,fe=1;do{let we,Pe=ae;ae=null;let et=null;for(ue=0;Pe;){ue++;let Be=Pe,re=0;for(let Fe=0;Fe<fe&&(re++,Be=Be.nextZ,Be);Fe++);let ve=fe;for(;re>0||ve>0&&Be;)re!==0&&(ve===0||!Be||Pe.z<=Be.z)?(we=Pe,Pe=Pe.nextZ,re--):(we=Be,Be=Be.nextZ,ve--),et?et.nextZ=we:ae=we,we.prevZ=et,et=we;Pe=Be}et.nextZ=null,fe*=2}while(ue>1)}(ee)}(a,l,m,v);let A=a;for(;a.prev!==a.next;){const z=a.prev,j=a.next;if(v?Xh(a,l,m,v):uf(a))t.push(z.i,a.i,j.i),ja(a),a=j.next,A=j.next;else if((a=j)===A){w?w===1?Ho(a=Yh(Ml(a),t),t,n,l,m,v,2):w===2&&nc(a,t,n,l,m,v):Ho(Ml(a),t,n,l,m,v,1);break}}}function uf(a){const t=a.prev,n=a,l=a.next;if(or(t,n,l)>=0)return!1;const m=t.x,v=n.x,w=l.x,A=t.y,z=n.y,j=l.y,G=Math.min(m,v,w),Y=Math.min(A,z,j),ee=Math.max(m,v,w),ae=Math.max(A,z,j);let ue=l.next;for(;ue!==t;){if(ue.x>=G&&ue.x<=ee&&ue.y>=Y&&ue.y<=ae&&Wh(m,A,v,z,w,j,ue.x,ue.y)&&or(ue.prev,ue,ue.next)>=0)return!1;ue=ue.next}return!0}function Xh(a,t,n,l){const m=a.prev,v=a,w=a.next;if(or(m,v,w)>=0)return!1;const A=m.x,z=v.x,j=w.x,G=m.y,Y=v.y,ee=w.y,ae=Math.min(A,z,j),ue=Math.min(G,Y,ee),fe=Math.max(A,z,j),we=Math.max(G,Y,ee),Pe=ph(ae,ue,t,n,l),et=ph(fe,we,t,n,l);let Be=a.prevZ,re=a.nextZ;for(;Be&&Be.z>=Pe&&re&&re.z<=et;){if(Be.x>=ae&&Be.x<=fe&&Be.y>=ue&&Be.y<=we&&Be!==m&&Be!==w&&Wh(A,G,z,Y,j,ee,Be.x,Be.y)&&or(Be.prev,Be,Be.next)>=0||(Be=Be.prevZ,re.x>=ae&&re.x<=fe&&re.y>=ue&&re.y<=we&&re!==m&&re!==w&&Wh(A,G,z,Y,j,ee,re.x,re.y)&&or(re.prev,re,re.next)>=0))return!1;re=re.nextZ}for(;Be&&Be.z>=Pe;){if(Be.x>=ae&&Be.x<=fe&&Be.y>=ue&&Be.y<=we&&Be!==m&&Be!==w&&Wh(A,G,z,Y,j,ee,Be.x,Be.y)&&or(Be.prev,Be,Be.next)>=0)return!1;Be=Be.prevZ}for(;re&&re.z<=et;){if(re.x>=ae&&re.x<=fe&&re.y>=ue&&re.y<=we&&re!==m&&re!==w&&Wh(A,G,z,Y,j,ee,re.x,re.y)&&or(re.prev,re,re.next)>=0)return!1;re=re.nextZ}return!0}function Yh(a,t){let n=a;do{const l=n.prev,m=n.next.next;!wu(l,m)&&df(l,n,n.next,m)&&Kh(l,m)&&Kh(m,l)&&(t.push(l.i,n.i,m.i),ja(n),ja(n.next),n=a=m),n=n.next}while(n!==a);return Ml(n)}function nc(a,t,n,l,m,v){let w=a;do{let A=w.next.next;for(;A!==w.prev;){if(w.i!==A.i&&Oc(w,A)){let z=pf(w,A);return w=Ml(w,w.next),z=Ml(z,z.next),Ho(w,t,n,l,m,v,0),void Ho(z,t,n,l,m,v,0)}A=A.next}w=w.next}while(w!==a)}function Vf(a,t){let n=a.x-t.x;return n===0&&(n=a.y-t.y,n===0)&&(n=(a.next.y-a.y)/(a.next.x-a.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function Ud(a,t){const n=function(m,v){let w=v;const A=m.x,z=m.y;let j,G=-1/0;if(wu(m,w))return w;do{if(wu(m,w.next))return w.next;if(z<=w.y&&z>=w.next.y&&w.next.y!==w.y){const fe=w.x+(z-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(fe<=A&&fe>G&&(G=fe,j=w.x<w.next.x?w:w.next,fe===A))return j}w=w.next}while(w!==v);if(!j)return null;const Y=j,ee=j.x,ae=j.y;let ue=1/0;w=j;do{if(A>=w.x&&w.x>=ee&&A!==w.x&&Vd(z<ae?A:G,z,ee,ae,z<ae?G:A,z,w.x,w.y)){const fe=Math.abs(z-w.y)/(A-w.x);Kh(w,m)&&(fe<ue||fe===ue&&(w.x>j.x||w.x===j.x&&bu(j,w)))&&(j=w,ue=fe)}w=w.next}while(w!==Y);return j}(a,t);if(!n)return t;const l=pf(n,a);return Ml(l,l.next),Ml(n,n.next)}function bu(a,t){return or(a.prev,a,t.prev)<0&&or(t.next,a,a.next)<0}function ph(a,t,n,l,m){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-n)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*m|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function hf(a){let t=a,n=a;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==a);return n}function Vd(a,t,n,l,m,v,w,A){return(m-w)*(t-A)>=(a-w)*(v-A)&&(a-w)*(l-A)>=(n-w)*(t-A)&&(n-w)*(v-A)>=(m-w)*(l-A)}function Wh(a,t,n,l,m,v,w,A){return!(a===w&&t===A)&&Vd(a,t,n,l,m,v,w,A)}function Oc(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(n,l){let m=n;do{if(m.i!==n.i&&m.next.i!==n.i&&m.i!==l.i&&m.next.i!==l.i&&df(m,m.next,n,l))return!0;m=m.next}while(m!==n);return!1}(a,t)&&(Kh(a,t)&&Kh(t,a)&&function(n,l){let m=n,v=!1;const w=(n.x+l.x)/2,A=(n.y+l.y)/2;do m.y>A!=m.next.y>A&&m.next.y!==m.y&&w<(m.next.x-m.x)*(A-m.y)/(m.next.y-m.y)+m.x&&(v=!v),m=m.next;while(m!==n);return v}(a,t)&&(or(a.prev,a,t.prev)||or(a,t.prev,t))||wu(a,t)&&or(a.prev,a,a.next)>0&&or(t.prev,t,t.next)>0)}function or(a,t,n){return(t.y-a.y)*(n.x-t.x)-(t.x-a.x)*(n.y-t.y)}function wu(a,t){return a.x===t.x&&a.y===t.y}function df(a,t,n,l){const m=Lp(or(a,t,n)),v=Lp(or(a,t,l)),w=Lp(or(n,l,a)),A=Lp(or(n,l,t));return m!==v&&w!==A||!(m!==0||!Hn(a,n,t))||!(v!==0||!Hn(a,l,t))||!(w!==0||!Hn(n,a,l))||!(A!==0||!Hn(n,t,l))}function Hn(a,t,n){return t.x<=Math.max(a.x,n.x)&&t.x>=Math.min(a.x,n.x)&&t.y<=Math.max(a.y,n.y)&&t.y>=Math.min(a.y,n.y)}function Lp(a){return a>0?1:a<0?-1:0}function Kh(a,t){return or(a.prev,a,a.next)<0?or(a,t,a.next)>=0&&or(a,a.prev,t)>=0:or(a,t,a.prev)<0||or(a,a.next,t)<0}function pf(a,t){const n=Zo(a.i,a.x,a.y),l=Zo(t.i,t.x,t.y),m=a.next,v=t.prev;return a.next=t,t.prev=a,n.next=m,m.prev=n,l.next=n,n.prev=l,v.next=l,l.prev=v,l}function cn(a,t,n,l){const m=Zo(a,t,n);return l?(m.next=l.next,m.prev=l,l.next.prev=m,l.next=m):(m.prev=m,m.next=m),m}function ja(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Zo(a,t,n){return{i:a,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class jc{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Gd{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Gd.noSubdivision=new Gd({fill:new jc(0,0),line:new jc(0,0),tile:new jc(0,0),stencil:new jc(0,0),circle:1}),si("SubdivisionGranularityExpression",jc),si("SubdivisionGranularitySetting",Gd);const Qh=-32768,fh=32767;class ls{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Ht/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|n+32768}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const l=0|Math.round(t),m=0|Math.round(n),v=this._getKey(l,m);if(this._vertexDictionary.has(v))return this._vertexDictionary.get(v);const w=this._vertexBuffer.length/2;return this._vertexDictionary.set(v,w),this._vertexBuffer.push(l,m),w}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(m,v){const w=[];for(let A=0;A<v.length;A+=3){const z=v[A],j=v[A+1],G=v[A+2],Y=m[2*z],ee=m[2*z+1];(m[2*j]-Y)*(m[2*G+1]-ee)-(m[2*j+1]-ee)*(m[2*G]-Y)>0?(w.push(z),w.push(G),w.push(j)):(w.push(z),w.push(j),w.push(G))}return w}(this._vertexBuffer,t);const n=[],l=t.length;for(let m=0;m<l;m+=3){const v=[t[m+0],t[m+1],t[m+2]],w=[this._vertexBuffer[2*t[m+0]+0],this._vertexBuffer[2*t[m+0]+1],this._vertexBuffer[2*t[m+1]+0],this._vertexBuffer[2*t[m+1]+1],this._vertexBuffer[2*t[m+2]+0],this._vertexBuffer[2*t[m+2]+1]];let A=1/0,z=1/0,j=-1/0,G=-1/0;for(let fe=0;fe<3;fe++){const we=w[2*fe],Pe=w[2*fe+1];A=Math.min(A,we),j=Math.max(j,we),z=Math.min(z,Pe),G=Math.max(G,Pe)}if(A===j||z===G)continue;const Y=Math.floor(A/this._granularityCellSize),ee=Math.ceil(j/this._granularityCellSize),ae=Math.floor(z/this._granularityCellSize),ue=Math.ceil(G/this._granularityCellSize);if(Y!==ee||ae!==ue)for(let fe=ae;fe<ue;fe++){const we=this._scanlineGenerateVertexRingForCellRow(fe,w,v);xo(this._vertexBuffer,we,n)}else n.push(...v)}return n}_scanlineGenerateVertexRingForCellRow(t,n,l){const m=t*this._granularityCellSize,v=m+this._granularityCellSize,w=[];for(let A=0;A<3;A++){const z=n[2*A],j=n[2*A+1],G=n[2*(A+1)%6],Y=n[(2*(A+1)+1)%6],ee=n[2*(A+2)%6],ae=n[(2*(A+2)+1)%6],ue=G-z,fe=Y-j,we=ue===0,Pe=fe===0,et=(m-j)/fe,Be=(v-j)/fe,re=Math.min(et,Be),ve=Math.max(et,Be);if(!Pe&&(re>=1||ve<=0)||Pe&&(j<m||j>v)){Y>=m&&Y<=v&&w.push(l[(A+1)%3]);continue}!Pe&&re>0&&w.push(this._vertexToIndex(z+ue*re,j+fe*re));const Fe=z+ue*Math.max(re,0),xt=z+ue*Math.min(ve,1);we||this._generateIntraEdgeVertices(w,z,j,G,Y,Fe,xt),!Pe&&ve<1&&w.push(this._vertexToIndex(z+ue*ve,j+fe*ve)),(Pe||Y>=m&&Y<=v)&&w.push(l[(A+1)%3]),!Pe&&(Y<=m||Y>=v)&&this._generateInterEdgeVertices(w,z,j,G,Y,ee,ae,xt,m,v)}return w}_generateIntraEdgeVertices(t,n,l,m,v,w,A){const z=m-n,j=v-l,G=j===0,Y=G?Math.min(n,m):Math.min(w,A),ee=G?Math.max(n,m):Math.max(w,A),ae=Math.floor(Y/this._granularityCellSize)+1,ue=Math.ceil(ee/this._granularityCellSize)-1;if(G?n<m:w<A)for(let fe=ae;fe<=ue;fe++){const we=fe*this._granularityCellSize;t.push(this._vertexToIndex(we,l+j*(we-n)/z))}else for(let fe=ue;fe>=ae;fe--){const we=fe*this._granularityCellSize;t.push(this._vertexToIndex(we,l+j*(we-n)/z))}}_generateInterEdgeVertices(t,n,l,m,v,w,A,z,j,G){const Y=v-l,ee=w-m,ae=A-v,ue=(j-v)/ae,fe=(G-v)/ae,we=Math.min(ue,fe),Pe=Math.max(ue,fe),et=m+ee*we;let Be=Math.floor(Math.min(et,z)/this._granularityCellSize)+1,re=Math.ceil(Math.max(et,z)/this._granularityCellSize)-1,ve=z<et;const Fe=ae===0;if(Fe&&(A===j||A===G))return;if(Fe||we>=1||Pe<=0){const Nt=l-A,Mt=w+(n-w)*Math.min((j-A)/Nt,(G-A)/Nt);Be=Math.floor(Math.min(Mt,z)/this._granularityCellSize)+1,re=Math.ceil(Math.max(Mt,z)/this._granularityCellSize)-1,ve=z<Mt}const xt=Y>0?G:j;if(ve)for(let Nt=Be;Nt<=re;Nt++)t.push(this._vertexToIndex(Nt*this._granularityCellSize,xt));else for(let Nt=re;Nt>=Be;Nt--)t.push(this._vertexToIndex(Nt*this._granularityCellSize,xt))}_generateOutline(t){const n=[];for(const l of t){const m=Bc(l,this._granularity,!0),v=this._pointArrayToIndices(m),w=[];for(let A=1;A<v.length;A++)w.push(v[A-1]),w.push(v[A]);n.push(w)}return n}_handlePoles(t){let n=!1,l=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(l=!0)),(n||l)&&this._fillPoles(t,n,l)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const l=t[n+1];l===Qh&&(t[n+1]=-32767),l===fh&&(t[n+1]=32766)}}_generatePoleQuad(t,n,l,m,v,w){m>v!=(w===Qh)?(t.push(n),t.push(l),t.push(this._vertexToIndex(m,w)),t.push(l),t.push(this._vertexToIndex(v,w)),t.push(this._vertexToIndex(m,w))):(t.push(l),t.push(n),t.push(this._vertexToIndex(m,w)),t.push(this._vertexToIndex(v,w)),t.push(l),t.push(this._vertexToIndex(m,w)))}_fillPoles(t,n,l){const m=this._vertexBuffer,v=Ht,w=t.length;for(let A=2;A<w;A+=3){const z=t[A-2],j=t[A-1],G=t[A],Y=m[2*z],ee=m[2*z+1],ae=m[2*j],ue=m[2*j+1],fe=m[2*G],we=m[2*G+1];n&&(ee===0&&ue===0&&this._generatePoleQuad(t,z,j,Y,ae,Qh),ue===0&&we===0&&this._generatePoleQuad(t,j,G,ae,fe,Qh),we===0&&ee===0&&this._generatePoleQuad(t,G,z,fe,Y,Qh)),l&&(ee===v&&ue===v&&this._generatePoleQuad(t,z,j,Y,ae,fh),ue===v&&we===v&&this._generatePoleQuad(t,j,G,ae,fe,fh),we===v&&ee===v&&this._generatePoleQuad(t,G,z,fe,Y,fh))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:l,holeIndices:m}=function(A){const z=[],j=[];for(const G of A)if(G.length!==0){G!==A[0]&&z.push(j.length/2);for(let Y=0;Y<G.length;Y++)j.push(G[Y].x),j.push(G[Y].y)}return{flattened:j,holeIndices:z}}(t);let v;this._initializeVertices(l);try{const A=function(j,G,Y=2){const ee=G&&G.length,ae=ee?G[0]*Y:j.length;let ue=zp(j,0,ae,Y,!0);const fe=[];if(!ue||ue.next===ue.prev)return fe;let we,Pe,et;if(ee&&(ue=function(Be,re,ve,Fe){const xt=[];for(let Nt=0,Mt=re.length;Nt<Mt;Nt++){const kt=zp(Be,re[Nt]*Fe,Nt<Mt-1?re[Nt+1]*Fe:Be.length,Fe,!1);kt===kt.next&&(kt.steiner=!0),xt.push(hf(kt))}xt.sort(Vf);for(let Nt=0;Nt<xt.length;Nt++)ve=Ud(xt[Nt],ve);return ve}(j,G,ue,Y)),j.length>80*Y){we=1/0,Pe=1/0;let Be=-1/0,re=-1/0;for(let ve=Y;ve<ae;ve+=Y){const Fe=j[ve],xt=j[ve+1];Fe<we&&(we=Fe),xt<Pe&&(Pe=xt),Fe>Be&&(Be=Fe),xt>re&&(re=xt)}et=Math.max(Be-we,re-Pe),et=et!==0?32767/et:0}return Ho(ue,fe,Y,we,Pe,et,0),fe}(l,m),z=this._convertIndices(l,A);v=this._subdivideTrianglesScanline(z)}catch(A){console.error(A)}let w=[];return n&&(w=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(v),{verticesFlattened:this._vertexBuffer,indicesTriangles:v,indicesLineList:w}}_convertIndices(t,n){const l=[];for(let m=0;m<n.length;m++)l.push(this._vertexToIndex(t[2*n[m]],t[2*n[m]+1]));return l}_pointArrayToIndices(t){const n=[];for(let l=0;l<t.length;l++){const m=t[l];n.push(this._vertexToIndex(m.x,m.y))}return n}}function Fs(a,t,n,l=!0){return new ls(n,t).subdividePolygonInternal(a,l)}function Bc(a,t,n=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const l=a[0],m=a[a.length-1],v=n&&(l.x!==m.x||l.y!==m.y);if(t<2)return v?[...a,a[0]]:[...a];const w=Math.floor(Ht/t),A=[];A.push(new Se(a[0].x,a[0].y));const z=a.length,j=v?z:z-1;for(let G=0;G<j;G++){const Y=a[G],ee=G<z-1?a[G+1]:a[0],ae=Y.x,ue=Y.y,fe=ee.x,we=ee.y,Pe=ae!==fe,et=ue!==we;if(!Pe&&!et)continue;const Be=fe-ae,re=we-ue,ve=Math.abs(Be),Fe=Math.abs(re);let xt=ae,Nt=ue;for(;;){const kt=Be>0?(Math.floor(xt/w)+1)*w:(Math.ceil(xt/w)-1)*w,qt=re>0?(Math.floor(Nt/w)+1)*w:(Math.ceil(Nt/w)-1)*w,Ut=Math.abs(xt-kt),Xt=Math.abs(Nt-qt),Rt=Math.abs(xt-fe),gi=Math.abs(Nt-we),Ei=Pe?Ut/ve:Number.POSITIVE_INFINITY,Si=et?Xt/Fe:Number.POSITIVE_INFINITY;if((Rt<=Ut||!Pe)&&(gi<=Xt||!et))break;if(Ei<Si&&Pe||!et){xt=kt,Nt+=re*Ei;const mi=new Se(xt,Math.round(Nt));A[A.length-1].x===mi.x&&A[A.length-1].y===mi.y||A.push(mi)}else{xt+=Be*Si,Nt=qt;const mi=new Se(Math.round(xt),Nt);A[A.length-1].x===mi.x&&A[A.length-1].y===mi.y||A.push(mi)}}const Mt=new Se(fe,we);A[A.length-1].x===Mt.x&&A[A.length-1].y===Mt.y||A.push(Mt)}return A}function xo(a,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let l=0,m=a[2*t[0]];for(let z=1;z<t.length;z++){const j=a[2*t[z]];j<m&&(m=j,l=z)}const v=t.length;let w=l,A=(w+1)%v;for(;;){const z=w-1>=0?w-1:v-1,j=(A+1)%v,G=a[2*t[z]],Y=a[2*t[j]],ee=a[2*t[w]],ae=a[2*t[w]+1],ue=a[2*t[A]+1];let fe=!1;if(G<Y)fe=!0;else if(G>Y)fe=!1;else{const we=ue-ae,Pe=-(a[2*t[A]]-ee),et=ae<ue?1:-1;((G-ee)*we+(a[2*t[z]+1]-ae)*Pe)*et>((Y-ee)*we+(a[2*t[j]+1]-ae)*Pe)*et&&(fe=!0)}if(fe){const we=t[z],Pe=t[w],et=t[A];we!==Pe&&we!==et&&Pe!==et&&n.push(et,Pe,we),w--,w<0&&(w=v-1)}else{const we=t[j],Pe=t[w],et=t[A];we!==Pe&&we!==et&&Pe!==et&&n.push(et,Pe,we),A++,A>=v&&(A=0)}if(z===j)break}}function Jh(a,t,n,l,m,v,w,A,z){const j=m.length/2,G=w&&A&&z;if(j<hr.MAX_VERTEX_ARRAY_LENGTH){const Y=t.prepareSegment(j,n,l),ee=Y.vertexLength;for(let fe=0;fe<v.length;fe+=3)l.emplaceBack(ee+v[fe],ee+v[fe+1],ee+v[fe+2]);let ae,ue;Y.vertexLength+=j,Y.primitiveLength+=v.length/3,G&&(ue=w.prepareSegment(j,n,A),ae=ue.vertexLength,ue.vertexLength+=j);for(let fe=0;fe<m.length;fe+=2)a(m[fe],m[fe+1]);if(G)for(let fe=0;fe<z.length;fe++){const we=z[fe];for(let Pe=1;Pe<we.length;Pe+=2)A.emplaceBack(ae+we[Pe-1],ae+we[Pe]);ue.primitiveLength+=we.length/2}}else(function(Y,ee,ae,ue,fe,we){const Pe=[];for(let Fe=0;Fe<ue.length/2;Fe++)Pe.push(-1);const et={count:0};let Be=0,re=Y.getOrCreateLatestSegment(ee,ae),ve=re.vertexLength;for(let Fe=2;Fe<fe.length;Fe+=3){const xt=fe[Fe-2],Nt=fe[Fe-1],Mt=fe[Fe];let kt=Pe[xt]<Be,qt=Pe[Nt]<Be,Ut=Pe[Mt]<Be;re.vertexLength+((kt?1:0)+(qt?1:0)+(Ut?1:0))>hr.MAX_VERTEX_ARRAY_LENGTH&&(re=Y.createNewSegment(ee,ae),Be=et.count,kt=!0,qt=!0,Ut=!0,ve=0);const Xt=Us(Pe,ue,we,et,xt,kt,re),Rt=Us(Pe,ue,we,et,Nt,qt,re),gi=Us(Pe,ue,we,et,Mt,Ut,re);ae.emplaceBack(ve+Xt-Be,ve+Rt-Be,ve+gi-Be),re.primitiveLength++}})(t,n,l,m,v,a),G&&function(Y,ee,ae,ue,fe,we){const Pe=[];for(let Fe=0;Fe<ue.length/2;Fe++)Pe.push(-1);const et={count:0};let Be=0,re=Y.getOrCreateLatestSegment(ee,ae),ve=re.vertexLength;for(let Fe=0;Fe<fe.length;Fe++){const xt=fe[Fe];for(let Nt=1;Nt<fe[Fe].length;Nt+=2){const Mt=xt[Nt-1],kt=xt[Nt];let qt=Pe[Mt]<Be,Ut=Pe[kt]<Be;re.vertexLength+((qt?1:0)+(Ut?1:0))>hr.MAX_VERTEX_ARRAY_LENGTH&&(re=Y.createNewSegment(ee,ae),Be=et.count,qt=!0,Ut=!0,ve=0);const Xt=Us(Pe,ue,we,et,Mt,qt,re),Rt=Us(Pe,ue,we,et,kt,Ut,re);ae.emplaceBack(ve+Xt-Be,ve+Rt-Be),re.primitiveLength++}}}(w,n,A,m,z,a),t.forceNewSegmentOnNextPrepare(),w==null||w.forceNewSegmentOnNextPrepare()}function Us(a,t,n,l,m,v,w){if(v){const A=l.count;return n(t[2*m],t[2*m+1]),a[m]=l.count,l.count++,w.vertexLength++,A}return a[m]}class ac{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new wt,this.indexArray=new cr,this.indexArray2=new nr,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new hr,this.segments2=new hr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l){this.hasPattern=Fd("fill",this.layers,n);const m=this.layers[0].layout.get("fill-sort-key"),v=!m.isConstant(),w=[];for(const{feature:A,id:z,index:j,sourceLayerIndex:G}of t){const Y=this.layers[0]._featureFilter.needGeometry,ee=Jl(A,Y);if(!this.layers[0]._featureFilter.filter(new Xr(this.zoom,{globalState:this.globalState}),ee,l))continue;const ae=v?m.evaluate(ee,{},l,n.availableImages):void 0,ue={id:z,properties:A.properties,type:A.type,sourceLayerIndex:G,index:j,geometry:Y?ee.geometry:Sl(A),patterns:{},sortKey:ae};w.push(ue)}v&&w.sort((A,z)=>A.sortKey-z.sortKey);for(const A of w){const{geometry:z,index:j,sourceLayerIndex:G}=A;if(this.hasPattern){const Y=dh("fill",this.layers,A,this.zoom,n);this.patternFeatures.push(Y)}else this.addFeature(A,z,j,l,{},n.subdivisionGranularity);n.featureIndex.insert(t[j].feature,z,j,G,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l)}addFeatures(t,n,l){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yn),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,l,m,v,w){for(const A of Dh(n,500)){const z=Fs(A,m,w.fill.getGranularityForZoomLevel(m.z)),j=this.layoutVertexArray;Jh((G,Y)=>{j.emplaceBack(G,Y)},this.segments,this.layoutVertexArray,this.indexArray,z.verticesFlattened,z.indicesTriangles,this.segments2,this.indexArray2,z.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,v,m)}}let Nc,ed;si("FillBucket",ac,{omit:["layers","patternFeatures"]});var ff={get paint(){return ed=ed||new Fn({"fill-antialias":new ui(He.paint_fill["fill-antialias"]),"fill-opacity":new Ti(He.paint_fill["fill-opacity"]),"fill-color":new Ti(He.paint_fill["fill-color"]),"fill-outline-color":new Ti(He.paint_fill["fill-outline-color"]),"fill-translate":new ui(He.paint_fill["fill-translate"]),"fill-translate-anchor":new ui(He.paint_fill["fill-translate-anchor"]),"fill-pattern":new oh(He.paint_fill["fill-pattern"])})},get layout(){return Nc=Nc||new Fn({"fill-sort-key":new Ti(He.layout_fill["fill-sort-key"])})}};class sc extends Qn{constructor(t){super(t,ff)}recalculate(t,n){super.recalculate(t,n);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new ac(t)}queryRadius(){return Id(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:l,pixelsToTileUnits:m}){return of(_u(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-l.bearingInRadians,m),n)}isTileClipped(){return!0}}const Dp=er([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),td=er([{name:"a_centroid",components:2,type:"Int16"}],4),{members:$d}=Dp;var mh,oc,gh,Rp,Su,Ip,id,Tu={};function Op(){if(oc)return mh;oc=1;var a=Ve();function t(m,v,w,A,z){this.properties={},this.extent=w,this.type=0,this._pbf=m,this._geometry=-1,this._keys=A,this._values=z,m.readFields(n,this,v)}function n(m,v,w){m==1?v.id=w.readVarint():m==2?function(A,z){for(var j=A.readVarint()+A.pos;A.pos<j;){var G=z._keys[A.readVarint()],Y=z._values[A.readVarint()];z.properties[G]=Y}}(w,v):m==3?v.type=w.readVarint():m==4&&(v._geometry=w.pos)}function l(m){for(var v,w,A=0,z=0,j=m.length,G=j-1;z<j;G=z++)A+=((w=m[G]).x-(v=m[z]).x)*(v.y+w.y);return A}return mh=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var v,w=m.readVarint()+m.pos,A=1,z=0,j=0,G=0,Y=[];m.pos<w;){if(z<=0){var ee=m.readVarint();A=7&ee,z=ee>>3}if(z--,A===1||A===2)j+=m.readSVarint(),G+=m.readSVarint(),A===1&&(v&&Y.push(v),v=[]),v.push(new a(j,G));else{if(A!==7)throw new Error("unknown command "+A);v&&v.push(v[0].clone())}}return v&&Y.push(v),Y},t.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var v=m.readVarint()+m.pos,w=1,A=0,z=0,j=0,G=1/0,Y=-1/0,ee=1/0,ae=-1/0;m.pos<v;){if(A<=0){var ue=m.readVarint();w=7&ue,A=ue>>3}if(A--,w===1||w===2)(z+=m.readSVarint())<G&&(G=z),z>Y&&(Y=z),(j+=m.readSVarint())<ee&&(ee=j),j>ae&&(ae=j);else if(w!==7)throw new Error("unknown command "+w)}return[G,ee,Y,ae]},t.prototype.toGeoJSON=function(m,v,w){var A,z,j=this.extent*Math.pow(2,w),G=this.extent*m,Y=this.extent*v,ee=this.loadGeometry(),ae=t.types[this.type];function ue(Pe){for(var et=0;et<Pe.length;et++){var Be=Pe[et];Pe[et]=[360*(Be.x+G)/j-180,360/Math.PI*Math.atan(Math.exp((180-360*(Be.y+Y)/j)*Math.PI/180))-90]}}switch(this.type){case 1:var fe=[];for(A=0;A<ee.length;A++)fe[A]=ee[A][0];ue(ee=fe);break;case 2:for(A=0;A<ee.length;A++)ue(ee[A]);break;case 3:for(ee=function(Pe){var et=Pe.length;if(et<=1)return[Pe];for(var Be,re,ve=[],Fe=0;Fe<et;Fe++){var xt=l(Pe[Fe]);xt!==0&&(re===void 0&&(re=xt<0),re===xt<0?(Be&&ve.push(Be),Be=[Pe[Fe]]):Be.push(Pe[Fe]))}return Be&&ve.push(Be),ve}(ee),A=0;A<ee.length;A++)for(z=0;z<ee[A].length;z++)ue(ee[A][z])}ee.length===1?ee=ee[0]:ae="Multi"+ae;var we={type:"Feature",geometry:{type:ae,coordinates:ee},properties:this.properties};return"id"in this&&(we.id=this.id),we},mh}function rd(){if(Rp)return gh;Rp=1;var a=Op();function t(l,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(n,this,m),this.length=this._features.length}function n(l,m,v){l===15?m.version=v.readVarint():l===1?m.name=v.readString():l===5?m.extent=v.readVarint():l===2?m._features.push(v.pos):l===3?m._keys.push(v.readString()):l===4&&m._values.push(function(w){for(var A=null,z=w.readVarint()+w.pos;w.pos<z;){var j=w.readVarint()>>3;A=j===1?w.readString():j===2?w.readFloat():j===3?w.readDouble():j===4?w.readVarint64():j===5?w.readVarint():j===6?w.readSVarint():j===7?w.readBoolean():null}return A}(v))}return gh=t,t.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var m=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,m,this.extent,this._keys,this._values)},gh}function $r(){return id||(id=1,Tu.VectorTile=function(){if(Ip)return Su;Ip=1;var a=rd();function t(n,l,m){if(n===3){var v=new a(m,m.readVarint()+m.pos);v.length&&(l[v.name]=v)}}return Su=function(n,l){this.layers=n.readFields(t,{},l)},Su}(),Tu.VectorTileFeature=Op(),Tu.VectorTileLayer=rd()),Tu}var Pr=oe($r());const gr=Pr.VectorTileFeature.types,Sr=Math.pow(2,13);function zr(a,t,n,l,m,v,w,A){a.emplaceBack(t,n,2*Math.floor(l*Sr)+w,m*Sr*2,v*Sr*2,Math.round(A))}class Zn{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ei,this.centroidVertexArray=new ot,this.indexArray=new cr,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new hr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l){this.features=[],this.hasPattern=Fd("fill-extrusion",this.layers,n);for(const{feature:m,id:v,index:w,sourceLayerIndex:A}of t){const z=this.layers[0]._featureFilter.needGeometry,j=Jl(m,z);if(!this.layers[0]._featureFilter.filter(new Xr(this.zoom,{globalState:this.globalState}),j,l))continue;const G={id:v,sourceLayerIndex:A,index:w,geometry:z?j.geometry:Sl(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(dh("fill-extrusion",this.layers,G,this.zoom,n)):this.addFeature(G,G.geometry,w,l,{},n.subdivisionGranularity),n.featureIndex.insert(m,G.geometry,w,A,this.index,!0)}}addFeatures(t,n,l){for(const m of this.features){const{geometry:v}=m;this.addFeature(m,v,m.index,n,l,t.subdivisionGranularity)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$d),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,td.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,l,m,v,w){for(const A of Dh(n,500)){const z={x:0,y:0,sampleCount:0},j=this.layoutVertexArray.length;this.processPolygon(z,m,t,A,w);const G=this.layoutVertexArray.length-j,Y=Math.floor(z.x/z.sampleCount),ee=Math.floor(z.y/z.sampleCount);for(let ae=0;ae<G;ae++)this.centroidVertexArray.emplaceBack(Y,ee)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,v,m)}processPolygon(t,n,l,m,v){if(m.length<1||Hd(m[0]))return;for(const Y of m)Y.length!==0&&Fc(t,Y);const w={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=v.fill.getGranularityForZoomLevel(n.z),z=gr[l.type]==="Polygon";for(const Y of m){if(Y.length===0||Hd(Y))continue;const ee=Bc(Y,A,z);this._generateSideFaces(ee,w)}if(!z)return;const j=Fs(m,n,A,!1),G=this.layoutVertexArray;Jh((Y,ee)=>{zr(G,Y,ee,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,j.verticesFlattened,j.indicesTriangles)}_generateSideFaces(t,n){let l=0;for(let m=1;m<t.length;m++){const v=t[m],w=t[m-1];if(Mu(v,w))continue;n.segment.vertexLength+4>hr.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const A=v.sub(w)._perp()._unit(),z=w.dist(v);l+z>32768&&(l=0),zr(this.layoutVertexArray,v.x,v.y,A.x,A.y,0,0,l),zr(this.layoutVertexArray,v.x,v.y,A.x,A.y,0,1,l),l+=z,zr(this.layoutVertexArray,w.x,w.y,A.x,A.y,0,0,l),zr(this.layoutVertexArray,w.x,w.y,A.x,A.y,0,1,l);const j=n.segment.vertexLength;this.indexArray.emplaceBack(j,j+2,j+1),this.indexArray.emplaceBack(j+1,j+2,j+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function Fc(a,t){for(let n=0;n<t.length;n++){const l=t[n];n===t.length-1&&t[0].x===l.x&&t[0].y===l.y||(a.x+=l.x,a.y+=l.y,a.sampleCount++)}}function Mu(a,t){return a.x===t.x&&(a.x<0||a.x>Ht)||a.y===t.y&&(a.y<0||a.y>Ht)}function Hd(a){return a.every(t=>t.x<0)||a.every(t=>t.x>Ht)||a.every(t=>t.y<0)||a.every(t=>t.y>Ht)}let Ja;si("FillExtrusionBucket",Zn,{omit:["layers","features"]});var un={get paint(){return Ja=Ja||new Fn({"fill-extrusion-opacity":new ui(He["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ti(He["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ui(He["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ui(He["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new oh(He["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ti(He["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ti(He["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ui(He["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class qo extends Qn{constructor(t){super(t,un)}createBucket(t){return new Zn(t)}queryRadius(){return Id(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:m,transform:v,pixelsToTileUnits:w,pixelPosMatrix:A}){const z=_u(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-v.bearingInRadians,w),j=this.paint.get("fill-extrusion-height").evaluate(n,l),G=this.paint.get("fill-extrusion-base").evaluate(n,l),Y=function(ae,ue){const fe=[];for(const we of ae){const Pe=[we.x,we.y,0,1];It(Pe,Pe,ue),fe.push(new Se(Pe[0]/Pe[3],Pe[1]/Pe[3]))}return fe}(z,A),ee=function(ae,ue,fe,we){const Pe=[],et=[],Be=we[8]*ue,re=we[9]*ue,ve=we[10]*ue,Fe=we[11]*ue,xt=we[8]*fe,Nt=we[9]*fe,Mt=we[10]*fe,kt=we[11]*fe;for(const qt of ae){const Ut=[],Xt=[];for(const Rt of qt){const gi=Rt.x,Ei=Rt.y,Si=we[0]*gi+we[4]*Ei+we[12],mi=we[1]*gi+we[5]*Ei+we[13],Ji=we[2]*gi+we[6]*Ei+we[14],rn=we[3]*gi+we[7]*Ei+we[15],In=Ji+ve,On=rn+Fe,kl=Si+xt,Hs=mi+Nt,qn=Ji+Mt,Mn=rn+kt,_a=new Se((Si+Be)/On,(mi+re)/On);_a.z=In/On,Ut.push(_a);const ia=new Se(kl/Mn,Hs/Mn);ia.z=qn/Mn,Xt.push(ia)}Pe.push(Ut),et.push(Xt)}return[Pe,et]}(m,G,j,A);return function(ae,ue,fe){let we=1/0;of(fe,ue)&&(we=Cu(fe,ue[0]));for(let Pe=0;Pe<ue.length;Pe++){const et=ue[Pe],Be=ae[Pe];for(let re=0;re<et.length-1;re++){const ve=et[re],Fe=[ve,et[re+1],Be[re+1],Be[re],ve];ec(fe,Fe)&&(we=Math.min(we,Cu(fe,Fe)))}}return we!==1/0&&we}(ee[0],ee[1],Y)}}function Cl(a,t){return a.x*t.x+a.y*t.y}function Cu(a,t){if(a.length===1){let n=0;const l=t[n++];let m;for(;!m||l.equals(m);)if(m=t[n++],!m)return 1/0;for(;n<t.length;n++){const v=t[n],w=a[0],A=m.sub(l),z=v.sub(l),j=w.sub(l),G=Cl(A,A),Y=Cl(A,z),ee=Cl(z,z),ae=Cl(j,A),ue=Cl(j,z),fe=G*ee-Y*Y,we=(ee*ae-Y*ue)/fe,Pe=(G*ue-Y*ae)/fe,et=l.z*(1-we-Pe)+m.z*we+v.z*Pe;if(isFinite(et))return et}return 1/0}{let n=1/0;for(const l of t)n=Math.min(n,l.z);return n}}const Xo=er([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:yh}=Xo,Au=er([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Vs}=Au,jp=Pr.VectorTileFeature.types,mf=Math.cos(Math.PI/180*37.5),Zd=Math.pow(2,14)/.5;class nd{constructor(t){this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Kt,this.layoutVertexArray2=new Lt,this.indexArray=new cr,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new hr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l){this.hasPattern=Fd("line",this.layers,n);const m=this.layers[0].layout.get("line-sort-key"),v=!m.isConstant(),w=[];for(const{feature:A,id:z,index:j,sourceLayerIndex:G}of t){const Y=this.layers[0]._featureFilter.needGeometry,ee=Jl(A,Y);if(!this.layers[0]._featureFilter.filter(new Xr(this.zoom,{globalState:this.globalState}),ee,l))continue;const ae=v?m.evaluate(ee,{},l):void 0,ue={id:z,properties:A.properties,type:A.type,sourceLayerIndex:G,index:j,geometry:Y?ee.geometry:Sl(A),patterns:{},sortKey:ae};w.push(ue)}v&&w.sort((A,z)=>A.sortKey-z.sortKey);for(const A of w){const{geometry:z,index:j,sourceLayerIndex:G}=A;if(this.hasPattern){const Y=dh("line",this.layers,A,this.zoom,n);this.patternFeatures.push(Y)}else this.addFeature(A,z,j,l,{},n.subdivisionGranularity);n.featureIndex.insert(t[j].feature,z,j,G,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l)}addFeatures(t,n,l){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,l,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Vs)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yh),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,l,m,v,w){const A=this.layers[0].layout,z=A.get("line-join").evaluate(t,{}),j=A.get("line-cap"),G=A.get("line-miter-limit"),Y=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const ee of n)this.addLine(ee,t,z,j,G,Y,m,w);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,v,m)}addLine(t,n,l,m,v,w,A,z){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Bc(t,A?z.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Be=0;Be<t.length-1;Be++)this.totalDistance+=t[Be].dist(t[Be+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=jp[n.type]==="Polygon";let G=t.length;for(;G>=2&&t[G-1].equals(t[G-2]);)G--;let Y=0;for(;Y<G-1&&t[Y].equals(t[Y+1]);)Y++;if(G<(j?3:2))return;l==="bevel"&&(v=1.05);const ee=this.overscaling<=16?122880/(512*this.overscaling):0,ae=this.segments.prepareSegment(10*G,this.layoutVertexArray,this.indexArray);let ue,fe,we,Pe,et;this.e1=this.e2=-1,j&&(ue=t[G-2],et=t[Y].sub(ue)._unit()._perp());for(let Be=Y;Be<G;Be++){if(we=Be===G-1?j?t[Y+1]:void 0:t[Be+1],we&&t[Be].equals(we))continue;et&&(Pe=et),ue&&(fe=ue),ue=t[Be],et=we?we.sub(ue)._unit()._perp():Pe,Pe=Pe||et;let re=Pe.add(et);re.x===0&&re.y===0||re._unit();const ve=Pe.x*et.x+Pe.y*et.y,Fe=re.x*et.x+re.y*et.y,xt=Fe!==0?1/Fe:1/0,Nt=2*Math.sqrt(2-2*Fe),Mt=Fe<mf&&fe&&we,kt=Pe.x*et.y-Pe.y*et.x>0;if(Mt&&Be>Y){const Xt=ue.dist(fe);if(Xt>2*ee){const Rt=ue.sub(ue.sub(fe)._mult(ee/Xt)._round());this.updateDistance(fe,Rt),this.addCurrentVertex(Rt,Pe,0,0,ae),fe=Rt}}const qt=fe&&we;let Ut=qt?l:j?"butt":m;if(qt&&Ut==="round"&&(xt<w?Ut="miter":xt<=2&&(Ut="fakeround")),Ut==="miter"&&xt>v&&(Ut="bevel"),Ut==="bevel"&&(xt>2&&(Ut="flipbevel"),xt<v&&(Ut="miter")),fe&&this.updateDistance(fe,ue),Ut==="miter")re._mult(xt),this.addCurrentVertex(ue,re,0,0,ae);else if(Ut==="flipbevel"){if(xt>100)re=et.mult(-1);else{const Xt=xt*Pe.add(et).mag()/Pe.sub(et).mag();re._perp()._mult(Xt*(kt?-1:1))}this.addCurrentVertex(ue,re,0,0,ae),this.addCurrentVertex(ue,re.mult(-1),0,0,ae)}else if(Ut==="bevel"||Ut==="fakeround"){const Xt=-Math.sqrt(xt*xt-1),Rt=kt?Xt:0,gi=kt?0:Xt;if(fe&&this.addCurrentVertex(ue,Pe,Rt,gi,ae),Ut==="fakeround"){const Ei=Math.round(180*Nt/Math.PI/20);for(let Si=1;Si<Ei;Si++){let mi=Si/Ei;if(mi!==.5){const rn=mi-.5;mi+=mi*rn*(mi-1)*((1.0904+ve*(ve*(3.55645-1.43519*ve)-3.2452))*rn*rn+(.848013+ve*(.215638*ve-1.06021)))}const Ji=et.sub(Pe)._mult(mi)._add(Pe)._unit()._mult(kt?-1:1);this.addHalfVertex(ue,Ji.x,Ji.y,!1,kt,0,ae)}}we&&this.addCurrentVertex(ue,et,-Rt,-gi,ae)}else if(Ut==="butt")this.addCurrentVertex(ue,re,0,0,ae);else if(Ut==="square"){const Xt=fe?1:-1;this.addCurrentVertex(ue,re,Xt,Xt,ae)}else Ut==="round"&&(fe&&(this.addCurrentVertex(ue,Pe,0,0,ae),this.addCurrentVertex(ue,Pe,1,1,ae,!0)),we&&(this.addCurrentVertex(ue,et,-1,-1,ae,!0),this.addCurrentVertex(ue,et,0,0,ae)));if(Mt&&Be<G-1){const Xt=ue.dist(we);if(Xt>2*ee){const Rt=ue.add(we.sub(ue)._mult(ee/Xt)._round());this.updateDistance(ue,Rt),this.addCurrentVertex(Rt,et,0,0,ae),ue=Rt}}}}addCurrentVertex(t,n,l,m,v,w=!1){const A=n.y*m-n.x,z=-n.y-n.x*m;this.addHalfVertex(t,n.x+n.y*l,n.y-n.x*l,w,!1,l,v),this.addHalfVertex(t,A,z,w,!0,-m,v),this.distance>Zd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,l,m,v,w))}addHalfVertex({x:t,y:n},l,m,v,w,A,z){const j=.5*(this.lineClips?this.scaledDistance*(Zd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(v?1:0),(n<<1)+(w?1:0),Math.round(63*l)+128,Math.round(63*m)+128,1+(A===0?0:A<0?-1:1)|(63&j)<<2,j>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const G=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,G,this.e2),z.primitiveLength++),w?this.e2=G:this.e1=G}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let Uc,Ba;si("LineBucket",nd,{omit:["layers","patternFeatures"]});var Al={get paint(){return Ba=Ba||new Fn({"line-opacity":new Ti(He.paint_line["line-opacity"]),"line-color":new Ti(He.paint_line["line-color"]),"line-translate":new ui(He.paint_line["line-translate"]),"line-translate-anchor":new ui(He.paint_line["line-translate-anchor"]),"line-width":new Ti(He.paint_line["line-width"]),"line-gap-width":new Ti(He.paint_line["line-gap-width"]),"line-offset":new Ti(He.paint_line["line-offset"]),"line-blur":new Ti(He.paint_line["line-blur"]),"line-dasharray":new Or(He.paint_line["line-dasharray"]),"line-pattern":new oh(He.paint_line["line-pattern"]),"line-gradient":new Vo(He.paint_line["line-gradient"])})},get layout(){return Uc=Uc||new Fn({"line-cap":new ui(He.layout_line["line-cap"]),"line-join":new Ti(He.layout_line["line-join"]),"line-miter-limit":new ui(He.layout_line["line-miter-limit"]),"line-round-limit":new ui(He.layout_line["line-round-limit"]),"line-sort-key":new Ti(He.layout_line["line-sort-key"])})}};class ad extends Ti{possiblyEvaluate(t,n){return n=new Xr(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,l,m){return n=aa({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,l,m)}}let lc;class gf extends Qn{constructor(t){super(t,Al),this.gradientVersion=0,lc||(lc=new ad(Al.paint.properties["line-width"].specification),lc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof ru,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=lc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new nd(t)}queryRadius(t){const n=t,l=Bp(ln("line-width",this,n),ln("line-gap-width",this,n)),m=ln("line-offset",this,n);return l/2+Math.abs(m)+Id(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:l,geometry:m,transform:v,pixelsToTileUnits:w}){const A=_u(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-v.bearingInRadians,w),z=w/2*Bp(this.paint.get("line-width").evaluate(n,l),this.paint.get("line-gap-width").evaluate(n,l)),j=this.paint.get("line-offset").evaluate(n,l);return j&&(m=function(G,Y){const ee=[];for(let ae=0;ae<G.length;ae++){const ue=G[ae],fe=[];for(let we=0;we<ue.length;we++){const Pe=ue[we-1],et=ue[we],Be=ue[we+1],re=we===0?new Se(0,0):et.sub(Pe)._unit()._perp(),ve=we===ue.length-1?new Se(0,0):Be.sub(et)._unit()._perp(),Fe=re._add(ve)._unit(),xt=Fe.x*ve.x+Fe.y*ve.y;xt!==0&&Fe._mult(1/xt),fe.push(Fe._mult(Y)._add(et))}ee.push(fe)}return ee}(m,j*w)),function(G,Y,ee){for(let ae=0;ae<Y.length;ae++){const ue=Y[ae];if(G.length>=3){for(let fe=0;fe<ue.length;fe++)if(Ic(G,ue[fe]))return!0}if(Tp(G,ue,ee))return!0}return!1}(A,m,z)}isTileClipped(){return!0}}function Bp(a,t){return t>0?t+2*a:a}const Gf=er([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Eu=er([{name:"a_projected_pos",components:3,type:"Float32"}],4);er([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Np=er([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);er([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Gs=er([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Fp=er([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function cs(a,t,n){return a.sections.forEach(l=>{l.text=function(m,v,w){const A=v.layout.get("text-transform").evaluate(w,{});return A==="uppercase"?m=m.toLocaleUpperCase():A==="lowercase"&&(m=m.toLocaleLowerCase()),mo.applyArabicShaping&&(m=mo.applyArabicShaping(m)),m}(l.text,t,n)}),a}er([{name:"triangle",components:3,type:"Uint16"}]),er([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),er([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),er([{type:"Float32",name:"offsetX"}]),er([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),er([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const sd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Up,yf,cc,Dn=24,qd={};function od(){return Up||(Up=1,qd.read=function(a,t,n,l,m){var v,w,A=8*m-l-1,z=(1<<A)-1,j=z>>1,G=-7,Y=n?m-1:0,ee=n?-1:1,ae=a[t+Y];for(Y+=ee,v=ae&(1<<-G)-1,ae>>=-G,G+=A;G>0;v=256*v+a[t+Y],Y+=ee,G-=8);for(w=v&(1<<-G)-1,v>>=-G,G+=l;G>0;w=256*w+a[t+Y],Y+=ee,G-=8);if(v===0)v=1-j;else{if(v===z)return w?NaN:1/0*(ae?-1:1);w+=Math.pow(2,l),v-=j}return(ae?-1:1)*w*Math.pow(2,v-l)},qd.write=function(a,t,n,l,m,v){var w,A,z,j=8*v-m-1,G=(1<<j)-1,Y=G>>1,ee=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,ae=l?0:v-1,ue=l?1:-1,fe=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(A=isNaN(t)?1:0,w=G):(w=Math.floor(Math.log(t)/Math.LN2),t*(z=Math.pow(2,-w))<1&&(w--,z*=2),(t+=w+Y>=1?ee/z:ee*Math.pow(2,1-Y))*z>=2&&(w++,z/=2),w+Y>=G?(A=0,w=G):w+Y>=1?(A=(t*z-1)*Math.pow(2,m),w+=Y):(A=t*Math.pow(2,Y-1)*Math.pow(2,m),w=0));m>=8;a[n+ae]=255&A,ae+=ue,A/=256,m-=8);for(w=w<<m|A,j+=m;j>0;a[n+ae]=255&w,ae+=ue,w/=256,j-=8);a[n+ae-ue]|=128*fe}),qd}function _f(){if(cc)return yf;cc=1,yf=t;var a=od();function t(re){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(re)?re:new Uint8Array(re||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var n=4294967296,l=1/n,m=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function v(re){return re.type===t.Bytes?re.readVarint()+re.pos:re.pos+1}function w(re,ve,Fe){return Fe?4294967296*ve+(re>>>0):4294967296*(ve>>>0)+(re>>>0)}function A(re,ve,Fe){var xt=ve<=16383?1:ve<=2097151?2:ve<=268435455?3:Math.floor(Math.log(ve)/(7*Math.LN2));Fe.realloc(xt);for(var Nt=Fe.pos-1;Nt>=re;Nt--)Fe.buf[Nt+xt]=Fe.buf[Nt]}function z(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeVarint(re[Fe])}function j(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeSVarint(re[Fe])}function G(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeFloat(re[Fe])}function Y(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeDouble(re[Fe])}function ee(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeBoolean(re[Fe])}function ae(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeFixed32(re[Fe])}function ue(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeSFixed32(re[Fe])}function fe(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeFixed64(re[Fe])}function we(re,ve){for(var Fe=0;Fe<re.length;Fe++)ve.writeSFixed64(re[Fe])}function Pe(re,ve){return(re[ve]|re[ve+1]<<8|re[ve+2]<<16)+16777216*re[ve+3]}function et(re,ve,Fe){re[Fe]=ve,re[Fe+1]=ve>>>8,re[Fe+2]=ve>>>16,re[Fe+3]=ve>>>24}function Be(re,ve){return(re[ve]|re[ve+1]<<8|re[ve+2]<<16)+(re[ve+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(re,ve,Fe){for(Fe=Fe||this.length;this.pos<Fe;){var xt=this.readVarint(),Nt=xt>>3,Mt=this.pos;this.type=7&xt,re(Nt,ve,this),this.pos===Mt&&this.skip(xt)}return ve},readMessage:function(re,ve){return this.readFields(re,ve,this.readVarint()+this.pos)},readFixed32:function(){var re=Pe(this.buf,this.pos);return this.pos+=4,re},readSFixed32:function(){var re=Be(this.buf,this.pos);return this.pos+=4,re},readFixed64:function(){var re=Pe(this.buf,this.pos)+Pe(this.buf,this.pos+4)*n;return this.pos+=8,re},readSFixed64:function(){var re=Pe(this.buf,this.pos)+Be(this.buf,this.pos+4)*n;return this.pos+=8,re},readFloat:function(){var re=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,re},readDouble:function(){var re=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,re},readVarint:function(re){var ve,Fe,xt=this.buf;return ve=127&(Fe=xt[this.pos++]),Fe<128?ve:(ve|=(127&(Fe=xt[this.pos++]))<<7,Fe<128?ve:(ve|=(127&(Fe=xt[this.pos++]))<<14,Fe<128?ve:(ve|=(127&(Fe=xt[this.pos++]))<<21,Fe<128?ve:function(Nt,Mt,kt){var qt,Ut,Xt=kt.buf;if(qt=(112&(Ut=Xt[kt.pos++]))>>4,Ut<128||(qt|=(127&(Ut=Xt[kt.pos++]))<<3,Ut<128)||(qt|=(127&(Ut=Xt[kt.pos++]))<<10,Ut<128)||(qt|=(127&(Ut=Xt[kt.pos++]))<<17,Ut<128)||(qt|=(127&(Ut=Xt[kt.pos++]))<<24,Ut<128)||(qt|=(1&(Ut=Xt[kt.pos++]))<<31,Ut<128))return w(Nt,qt,Mt);throw new Error("Expected varint not more than 10 bytes")}(ve|=(15&(Fe=xt[this.pos]))<<28,re,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var re=this.readVarint();return re%2==1?(re+1)/-2:re/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var re=this.readVarint()+this.pos,ve=this.pos;return this.pos=re,re-ve>=12&&m?function(Fe,xt,Nt){return m.decode(Fe.subarray(xt,Nt))}(this.buf,ve,re):function(Fe,xt,Nt){for(var Mt="",kt=xt;kt<Nt;){var qt,Ut,Xt,Rt=Fe[kt],gi=null,Ei=Rt>239?4:Rt>223?3:Rt>191?2:1;if(kt+Ei>Nt)break;Ei===1?Rt<128&&(gi=Rt):Ei===2?(192&(qt=Fe[kt+1]))==128&&(gi=(31&Rt)<<6|63&qt)<=127&&(gi=null):Ei===3?(Ut=Fe[kt+2],(192&(qt=Fe[kt+1]))==128&&(192&Ut)==128&&((gi=(15&Rt)<<12|(63&qt)<<6|63&Ut)<=2047||gi>=55296&&gi<=57343)&&(gi=null)):Ei===4&&(Ut=Fe[kt+2],Xt=Fe[kt+3],(192&(qt=Fe[kt+1]))==128&&(192&Ut)==128&&(192&Xt)==128&&((gi=(15&Rt)<<18|(63&qt)<<12|(63&Ut)<<6|63&Xt)<=65535||gi>=1114112)&&(gi=null)),gi===null?(gi=65533,Ei=1):gi>65535&&(gi-=65536,Mt+=String.fromCharCode(gi>>>10&1023|55296),gi=56320|1023&gi),Mt+=String.fromCharCode(gi),kt+=Ei}return Mt}(this.buf,ve,re)},readBytes:function(){var re=this.readVarint()+this.pos,ve=this.buf.subarray(this.pos,re);return this.pos=re,ve},readPackedVarint:function(re,ve){if(this.type!==t.Bytes)return re.push(this.readVarint(ve));var Fe=v(this);for(re=re||[];this.pos<Fe;)re.push(this.readVarint(ve));return re},readPackedSVarint:function(re){if(this.type!==t.Bytes)return re.push(this.readSVarint());var ve=v(this);for(re=re||[];this.pos<ve;)re.push(this.readSVarint());return re},readPackedBoolean:function(re){if(this.type!==t.Bytes)return re.push(this.readBoolean());var ve=v(this);for(re=re||[];this.pos<ve;)re.push(this.readBoolean());return re},readPackedFloat:function(re){if(this.type!==t.Bytes)return re.push(this.readFloat());var ve=v(this);for(re=re||[];this.pos<ve;)re.push(this.readFloat());return re},readPackedDouble:function(re){if(this.type!==t.Bytes)return re.push(this.readDouble());var ve=v(this);for(re=re||[];this.pos<ve;)re.push(this.readDouble());return re},readPackedFixed32:function(re){if(this.type!==t.Bytes)return re.push(this.readFixed32());var ve=v(this);for(re=re||[];this.pos<ve;)re.push(this.readFixed32());return re},readPackedSFixed32:function(re){if(this.type!==t.Bytes)return re.push(this.readSFixed32());var ve=v(this);for(re=re||[];this.pos<ve;)re.push(this.readSFixed32());return re},readPackedFixed64:function(re){if(this.type!==t.Bytes)return re.push(this.readFixed64());var ve=v(this);for(re=re||[];this.pos<ve;)re.push(this.readFixed64());return re},readPackedSFixed64:function(re){if(this.type!==t.Bytes)return re.push(this.readSFixed64());var ve=v(this);for(re=re||[];this.pos<ve;)re.push(this.readSFixed64());return re},skip:function(re){var ve=7&re;if(ve===t.Varint)for(;this.buf[this.pos++]>127;);else if(ve===t.Bytes)this.pos=this.readVarint()+this.pos;else if(ve===t.Fixed32)this.pos+=4;else{if(ve!==t.Fixed64)throw new Error("Unimplemented type: "+ve);this.pos+=8}},writeTag:function(re,ve){this.writeVarint(re<<3|ve)},realloc:function(re){for(var ve=this.length||16;ve<this.pos+re;)ve*=2;if(ve!==this.length){var Fe=new Uint8Array(ve);Fe.set(this.buf),this.buf=Fe,this.length=ve}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(re){this.realloc(4),et(this.buf,re,this.pos),this.pos+=4},writeSFixed32:function(re){this.realloc(4),et(this.buf,re,this.pos),this.pos+=4},writeFixed64:function(re){this.realloc(8),et(this.buf,-1&re,this.pos),et(this.buf,Math.floor(re*l),this.pos+4),this.pos+=8},writeSFixed64:function(re){this.realloc(8),et(this.buf,-1&re,this.pos),et(this.buf,Math.floor(re*l),this.pos+4),this.pos+=8},writeVarint:function(re){(re=+re||0)>268435455||re<0?function(ve,Fe){var xt,Nt;if(ve>=0?(xt=ve%4294967296|0,Nt=ve/4294967296|0):(Nt=~(-ve/4294967296),4294967295^(xt=~(-ve%4294967296))?xt=xt+1|0:(xt=0,Nt=Nt+1|0)),ve>=18446744073709552e3||ve<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Fe.realloc(10),function(Mt,kt,qt){qt.buf[qt.pos++]=127&Mt|128,Mt>>>=7,qt.buf[qt.pos++]=127&Mt|128,Mt>>>=7,qt.buf[qt.pos++]=127&Mt|128,Mt>>>=7,qt.buf[qt.pos++]=127&Mt|128,qt.buf[qt.pos]=127&(Mt>>>=7)}(xt,0,Fe),function(Mt,kt){var qt=(7&Mt)<<4;kt.buf[kt.pos++]|=qt|((Mt>>>=3)?128:0),Mt&&(kt.buf[kt.pos++]=127&Mt|((Mt>>>=7)?128:0),Mt&&(kt.buf[kt.pos++]=127&Mt|((Mt>>>=7)?128:0),Mt&&(kt.buf[kt.pos++]=127&Mt|((Mt>>>=7)?128:0),Mt&&(kt.buf[kt.pos++]=127&Mt|((Mt>>>=7)?128:0),Mt&&(kt.buf[kt.pos++]=127&Mt)))))}(Nt,Fe)}(re,this):(this.realloc(4),this.buf[this.pos++]=127&re|(re>127?128:0),re<=127||(this.buf[this.pos++]=127&(re>>>=7)|(re>127?128:0),re<=127||(this.buf[this.pos++]=127&(re>>>=7)|(re>127?128:0),re<=127||(this.buf[this.pos++]=re>>>7&127))))},writeSVarint:function(re){this.writeVarint(re<0?2*-re-1:2*re)},writeBoolean:function(re){this.writeVarint(!!re)},writeString:function(re){re=String(re),this.realloc(4*re.length),this.pos++;var ve=this.pos;this.pos=function(xt,Nt,Mt){for(var kt,qt,Ut=0;Ut<Nt.length;Ut++){if((kt=Nt.charCodeAt(Ut))>55295&&kt<57344){if(!qt){kt>56319||Ut+1===Nt.length?(xt[Mt++]=239,xt[Mt++]=191,xt[Mt++]=189):qt=kt;continue}if(kt<56320){xt[Mt++]=239,xt[Mt++]=191,xt[Mt++]=189,qt=kt;continue}kt=qt-55296<<10|kt-56320|65536,qt=null}else qt&&(xt[Mt++]=239,xt[Mt++]=191,xt[Mt++]=189,qt=null);kt<128?xt[Mt++]=kt:(kt<2048?xt[Mt++]=kt>>6|192:(kt<65536?xt[Mt++]=kt>>12|224:(xt[Mt++]=kt>>18|240,xt[Mt++]=kt>>12&63|128),xt[Mt++]=kt>>6&63|128),xt[Mt++]=63&kt|128)}return Mt}(this.buf,re,this.pos);var Fe=this.pos-ve;Fe>=128&&A(ve,Fe,this),this.pos=ve-1,this.writeVarint(Fe),this.pos+=Fe},writeFloat:function(re){this.realloc(4),a.write(this.buf,re,this.pos,!0,23,4),this.pos+=4},writeDouble:function(re){this.realloc(8),a.write(this.buf,re,this.pos,!0,52,8),this.pos+=8},writeBytes:function(re){var ve=re.length;this.writeVarint(ve),this.realloc(ve);for(var Fe=0;Fe<ve;Fe++)this.buf[this.pos++]=re[Fe]},writeRawMessage:function(re,ve){this.pos++;var Fe=this.pos;re(ve,this);var xt=this.pos-Fe;xt>=128&&A(Fe,xt,this),this.pos=Fe-1,this.writeVarint(xt),this.pos+=xt},writeMessage:function(re,ve,Fe){this.writeTag(re,t.Bytes),this.writeRawMessage(ve,Fe)},writePackedVarint:function(re,ve){ve.length&&this.writeMessage(re,z,ve)},writePackedSVarint:function(re,ve){ve.length&&this.writeMessage(re,j,ve)},writePackedBoolean:function(re,ve){ve.length&&this.writeMessage(re,ee,ve)},writePackedFloat:function(re,ve){ve.length&&this.writeMessage(re,G,ve)},writePackedDouble:function(re,ve){ve.length&&this.writeMessage(re,Y,ve)},writePackedFixed32:function(re,ve){ve.length&&this.writeMessage(re,ae,ve)},writePackedSFixed32:function(re,ve){ve.length&&this.writeMessage(re,ue,ve)},writePackedFixed64:function(re,ve){ve.length&&this.writeMessage(re,fe,ve)},writePackedSFixed64:function(re,ve){ve.length&&this.writeMessage(re,we,ve)},writeBytesField:function(re,ve){this.writeTag(re,t.Bytes),this.writeBytes(ve)},writeFixed32Field:function(re,ve){this.writeTag(re,t.Fixed32),this.writeFixed32(ve)},writeSFixed32Field:function(re,ve){this.writeTag(re,t.Fixed32),this.writeSFixed32(ve)},writeFixed64Field:function(re,ve){this.writeTag(re,t.Fixed64),this.writeFixed64(ve)},writeSFixed64Field:function(re,ve){this.writeTag(re,t.Fixed64),this.writeSFixed64(ve)},writeVarintField:function(re,ve){this.writeTag(re,t.Varint),this.writeVarint(ve)},writeSVarintField:function(re,ve){this.writeTag(re,t.Varint),this.writeSVarint(ve)},writeStringField:function(re,ve){this.writeTag(re,t.Bytes),this.writeString(ve)},writeFloatField:function(re,ve){this.writeTag(re,t.Fixed32),this.writeFloat(ve)},writeDoubleField:function(re,ve){this.writeTag(re,t.Fixed64),this.writeDouble(ve)},writeBooleanField:function(re,ve){this.writeVarintField(re,!!ve)}},yf}var Vc,Xd=oe(_f());function xf(a,t,n){a===1&&n.readMessage(Vp,t)}function Vp(a,t,n){if(a===3){const{id:l,bitmap:m,width:v,height:w,left:A,top:z,advance:j}=n.readMessage(pm,{});t.push({id:l,bitmap:new Zh({width:v+6,height:w+6},m),metrics:{width:v,height:w,left:A,top:z,advance:j}})}}function pm(a,t,n){a===1?t.id=n.readVarint():a===2?t.bitmap=n.readBytes():a===3?t.width=n.readVarint():a===4?t.height=n.readVarint():a===5?t.left=n.readSVarint():a===6?t.top=n.readSVarint():a===7&&(t.advance=n.readVarint())}function $f(a){let t=0,n=0;for(const w of a)t+=w.w*w.h,n=Math.max(n,w.w);a.sort((w,A)=>A.h-w.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let m=0,v=0;for(const w of a)for(let A=l.length-1;A>=0;A--){const z=l[A];if(!(w.w>z.w||w.h>z.h)){if(w.x=z.x,w.y=z.y,v=Math.max(v,w.y+w.h),m=Math.max(m,w.x+w.w),w.w===z.w&&w.h===z.h){const j=l.pop();A<l.length&&(l[A]=j)}else w.h===z.h?(z.x+=w.w,z.w-=w.w):w.w===z.w?(z.y+=w.h,z.h-=w.h):(l.push({x:z.x+w.w,y:z.y,w:z.w-w.w,h:w.h}),z.y+=w.h,z.h-=w.h);break}}return{w:m,h:v,fill:t/(m*v)||0}}class Gp{constructor(t,{pixelRatio:n,version:l,stretchX:m,stretchY:v,content:w,textFitWidth:A,textFitHeight:z}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=m,this.stretchY=v,this.content=w,this.version=l,this.textFitWidth=A,this.textFitHeight=z}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Yd{constructor(t,n){const l={},m={};this.haveRenderCallbacks=[];const v=[];this.addImages(t,l,v),this.addImages(n,m,v);const{w,h:A}=$f(v),z=new Tn({width:w||1,height:A||1});for(const j in t){const G=t[j],Y=l[j].paddedRect;Tn.copy(G.data,z,{x:0,y:0},{x:Y.x+1,y:Y.y+1},G.data)}for(const j in n){const G=n[j],Y=m[j].paddedRect,ee=Y.x+1,ae=Y.y+1,ue=G.data.width,fe=G.data.height;Tn.copy(G.data,z,{x:0,y:0},{x:ee,y:ae},G.data),Tn.copy(G.data,z,{x:0,y:fe-1},{x:ee,y:ae-1},{width:ue,height:1}),Tn.copy(G.data,z,{x:0,y:0},{x:ee,y:ae+fe},{width:ue,height:1}),Tn.copy(G.data,z,{x:ue-1,y:0},{x:ee-1,y:ae},{width:1,height:fe}),Tn.copy(G.data,z,{x:0,y:0},{x:ee+ue,y:ae},{width:1,height:fe})}this.image=z,this.iconPositions=l,this.patternPositions=m}addImages(t,n,l){for(const m in t){const v=t[m],w={x:0,y:0,w:v.data.width+2,h:v.data.height+2};l.push(w),n[m]=new Gp(w,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),n),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),n)}patchUpdatedImage(t,n,l){if(!t||!n||t.version===n.version)return;t.version=n.version;const[m,v]=t.tl;l.update(n.data,void 0,{x:m,y:v})}}si("ImagePosition",Gp),si("ImageAtlas",Yd),B.an=void 0,(Vc=B.an||(B.an={}))[Vc.none=0]="none",Vc[Vc.horizontal=1]="horizontal",Vc[Vc.vertical=2]="vertical",Vc[Vc.horizontalOnly=3]="horizontalOnly";class ld{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,l){const m=new ld;return m.scale=t||1,m.fontStack=n,m.verticalAlign=l||"bottom",m}static forImage(t,n){const l=new ld;return l.imageName=t,l.verticalAlign=n||"bottom",l}}class vo{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const l=new vo;for(let m=0;m<t.sections.length;m++){const v=t.sections[m];v.image?l.addImageSection(v):l.addTextSection(v,n)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let n="";for(let l=0;l<t.length;l++){const m=t.charCodeAt(l+1)||null,v=t.charCodeAt(l-1)||null;n+=m&&ho(m)&&!sd[t[l+1]]||v&&ho(v)&&!sd[t[l-1]]||!sd[t[l]]?t[l]:sd[t[l]]}return n}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&Wd[this.text.charCodeAt(l)];l++)t++;let n=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&Wd[this.text.charCodeAt(l)];l--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const l=new vo;return l.text=this.text.substring(t,n),l.sectionIndex=this.sectionIndex.slice(t,n),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}getMaxImageSize(t){let n=0,l=0;for(let m=0;m<this.length();m++){const v=this.getSection(m);if(v.imageName){const w=t[v.imageName];if(!w)continue;const A=w.displaySize;n=Math.max(n,A[0]),l=Math.max(l,A[1])}}return{maxImageWidth:n,maxImageHeight:l}}addTextSection(t,n){this.text+=t.text,this.sections.push(ld.forText(t.scale,t.fontStack||n,t.verticalAlign));const l=this.sections.length-1;for(let m=0;m<t.text.length;++m)this.sectionIndex.push(l)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void qr("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(ld.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):qr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _h(a,t,n,l,m,v,w,A,z,j,G,Y,ee,ae,ue){const fe=vo.fromFeature(a,m);let we;Y===B.an.vertical&&fe.verticalizePunctuation();const{processBidirectionalText:Pe,processStyledBidirectionalText:et}=mo;if(Pe&&fe.sections.length===1){we=[];const ve=Pe(fe.toString(),Qd(fe,j,v,t,l,ae));for(const Fe of ve){const xt=new vo;xt.text=Fe,xt.sections=fe.sections;for(let Nt=0;Nt<Fe.length;Nt++)xt.sectionIndex.push(0);we.push(xt)}}else if(et){we=[];const ve=et(fe.text,fe.sectionIndex,Qd(fe,j,v,t,l,ae));for(const Fe of ve){const xt=new vo;xt.text=Fe[0],xt.sectionIndex=Fe[1],xt.sections=fe.sections,we.push(xt)}}else we=function(ve,Fe){const xt=[],Nt=ve.text;let Mt=0;for(const kt of Fe)xt.push(ve.substring(Mt,kt)),Mt=kt;return Mt<Nt.length&&xt.push(ve.substring(Mt,Nt.length)),xt}(fe,Qd(fe,j,v,t,l,ae));const Be=[],re={positionedLines:Be,text:fe.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:Y,iconsInText:!1,verticalizable:!1};return function(ve,Fe,xt,Nt,Mt,kt,qt,Ut,Xt,Rt,gi,Ei){let Si=0,mi=0,Ji=0,rn=0;const In=Ut==="right"?1:Ut==="left"?0:.5,On=Dn/Ei;let kl=0;for(const Mn of Mt){Mn.trim();const _a=Mn.getMaxScale(),ia={positionedGlyphs:[],lineOffset:0};ve.positionedLines[kl]=ia;const Fa=ia.positionedGlyphs;let Zs=0;if(!Mn.length()){mi+=kt,++kl;continue}const qs=Tf(Nt,Mn,On);for(let Xs=0;Xs<Mn.length();Xs++){const jn=Mn.getSection(Xs),ra=Mn.getSectionIndex(Xs),Yn=Mn.getCharCode(Xs),Wn=qf(Xt,gi,Yn);let dn;if(jn.imageName){if(ve.iconsInText=!0,jn.scale=jn.scale*On,dn=Yf(jn,Wn,_a,qs,Nt),!dn)continue;Zs=Math.max(Zs,dn.imageOffset)}else if(dn=Xf(jn,Yn,Wn,qs,Fe,xt),!dn)continue;const{rect:Wo,metrics:i,baselineOffset:o}=dn;Fa.push({glyph:Yn,imageName:jn.imageName,x:Si,y:mi+o+-17,vertical:Wn,scale:jn.scale,fontStack:jn.fontStack,sectionIndex:ra,metrics:i,rect:Wo}),Wn?(ve.verticalizable=!0,Si+=(jn.imageName?i.advance:Dn)*jn.scale+Rt):Si+=i.advance*jn.scale+Rt}Fa.length!==0&&(Ji=Math.max(Si-Rt,Ji),fm(Fa,0,Fa.length-1,In)),Si=0,ia.lineOffset=Math.max(Zs,(_a-1)*Dn);const Xn=kt*_a+Zs;mi+=Xn,rn=Math.max(Xn,rn),++kl}const{horizontalAlign:Hs,verticalAlign:qn}=Qr(qt);(function(Mn,_a,ia,Fa,Zs,qs,Xn,Xs,jn){const ra=(_a-ia)*Zs;let Yn=0;Yn=qs!==Xn?-Xs*Fa- -17:-Fa*jn*Xn+.5*Xn;for(const Wn of Mn)for(const dn of Wn.positionedGlyphs)dn.x+=ra,dn.y+=Yn})(ve.positionedLines,In,Hs,qn,Ji,rn,kt,mi,Mt.length),ve.top+=-qn*mi,ve.bottom=ve.top+mi,ve.left+=-Hs*Ji,ve.right=ve.left+Ji}(re,t,n,l,we,w,A,z,Y,j,ee,ue),!function(ve){for(const Fe of ve)if(Fe.positionedGlyphs.length!==0)return!1;return!0}(Be)&&re}const Wd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Hf={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},vf={40:!0};function bf(a,t,n,l,m,v){if(t.imageName){const w=l[t.imageName];return w?w.displaySize[0]*t.scale*Dn/v+m:0}{const w=n[t.fontStack],A=w&&w[a];return A?A.metrics.advance*t.scale+m:0}}function $p(a,t,n,l){const m=Math.pow(a-t,2);return l?a<t?m/2:2*m:m+Math.abs(n)*n}function wf(a,t,n){let l=0;return a===10&&(l-=1e4),n&&(l+=150),a!==40&&a!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Kd(a,t,n,l,m,v){let w=null,A=$p(t,n,m,v);for(const z of l){const j=$p(t-z.x,n,m,v)+z.badness;j<=A&&(w=z,A=j)}return{index:a,x:t,priorBreak:w,badness:A}}function Sf(a){return a?Sf(a.priorBreak).concat(a.index):[]}function Qd(a,t,n,l,m,v){if(!a)return[];const w=[],A=function(Y,ee,ae,ue,fe,we){let Pe=0;for(let et=0;et<Y.length();et++){const Be=Y.getSection(et);Pe+=bf(Y.getCharCode(et),Be,ue,fe,ee,we)}return Pe/Math.max(1,Math.ceil(Pe/ae))}(a,t,n,l,m,v),z=a.text.indexOf("​")>=0;let j=0;for(let Y=0;Y<a.length();Y++){const ee=a.getSection(Y),ae=a.getCharCode(Y);if(Wd[ae]||(j+=bf(ae,ee,l,m,t,v)),Y<a.length()-1){const ue=!((G=ae)<11904)&&(!!rr["CJK Compatibility Forms"](G)||!!rr["CJK Compatibility"](G)||!!rr["CJK Strokes"](G)||!!rr["CJK Symbols and Punctuation"](G)||!!rr["Enclosed CJK Letters and Months"](G)||!!rr["Halfwidth and Fullwidth Forms"](G)||!!rr["Ideographic Description Characters"](G)||!!rr["Vertical Forms"](G)||Pc.test(String.fromCodePoint(G)));(Hf[ae]||ue||ee.imageName||Y!==a.length()-2&&vf[a.getCharCode(Y+1)])&&w.push(Kd(Y+1,j,A,w,wf(ae,a.getCharCode(Y+1),ue&&z),!1))}}var G;return Sf(Kd(a.length(),j,A,w,0,!0))}function Qr(a){let t=.5,n=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Tf(a,t,n){const l=t.getMaxScale()*Dn,{maxImageWidth:m,maxImageHeight:v}=t.getMaxImageSize(a),w=Math.max(l,v*n);return{verticalLineContentWidth:Math.max(l,m*n),horizontalLineContentHeight:w}}function Zf(a){switch(a){case"top":return 0;case"center":return .5;default:return 1}}function qf(a,t,n){return!(a===B.an.horizontal||!t&&!Xl(n)||t&&(Wd[n]||(l=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(l)))));var l}function Xf(a,t,n,l,m,v){const w=v[a.fontStack],A=function(j,G,Y,ee){if(j&&j.rect)return j;const ae=G[Y.fontStack],ue=ae&&ae[ee];return ue?{rect:null,metrics:ue.metrics}:null}(w&&w[t],m,a,t);if(A===null)return null;let z;if(n)z=l.verticalLineContentWidth-a.scale*Dn;else{const j=Zf(a.verticalAlign);z=(l.horizontalLineContentHeight-a.scale*Dn)*j}return{rect:A.rect,metrics:A.metrics,baselineOffset:z}}function Yf(a,t,n,l,m){const v=m[a.imageName];if(!v)return null;const w=v.paddedRect,A=v.displaySize,z={width:A[0],height:A[1],left:1,top:-3,advance:t?A[1]:A[0]};let j;if(t)j=l.verticalLineContentWidth-A[1]*a.scale;else{const G=Zf(a.verticalAlign);j=(l.horizontalLineContentHeight-A[1]*a.scale)*G}return{rect:w,metrics:z,baselineOffset:j,imageOffset:(t?A[0]:A[1])*a.scale-Dn*n}}function fm(a,t,n,l){if(l===0)return;const m=a[n],v=(a[n].x+m.metrics.advance*m.scale)*l;for(let w=t;w<=n;w++)a[w].x-=v}function Hp(a,t,n){const{horizontalAlign:l,verticalAlign:m}=Qr(n),v=t[0]-a.displaySize[0]*l,w=t[1]-a.displaySize[1]*m;return{image:a,top:w,bottom:w+a.displaySize[1],left:v,right:v+a.displaySize[0]}}function ku(a){var t,n;let l=a.left,m=a.top,v=a.right-l,w=a.bottom-m;const A=(t=a.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",z=(n=a.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",j=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(z==="proportional"){if(A==="stretchOnly"&&v/w<j||A==="proportional"){const G=Math.ceil(w*j);l*=G/v,v=G}}else if(A==="proportional"&&z==="stretchOnly"&&j!==0&&v/w>j){const G=Math.ceil(v/j);m*=G/w,w=G}return{x1:l,y1:m,x2:l+v,y2:m+w}}function Zp(a,t,n,l,m,v){const w=a.image;let A;if(w.content){const we=w.content,Pe=w.pixelRatio||1;A=[we[0]/Pe,we[1]/Pe,w.displaySize[0]-we[2]/Pe,w.displaySize[1]-we[3]/Pe]}const z=t.left*v,j=t.right*v;let G,Y,ee,ae;n==="width"||n==="both"?(ae=m[0]+z-l[3],Y=m[0]+j+l[1]):(ae=m[0]+(z+j-w.displaySize[0])/2,Y=ae+w.displaySize[0]);const ue=t.top*v,fe=t.bottom*v;return n==="height"||n==="both"?(G=m[1]+ue-l[0],ee=m[1]+fe+l[2]):(G=m[1]+(ue+fe-w.displaySize[1])/2,ee=G+w.displaySize[1]),{image:w,top:G,right:Y,bottom:ee,left:ae,collisionPadding:A}}const bo=128,uc=32640;function Gc(a,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Xr(a+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:m}=n;let v=0;for(;v<l.length&&l[v]<=a;)v++;v=Math.max(0,v-1);let w=v;for(;w<l.length&&l[w]<a+1;)w++;w=Math.min(l.length-1,w);const A=l[v],z=l[w];return n.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:z,interpolationType:m}:{kind:"camera",minZoom:A,maxZoom:z,minSize:n.evaluate(new Xr(A)),maxSize:n.evaluate(new Xr(z)),interpolationType:m}}}function wo(a,t,n){let l="never";const m=a.get(t);return m?l=m:a.get(n)&&(l="always"),l}const Jd=Pr.VectorTileFeature.types,Wf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ep(a,t,n,l,m,v,w,A,z,j,G,Y,ee){const ae=A?Math.min(uc,Math.round(A[0])):0,ue=A?Math.min(uc,Math.round(A[1])):0;a.emplaceBack(t,n,Math.round(32*l),Math.round(32*m),v,w,(ae<<1)+(z?1:0),ue,16*j,16*G,256*Y,256*ee)}function cd(a,t,n){a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n)}function Kf(a){for(const t of a.sections)if(Uh(t.text))return!0;return!1}class tp{constructor(t){this.layoutVertexArray=new Hi,this.indexArray=new cr,this.programConfigurations=t,this.segments=new hr,this.dynamicLayoutVertexArray=new xr,this.opacityVertexArray=new Xi,this.hasVisibleVertices=!1,this.placedSymbolArray=new ke}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,l,m){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Gf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Eu.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Wf,!0),this.opacityVertexBuffer.itemSize=1),(l||m)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}si("SymbolBuffers",tp);class qp{constructor(t,n,l){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new l,this.segments=new hr,this.collisionVertexArray=new tn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Np.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}si("CollisionBuffers",qp);class Pu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.globalState=t.globalState,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(w=>w.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Gc(this.zoom,n["text-size"]),this.iconSizeData=Gc(this.zoom,n["icon-size"]);const l=this.layers[0].layout,m=l.get("symbol-sort-key"),v=l.get("symbol-z-order");this.canOverlap=wo(l,"text-overlap","text-allow-overlap")!=="never"||wo(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(w=>B.an[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=t.sourceID}createArrays(){this.text=new tp(new Ln(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new tp(new Ln(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new De,this.lineVertexArray=new Ge,this.symbolInstances=new Le,this.textAnchorOffsets=new Re}calculateGlyphDependencies(t,n,l,m,v){for(let w=0;w<t.length;w++)if(n[t.charCodeAt(w)]=!0,(l||m)&&v){const A=sd[t.charAt(w)];A&&(n[A.charCodeAt(0)]=!0)}}populate(t,n,l){const m=this.layers[0],v=m.layout,w=v.get("text-font"),A=v.get("text-field"),z=v.get("icon-image"),j=(A.value.kind!=="constant"||A.value.value instanceof ca&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),G=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,Y=v.get("symbol-sort-key");if(this.features=[],!j&&!G)return;const ee=n.iconDependencies,ae=n.glyphDependencies,ue=n.availableImages,fe=new Xr(this.zoom,{globalState:this.globalState});for(const{feature:we,id:Pe,index:et,sourceLayerIndex:Be}of t){const re=m._featureFilter.needGeometry,ve=Jl(we,re);if(!m._featureFilter.filter(fe,ve,l))continue;let Fe,xt;if(re||(ve.geometry=Sl(we)),j){const Mt=m.getValueAndResolveTokens("text-field",ve,l,ue),kt=ca.factory(Mt),qt=this.hasRTLText=this.hasRTLText||Kf(kt);(!qt||mo.getRTLTextPluginStatus()==="unavailable"||qt&&mo.isParsed())&&(Fe=cs(kt,m,ve))}if(G){const Mt=m.getValueAndResolveTokens("icon-image",ve,l,ue);xt=Mt instanceof ua?Mt:ua.fromString(Mt)}if(!Fe&&!xt)continue;const Nt=this.sortFeaturesByKey?Y.evaluate(ve,{},l):void 0;if(this.features.push({id:Pe,text:Fe,icon:xt,index:et,sourceLayerIndex:Be,geometry:ve.geometry,properties:we.properties,type:Jd[we.type],sortKey:Nt}),xt&&(ee[xt.name]=!0),Fe){const Mt=w.evaluate(ve,{},l).join(","),kt=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(B.an.vertical)>=0;for(const qt of Fe.sections)if(qt.image)ee[qt.image.name]=!0;else{const Ut=Uo(Fe.toString()),Xt=qt.fontStack||Mt,Rt=ae[Xt]=ae[Xt]||{};this.calculateGlyphDependencies(qt.text,Rt,kt,this.allowVerticalPlacement,Ut)}}}v.get("symbol-placement")==="line"&&(this.features=function(we){const Pe={},et={},Be=[];let re=0;function ve(Mt){Be.push(we[Mt]),re++}function Fe(Mt,kt,qt){const Ut=et[Mt];return delete et[Mt],et[kt]=Ut,Be[Ut].geometry[0].pop(),Be[Ut].geometry[0]=Be[Ut].geometry[0].concat(qt[0]),Ut}function xt(Mt,kt,qt){const Ut=Pe[kt];return delete Pe[kt],Pe[Mt]=Ut,Be[Ut].geometry[0].shift(),Be[Ut].geometry[0]=qt[0].concat(Be[Ut].geometry[0]),Ut}function Nt(Mt,kt,qt){const Ut=qt?kt[0][kt[0].length-1]:kt[0][0];return`${Mt}:${Ut.x}:${Ut.y}`}for(let Mt=0;Mt<we.length;Mt++){const kt=we[Mt],qt=kt.geometry,Ut=kt.text?kt.text.toString():null;if(!Ut){ve(Mt);continue}const Xt=Nt(Ut,qt),Rt=Nt(Ut,qt,!0);if(Xt in et&&Rt in Pe&&et[Xt]!==Pe[Rt]){const gi=xt(Xt,Rt,qt),Ei=Fe(Xt,Rt,Be[gi].geometry);delete Pe[Xt],delete et[Rt],et[Nt(Ut,Be[Ei].geometry,!0)]=Ei,Be[gi].geometry=null}else Xt in et?Fe(Xt,Rt,qt):Rt in Pe?xt(Xt,Rt,qt):(ve(Mt),Pe[Xt]=re-1,et[Rt]=re-1)}return Be.filter(Mt=>Mt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((we,Pe)=>we.sortKey-Pe.sortKey)}update(t,n,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const l=this.lineVertexArray.length;if(t.segment!==void 0){let m=t.dist(n[t.segment+1]),v=t.dist(n[t.segment]);const w={};for(let A=t.segment+1;A<n.length;A++)w[A]={x:n[A].x,y:n[A].y,tileUnitDistanceFromAnchor:m},A<n.length-1&&(m+=n[A+1].dist(n[A]));for(let A=t.segment||0;A>=0;A--)w[A]={x:n[A].x,y:n[A].y,tileUnitDistanceFromAnchor:v},A>0&&(v+=n[A-1].dist(n[A]));for(let A=0;A<n.length;A++){const z=w[A];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,n,l,m,v,w,A,z,j,G,Y,ee){const ae=t.indexArray,ue=t.layoutVertexArray,fe=t.segments.prepareSegment(4*n.length,ue,ae,this.canOverlap?w.sortKey:void 0),we=this.glyphOffsetArray.length,Pe=fe.vertexLength,et=this.allowVerticalPlacement&&A===B.an.vertical?Math.PI/2:0,Be=w.text&&w.text.sections;for(let re=0;re<n.length;re++){const{tl:ve,tr:Fe,bl:xt,br:Nt,tex:Mt,pixelOffsetTL:kt,pixelOffsetBR:qt,minFontScaleX:Ut,minFontScaleY:Xt,glyphOffset:Rt,isSDF:gi,sectionIndex:Ei}=n[re],Si=fe.vertexLength,mi=Rt[1];ep(ue,z.x,z.y,ve.x,mi+ve.y,Mt.x,Mt.y,l,gi,kt.x,kt.y,Ut,Xt),ep(ue,z.x,z.y,Fe.x,mi+Fe.y,Mt.x+Mt.w,Mt.y,l,gi,qt.x,kt.y,Ut,Xt),ep(ue,z.x,z.y,xt.x,mi+xt.y,Mt.x,Mt.y+Mt.h,l,gi,kt.x,qt.y,Ut,Xt),ep(ue,z.x,z.y,Nt.x,mi+Nt.y,Mt.x+Mt.w,Mt.y+Mt.h,l,gi,qt.x,qt.y,Ut,Xt),cd(t.dynamicLayoutVertexArray,z,et),ae.emplaceBack(Si,Si+2,Si+1),ae.emplaceBack(Si+1,Si+2,Si+3),fe.vertexLength+=4,fe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Rt[0]),re!==n.length-1&&Ei===n[re+1].sectionIndex||t.programConfigurations.populatePaintArrays(ue.length,w,w.index,{},ee,Be&&Be[Ei])}t.placedSymbolArray.emplaceBack(z.x,z.y,we,this.glyphOffsetArray.length-we,Pe,j,G,z.segment,l?l[0]:0,l?l[1]:0,m[0],m[1],A,0,!1,0,Y)}_addCollisionDebugVertex(t,n,l,m,v,w){return n.emplaceBack(0,0),t.emplaceBack(l.x,l.y,m,v,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(t,n,l,m,v,w,A){const z=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),j=z.vertexLength,G=v.layoutVertexArray,Y=v.collisionVertexArray,ee=A.anchorX,ae=A.anchorY;this._addCollisionDebugVertex(G,Y,w,ee,ae,new Se(t,n)),this._addCollisionDebugVertex(G,Y,w,ee,ae,new Se(l,n)),this._addCollisionDebugVertex(G,Y,w,ee,ae,new Se(l,m)),this._addCollisionDebugVertex(G,Y,w,ee,ae,new Se(t,m)),z.vertexLength+=4;const ue=v.indexArray;ue.emplaceBack(j,j+1),ue.emplaceBack(j+1,j+2),ue.emplaceBack(j+2,j+3),ue.emplaceBack(j+3,j),z.primitiveLength+=4}addDebugCollisionBoxes(t,n,l,m){for(let v=t;v<n;v++){const w=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,m?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new qp(jr,Gs.members,nr),this.iconCollisionBox=new qp(jr,Gs.members,nr);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,l,m,v,w,A,z,j){const G={};for(let Y=n;Y<l;Y++){const ee=t.get(Y);G.textBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.textFeatureIndex=ee.featureIndex;break}for(let Y=m;Y<v;Y++){const ee=t.get(Y);G.verticalTextBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.verticalTextFeatureIndex=ee.featureIndex;break}for(let Y=w;Y<A;Y++){const ee=t.get(Y);G.iconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.iconFeatureIndex=ee.featureIndex;break}for(let Y=z;Y<j;Y++){const ee=t.get(Y);G.verticalIconBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},G.verticalIconFeatureIndex=ee.featureIndex;break}return G}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const l=t.placedSymbolArray.get(n),m=l.vertexStartIndex+4*l.numGlyphs;for(let v=l.vertexStartIndex;v<m;v+=4)t.indexArray.emplaceBack(v,v+2,v+1),t.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),l=Math.cos(t),m=[],v=[],w=[];for(let A=0;A<this.symbolInstances.length;++A){w.push(A);const z=this.symbolInstances.get(A);m.push(0|Math.round(n*z.anchorX+l*z.anchorY)),v.push(z.featureIndex)}return w.sort((A,z)=>m[A]-m[z]||v[z]-v[A]),w}addToSortKeyRanges(t,n){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const l=this.symbolInstances.get(n);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((m,v,w)=>{m>=0&&w.indexOf(m)===v&&this.addIndicesForPlacedSymbol(this.text,m)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Mf,ip;si("SymbolBucket",Pu,{omit:["layers","collisionBoxArray","features","compareText"]}),Pu.MAX_GLYPHS=65535,Pu.addDynamicAttributes=cd;var Cf={get paint(){return ip=ip||new Fn({"icon-opacity":new Ti(He.paint_symbol["icon-opacity"]),"icon-color":new Ti(He.paint_symbol["icon-color"]),"icon-halo-color":new Ti(He.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ti(He.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ti(He.paint_symbol["icon-halo-blur"]),"icon-translate":new ui(He.paint_symbol["icon-translate"]),"icon-translate-anchor":new ui(He.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ti(He.paint_symbol["text-opacity"]),"text-color":new Ti(He.paint_symbol["text-color"],{runtimeType:Dr,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Ti(He.paint_symbol["text-halo-color"]),"text-halo-width":new Ti(He.paint_symbol["text-halo-width"]),"text-halo-blur":new Ti(He.paint_symbol["text-halo-blur"]),"text-translate":new ui(He.paint_symbol["text-translate"]),"text-translate-anchor":new ui(He.paint_symbol["text-translate-anchor"])})},get layout(){return Mf=Mf||new Fn({"symbol-placement":new ui(He.layout_symbol["symbol-placement"]),"symbol-spacing":new ui(He.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ui(He.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ti(He.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ui(He.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ui(He.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ui(He.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ui(He.layout_symbol["icon-ignore-placement"]),"icon-optional":new ui(He.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ui(He.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ti(He.layout_symbol["icon-size"]),"icon-text-fit":new ui(He.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ui(He.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ti(He.layout_symbol["icon-image"]),"icon-rotate":new Ti(He.layout_symbol["icon-rotate"]),"icon-padding":new Ti(He.layout_symbol["icon-padding"]),"icon-keep-upright":new ui(He.layout_symbol["icon-keep-upright"]),"icon-offset":new Ti(He.layout_symbol["icon-offset"]),"icon-anchor":new Ti(He.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ui(He.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ui(He.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ui(He.layout_symbol["text-rotation-alignment"]),"text-field":new Ti(He.layout_symbol["text-field"]),"text-font":new Ti(He.layout_symbol["text-font"]),"text-size":new Ti(He.layout_symbol["text-size"]),"text-max-width":new Ti(He.layout_symbol["text-max-width"]),"text-line-height":new ui(He.layout_symbol["text-line-height"]),"text-letter-spacing":new Ti(He.layout_symbol["text-letter-spacing"]),"text-justify":new Ti(He.layout_symbol["text-justify"]),"text-radial-offset":new Ti(He.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ui(He.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ti(He.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ti(He.layout_symbol["text-anchor"]),"text-max-angle":new ui(He.layout_symbol["text-max-angle"]),"text-writing-mode":new ui(He.layout_symbol["text-writing-mode"]),"text-rotate":new Ti(He.layout_symbol["text-rotate"]),"text-padding":new ui(He.layout_symbol["text-padding"]),"text-keep-upright":new ui(He.layout_symbol["text-keep-upright"]),"text-transform":new Ti(He.layout_symbol["text-transform"]),"text-offset":new Ti(He.layout_symbol["text-offset"]),"text-allow-overlap":new ui(He.layout_symbol["text-allow-overlap"]),"text-overlap":new ui(He.layout_symbol["text-overlap"]),"text-ignore-placement":new ui(He.layout_symbol["text-ignore-placement"]),"text-optional":new ui(He.layout_symbol["text-optional"])})}};class Xp{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Cs,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}si("FormatSectionOverride",Xp,{omit:["defaultValue"]});class ud extends Qn{constructor(t){super(t,Cf)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const m=[];for(const v of l)m.indexOf(v)<0&&m.push(v);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,l,m){const v=this.layout.get(t).evaluate(n,{},l,m),w=this._unevaluatedLayout._values[t];return w.isDataDriven()||Ec(w.value)||!v?v:function(A,z){return z.replace(/{([^{}]+)}/g,(j,G)=>A&&G in A?String(A[G]):"")}(n.properties,v)}createBucket(t){return new Pu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Cf.paint.overridableProperties){if(!ud.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),l=new Xp(n),m=new Vl(l,n.property.specification);let v=null;v=n.value.kind==="constant"||n.value.kind==="source"?new xi("source",m):new no("composite",m,n.value.zoomStops),this.paint._values[t]=new Yr(n.property,v,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,l){return!(!this.layout||n.isDataDriven()||l.isDataDriven())&&ud.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const l=t.get("text-field"),m=Cf.paint.properties[n];let v=!1;const w=A=>{for(const z of A)if(m.overrides&&m.overrides.hasOverride(z))return void(v=!0)};if(l.value.kind==="constant"&&l.value.value instanceof ca)w(l.value.value.sections);else if(l.value.kind==="source"){const A=j=>{v||(j instanceof En&&Li(j.value)===Ll?w(j.value.sections):j instanceof nl?w(j.sections):j.eachChild(A))},z=l.value;z._styleExpression&&A(z._styleExpression.expression)}return v}}let Qf;var mm={get paint(){return Qf=Qf||new Fn({"background-color":new ui(He.paint_background["background-color"]),"background-pattern":new Or(He.paint_background["background-pattern"]),"background-opacity":new ui(He.paint_background["background-opacity"])})}};class rp extends Qn{constructor(t){super(t,mm)}}let np;var Jf={get paint(){return np=np||new Fn({"raster-opacity":new ui(He.paint_raster["raster-opacity"]),"raster-hue-rotate":new ui(He.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ui(He.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ui(He.paint_raster["raster-brightness-max"]),"raster-saturation":new ui(He.paint_raster["raster-saturation"]),"raster-contrast":new ui(He.paint_raster["raster-contrast"]),"raster-resampling":new ui(He.paint_raster["raster-resampling"]),"raster-fade-duration":new ui(He.paint_raster["raster-fade-duration"])})}};class br extends Qn{constructor(t){super(t,Jf)}}class Af extends Qn{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class ap{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const R={once:!0},s=63710088e-1;class u{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new u(Pl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,l=this.lat*n,m=t.lat*n,v=Math.sin(l)*Math.sin(m)+Math.cos(l)*Math.cos(m)*Math.cos((t.lng-this.lng)*n);return s*Math.acos(Math.min(v,1))}static convert(t){if(t instanceof u)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new u(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new u(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const p=2*Math.PI*s;function g(a){return p*Math.cos(a*Math.PI/180)}function b(a){return(180+a)/360}function T(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function C(a,t){return a/g(t)}function E(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function D(a,t){return a*g(E(t))}class N{constructor(t,n,l=0){this.x=+t,this.y=+n,this.z=+l}static fromLngLat(t,n=0){const l=u.convert(t);return new N(b(l.lng),T(l.lat),C(n,l.lat))}toLngLat(){return new u(360*this.x-180,E(this.y))}toAltitude(){return D(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/p*(t=E(this.y),1/Math.cos(t*Math.PI/180));var t}}function I(a,t,n){var l=2*Math.PI*6378137/256/Math.pow(2,n);return[a*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class U{constructor(t,n,l){if(!function(m,v,w){return!(m<0||m>25||w<0||w>=Math.pow(2,m)||v<0||v>=Math.pow(2,m))}(t,n,l))throw new Error(`x=${n}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=l,this.key=le(0,t,t,n,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,l){const m=(w=this.y,A=this.z,z=I(256*(v=this.x),256*(w=Math.pow(2,A)-w-1),A),j=I(256*(v+1),256*(w+1),A),z[0]+","+z[1]+","+j[0]+","+j[1]);var v,w,A,z,j;const G=function(Y,ee,ae){let ue,fe="";for(let we=Y;we>0;we--)ue=1<<we-1,fe+=(ee&ue?1:0)+(ae&ue?2:0);return fe}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,G).replace(/{bbox-epsg-3857}/g,m)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new Se((t.x*n-this.x)*Ht,(t.y*n-this.y)*Ht)}toString(){return`${this.z}/${this.x}/${this.y}`}}class X{constructor(t,n){this.wrap=t,this.canonical=n,this.key=le(t,n.z,n.z,n.x,n.y)}}class Q{constructor(t,n,l,m,v){if(this.terrainRttPosMatrix32f=null,t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=n,this.canonical=new U(l,+m,+v),this.key=le(n,t,l,m,v)}clone(){return new Q(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new Q(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Q(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?le(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):le(this.wrap*+n,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new Q(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,l=2*this.canonical.x,m=2*this.canonical.y;return[new Q(n,this.wrap,n,l,m),new Q(n,this.wrap,n,l+1,m),new Q(n,this.wrap,n,l,m+1),new Q(n,this.wrap,n,l+1,m+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Q(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Q(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new X(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new N(t.x-this.wrap,t.y))}}function le(a,t,n,l,m){(a*=2)<0&&(a=-1*a-1);const v=1<<n;return(v*v*a+v*m+l).toString(36)+n.toString(36)+t.toString(36)}si("CanonicalTileID",U),si("OverscaledTileID",Q,{omit:["terrainRttPosMatrix32f"]});class ne{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const n=new ne;return n.extend(t(new Se(this.minX,this.minY))),n.extend(t(new Se(this.maxX,this.minY))),n.extend(t(new Se(this.minX,this.maxY))),n.extend(t(new Se(this.maxX,this.maxY))),n}static fromPoints(t){const n=new ne;for(const l of t)n.extend(l);return n}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class ie{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const l=t[n];this._stringToNumber[l]=n,this._numberToString[n]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class me{constructor(t,n,l,m,v){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=l,t._y=m,this.properties=t.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class _e{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new vs(Ht,16,0),this.grid3D=new vs(Ht,16,0),this.featureIndexArray=new vt,this.promoteId=n}insert(t,n,l,m,v,w){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,m,v);const z=w?this.grid3D:this.grid;for(let j=0;j<n.length;j++){const G=n[j],Y=[1/0,1/0,-1/0,-1/0];for(let ee=0;ee<G.length;ee++){const ae=G[ee];Y[0]=Math.min(Y[0],ae.x),Y[1]=Math.min(Y[1],ae.y),Y[2]=Math.max(Y[2],ae.x),Y[3]=Math.max(Y[3],ae.y)}Y[0]<Ht&&Y[1]<Ht&&Y[2]>=0&&Y[3]>=0&&z.insert(A,Y[0],Y[1],Y[2],Y[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Pr.VectorTile(new Xd(this.rawTileData)).layers,this.sourceLayerCoder=new ie(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,l,m){this.loadVTLayers();const v=t.params,w=Ht/t.tileSize/t.scale,A=xn(v.filter),z=t.queryGeometry,j=t.queryPadding*w,G=ne.fromPoints(z),Y=this.grid.query(G.minX-j,G.minY-j,G.maxX+j,G.maxY+j),ee=ne.fromPoints(t.cameraQueryGeometry).expandBy(j),ae=this.grid3D.query(ee.minX,ee.minY,ee.maxX,ee.maxY,(we,Pe,et,Be)=>function(re,ve,Fe,xt,Nt){for(const kt of re)if(ve<=kt.x&&Fe<=kt.y&&xt>=kt.x&&Nt>=kt.y)return!0;const Mt=[new Se(ve,Fe),new Se(ve,Nt),new Se(xt,Nt),new Se(xt,Fe)];if(re.length>2){for(const kt of Mt)if(Ic(re,kt))return!0}for(let kt=0;kt<re.length-1;kt++)if(Ia(re[kt],re[kt+1],Mt))return!0;return!1}(t.cameraQueryGeometry,we-j,Pe-j,et+j,Be+j));for(const we of ae)Y.push(we);Y.sort($e);const ue={};let fe;for(let we=0;we<Y.length;we++){const Pe=Y[we];if(Pe===fe)continue;fe=Pe;const et=this.featureIndexArray.get(Pe);let Be=null;this.loadMatchingFeature(ue,et.bucketIndex,et.sourceLayerIndex,et.featureIndex,A,v.layers,v.availableImages,n,l,m,(re,ve,Fe)=>(Be||(Be=Sl(re)),ve.queryIntersectsFeature({queryGeometry:z,feature:re,featureState:Fe,geometry:Be,zoom:this.z,transform:t.transform,pixelsToTileUnits:w,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return ue}loadMatchingFeature(t,n,l,m,v,w,A,z,j,G,Y){const ee=this.bucketLayerIDs[n];if(w&&!ee.some(we=>w.has(we)))return;const ae=this.sourceLayerCoder.decode(l),ue=this.vtLayers[ae].feature(m);if(v.needGeometry){const we=Jl(ue,!0);if(!v.filter(new Xr(this.tileID.overscaledZ),we,this.tileID.canonical))return}else if(!v.filter(new Xr(this.tileID.overscaledZ),ue))return;const fe=this.getId(ue,ae);for(let we=0;we<ee.length;we++){const Pe=ee[we];if(w&&!w.has(Pe))continue;const et=z[Pe];if(!et)continue;let Be={};fe&&G&&(Be=G.getState(et.sourceLayer||"_geojsonTileLayer",fe));const re=aa({},j[Pe]);re.paint=Je(re.paint,et.paint,ue,Be,A),re.layout=Je(re.layout,et.layout,ue,Be,A);const ve=!Y||Y(ue,et,Be);if(!ve)continue;const Fe=new me(ue,this.z,this.x,this.y,fe);Fe.layer=re;let xt=t[Pe];xt===void 0&&(xt=t[Pe]=[]),xt.push({featureIndex:m,feature:Fe,intersectionZ:ve})}}lookupSymbolFeatures(t,n,l,m,v,w,A,z){const j={};this.loadVTLayers();const G=xn(v);for(const Y of t)this.loadMatchingFeature(j,l,m,Y,G,w,A,z,n);return j}hasLayer(t){for(const n of this.bucketLayerIDs)for(const l of n)if(t===l)return!0;return!1}getId(t,n){var l;let m=t.id;return this.promoteId&&(m=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((l=t.properties)===null||l===void 0)&&l.cluster)&&this.promoteId&&(m=Number(t.properties.cluster_id))),m}}function Je(a,t,n,l,m){return li(a,(v,w)=>{const A=t instanceof zc?t.get(w):null;return A&&A.evaluate?A.evaluate(n,l,m):A})}function $e(a,t){return t-a}function Ze(a,t,n,l,m){const v=[];for(let w=0;w<a.length;w++){const A=a[w];let z;for(let j=0;j<A.length-1;j++){let G=A[j],Y=A[j+1];G.x<t&&Y.x<t||(G.x<t?G=new Se(t,G.y+(t-G.x)/(Y.x-G.x)*(Y.y-G.y))._round():Y.x<t&&(Y=new Se(t,G.y+(t-G.x)/(Y.x-G.x)*(Y.y-G.y))._round()),G.y<n&&Y.y<n||(G.y<n?G=new Se(G.x+(n-G.y)/(Y.y-G.y)*(Y.x-G.x),n)._round():Y.y<n&&(Y=new Se(G.x+(n-G.y)/(Y.y-G.y)*(Y.x-G.x),n)._round()),G.x>=l&&Y.x>=l||(G.x>=l?G=new Se(l,G.y+(l-G.x)/(Y.x-G.x)*(Y.y-G.y))._round():Y.x>=l&&(Y=new Se(l,G.y+(l-G.x)/(Y.x-G.x)*(Y.y-G.y))._round()),G.y>=m&&Y.y>=m||(G.y>=m?G=new Se(G.x+(m-G.y)/(Y.y-G.y)*(Y.x-G.x),m)._round():Y.y>=m&&(Y=new Se(G.x+(m-G.y)/(Y.y-G.y)*(Y.x-G.x),m)._round()),z&&G.equals(z[z.length-1])||(z=[G],v.push(z)),z.push(Y)))))}}return v}si("FeatureIndex",_e,{omit:["rawTileData","sourceLayerCoder"]});class ht extends Se{constructor(t,n,l,m){super(t,n),this.angle=l,m!==void 0&&(this.segment=m)}clone(){return new ht(this.x,this.y,this.angle,this.segment)}}function at(a,t,n,l,m){if(t.segment===void 0||n===0)return!0;let v=t,w=t.segment+1,A=0;for(;A>-n/2;){if(w--,w<0)return!1;A-=a[w].dist(v),v=a[w]}A+=a[w].dist(a[w+1]),w++;const z=[];let j=0;for(;A<n/2;){const G=a[w],Y=a[w+1];if(!Y)return!1;let ee=a[w-1].angleTo(G)-G.angleTo(Y);for(ee=Math.abs((ee+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:A,angleDelta:ee}),j+=ee;A-z[0].distance>l;)j-=z.shift().angleDelta;if(j>m)return!1;w++,A+=G.dist(Y)}return!0}function mt(a){let t=0;for(let n=0;n<a.length-1;n++)t+=a[n].dist(a[n+1]);return t}function Bt(a,t,n){return a?.6*t*n:0}function Zt(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function Qt(a,t,n,l,m,v){const w=Bt(n,m,v),A=Zt(n,l)*v;let z=0;const j=mt(a)/2;for(let G=0;G<a.length-1;G++){const Y=a[G],ee=a[G+1],ae=Y.dist(ee);if(z+ae>j){const ue=(j-z)/ae,fe=ts.number(Y.x,ee.x,ue),we=ts.number(Y.y,ee.y,ue),Pe=new ht(fe,we,ee.angleTo(Y),G);return Pe._round(),!w||at(a,Pe,A,w,t)?Pe:void 0}z+=ae}}function Gt(a,t,n,l,m,v,w,A,z){const j=Bt(l,v,w),G=Zt(l,m),Y=G*w,ee=a[0].x===0||a[0].x===z||a[0].y===0||a[0].y===z;return t-Y<t/4&&(t=Y+t/4),hi(a,ee?t/2*A%t:(G/2+2*v)*w*A%t,t,j,n,Y,ee,!1,z)}function hi(a,t,n,l,m,v,w,A,z){const j=v/2,G=mt(a);let Y=0,ee=t-n,ae=[];for(let ue=0;ue<a.length-1;ue++){const fe=a[ue],we=a[ue+1],Pe=fe.dist(we),et=we.angleTo(fe);for(;ee+n<Y+Pe;){ee+=n;const Be=(ee-Y)/Pe,re=ts.number(fe.x,we.x,Be),ve=ts.number(fe.y,we.y,Be);if(re>=0&&re<z&&ve>=0&&ve<z&&ee-j>=0&&ee+j<=G){const Fe=new ht(re,ve,et,ue);Fe._round(),l&&!at(a,Fe,v,l,m)||ae.push(Fe)}}Y+=Pe}return A||ae.length||w||(ae=hi(a,Y/2,n,l,m,v,w,!0,z)),ae}function oi(a,t,n,l){const m=[],v=a.image,w=v.pixelRatio,A=v.paddedRect.w-2,z=v.paddedRect.h-2;let j={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const G=v.stretchX||[[0,A]],Y=v.stretchY||[[0,z]],ee=(Rt,gi)=>Rt+gi[1]-gi[0],ae=G.reduce(ee,0),ue=Y.reduce(ee,0),fe=A-ae,we=z-ue;let Pe=0,et=ae,Be=0,re=ue,ve=0,Fe=fe,xt=0,Nt=we;if(v.content&&l){const Rt=v.content,gi=Rt[2]-Rt[0],Ei=Rt[3]-Rt[1];(v.textFitWidth||v.textFitHeight)&&(j=ku(a)),Pe=ji(G,0,Rt[0]),Be=ji(Y,0,Rt[1]),et=ji(G,Rt[0],Rt[2]),re=ji(Y,Rt[1],Rt[3]),ve=Rt[0]-Pe,xt=Rt[1]-Be,Fe=gi-et,Nt=Ei-re}const Mt=j.x1,kt=j.y1,qt=j.x2-Mt,Ut=j.y2-kt,Xt=(Rt,gi,Ei,Si)=>{const mi=Di(Rt.stretch-Pe,et,qt,Mt),Ji=lr(Rt.fixed-ve,Fe,Rt.stretch,ae),rn=Di(gi.stretch-Be,re,Ut,kt),In=lr(gi.fixed-xt,Nt,gi.stretch,ue),On=Di(Ei.stretch-Pe,et,qt,Mt),kl=lr(Ei.fixed-ve,Fe,Ei.stretch,ae),Hs=Di(Si.stretch-Be,re,Ut,kt),qn=lr(Si.fixed-xt,Nt,Si.stretch,ue),Mn=new Se(mi,rn),_a=new Se(On,rn),ia=new Se(On,Hs),Fa=new Se(mi,Hs),Zs=new Se(Ji/w,In/w),qs=new Se(kl/w,qn/w),Xn=t*Math.PI/180;if(Xn){const ra=Math.sin(Xn),Yn=Math.cos(Xn),Wn=[Yn,-ra,ra,Yn];Mn._matMult(Wn),_a._matMult(Wn),Fa._matMult(Wn),ia._matMult(Wn)}const Xs=Rt.stretch+Rt.fixed,jn=gi.stretch+gi.fixed;return{tl:Mn,tr:_a,bl:Fa,br:ia,tex:{x:v.paddedRect.x+1+Xs,y:v.paddedRect.y+1+jn,w:Ei.stretch+Ei.fixed-Xs,h:Si.stretch+Si.fixed-jn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Zs,pixelOffsetBR:qs,minFontScaleX:Fe/w/qt,minFontScaleY:Nt/w/Ut,isSDF:n}};if(l&&(v.stretchX||v.stretchY)){const Rt=_i(G,fe,ae),gi=_i(Y,we,ue);for(let Ei=0;Ei<Rt.length-1;Ei++){const Si=Rt[Ei],mi=Rt[Ei+1];for(let Ji=0;Ji<gi.length-1;Ji++)m.push(Xt(Si,gi[Ji],mi,gi[Ji+1]))}}else m.push(Xt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:z+1}));return m}function ji(a,t,n){let l=0;for(const m of a)l+=Math.max(t,Math.min(n,m[1]))-Math.max(t,Math.min(n,m[0]));return l}function _i(a,t,n){const l=[{fixed:-1,stretch:0}];for(const[m,v]of a){const w=l[l.length-1];l.push({fixed:m-w.stretch,stretch:w.stretch}),l.push({fixed:m-w.stretch,stretch:w.stretch+(v-m)})}return l.push({fixed:t+1,stretch:n}),l}function Di(a,t,n,l){return a/t*n+l}function lr(a,t,n,l){return a-t*n/l}si("Anchor",ht);class Bi{constructor(t,n,l,m,v,w,A,z,j,G){var Y;if(this.boxStartIndex=t.length,j){let ee=w.top,ae=w.bottom;const ue=w.collisionPadding;ue&&(ee-=ue[1],ae+=ue[3]);let fe=ae-ee;fe>0&&(fe=Math.max(10,fe),this.circleDiameter=fe)}else{const ee=!((Y=w.image)===null||Y===void 0)&&Y.content&&(w.image.textFitWidth||w.image.textFitHeight)?ku(w):{x1:w.left,y1:w.top,x2:w.right,y2:w.bottom};ee.y1=ee.y1*A-z[0],ee.y2=ee.y2*A+z[2],ee.x1=ee.x1*A-z[3],ee.x2=ee.x2*A+z[1];const ae=w.collisionPadding;if(ae&&(ee.x1-=ae[0]*A,ee.y1-=ae[1]*A,ee.x2+=ae[2]*A,ee.y2+=ae[3]*A),G){const ue=new Se(ee.x1,ee.y1),fe=new Se(ee.x2,ee.y1),we=new Se(ee.x1,ee.y2),Pe=new Se(ee.x2,ee.y2),et=G*Math.PI/180;ue._rotate(et),fe._rotate(et),we._rotate(et),Pe._rotate(et),ee.x1=Math.min(ue.x,fe.x,we.x,Pe.x),ee.x2=Math.max(ue.x,fe.x,we.x,Pe.x),ee.y1=Math.min(ue.y,fe.y,we.y,Pe.y),ee.y2=Math.max(ue.y,fe.y,we.y,Pe.y)}t.emplaceBack(n.x,n.y,ee.x1,ee.y1,ee.x2,ee.y2,l,m,v)}this.boxEndIndex=t.length}}class yr{constructor(t=[],n=(l,m)=>l<m?-1:l>m?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:l}=this,m=n[t];for(;t>0;){const v=t-1>>1,w=n[v];if(l(m,w)>=0)break;n[t]=w,t=v}n[t]=m}_down(t){const{data:n,compare:l}=this,m=this.length>>1,v=n[t];for(;t<m;){let w=1+(t<<1);const A=w+1;if(A<this.length&&l(n[A],n[w])<0&&(w=A),l(n[w],v)>=0)break;n[t]=n[w],t=w}n[t]=v}}function Na(a,t=1,n=!1){const l=ne.fromPoints(a[0]),m=Math.min(l.width(),l.height());let v=m/2;const w=new yr([],_r),{minX:A,minY:z,maxX:j,maxY:G}=l;if(m===0)return new Se(A,z);for(let ae=A;ae<j;ae+=m)for(let ue=z;ue<G;ue+=m)w.push(new dr(ae+v,ue+v,v,a));let Y=function(ae){let ue=0,fe=0,we=0;const Pe=ae[0];for(let et=0,Be=Pe.length,re=Be-1;et<Be;re=et++){const ve=Pe[et],Fe=Pe[re],xt=ve.x*Fe.y-Fe.x*ve.y;fe+=(ve.x+Fe.x)*xt,we+=(ve.y+Fe.y)*xt,ue+=3*xt}return new dr(fe/ue,we/ue,0,ae)}(a),ee=w.length;for(;w.length;){const ae=w.pop();(ae.d>Y.d||!Y.d)&&(Y=ae,n&&console.log("found best %d after %d probes",Math.round(1e4*ae.d)/1e4,ee)),ae.max-Y.d<=t||(v=ae.h/2,w.push(new dr(ae.p.x-v,ae.p.y-v,v,a)),w.push(new dr(ae.p.x+v,ae.p.y-v,v,a)),w.push(new dr(ae.p.x-v,ae.p.y+v,v,a)),w.push(new dr(ae.p.x+v,ae.p.y+v,v,a)),ee+=4)}return n&&(console.log(`num probes: ${ee}`),console.log(`best distance: ${Y.d}`)),Y.p}function _r(a,t){return t.max-a.max}function dr(a,t,n,l){this.p=new Se(a,t),this.h=n,this.d=function(m,v){let w=!1,A=1/0;for(let z=0;z<v.length;z++){const j=v[z];for(let G=0,Y=j.length,ee=Y-1;G<Y;ee=G++){const ae=j[G],ue=j[ee];ae.y>m.y!=ue.y>m.y&&m.x<(ue.x-ae.x)*(m.y-ae.y)/(ue.y-ae.y)+ae.x&&(w=!w),A=Math.min(A,vr(m,ae,ue))}}return(w?1:-1)*Math.sqrt(A)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var fi;B.aD=void 0,(fi=B.aD||(B.aD={}))[fi.center=1]="center",fi[fi.left=2]="left",fi[fi.right=3]="right",fi[fi.top=4]="top",fi[fi.bottom=5]="bottom",fi[fi["top-left"]=6]="top-left",fi[fi["top-right"]=7]="top-right",fi[fi["bottom-left"]=8]="bottom-left",fi[fi["bottom-right"]=9]="bottom-right";const zi=Number.POSITIVE_INFINITY;function hn(a,t){return t[1]!==zi?function(n,l,m){let v=0,w=0;switch(l=Math.abs(l),m=Math.abs(m),n){case"top-right":case"top-left":case"top":w=m-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-m}switch(n){case"top-right":case"bottom-right":case"right":v=-l;break;case"top-left":case"bottom-left":case"left":v=l}return[v,w]}(a,t[0],t[1]):function(n,l){let m=0,v=0;l<0&&(l=0);const w=l/Math.SQRT2;switch(n){case"top-right":case"top-left":v=w-7;break;case"bottom-right":case"bottom-left":v=7-w;break;case"bottom":v=7-l;break;case"top":v=l-7}switch(n){case"top-right":case"bottom-right":m=-w;break;case"top-left":case"bottom-left":m=w;break;case"left":m=l;break;case"right":m=-l}return[m,v]}(a,t[0])}function pr(a,t,n){var l;const m=a.layout,v=(l=m.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},n);if(v){const A=v.values,z=[];for(let j=0;j<A.length;j+=2){const G=z[j]=A[j],Y=A[j+1].map(ee=>ee*Dn);G.startsWith("top")?Y[1]-=7:G.startsWith("bottom")&&(Y[1]+=7),z[j+1]=Y}return new Vi(z)}const w=m.get("text-variable-anchor");if(w){let A;A=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(t,{},n)*Dn,zi]:m.get("text-offset").evaluate(t,{},n).map(j=>j*Dn);const z=[];for(const j of w)z.push(j,hn(j,A));return new Vi(z)}return null}function Hr(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ta(a,t,n,l,m,v,w,A,z,j,G,Y){let ee=v.textMaxSize.evaluate(t,{});ee===void 0&&(ee=w);const ae=a.layers[0].layout,ue=ae.get("icon-offset").evaluate(t,{},G),fe=$s(n.horizontal),we=w/24,Pe=a.tilePixelRatio*we,et=a.tilePixelRatio*ee/24,Be=a.tilePixelRatio*A,re=a.tilePixelRatio*ae.get("symbol-spacing"),ve=ae.get("text-padding")*a.tilePixelRatio,Fe=function(Ei,Si,mi,Ji=1){const rn=Ei.get("icon-padding").evaluate(Si,{},mi),In=rn&&rn.values;return[In[0]*Ji,In[1]*Ji,In[2]*Ji,In[3]*Ji]}(ae,t,G,a.tilePixelRatio),xt=ae.get("text-max-angle")/180*Math.PI,Nt=ae.get("text-rotation-alignment")!=="viewport"&&ae.get("symbol-placement")!=="point",Mt=ae.get("icon-rotation-alignment")==="map"&&ae.get("symbol-placement")!=="point",kt=ae.get("symbol-placement"),qt=re/2,Ut=ae.get("icon-text-fit");let Xt;l&&Ut!=="none"&&(a.allowVerticalPlacement&&n.vertical&&(Xt=Zp(l,n.vertical,Ut,ae.get("icon-text-fit-padding"),ue,we)),fe&&(l=Zp(l,fe,Ut,ae.get("icon-text-fit-padding"),ue,we)));const Rt=G?Y.line.getGranularityForZoomLevel(G.z):1,gi=(Ei,Si)=>{Si.x<0||Si.x>=Ht||Si.y<0||Si.y>=Ht||function(mi,Ji,rn,In,On,kl,Hs,qn,Mn,_a,ia,Fa,Zs,qs,Xn,Xs,jn,ra,Yn,Wn,dn,Wo,i,o,d){const x=mi.addToLineVertexArray(Ji,rn);let k,O,se,xe,Xe=0,Tt=0,Ft=0,$t=0,Ct=-1,At=-1;const Ni={};let Yi=ya("");if(mi.allowVerticalPlacement&&In.vertical){const Mo=qn.layout.get("text-rotate").evaluate(dn,{},o)+90;se=new Bi(Mn,Ji,_a,ia,Fa,In.vertical,Zs,qs,Xn,Mo),Hs&&(xe=new Bi(Mn,Ji,_a,ia,Fa,Hs,jn,ra,Xn,Mo))}if(On){const Mo=qn.layout.get("icon-rotate").evaluate(dn,{}),Zc=qn.layout.get("icon-text-fit")!=="none",Ef=oi(On,Mo,i,Zc),wh=Hs?oi(Hs,Mo,i,Zc):void 0;O=new Bi(Mn,Ji,_a,ia,Fa,On,jn,ra,!1,Mo),Xe=4*Ef.length;const kf=mi.iconSizeData;let dd=null;kf.kind==="source"?(dd=[bo*qn.layout.get("icon-size").evaluate(dn,{})],dd[0]>uc&&qr(`${mi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):kf.kind==="composite"&&(dd=[bo*Wo.compositeIconSizes[0].evaluate(dn,{},o),bo*Wo.compositeIconSizes[1].evaluate(dn,{},o)],(dd[0]>uc||dd[1]>uc)&&qr(`${mi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),mi.addSymbols(mi.icon,Ef,dd,Wn,Yn,dn,B.an.none,Ji,x.lineStartIndex,x.lineLength,-1,o),Ct=mi.icon.placedSymbolArray.length-1,wh&&(Tt=4*wh.length,mi.addSymbols(mi.icon,wh,dd,Wn,Yn,dn,B.an.vertical,Ji,x.lineStartIndex,x.lineLength,-1,o),At=mi.icon.placedSymbolArray.length-1)}const nn=Object.keys(In.horizontal);for(const Mo of nn){const Zc=In.horizontal[Mo];if(!k){Yi=ya(Zc.text);const wh=qn.layout.get("text-rotate").evaluate(dn,{},o);k=new Bi(Mn,Ji,_a,ia,Fa,Zc,Zs,qs,Xn,wh)}const Ef=Zc.positionedLines.length===1;if(Ft+=Ts(mi,Ji,Zc,kl,qn,Xn,dn,Xs,x,In.vertical?B.an.horizontal:B.an.horizontalOnly,Ef?nn:[Mo],Ni,Ct,Wo,o),Ef)break}In.vertical&&($t+=Ts(mi,Ji,In.vertical,kl,qn,Xn,dn,Xs,x,B.an.vertical,["vertical"],Ni,At,Wo,o));const dt=k?k.boxStartIndex:mi.collisionBoxArray.length,st=k?k.boxEndIndex:mi.collisionBoxArray.length,bt=se?se.boxStartIndex:mi.collisionBoxArray.length,Vt=se?se.boxEndIndex:mi.collisionBoxArray.length,Ci=O?O.boxStartIndex:mi.collisionBoxArray.length,Tr=O?O.boxEndIndex:mi.collisionBoxArray.length,Ii=xe?xe.boxStartIndex:mi.collisionBoxArray.length,Ki=xe?xe.boxEndIndex:mi.collisionBoxArray.length;let pn=-1;const Lr=(Mo,Zc)=>Mo&&Mo.circleDiameter?Math.max(Mo.circleDiameter,Zc):Zc;pn=Lr(k,pn),pn=Lr(se,pn),pn=Lr(O,pn),pn=Lr(xe,pn);const bh=pn>-1?1:0;bh&&(pn*=d/Dn),mi.glyphOffsetArray.length>=Pu.MAX_GLYPHS&&qr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),dn.sortKey!==void 0&&mi.addToSortKeyRanges(mi.symbolInstances.length,dn.sortKey);const dg=pr(qn,dn,o),[L_,D_]=function(Mo,Zc){const Ef=Mo.length,wh=Zc==null?void 0:Zc.values;if((wh==null?void 0:wh.length)>0)for(let kf=0;kf<wh.length;kf+=2){const dd=wh[kf+1];Mo.emplaceBack(B.aD[wh[kf]],dd[0],dd[1])}return[Ef,Mo.length]}(mi.textAnchorOffsets,dg);mi.symbolInstances.emplaceBack(Ji.x,Ji.y,Ni.right>=0?Ni.right:-1,Ni.center>=0?Ni.center:-1,Ni.left>=0?Ni.left:-1,Ni.vertical||-1,Ct,At,Yi,dt,st,bt,Vt,Ci,Tr,Ii,Ki,_a,Ft,$t,Xe,Tt,bh,0,Zs,pn,L_,D_)}(a,Si,Ei,n,l,m,Xt,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,Pe,[ve,ve,ve,ve],Nt,z,Be,Fe,Mt,ue,t,v,j,G,w)};if(kt==="line")for(const Ei of Ze(t.geometry,0,0,Ht,Ht)){const Si=Bc(Ei,Rt),mi=Gt(Si,re,xt,n.vertical||fe,l,24,et,a.overscaling,Ht);for(const Ji of mi)fe&&Yo(a,fe.text,qt,Ji)||gi(Si,Ji)}else if(kt==="line-center"){for(const Ei of t.geometry)if(Ei.length>1){const Si=Bc(Ei,Rt),mi=Qt(Si,xt,n.vertical||fe,l,24,et);mi&&gi(Si,mi)}}else if(t.type==="Polygon")for(const Ei of Dh(t.geometry,0)){const Si=Na(Ei,16);gi(Bc(Ei[0],Rt,!0),new ht(Si.x,Si.y,0))}else if(t.type==="LineString")for(const Ei of t.geometry){const Si=Bc(Ei,Rt);gi(Si,new ht(Si[0].x,Si[0].y,0))}else if(t.type==="Point")for(const Ei of t.geometry)for(const Si of Ei)gi([Si],new ht(Si.x,Si.y,0))}function Ts(a,t,n,l,m,v,w,A,z,j,G,Y,ee,ae,ue){const fe=function(et,Be,re,ve,Fe,xt,Nt,Mt){const kt=ve.layout.get("text-rotate").evaluate(xt,{})*Math.PI/180,qt=[];for(const Ut of Be.positionedLines)for(const Xt of Ut.positionedGlyphs){if(!Xt.rect)continue;const Rt=Xt.rect||{};let gi=4,Ei=!0,Si=1,mi=0;const Ji=(Fe||Mt)&&Xt.vertical,rn=Xt.metrics.advance*Xt.scale/2;if(Mt&&Be.verticalizable&&(mi=Ut.lineOffset/2-(Xt.imageName?-(Dn-Xt.metrics.width*Xt.scale)/2:(Xt.scale-1)*Dn)),Xt.imageName){const ra=Nt[Xt.imageName];Ei=ra.sdf,Si=ra.pixelRatio,gi=1/Si}const In=Fe?[Xt.x+rn,Xt.y]:[0,0];let On=Fe?[0,0]:[Xt.x+rn+re[0],Xt.y+re[1]-mi],kl=[0,0];Ji&&(kl=On,On=[0,0]);const Hs=Xt.metrics.isDoubleResolution?2:1,qn=(Xt.metrics.left-gi)*Xt.scale-rn+On[0],Mn=(-Xt.metrics.top-gi)*Xt.scale+On[1],_a=qn+Rt.w/Hs*Xt.scale/Si,ia=Mn+Rt.h/Hs*Xt.scale/Si,Fa=new Se(qn,Mn),Zs=new Se(_a,Mn),qs=new Se(qn,ia),Xn=new Se(_a,ia);if(Ji){const ra=new Se(-rn,rn- -17),Yn=-Math.PI/2,Wn=12-rn,dn=new Se(22-Wn,-(Xt.imageName?Wn:0)),Wo=new Se(...kl);Fa._rotateAround(Yn,ra)._add(dn)._add(Wo),Zs._rotateAround(Yn,ra)._add(dn)._add(Wo),qs._rotateAround(Yn,ra)._add(dn)._add(Wo),Xn._rotateAround(Yn,ra)._add(dn)._add(Wo)}if(kt){const ra=Math.sin(kt),Yn=Math.cos(kt),Wn=[Yn,-ra,ra,Yn];Fa._matMult(Wn),Zs._matMult(Wn),qs._matMult(Wn),Xn._matMult(Wn)}const Xs=new Se(0,0),jn=new Se(0,0);qt.push({tl:Fa,tr:Zs,bl:qs,br:Xn,tex:Rt,writingMode:Be.writingMode,glyphOffset:In,sectionIndex:Xt.sectionIndex,isSDF:Ei,pixelOffsetTL:Xs,pixelOffsetBR:jn,minFontScaleX:0,minFontScaleY:0})}return qt}(0,n,A,m,v,w,l,a.allowVerticalPlacement),we=a.textSizeData;let Pe=null;we.kind==="source"?(Pe=[bo*m.layout.get("text-size").evaluate(w,{})],Pe[0]>uc&&qr(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):we.kind==="composite"&&(Pe=[bo*ae.compositeTextSizes[0].evaluate(w,{},ue),bo*ae.compositeTextSizes[1].evaluate(w,{},ue)],(Pe[0]>uc||Pe[1]>uc)&&qr(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,fe,Pe,A,v,w,j,t,z.lineStartIndex,z.lineLength,ee,ue);for(const et of G)Y[et]=a.text.placedSymbolArray.length-1;return 4*fe.length}function $s(a){for(const t in a)return a[t];return null}function Yo(a,t,n,l){const m=a.compareText;if(t in m){const v=m[t];for(let w=v.length-1;w>=0;w--)if(l.dist(v[w])<n)return!0}else m[t]=[];return m[t].push(l),!1}const us=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Rn{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,l]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=l>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const v=us[15&l];if(!v)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(t,2,1),[A]=new Uint32Array(t,4,1);return new Rn(A,w,v,t)}constructor(t,n=64,l=Float64Array,m){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const v=us.indexOf(this.ArrayType),w=2*t*this.ArrayType.BYTES_PER_ELEMENT,A=t*this.IndexArrayType.BYTES_PER_ELEMENT,z=(8-A%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${l}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+z,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+w+A+z),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+A+z,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=n,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return xh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,l,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:w,nodeSize:A}=this,z=[0,v.length-1,0],j=[];for(;z.length;){const G=z.pop()||0,Y=z.pop()||0,ee=z.pop()||0;if(Y-ee<=A){for(let we=ee;we<=Y;we++){const Pe=w[2*we],et=w[2*we+1];Pe>=t&&Pe<=l&&et>=n&&et<=m&&j.push(v[we])}continue}const ae=ee+Y>>1,ue=w[2*ae],fe=w[2*ae+1];ue>=t&&ue<=l&&fe>=n&&fe<=m&&j.push(v[ae]),(G===0?t<=ue:n<=fe)&&(z.push(ee),z.push(ae-1),z.push(1-G)),(G===0?l>=ue:m>=fe)&&(z.push(ae+1),z.push(Y),z.push(1-G))}return j}within(t,n,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:v,nodeSize:w}=this,A=[0,m.length-1,0],z=[],j=l*l;for(;A.length;){const G=A.pop()||0,Y=A.pop()||0,ee=A.pop()||0;if(Y-ee<=w){for(let we=ee;we<=Y;we++)So(v[2*we],v[2*we+1],t,n)<=j&&z.push(m[we]);continue}const ae=ee+Y>>1,ue=v[2*ae],fe=v[2*ae+1];So(ue,fe,t,n)<=j&&z.push(m[ae]),(G===0?t-l<=ue:n-l<=fe)&&(A.push(ee),A.push(ae-1),A.push(1-G)),(G===0?t+l>=ue:n+l>=fe)&&(A.push(ae+1),A.push(Y),A.push(1-G))}return z}}function xh(a,t,n,l,m,v){if(m-l<=n)return;const w=l+m>>1;$c(a,t,w,l,m,v),xh(a,t,n,l,w-1,1-v),xh(a,t,n,w+1,m,1-v)}function $c(a,t,n,l,m,v){for(;m>l;){if(m-l>600){const j=m-l+1,G=n-l+1,Y=Math.log(j),ee=.5*Math.exp(2*Y/3),ae=.5*Math.sqrt(Y*ee*(j-ee)/j)*(G-j/2<0?-1:1);$c(a,t,n,Math.max(l,Math.floor(n-G*ee/j+ae)),Math.min(m,Math.floor(n+(j-G)*ee/j+ae)),v)}const w=t[2*n+v];let A=l,z=m;for(El(a,t,l,n),t[2*m+v]>w&&El(a,t,l,m);A<z;){for(El(a,t,A,z),A++,z--;t[2*A+v]<w;)A++;for(;t[2*z+v]>w;)z--}t[2*l+v]===w?El(a,t,l,z):(z++,El(a,t,z,m)),z<=n&&(l=z+1),n<=z&&(m=z-1)}}function El(a,t,n,l){vh(a,n,l),vh(t,2*n,2*l),vh(t,2*n+1,2*l+1)}function vh(a,t,n){const l=a[t];a[t]=a[n],a[n]=l}function So(a,t,n,l){const m=a-n,v=t-l;return m*m+v*v}var To;B.cw=void 0,(To=B.cw||(B.cw={})).create="create",To.load="load",To.fullLoad="fullLoad";let Hc=null,Yp=[];const gm=1e3/60,hd="loadTime",sp="fullLoadTime",Rm={mark(a){performance.mark(a)},frame(a){const t=a;Hc!=null&&Yp.push(t-Hc),Hc=t},clearMetrics(){Hc=null,Yp=[],performance.clearMeasures(hd),performance.clearMeasures(sp);for(const a in B.cw)performance.clearMarks(B.cw[a])},getPerformanceMetrics(){performance.measure(hd,B.cw.create,B.cw.load),performance.measure(sp,B.cw.create,B.cw.fullLoad);const a=performance.getEntriesByName(hd)[0].duration,t=performance.getEntriesByName(sp)[0].duration,n=Yp.length,l=1/(Yp.reduce((v,w)=>v+w,0)/n/1e3),m=Yp.filter(v=>v>gm).reduce((v,w)=>v+(w-gm)/gm,0);return{loadTime:a,fullLoadTime:t,fps:l,percentDroppedFrames:m/(n+m)*100,totalFrames:n}}};B.$=Ht,B.A=pt,B.B=function([a,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:a*Math.cos(t)*Math.sin(n),y:a*Math.sin(t)*Math.sin(n),z:a*Math.cos(n)}},B.C=ts,B.D=ui,B.E=jt,B.F=Xr,B.G=th,B.H=function(a){if(Ao==null){const t=a.navigator?a.navigator.userAgent:null;Ao=!!a.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ao},B.I=Gp,B.J=class{constructor(a,t){this.target=a,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new ap(()=>this.process()),this.subscription=Ha(this.target,"message",n=>this.receive(n),!1),this.globalScope=va(self)?a:window}registerMessageHandler(a,t){this.messageHandlers[a]=t}sendAsync(a,t){return new Promise((n,l)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10),v=t?Ha(t.signal,"abort",()=>{v==null||v.unsubscribe(),delete this.resolveRejects[m];const z={id:m,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(z)},R):null;this.resolveRejects[m]={resolve:z=>{v==null||v.unsubscribe(),n(z)},reject:z=>{v==null||v.unsubscribe(),l(z)}};const w=[],A=Object.assign(Object.assign({},a),{id:m,sourceMapId:this.mapId,origin:location.origin,data:du(a.data,w)});this.target.postMessage(A,{transfer:w})})}receive(a){const t=a.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const l=this.abortControllers[n];return delete this.abortControllers[n],void(l&&l.abort())}if(va(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),t=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(a,t)}processTask(a,t){return h(this,void 0,void 0,function*(){if(t.type==="<response>"){const m=this.resolveRejects[a];return delete this.resolveRejects[a],m?void(t.error?m.reject(bs(t.error)):m.resolve(bs(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=bs(t.data),l=new AbortController;this.abortControllers[a]=l;try{const m=yield this.messageHandlers[t.type](t.sourceMapId,n,l);this.completeTask(a,null,m)}catch(m){this.completeTask(a,m)}})}completeTask(a,t,n){const l=[];delete this.abortControllers[a];const m={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?du(t):null,data:du(n,l)};this.target.postMessage(m,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},B.K=Me,B.L=function(){var a=new pt(16);return pt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},B.M=function(a,t,n){var l,m,v,w,A,z,j,G,Y,ee,ae,ue,fe=n[0],we=n[1],Pe=n[2];return t===a?(a[12]=t[0]*fe+t[4]*we+t[8]*Pe+t[12],a[13]=t[1]*fe+t[5]*we+t[9]*Pe+t[13],a[14]=t[2]*fe+t[6]*we+t[10]*Pe+t[14],a[15]=t[3]*fe+t[7]*we+t[11]*Pe+t[15]):(m=t[1],v=t[2],w=t[3],A=t[4],z=t[5],j=t[6],G=t[7],Y=t[8],ee=t[9],ae=t[10],ue=t[11],a[0]=l=t[0],a[1]=m,a[2]=v,a[3]=w,a[4]=A,a[5]=z,a[6]=j,a[7]=G,a[8]=Y,a[9]=ee,a[10]=ae,a[11]=ue,a[12]=l*fe+A*we+Y*Pe+t[12],a[13]=m*fe+z*we+ee*Pe+t[13],a[14]=v*fe+j*we+ae*Pe+t[14],a[15]=w*fe+G*we+ue*Pe+t[15]),a},B.N=function(a,t,n){var l=n[0],m=n[1],v=n[2];return a[0]=t[0]*l,a[1]=t[1]*l,a[2]=t[2]*l,a[3]=t[3]*l,a[4]=t[4]*m,a[5]=t[5]*m,a[6]=t[6]*m,a[7]=t[7]*m,a[8]=t[8]*v,a[9]=t[9]*v,a[10]=t[10]*v,a[11]=t[11]*v,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},B.O=function(a,t,n){var l=t[0],m=t[1],v=t[2],w=t[3],A=t[4],z=t[5],j=t[6],G=t[7],Y=t[8],ee=t[9],ae=t[10],ue=t[11],fe=t[12],we=t[13],Pe=t[14],et=t[15],Be=n[0],re=n[1],ve=n[2],Fe=n[3];return a[0]=Be*l+re*A+ve*Y+Fe*fe,a[1]=Be*m+re*z+ve*ee+Fe*we,a[2]=Be*v+re*j+ve*ae+Fe*Pe,a[3]=Be*w+re*G+ve*ue+Fe*et,a[4]=(Be=n[4])*l+(re=n[5])*A+(ve=n[6])*Y+(Fe=n[7])*fe,a[5]=Be*m+re*z+ve*ee+Fe*we,a[6]=Be*v+re*j+ve*ae+Fe*Pe,a[7]=Be*w+re*G+ve*ue+Fe*et,a[8]=(Be=n[8])*l+(re=n[9])*A+(ve=n[10])*Y+(Fe=n[11])*fe,a[9]=Be*m+re*z+ve*ee+Fe*we,a[10]=Be*v+re*j+ve*ae+Fe*Pe,a[11]=Be*w+re*G+ve*ue+Fe*et,a[12]=(Be=n[12])*l+(re=n[13])*A+(ve=n[14])*Y+(Fe=n[15])*fe,a[13]=Be*m+re*z+ve*ee+Fe*we,a[14]=Be*v+re*j+ve*ae+Fe*Pe,a[15]=Be*w+re*G+ve*ue+Fe*et,a},B.P=Se,B.Q=function(a,t){const n={};for(let l=0;l<t.length;l++){const m=t[l];m in a&&(n[m]=a[m])}return n},B.R=Tn,B.S=u,B.T=vu,B.U=T,B.V=b,B.W=We,B.X=ct,B.Y=zl,B.Z=Q,B._=h,B.a=de,B.a$=function(a,t,n){return a[0]=t[0]*n,a[1]=t[1]*n,a[2]=t[2]*n,a[3]=t[3]*n,a},B.a0=N,B.a1=ne,B.a2=25,B.a3=U,B.a4=a=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const l of a){const m=window.document.createElement("source");yt(l)||(t.crossOrigin="Anonymous"),m.src=l,t.appendChild(m)}})},B.a5=Wt,B.a6=function(){return hc++},B.a7=Ae,B.a8=Pu,B.a9=xn,B.aA=Dn,B.aB=ii,B.aC=function(a,t,n,l,m=!1){if(!n[0]&&!n[1])return[0,0];const v=m?l==="map"?-a.bearingInRadians:0:l==="viewport"?a.bearingInRadians:0;if(v){const w=Math.sin(v),A=Math.cos(v);n=[n[0]*A-n[1]*w,n[0]*w+n[1]*A]}return[m?n[0]:ii(t,n[0],a.zoom),m?n[1]:ii(t,n[1],a.zoom)]},B.aE=wo,B.aF=Hr,B.aG=Qr,B.aH=Rn,B.aI=er,B.aJ=Gd,B.aK=ot,B.aL=hr,B.aM=cr,B.aN=Pl,B.aO=sa,B.aP=D,B.aQ=Yt,B.aR=ri,B.aS=function(a){var t=new pt(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},B.aT=function(a,t,n){return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],a},B.aU=function(a,t){var n=t[0],l=t[1],m=t[2],v=n*n+l*l+m*m;return v>0&&(v=1/Math.sqrt(v)),a[0]=t[0]*v,a[1]=t[1]*v,a[2]=t[2]*v,a},B.aV=yi,B.aW=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]},B.aX=function(a,t,n){return a[0]=t[0]*n[0],a[1]=t[1]*n[1],a[2]=t[2]*n[2],a[3]=t[3]*n[3],a},B.aY=_t,B.aZ=function(a,t,n){const l=t[0]*n[0]+t[1]*n[1]+t[2]*n[2];return l===0?null:(-(a[0]*n[0]+a[1]*n[1]+a[2]*n[2])-n[3])/l},B.a_=gt,B.aa=Jl,B.ab=me,B.ac=function(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,l,m,v)=>{const w=m||v;return t[l]=!w||w.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},B.ad=en,B.ae=function(a){return Math.pow(2,a)},B.af=Ue,B.ag=Cr,B.ah=85.051129,B.ai=C,B.aj=function(a){return Math.log(a)/Math.LN2},B.ak=function(a){var t=a[0],n=a[1];return t*t+n*n},B.al=function(a,t){const n=[];for(const l in a)l in t||n.push(l);return n},B.am=function(a,t){let n=0,l=0;if(a.kind==="constant")l=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:m,minZoom:v,maxZoom:w}=a,A=m?Cr(kn.interpolationFactor(m,t,v,w),0,1):0;a.kind==="camera"?l=ts.number(a.minSize,a.maxSize,A):n=A}return{uSizeT:n,uSize:l}},B.ao=function(a,{uSize:t,uSizeT:n},{lowerSize:l,upperSize:m}){return a.kind==="source"?l/bo:a.kind==="composite"?ts.number(l/bo,m/bo,n):t},B.ap=function(a,t){var n=t[0],l=t[1],m=t[2],v=t[3],w=t[4],A=t[5],z=t[6],j=t[7],G=t[8],Y=t[9],ee=t[10],ae=t[11],ue=t[12],fe=t[13],we=t[14],Pe=t[15],et=n*A-l*w,Be=n*z-m*w,re=n*j-v*w,ve=l*z-m*A,Fe=l*j-v*A,xt=m*j-v*z,Nt=G*fe-Y*ue,Mt=G*we-ee*ue,kt=G*Pe-ae*ue,qt=Y*we-ee*fe,Ut=Y*Pe-ae*fe,Xt=ee*Pe-ae*we,Rt=et*Xt-Be*Ut+re*qt+ve*kt-Fe*Mt+xt*Nt;return Rt?(a[0]=(A*Xt-z*Ut+j*qt)*(Rt=1/Rt),a[1]=(m*Ut-l*Xt-v*qt)*Rt,a[2]=(fe*xt-we*Fe+Pe*ve)*Rt,a[3]=(ee*Fe-Y*xt-ae*ve)*Rt,a[4]=(z*kt-w*Xt-j*Mt)*Rt,a[5]=(n*Xt-m*kt+v*Mt)*Rt,a[6]=(we*re-ue*xt-Pe*Be)*Rt,a[7]=(G*xt-ee*re+ae*Be)*Rt,a[8]=(w*Ut-A*kt+j*Nt)*Rt,a[9]=(l*kt-n*Ut-v*Nt)*Rt,a[10]=(ue*Fe-fe*re+Pe*et)*Rt,a[11]=(Y*re-G*Fe-ae*et)*Rt,a[12]=(A*Mt-w*qt-z*Nt)*Rt,a[13]=(n*qt-l*Mt+m*Nt)*Rt,a[14]=(fe*Be-ue*ve-we*et)*Rt,a[15]=(G*ve-Y*Be+ee*et)*Rt,a):null},B.aq=qe,B.ar=function(a){return Math.hypot(a[0],a[1])},B.as=function(a){return a[0]=0,a[1]=0,a},B.at=function(a,t,n){return a[0]=t[0]*n,a[1]=t[1]*n,a},B.au=cd,B.av=It,B.aw=function(a,t,n,l){const m=t.y-a.y,v=t.x-a.x,w=l.y-n.y,A=l.x-n.x,z=w*v-A*m;if(z===0)return null;const j=(A*(a.y-n.y)-w*(a.x-n.x))/z;return new Se(a.x+j*v,a.y+j*m)},B.ax=Ze,B.ay=ec,B.az=function(a){let t=1/0,n=1/0,l=-1/0,m=-1/0;for(const v of a)t=Math.min(t,v.x),n=Math.min(n,v.y),l=Math.max(l,v.x),m=Math.max(m,v.y);return[t,n,l,m]},B.b=$a,B.b$=Fp,B.b0=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]},B.b1=X,B.b2=le,B.b3=function(a,t,n,l,m){var v,w=1/Math.tan(t/2);return a[0]=w/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=w,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,m!=null&&m!==1/0?(a[10]=(m+l)*(v=1/(l-m)),a[14]=2*m*l*v):(a[10]=-1,a[14]=-2*l),a},B.b4=function(a){var t=new pt(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},B.b5=function(a,t,n){var l=Math.sin(n),m=Math.cos(n),v=t[0],w=t[1],A=t[2],z=t[3],j=t[4],G=t[5],Y=t[6],ee=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=v*m+j*l,a[1]=w*m+G*l,a[2]=A*m+Y*l,a[3]=z*m+ee*l,a[4]=j*m-v*l,a[5]=G*m-w*l,a[6]=Y*m-A*l,a[7]=ee*m-z*l,a},B.b6=function(a,t,n){var l=Math.sin(n),m=Math.cos(n),v=t[4],w=t[5],A=t[6],z=t[7],j=t[8],G=t[9],Y=t[10],ee=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=v*m+j*l,a[5]=w*m+G*l,a[6]=A*m+Y*l,a[7]=z*m+ee*l,a[8]=j*m-v*l,a[9]=G*m-w*l,a[10]=Y*m-A*l,a[11]=ee*m-z*l,a},B.b7=function(){const a=new Float32Array(16);return Ue(a),a},B.b8=function(){const a=new Float64Array(16);return Ue(a),a},B.b9=function(){return new Float64Array(16)},B.bA=function(a){return a[0]=0,a[1]=0,a[2]=0,a},B.bB=function(a,t,n,l){const m=Math.sqrt(a*a+t*t),v=Math.sqrt(n*n+l*l);a/=m,t/=m,n/=v,l/=v;const w=Math.acos(a*n+t*l);return-t*n+a*l>0?w:-w},B.bC=function(a,t){const n=di(a,2*Math.PI),l=di(t,2*Math.PI);return Math.min(Math.abs(n-l),Math.abs(n-l+2*Math.PI),Math.abs(n-l-2*Math.PI))},B.bD=function(){const a={},t=He.$version;for(const n in He.$root){const l=He.$root[n];if(l.required){let m=null;m=n==="version"?t:l.type==="array"?[]:{},m!=null&&(a[n]=m)}}return a},B.bE=nh,B.bF=Qe,B.bG=function a(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let l=0;l<t.length;l++)if(!a(t[l],n[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const l in t)if(!a(t[l],n[l]))return!1;return!0}return t===n},B.bH=function(a){a=a.slice();const t=Object.create(null);for(let n=0;n<a.length;n++)t[a[n].id]=a[n];for(let n=0;n<a.length;n++)"ref"in a[n]&&(a[n]=Pi(a[n],t[a[n].ref]));return a},B.bI=function(a){if(a.type==="custom")return new Af(a);switch(a.type){case"background":return new rp(a);case"circle":return new Mp(a);case"color-relief":return new Pp(a);case"fill":return new sc(a);case"fill-extrusion":return new qo(a);case"heatmap":return new Ap(a);case"hillshade":return new ic(a);case"line":return new gf(a);case"raster":return new br(a);case"symbol":return new ud(a)}},B.bJ=Va,B.bK=function(a,t){if(!a)return[{command:"setStyle",args:[t]}];let n=[];try{if(!ci(a.version,t.version))return[{command:"setStyle",args:[t]}];ci(a.center,t.center)||n.push({command:"setCenter",args:[t.center]}),ci(a.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),ci(a.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),ci(a.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),ci(a.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),ci(a.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),ci(a.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),ci(a.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),ci(a.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),ci(a.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),ci(a.light,t.light)||n.push({command:"setLight",args:[t.light]}),ci(a.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),ci(a.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),ci(a.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const l={},m=[];(function(w,A,z,j){let G;for(G in A=A||{},w=w||{})Object.prototype.hasOwnProperty.call(w,G)&&(Object.prototype.hasOwnProperty.call(A,G)||tr(G,z,j));for(G in A)Object.prototype.hasOwnProperty.call(A,G)&&(Object.prototype.hasOwnProperty.call(w,G)?ci(w[G],A[G])||(w[G].type==="geojson"&&A[G].type==="geojson"&&ur(w,A,G)?ai(z,{command:"setGeoJSONSourceData",args:[G,A[G].data]}):Wi(G,A,z,j)):Ai(G,A,z))})(a.sources,t.sources,m,l);const v=[];a.layers&&a.layers.forEach(w=>{"source"in w&&l[w.source]?n.push({command:"removeLayer",args:[w.id]}):v.push(w)}),n=n.concat(m),function(w,A,z){A=A||[];const j=(w=w||[]).map(fr),G=A.map(fr),Y=w.reduce(Kn,{}),ee=A.reduce(Kn,{}),ae=j.slice(),ue=Object.create(null);let fe,we,Pe,et,Be;for(let re=0,ve=0;re<j.length;re++)fe=j[re],Object.prototype.hasOwnProperty.call(ee,fe)?ve++:(ai(z,{command:"removeLayer",args:[fe]}),ae.splice(ae.indexOf(fe,ve),1));for(let re=0,ve=0;re<G.length;re++)fe=G[G.length-1-re],ae[ae.length-1-re]!==fe&&(Object.prototype.hasOwnProperty.call(Y,fe)?(ai(z,{command:"removeLayer",args:[fe]}),ae.splice(ae.lastIndexOf(fe,ae.length-ve),1)):ve++,et=ae[ae.length-re],ai(z,{command:"addLayer",args:[ee[fe],et]}),ae.splice(ae.length-re,0,fe),ue[fe]=!0);for(let re=0;re<G.length;re++)if(fe=G[re],we=Y[fe],Pe=ee[fe],!ue[fe]&&!ci(we,Pe))if(ci(we.source,Pe.source)&&ci(we["source-layer"],Pe["source-layer"])&&ci(we.type,Pe.type)){for(Be in bi(we.layout,Pe.layout,z,fe,null,"setLayoutProperty"),bi(we.paint,Pe.paint,z,fe,null,"setPaintProperty"),ci(we.filter,Pe.filter)||ai(z,{command:"setFilter",args:[fe,Pe.filter]}),ci(we.minzoom,Pe.minzoom)&&ci(we.maxzoom,Pe.maxzoom)||ai(z,{command:"setLayerZoomRange",args:[fe,Pe.minzoom,Pe.maxzoom]}),we)Object.prototype.hasOwnProperty.call(we,Be)&&Be!=="layout"&&Be!=="paint"&&Be!=="filter"&&Be!=="metadata"&&Be!=="minzoom"&&Be!=="maxzoom"&&(Be.indexOf("paint.")===0?bi(we[Be],Pe[Be],z,fe,Be.slice(6),"setPaintProperty"):ci(we[Be],Pe[Be])||ai(z,{command:"setLayerProperty",args:[fe,Be,Pe[Be]]}));for(Be in Pe)Object.prototype.hasOwnProperty.call(Pe,Be)&&!Object.prototype.hasOwnProperty.call(we,Be)&&Be!=="layout"&&Be!=="paint"&&Be!=="filter"&&Be!=="metadata"&&Be!=="minzoom"&&Be!=="maxzoom"&&(Be.indexOf("paint.")===0?bi(we[Be],Pe[Be],z,fe,Be.slice(6),"setPaintProperty"):ci(we[Be],Pe[Be])||ai(z,{command:"setLayerProperty",args:[fe,Be,Pe[Be]]}))}else ai(z,{command:"removeLayer",args:[fe]}),et=ae[ae.lastIndexOf(fe)+1],ai(z,{command:"addLayer",args:[Pe,et]})}(v,t.layers,n)}catch(l){console.warn("Unable to compute style diff:",l),n=[{command:"setStyle",args:[t]}]}return n},B.bL=function(a){const t=[],n=a.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},B.bM=li,B.bN=Ms,B.bO=class extends Br{constructor(a,t){super(a,t),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},B.bP=lh,B.bQ=class extends Br{constructor(a,t){super(a,t),this.current=Vh}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let t=1;t<16;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},B.bR=gn,B.bS=class extends Br{constructor(a,t){super(a,t),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},B.bT=class extends Br{constructor(a,t){super(a,t),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},B.bU=Pt,B.bV=function(a,t){var n=Math.sin(t),l=Math.cos(t);return a[0]=l,a[1]=n,a[2]=0,a[3]=-n,a[4]=l,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},B.bW=function(a,t,n){var l=t[0],m=t[1],v=t[2];return a[0]=l*n[0]+m*n[3]+v*n[6],a[1]=l*n[1]+m*n[4]+v*n[7],a[2]=l*n[2]+m*n[5]+v*n[8],a},B.bX=function(a,t,n,l,m,v,w){var A=1/(t-n),z=1/(l-m),j=1/(v-w);return a[0]=-2*A,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*z,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(t+n)*A,a[13]=(m+l)*z,a[14]=(w+v)*j,a[15]=1,a},B.bY=class extends Br{constructor(a,t){super(a,t),this.current=new Array}set(a){if(a!=this.current){this.current=a;const t=new Float32Array(4*a.length);for(let n=0;n<a.length;n++)t[4*n]=a[n].r,t[4*n+1]=a[n].g,t[4*n+2]=a[n].b,t[4*n+3]=a[n].a;this.gl.uniform4fv(this.location,t)}}},B.bZ=class extends Br{constructor(a,t){super(a,t),this.current=new Array}set(a){if(a!=this.current){this.current=a;const t=new Float32Array(a);this.gl.uniform1fv(this.location,t)}}},B.b_=class extends c{},B.ba=function(a,t,n){const l=new Float64Array(4);return ki(l,a,t-90,n),l},B.bb=function(a,t,n,l){var m,v,w,A,z,j=t[0],G=t[1],Y=t[2],ee=t[3],ae=n[0],ue=n[1],fe=n[2],we=n[3];return(v=j*ae+G*ue+Y*fe+ee*we)<0&&(v=-v,ae=-ae,ue=-ue,fe=-fe,we=-we),1-v>Ke?(m=Math.acos(v),w=Math.sin(m),A=Math.sin((1-l)*m)/w,z=Math.sin(l*m)/w):(A=1-l,z=l),a[0]=A*j+z*ae,a[1]=A*G+z*ue,a[2]=A*Y+z*fe,a[3]=A*ee+z*we,a},B.bc=function(a){const t=new Float64Array(9);var n,l,m,v,w,A,z,j,G,Y,ee,ae,ue,fe,we,Pe,et,Be;Y=(m=(l=a)[0])*(z=m+m),ee=(v=l[1])*z,ue=(w=l[2])*z,fe=w*(j=v+v),Pe=(A=l[3])*z,et=A*j,Be=A*(G=w+w),(n=t)[0]=1-(ae=v*j)-(we=w*G),n[3]=ee-Be,n[6]=ue+et,n[1]=ee+Be,n[4]=1-Y-we,n[7]=fe-Pe,n[2]=ue-et,n[5]=fe+Pe,n[8]=1-Y-ae;const re=sa(-Math.asin(Cr(t[2],-1,1)));let ve,Fe;return Math.hypot(t[5],t[8])<.001?(ve=0,Fe=-sa(Math.atan2(t[3],t[4]))):(ve=sa(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),Fe=sa(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:ve,pitch:re+90,bearing:Fe}},B.bd=function(a,t){return a.roll==t.roll&&a.pitch==t.pitch&&a.bearing==t.bearing},B.be=Ui,B.bf=ea,B.bg=Qh,B.bh=fh,B.bi=jc,B.bj=Qi,B.bk=Ri,B.bl=Oi,B.bm=function(a,t,n,l,m){return Qi(l,m,Cr((a-t)/(n-t),0,1))},B.bn=di,B.bo=function(){return new Float64Array(3)},B.bp=function(a,t,n,l){return a[0]=t[0]+n[0]*l,a[1]=t[1]+n[1]*l,a[2]=t[2]+n[2]*l,a},B.bq=ki,B.br=function(a,t,n){var l=n[0],m=n[1],v=n[2],w=t[0],A=t[1],z=t[2],j=m*z-v*A,G=v*w-l*z,Y=l*A-m*w,ee=m*Y-v*G,ae=v*j-l*Y,ue=l*G-m*j,fe=2*n[3];return G*=fe,Y*=fe,ae*=2,ue*=2,a[0]=w+(j*=fe)+(ee*=2),a[1]=A+G+ae,a[2]=z+Y+ue,a},B.bs=function(a,t,n){const l=(m=[a[0],a[1],a[2],t[0],t[1],t[2],n[0],n[1],n[2]])[0]*((G=m[8])*(w=m[4])-(A=m[5])*(j=m[7]))+m[1]*(-G*(v=m[3])+A*(z=m[6]))+m[2]*(j*v-w*z);var m,v,w,A,z,j,G;if(l===0)return null;const Y=yi([],[t[0],t[1],t[2]],[n[0],n[1],n[2]]),ee=yi([],[n[0],n[1],n[2]],[a[0],a[1],a[2]]),ae=yi([],[a[0],a[1],a[2]],[t[0],t[1],t[2]]),ue=Yt([],Y,-a[3]);return ri(ue,ue,Yt([],ee,-t[3])),ri(ue,ue,Yt([],ae,-n[3])),Yt(ue,ue,1/l),ue},B.bt=s,B.bu=function(){return new Float64Array(4)},B.bv=function(a,t,n,l){var m=[],v=[];return m[0]=t[0]-n[0],m[1]=t[1]-n[1],m[2]=t[2]-n[2],v[0]=m[0]*Math.cos(l)-m[1]*Math.sin(l),v[1]=m[0]*Math.sin(l)+m[1]*Math.cos(l),v[2]=m[2],a[0]=v[0]+n[0],a[1]=v[1]+n[1],a[2]=v[2]+n[2],a},B.bw=function(a,t,n,l){var m=[],v=[];return m[0]=t[0]-n[0],m[1]=t[1]-n[1],m[2]=t[2]-n[2],v[0]=m[0],v[1]=m[1]*Math.cos(l)-m[2]*Math.sin(l),v[2]=m[1]*Math.sin(l)+m[2]*Math.cos(l),a[0]=v[0]+n[0],a[1]=v[1]+n[1],a[2]=v[2]+n[2],a},B.bx=function(a,t,n,l){var m=[],v=[];return m[0]=t[0]-n[0],m[1]=t[1]-n[1],m[2]=t[2]-n[2],v[0]=m[2]*Math.sin(l)+m[0]*Math.cos(l),v[1]=m[1],v[2]=m[2]*Math.cos(l)-m[0]*Math.sin(l),a[0]=v[0]+n[0],a[1]=v[1]+n[1],a[2]=v[2]+n[2],a},B.by=function(a,t,n){var l=Math.sin(n),m=Math.cos(n),v=t[0],w=t[1],A=t[2],z=t[3],j=t[8],G=t[9],Y=t[10],ee=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=v*m-j*l,a[1]=w*m-G*l,a[2]=A*m-Y*l,a[3]=z*m-ee*l,a[8]=v*l+j*m,a[9]=w*l+G*m,a[10]=A*l+Y*m,a[11]=z*l+ee*m,a},B.bz=function(a,t){const n=di(a,360),l=di(t,360),m=l-n,v=l>n?m-360:m+360;return Math.abs(m)<Math.abs(v)?m:v},B.c=lt,B.c0=class extends _{},B.c1=hh,B.c2=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},B.c3=xu,B.c4=function(a,t,n){var l=t[0],m=t[1],v=t[2],w=n[3]*l+n[7]*m+n[11]*v+n[15];return a[0]=(n[0]*l+n[4]*m+n[8]*v+n[12])/(w=w||1),a[1]=(n[1]*l+n[5]*m+n[9]*v+n[13])/w,a[2]=(n[2]*l+n[6]*m+n[10]*v+n[14])/w,a},B.c5=class extends bl{},B.c6=class extends W{},B.c7=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]&&a[9]===t[9]&&a[10]===t[10]&&a[11]===t[11]&&a[12]===t[12]&&a[13]===t[13]&&a[14]===t[14]&&a[15]===t[15]},B.c8=function(a,t){var n=a[0],l=a[1],m=a[2],v=a[3],w=a[4],A=a[5],z=a[6],j=a[7],G=a[8],Y=a[9],ee=a[10],ae=a[11],ue=a[12],fe=a[13],we=a[14],Pe=a[15],et=t[0],Be=t[1],re=t[2],ve=t[3],Fe=t[4],xt=t[5],Nt=t[6],Mt=t[7],kt=t[8],qt=t[9],Ut=t[10],Xt=t[11],Rt=t[12],gi=t[13],Ei=t[14],Si=t[15];return Math.abs(n-et)<=Ke*Math.max(1,Math.abs(n),Math.abs(et))&&Math.abs(l-Be)<=Ke*Math.max(1,Math.abs(l),Math.abs(Be))&&Math.abs(m-re)<=Ke*Math.max(1,Math.abs(m),Math.abs(re))&&Math.abs(v-ve)<=Ke*Math.max(1,Math.abs(v),Math.abs(ve))&&Math.abs(w-Fe)<=Ke*Math.max(1,Math.abs(w),Math.abs(Fe))&&Math.abs(A-xt)<=Ke*Math.max(1,Math.abs(A),Math.abs(xt))&&Math.abs(z-Nt)<=Ke*Math.max(1,Math.abs(z),Math.abs(Nt))&&Math.abs(j-Mt)<=Ke*Math.max(1,Math.abs(j),Math.abs(Mt))&&Math.abs(G-kt)<=Ke*Math.max(1,Math.abs(G),Math.abs(kt))&&Math.abs(Y-qt)<=Ke*Math.max(1,Math.abs(Y),Math.abs(qt))&&Math.abs(ee-Ut)<=Ke*Math.max(1,Math.abs(ee),Math.abs(Ut))&&Math.abs(ae-Xt)<=Ke*Math.max(1,Math.abs(ae),Math.abs(Xt))&&Math.abs(ue-Rt)<=Ke*Math.max(1,Math.abs(ue),Math.abs(Rt))&&Math.abs(fe-gi)<=Ke*Math.max(1,Math.abs(fe),Math.abs(gi))&&Math.abs(we-Ei)<=Ke*Math.max(1,Math.abs(we),Math.abs(Ei))&&Math.abs(Pe-Si)<=Ke*Math.max(1,Math.abs(Pe),Math.abs(Si))},B.c9=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},B.cA=function(a){delete de.REGISTERED_PROTOCOLS[a]},B.cB=function(a,t){const n={};for(let m=0;m<a.length;m++){const v=t&&t[a[m].id]||fl(a[m]);t&&(t[a[m].id]=v);let w=n[v];w||(w=n[v]=[]),w.push(a[m])}const l=[];for(const m in n)l.push(n[m]);return l},B.cC=si,B.cD=ie,B.cE=_e,B.cF=Yd,B.cG=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Ht/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const t=a.bucket.layers[0],n=t.layout,l=t._unevaluatedLayout._values,m={layoutIconSize:l["icon-size"].possiblyEvaluate(new Xr(a.bucket.zoom+1),a.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Xr(a.bucket.zoom+1),a.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Xr(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:j,maxZoom:G}=a.bucket.textSizeData;m.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Xr(j),a.canonical),l["text-size"].possiblyEvaluate(new Xr(G),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:j,maxZoom:G}=a.bucket.iconSizeData;m.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Xr(j),a.canonical),l["icon-size"].possiblyEvaluate(new Xr(G),a.canonical)]}const v=n.get("text-line-height")*Dn,w=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",A=n.get("text-keep-upright"),z=n.get("text-size");for(const j of a.bucket.features){const G=n.get("text-font").evaluate(j,{},a.canonical).join(","),Y=z.evaluate(j,{},a.canonical),ee=m.layoutTextSize.evaluate(j,{},a.canonical),ae=m.layoutIconSize.evaluate(j,{},a.canonical),ue={horizontal:{},vertical:void 0},fe=j.text;let we,Pe=[0,0];if(fe){const re=fe.toString(),ve=n.get("text-letter-spacing").evaluate(j,{},a.canonical)*Dn,Fe=xl(re)?ve:0,xt=n.get("text-anchor").evaluate(j,{},a.canonical),Nt=pr(t,j,a.canonical);if(!Nt){const Ut=n.get("text-radial-offset").evaluate(j,{},a.canonical);Pe=Ut?hn(xt,[Ut*Dn,zi]):n.get("text-offset").evaluate(j,{},a.canonical).map(Xt=>Xt*Dn)}let Mt=w?"center":n.get("text-justify").evaluate(j,{},a.canonical);const kt=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(j,{},a.canonical)*Dn:1/0,qt=()=>{a.bucket.allowVerticalPlacement&&Uo(re)&&(ue.vertical=_h(fe,a.glyphMap,a.glyphPositions,a.imagePositions,G,kt,v,xt,"left",Fe,Pe,B.an.vertical,!0,ee,Y))};if(!w&&Nt){const Ut=new Set;if(Mt==="auto")for(let Rt=0;Rt<Nt.values.length;Rt+=2)Ut.add(Hr(Nt.values[Rt]));else Ut.add(Mt);let Xt=!1;for(const Rt of Ut)if(!ue.horizontal[Rt])if(Xt)ue.horizontal[Rt]=ue.horizontal[0];else{const gi=_h(fe,a.glyphMap,a.glyphPositions,a.imagePositions,G,kt,v,"center",Rt,Fe,Pe,B.an.horizontal,!1,ee,Y);gi&&(ue.horizontal[Rt]=gi,Xt=gi.positionedLines.length===1)}qt()}else{Mt==="auto"&&(Mt=Hr(xt));const Ut=_h(fe,a.glyphMap,a.glyphPositions,a.imagePositions,G,kt,v,xt,Mt,Fe,Pe,B.an.horizontal,!1,ee,Y);Ut&&(ue.horizontal[Mt]=Ut),qt(),Uo(re)&&w&&A&&(ue.vertical=_h(fe,a.glyphMap,a.glyphPositions,a.imagePositions,G,kt,v,xt,Mt,Fe,Pe,B.an.vertical,!1,ee,Y))}}let et=!1;if(j.icon&&j.icon.name){const re=a.imageMap[j.icon.name];re&&(we=Hp(a.imagePositions[j.icon.name],n.get("icon-offset").evaluate(j,{},a.canonical),n.get("icon-anchor").evaluate(j,{},a.canonical)),et=!!re.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=et:a.bucket.sdfIcons!==et&&qr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(re.pixelRatio!==a.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const Be=$s(ue.horizontal)||ue.vertical;a.bucket.iconsInText=!!Be&&Be.iconsInText,(Be||we)&&ta(a.bucket,j,ue,we,a.imageMap,m,ee,ae,Pe,et,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},B.cH=nd,B.cI=ac,B.cJ=Zn,B.cK=Pr,B.cL=Xd,B.cM=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},B.cN=function(a,t,n,l,m){return h(this,void 0,void 0,function*(){if(ct())try{return yield zl(a,t,n,l,m)}catch{}return function(v,w,A,z,j){const G=v.width,Y=v.height;ba&&pc||(ba=new OffscreenCanvas(G,Y),pc=ba.getContext("2d",{willReadFrequently:!0})),ba.width=G,ba.height=Y,pc.drawImage(v,0,0,G,Y);const ee=pc.getImageData(w,A,z,j);return pc.clearRect(0,0,G,Y),ee.data}(a,t,n,l,m)})},B.cO=rc,B.cP=oe,B.cQ=Ve,B.cR=$r,B.cS=_f,B.cT=ka,B.cU=mo,B.ca=a=>a.type==="symbol",B.cb=a=>a.type==="circle",B.cc=a=>a.type==="heatmap",B.cd=a=>a.type==="line",B.ce=a=>a.type==="fill",B.cf=a=>a.type==="fill-extrusion",B.cg=a=>a.type==="hillshade",B.ch=a=>a.type==="color-relief",B.ci=a=>a.type==="raster",B.cj=a=>a.type==="background",B.ck=a=>a.type==="custom",B.cl=_n,B.cm=function(a,t,n){const l=Ot(t.x-n.x,t.y-n.y),m=Ot(a.x-n.x,a.y-n.y);var v,w;return sa(Math.atan2(l[0]*m[1]-l[1]*m[0],(v=l)[0]*(w=m)[0]+v[1]*w[1]))},B.cn=Zr,B.co=function(a,t){return Mh[t]&&(a instanceof MouseEvent||a instanceof WheelEvent)},B.cp=function(a,t){return oa[t]&&"touches"in a},B.cq=function(a){return oa[a]||Mh[a]},B.cr=function(a,t,n){var l=t[0],m=t[1];return a[0]=n[0]*l+n[4]*m+n[12],a[1]=n[1]*l+n[5]*m+n[13],a},B.cs=function(a,t){const{x:n,y:l}=N.fromLngLat(t);return!(a<0||a>25||l<0||l>=1||n<0||n>=1)},B.ct=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},B.cu=class extends yo{},B.cv=Rm,B.cx=function(a){return a.message===Eo},B.cy=je,B.cz=function(a,t){de.REGISTERED_PROTOCOLS[a]=t},B.d=yt,B.e=aa,B.f=a=>h(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),B.g=ye,B.h=a=>new Promise((t,n)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Ru})},l.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(a)],{type:"image/png"});l.src=a.byteLength?URL.createObjectURL(m):Ru}),B.i=va,B.j=(a,t)=>nt(aa(a,{type:"json"}),t),B.k=ut,B.l=St,B.m=nt,B.n=(a,t)=>nt(aa(a,{type:"arrayBuffer"}),t),B.o=function(a){return new Xd(a).readFields(xf,[])},B.p=$f,B.q=Zh,B.r=Fn,B.s=Ha,B.t=Ir,B.u=rr,B.v=He,B.w=qr,B.x=Nh,B.y=ql,B.z=_l}),J("worker",["./shared"],function(B){class h{constructor(de){this.keyCache={},de&&this.replace(de)}replace(de){this._layerConfigs={},this._layers={},this.update(de,[])}update(de,ye){for(const je of de){this._layerConfigs[je.id]=je;const Qe=this._layers[je.id]=B.bI(je);Qe._featureFilter=B.a9(Qe.filter),this.keyCache[je.id]&&delete this.keyCache[je.id]}for(const je of ye)delete this.keyCache[je],delete this._layerConfigs[je],delete this._layers[je];this.familiesBySource={};const Me=B.cB(Object.values(this._layerConfigs),this.keyCache);for(const je of Me){const Qe=je.map(ut=>this._layers[ut.id]),nt=Qe[0];if(nt.visibility==="none")continue;const yt=nt.source||"";let tt=this.familiesBySource[yt];tt||(tt=this.familiesBySource[yt]={});const Et=nt.sourceLayer||"_geojsonTileLayer";let St=tt[Et];St||(St=tt[Et]=[]),St.push(Qe)}}}class oe{constructor(de){const ye={},Me=[];for(const yt in de){const tt=de[yt],Et=ye[yt]={};for(const St in tt){const ut=tt[+St];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const jt={x:0,y:0,w:ut.bitmap.width+2,h:ut.bitmap.height+2};Me.push(jt),Et[St]={rect:jt,metrics:ut.metrics}}}const{w:je,h:Qe}=B.p(Me),nt=new B.q({width:je||1,height:Qe||1});for(const yt in de){const tt=de[yt];for(const Et in tt){const St=tt[+Et];if(!St||St.bitmap.width===0||St.bitmap.height===0)continue;const ut=ye[yt][Et].rect;B.q.copy(St.bitmap,nt,{x:0,y:0},{x:ut.x+1,y:ut.y+1},St.bitmap)}}this.image=nt,this.positions=ye}}B.cC("GlyphAtlas",oe);class ge{constructor(de){this.tileID=new B.Z(de.tileID.overscaledZ,de.tileID.wrap,de.tileID.canonical.z,de.tileID.canonical.x,de.tileID.canonical.y),this.uid=de.uid,this.zoom=de.zoom,this.pixelRatio=de.pixelRatio,this.tileSize=de.tileSize,this.source=de.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=de.showCollisionBoxes,this.collectResourceTiming=!!de.collectResourceTiming,this.returnDependencies=!!de.returnDependencies,this.promoteId=de.promoteId,this.inFlightDependencies=[],this.globalState=de.globalState}parse(de,ye,Me,je,Qe){return B._(this,void 0,void 0,function*(){this.status="parsing",this.data=de,this.collisionBoxArray=new B.a7;const nt=new B.cD(Object.keys(de.layers).sort()),yt=new B.cE(this.tileID,this.promoteId);yt.bucketLayerIDs=[];const tt={},Et={featureIndex:yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Me,subdivisionGranularity:Qe},St=ye.familiesBySource[this.source];for(const bi in St){const fr=de.layers[bi];if(!fr)continue;fr.version===1&&B.w(`Vector tile source "${this.source}" layer "${bi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Kn=nt.encode(bi),Wt=[];for(let Cn=0;Cn<fr.length;Cn++){const Ur=fr.feature(Cn),es=yt.getId(Ur,bi);Wt.push({feature:Ur,id:es,index:Cn,sourceLayerIndex:Kn})}for(const Cn of St[bi]){const Ur=Cn[0];Ur.source!==this.source&&B.w(`layer.source = ${Ur.source} does not equal this.source = ${this.source}`),Ur.minzoom&&this.zoom<Math.floor(Ur.minzoom)||Ur.maxzoom&&this.zoom>=Ur.maxzoom||Ur.visibility!=="none"&&(Te(Cn,this.zoom,Me),(tt[Ur.id]=Ur.createBucket({index:yt.bucketLayerIDs.length,layers:Cn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kn,sourceID:this.source,globalState:this.globalState})).populate(Wt,Et,this.tileID.canonical),yt.bucketLayerIDs.push(Cn.map(es=>es.id)))}}const ut=B.bM(Et.glyphDependencies,bi=>Object.keys(bi).map(Number));this.inFlightDependencies.forEach(bi=>bi==null?void 0:bi.abort()),this.inFlightDependencies=[];let jt=Promise.resolve({});if(Object.keys(ut).length){const bi=new AbortController;this.inFlightDependencies.push(bi),jt=je.sendAsync({type:"GG",data:{stacks:ut,source:this.source,tileID:this.tileID,type:"glyphs"}},bi)}const He=Object.keys(Et.iconDependencies);let ni=Promise.resolve({});if(He.length){const bi=new AbortController;this.inFlightDependencies.push(bi),ni=je.sendAsync({type:"GI",data:{icons:He,source:this.source,tileID:this.tileID,type:"icons"}},bi)}const Pi=Object.keys(Et.patternDependencies);let ci=Promise.resolve({});if(Pi.length){const bi=new AbortController;this.inFlightDependencies.push(bi),ci=je.sendAsync({type:"GI",data:{icons:Pi,source:this.source,tileID:this.tileID,type:"patterns"}},bi)}const[ai,Ai,tr]=yield Promise.all([jt,ni,ci]),Wi=new oe(ai),ur=new B.cF(Ai,tr);for(const bi in tt){const fr=tt[bi];fr instanceof B.a8?(Te(fr.layers,this.zoom,Me),B.cG({bucket:fr,glyphMap:ai,glyphPositions:Wi.positions,imageMap:Ai,imagePositions:ur.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Et.subdivisionGranularity})):fr.hasPattern&&(fr instanceof B.cH||fr instanceof B.cI||fr instanceof B.cJ)&&(Te(fr.layers,this.zoom,Me),fr.addFeatures(Et,this.tileID.canonical,ur.patternPositions))}return this.status="done",{buckets:Object.values(tt).filter(bi=>!bi.isEmpty()),featureIndex:yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Wi.image,imageAtlas:ur,glyphMap:this.returnDependencies?ai:null,iconMap:this.returnDependencies?Ai:null,glyphPositions:this.returnDependencies?Wi.positions:null}})}}function Te(lt,de,ye){const Me=new B.F(de);for(const je of lt)je.recalculate(Me,ye)}class Ve{constructor(de,ye,Me){this.actor=de,this.layerIndex=ye,this.availableImages=Me,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(de,ye){return B._(this,void 0,void 0,function*(){const Me=yield B.n(de.request,ye);try{return{vectorTile:new B.cK.VectorTile(new B.cL(Me.data)),rawData:Me.data,cacheControl:Me.cacheControl,expires:Me.expires}}catch(je){const Qe=new Uint8Array(Me.data);let nt=`Unable to parse the tile at ${de.request.url}, `;throw nt+=Qe[0]===31&&Qe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${je.message}`,new Error(nt)}})}loadTile(de){return B._(this,void 0,void 0,function*(){const ye=de.uid,Me=!!(de&&de.request&&de.request.collectResourceTiming)&&new B.cM(de.request),je=new ge(de);this.loading[ye]=je;const Qe=new AbortController;je.abort=Qe;try{const nt=yield this.loadVectorTile(de,Qe);if(delete this.loading[ye],!nt)return null;const yt=nt.rawData,tt={};nt.expires&&(tt.expires=nt.expires),nt.cacheControl&&(tt.cacheControl=nt.cacheControl);const Et={};if(Me){const ut=Me.finish();ut&&(Et.resourceTiming=JSON.parse(JSON.stringify(ut)))}je.vectorTile=nt.vectorTile;const St=je.parse(nt.vectorTile,this.layerIndex,this.availableImages,this.actor,de.subdivisionGranularity);this.loaded[ye]=je,this.fetching[ye]={rawTileData:yt,cacheControl:tt,resourceTiming:Et};try{const ut=yield St;return B.e({rawTileData:yt.slice(0)},ut,tt,Et)}finally{delete this.fetching[ye]}}catch(nt){throw delete this.loading[ye],je.status="done",this.loaded[ye]=je,nt}})}reloadTile(de){return B._(this,void 0,void 0,function*(){const ye=de.uid;if(!this.loaded||!this.loaded[ye])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Me=this.loaded[ye];if(Me.showCollisionBoxes=de.showCollisionBoxes,Me.globalState=de.globalState,Me.status==="parsing"){const je=yield Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,de.subdivisionGranularity);let Qe;if(this.fetching[ye]){const{rawTileData:nt,cacheControl:yt,resourceTiming:tt}=this.fetching[ye];delete this.fetching[ye],Qe=B.e({rawTileData:nt.slice(0)},je,yt,tt)}else Qe=je;return Qe}if(Me.status==="done"&&Me.vectorTile)return Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,de.subdivisionGranularity)})}abortTile(de){return B._(this,void 0,void 0,function*(){const ye=this.loading,Me=de.uid;ye&&ye[Me]&&ye[Me].abort&&(ye[Me].abort.abort(),delete ye[Me])})}removeTile(de){return B._(this,void 0,void 0,function*(){this.loaded&&this.loaded[de.uid]&&delete this.loaded[de.uid]})}}class Ee{constructor(){this.loaded={}}loadTile(de){return B._(this,void 0,void 0,function*(){const{uid:ye,encoding:Me,rawImageData:je,redFactor:Qe,greenFactor:nt,blueFactor:yt,baseShift:tt}=de,Et=je.width+2,St=je.height+2,ut=B.b(je)?new B.R({width:Et,height:St},yield B.cN(je,-1,-1,Et,St)):je,jt=new B.cO(ye,ut,Me,Qe,nt,yt,tt);return this.loaded=this.loaded||{},this.loaded[ye]=jt,jt})}removeTile(de){const ye=this.loaded,Me=de.uid;ye&&ye[Me]&&delete ye[Me]}}var pe,Se,Ne=function(){if(Se)return pe;function lt(ye,Me){if(ye.length!==0){de(ye[0],Me);for(var je=1;je<ye.length;je++)de(ye[je],!Me)}}function de(ye,Me){for(var je=0,Qe=0,nt=0,yt=ye.length,tt=yt-1;nt<yt;tt=nt++){var Et=(ye[nt][0]-ye[tt][0])*(ye[tt][1]+ye[nt][1]),St=je+Et;Qe+=Math.abs(je)>=Math.abs(Et)?je-St+Et:Et-St+je,je=St}je+Qe>=0!=!!Me&&ye.reverse()}return Se=1,pe=function ye(Me,je){var Qe,nt=Me&&Me.type;if(nt==="FeatureCollection")for(Qe=0;Qe<Me.features.length;Qe++)ye(Me.features[Qe],je);else if(nt==="GeometryCollection")for(Qe=0;Qe<Me.geometries.length;Qe++)ye(Me.geometries[Qe],je);else if(nt==="Feature")ye(Me.geometry,je);else if(nt==="Polygon")lt(Me.coordinates,je);else if(nt==="MultiPolygon")for(Qe=0;Qe<Me.coordinates.length;Qe++)lt(Me.coordinates[Qe],je);return Me}}(),rt=B.cP(Ne);const Ie=B.cK.VectorTileFeature.prototype.toGeoJSON;class Oe{constructor(de){this._feature=de,this.extent=B.$,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const ye of this._feature.geometry)de.push([new B.P(ye[0],ye[1])]);return de}{const de=[];for(const ye of this._feature.geometry){const Me=[];for(const je of ye)Me.push(new B.P(je[0],je[1]));de.push(Me)}return de}}toGeoJSON(de,ye,Me){return Ie.call(this,de,ye,Me)}}class We{constructor(de){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=B.$,this.length=de.length,this._features=de}feature(de){return new Oe(this._features[de])}}var ct,Ke,pt,Pt={exports:{}},Ue=function(){if(pt)return Pt.exports;pt=1;var lt=B.cS(),de=function(){if(Ke)return ct;Ke=1;var St=B.cQ(),ut=B.cR().VectorTileFeature;function jt(ni,Pi){this.options=Pi||{},this.features=ni,this.length=ni.length}function He(ni,Pi){this.id=typeof ni.id=="number"?ni.id:void 0,this.type=ni.type,this.rawGeometry=ni.type===1?[ni.geometry]:ni.geometry,this.properties=ni.tags,this.extent=Pi||4096}return ct=jt,jt.prototype.feature=function(ni){return new He(this.features[ni],this.options.extent)},He.prototype.loadGeometry=function(){var ni=this.rawGeometry;this.geometry=[];for(var Pi=0;Pi<ni.length;Pi++){for(var ci=ni[Pi],ai=[],Ai=0;Ai<ci.length;Ai++)ai.push(new St(ci[Ai][0],ci[Ai][1]));this.geometry.push(ai)}return this.geometry},He.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ni=this.geometry,Pi=1/0,ci=-1/0,ai=1/0,Ai=-1/0,tr=0;tr<ni.length;tr++)for(var Wi=ni[tr],ur=0;ur<Wi.length;ur++){var bi=Wi[ur];Pi=Math.min(Pi,bi.x),ci=Math.max(ci,bi.x),ai=Math.min(ai,bi.y),Ai=Math.max(Ai,bi.y)}return[Pi,ai,ci,Ai]},He.prototype.toGeoJSON=ut.prototype.toGeoJSON,ct}();function ye(St){var ut=new lt;return function(jt,He){for(var ni in jt.layers)He.writeMessage(3,Me,jt.layers[ni])}(St,ut),ut.finish()}function Me(St,ut){var jt;ut.writeVarintField(15,St.version||1),ut.writeStringField(1,St.name||""),ut.writeVarintField(5,St.extent||4096);var He={keys:[],values:[],keycache:{},valuecache:{}};for(jt=0;jt<St.length;jt++)He.feature=St.feature(jt),ut.writeMessage(2,je,He);var ni=He.keys;for(jt=0;jt<ni.length;jt++)ut.writeStringField(3,ni[jt]);var Pi=He.values;for(jt=0;jt<Pi.length;jt++)ut.writeMessage(4,Et,Pi[jt])}function je(St,ut){var jt=St.feature;jt.id!==void 0&&ut.writeVarintField(1,jt.id),ut.writeMessage(2,Qe,St),ut.writeVarintField(3,jt.type),ut.writeMessage(4,tt,jt)}function Qe(St,ut){var jt=St.feature,He=St.keys,ni=St.values,Pi=St.keycache,ci=St.valuecache;for(var ai in jt.properties){var Ai=jt.properties[ai],tr=Pi[ai];if(Ai!==null){tr===void 0&&(He.push(ai),Pi[ai]=tr=He.length-1),ut.writeVarint(tr);var Wi=typeof Ai;Wi!=="string"&&Wi!=="boolean"&&Wi!=="number"&&(Ai=JSON.stringify(Ai));var ur=Wi+":"+Ai,bi=ci[ur];bi===void 0&&(ni.push(Ai),ci[ur]=bi=ni.length-1),ut.writeVarint(bi)}}}function nt(St,ut){return(ut<<3)+(7&St)}function yt(St){return St<<1^St>>31}function tt(St,ut){for(var jt=St.loadGeometry(),He=St.type,ni=0,Pi=0,ci=jt.length,ai=0;ai<ci;ai++){var Ai=jt[ai],tr=1;He===1&&(tr=Ai.length),ut.writeVarint(nt(1,tr));for(var Wi=He===3?Ai.length-1:Ai.length,ur=0;ur<Wi;ur++){ur===1&&He!==1&&ut.writeVarint(nt(2,Wi-1));var bi=Ai[ur].x-ni,fr=Ai[ur].y-Pi;ut.writeVarint(yt(bi)),ut.writeVarint(yt(fr)),ni+=bi,Pi+=fr}He===3&&ut.writeVarint(nt(7,1))}}function Et(St,ut){var jt=typeof St;jt==="string"?ut.writeStringField(1,St):jt==="boolean"?ut.writeBooleanField(7,St):jt==="number"&&(St%1!=0?ut.writeDoubleField(3,St):St<0?ut.writeSVarintField(6,St):ut.writeVarintField(5,St))}return Pt.exports=ye,Pt.exports.fromVectorTileJs=ye,Pt.exports.fromGeojsonVt=function(St,ut){ut=ut||{};var jt={};for(var He in St)jt[He]=new de(St[He].features,ut),jt[He].name=He,jt[He].version=ut.version,jt[He].extent=ut.extent;return ye({layers:jt})},Pt.exports.GeoJSONWrapper=de,Pt.exports}(),zt=B.cP(Ue);const _t={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:lt=>lt},Dt=Math.fround||(ri=new Float32Array(1),lt=>(ri[0]=+lt,ri[0]));var ri;class Yt{constructor(de){this.options=Object.assign(Object.create(_t),de),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(de){const{log:ye,minZoom:Me,maxZoom:je}=this.options;ye&&console.time("total time");const Qe=`prepare ${de.length} points`;ye&&console.time(Qe),this.points=de;const nt=[];for(let tt=0;tt<de.length;tt++){const Et=de[tt];if(!Et.geometry)continue;const[St,ut]=Et.geometry.coordinates,jt=Dt(gt(St)),He=Dt(It(ut));nt.push(jt,He,1/0,tt,-1,1),this.options.reduce&&nt.push(0)}let yt=this.trees[je+1]=this._createTree(nt);ye&&console.timeEnd(Qe);for(let tt=je;tt>=Me;tt--){const Et=+Date.now();yt=this.trees[tt]=this._createTree(this._cluster(yt,tt)),ye&&console.log("z%d: %d clusters in %dms",tt,yt.numItems,+Date.now()-Et)}return ye&&console.timeEnd("total time"),this}getClusters(de,ye){let Me=((de[0]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,de[1]));let Qe=de[2]===180?180:((de[2]+180)%360+360)%360-180;const nt=Math.max(-90,Math.min(90,de[3]));if(de[2]-de[0]>=360)Me=-180,Qe=180;else if(Me>Qe){const ut=this.getClusters([Me,je,180,nt],ye),jt=this.getClusters([-180,je,Qe,nt],ye);return ut.concat(jt)}const yt=this.trees[this._limitZoom(ye)],tt=yt.range(gt(Me),It(nt),gt(Qe),It(je)),Et=yt.data,St=[];for(const ut of tt){const jt=this.stride*ut;St.push(Et[jt+5]>1?yi(Et,jt,this.clusterProps):this.points[Et[jt+3]])}return St}getChildren(de){const ye=this._getOriginId(de),Me=this._getOriginZoom(de),je="No cluster with the specified id.",Qe=this.trees[Me];if(!Qe)throw new Error(je);const nt=Qe.data;if(ye*this.stride>=nt.length)throw new Error(je);const yt=this.options.radius/(this.options.extent*Math.pow(2,Me-1)),tt=Qe.within(nt[ye*this.stride],nt[ye*this.stride+1],yt),Et=[];for(const St of tt){const ut=St*this.stride;nt[ut+4]===de&&Et.push(nt[ut+5]>1?yi(nt,ut,this.clusterProps):this.points[nt[ut+3]])}if(Et.length===0)throw new Error(je);return Et}getLeaves(de,ye,Me){const je=[];return this._appendLeaves(je,de,ye=ye||10,Me=Me||0,0),je}getTile(de,ye,Me){const je=this.trees[this._limitZoom(de)],Qe=Math.pow(2,de),{extent:nt,radius:yt}=this.options,tt=yt/nt,Et=(Me-tt)/Qe,St=(Me+1+tt)/Qe,ut={features:[]};return this._addTileFeatures(je.range((ye-tt)/Qe,Et,(ye+1+tt)/Qe,St),je.data,ye,Me,Qe,ut),ye===0&&this._addTileFeatures(je.range(1-tt/Qe,Et,1,St),je.data,Qe,Me,Qe,ut),ye===Qe-1&&this._addTileFeatures(je.range(0,Et,tt/Qe,St),je.data,-1,Me,Qe,ut),ut.features.length?ut:null}getClusterExpansionZoom(de){let ye=this._getOriginZoom(de)-1;for(;ye<=this.options.maxZoom;){const Me=this.getChildren(de);if(ye++,Me.length!==1)break;de=Me[0].properties.cluster_id}return ye}_appendLeaves(de,ye,Me,je,Qe){const nt=this.getChildren(ye);for(const yt of nt){const tt=yt.properties;if(tt&&tt.cluster?Qe+tt.point_count<=je?Qe+=tt.point_count:Qe=this._appendLeaves(de,tt.cluster_id,Me,je,Qe):Qe<je?Qe++:de.push(yt),de.length===Me)break}return Qe}_createTree(de){const ye=new B.aH(de.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Me=0;Me<de.length;Me+=this.stride)ye.add(de[Me],de[Me+1]);return ye.finish(),ye.data=de,ye}_addTileFeatures(de,ye,Me,je,Qe,nt){for(const yt of de){const tt=yt*this.stride,Et=ye[tt+5]>1;let St,ut,jt;if(Et)St=wi(ye,tt,this.clusterProps),ut=ye[tt],jt=ye[tt+1];else{const Pi=this.points[ye[tt+3]];St=Pi.properties;const[ci,ai]=Pi.geometry.coordinates;ut=gt(ci),jt=It(ai)}const He={type:1,geometry:[[Math.round(this.options.extent*(ut*Qe-Me)),Math.round(this.options.extent*(jt*Qe-je))]],tags:St};let ni;ni=Et||this.options.generateId?ye[tt+3]:this.points[ye[tt+3]].id,ni!==void 0&&(He.id=ni),nt.features.push(He)}}_limitZoom(de){return Math.max(this.options.minZoom,Math.min(Math.floor(+de),this.options.maxZoom+1))}_cluster(de,ye){const{radius:Me,extent:je,reduce:Qe,minPoints:nt}=this.options,yt=Me/(je*Math.pow(2,ye)),tt=de.data,Et=[],St=this.stride;for(let ut=0;ut<tt.length;ut+=St){if(tt[ut+2]<=ye)continue;tt[ut+2]=ye;const jt=tt[ut],He=tt[ut+1],ni=de.within(tt[ut],tt[ut+1],yt),Pi=tt[ut+5];let ci=Pi;for(const ai of ni){const Ai=ai*St;tt[Ai+2]>ye&&(ci+=tt[Ai+5])}if(ci>Pi&&ci>=nt){let ai,Ai=jt*Pi,tr=He*Pi,Wi=-1;const ur=(ut/St<<5)+(ye+1)+this.points.length;for(const bi of ni){const fr=bi*St;if(tt[fr+2]<=ye)continue;tt[fr+2]=ye;const Kn=tt[fr+5];Ai+=tt[fr]*Kn,tr+=tt[fr+1]*Kn,tt[fr+4]=ur,Qe&&(ai||(ai=this._map(tt,ut,!0),Wi=this.clusterProps.length,this.clusterProps.push(ai)),Qe(ai,this._map(tt,fr)))}tt[ut+4]=ur,Et.push(Ai/ci,tr/ci,1/0,ur,-1,ci),Qe&&Et.push(Wi)}else{for(let ai=0;ai<St;ai++)Et.push(tt[ut+ai]);if(ci>1)for(const ai of ni){const Ai=ai*St;if(!(tt[Ai+2]<=ye)){tt[Ai+2]=ye;for(let tr=0;tr<St;tr++)Et.push(tt[Ai+tr])}}}}return Et}_getOriginId(de){return de-this.points.length>>5}_getOriginZoom(de){return(de-this.points.length)%32}_map(de,ye,Me){if(de[ye+5]>1){const nt=this.clusterProps[de[ye+6]];return Me?Object.assign({},nt):nt}const je=this.points[de[ye+3]].properties,Qe=this.options.map(je);return Me&&Qe===je?Object.assign({},Qe):Qe}}function yi(lt,de,ye){return{type:"Feature",id:lt[de+3],properties:wi(lt,de,ye),geometry:{type:"Point",coordinates:[(Me=lt[de],360*(Me-.5)),ti(lt[de+1])]}};var Me}function wi(lt,de,ye){const Me=lt[de+5],je=Me>=1e4?`${Math.round(Me/1e3)}k`:Me>=1e3?Math.round(Me/100)/10+"k":Me,Qe=lt[de+6],nt=Qe===-1?{}:Object.assign({},ye[Qe]);return Object.assign(nt,{cluster:!0,cluster_id:lt[de+3],point_count:Me,point_count_abbreviated:je})}function gt(lt){return lt/360+.5}function It(lt){const de=Math.sin(lt*Math.PI/180),ye=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return ye<0?0:ye>1?1:ye}function ti(lt){const de=(180-360*lt)*Math.PI/180;return 360*Math.atan(Math.exp(de))/Math.PI-90}function ki(lt,de,ye,Me){let je=Me;const Qe=de+(ye-de>>1);let nt,yt=ye-de;const tt=lt[de],Et=lt[de+1],St=lt[ye],ut=lt[ye+1];for(let jt=de+3;jt<ye;jt+=3){const He=qe(lt[jt],lt[jt+1],tt,Et,St,ut);if(He>je)nt=jt,je=He;else if(He===je){const ni=Math.abs(jt-Qe);ni<yt&&(nt=jt,yt=ni)}}je>Me&&(nt-de>3&&ki(lt,de,nt,Me),lt[nt+2]=je,ye-nt>3&&ki(lt,nt,ye,Me))}function qe(lt,de,ye,Me,je,Qe){let nt=je-ye,yt=Qe-Me;if(nt!==0||yt!==0){const tt=((lt-ye)*nt+(de-Me)*yt)/(nt*nt+yt*yt);tt>1?(ye=je,Me=Qe):tt>0&&(ye+=nt*tt,Me+=yt*tt)}return nt=lt-ye,yt=de-Me,nt*nt+yt*yt}function Ot(lt,de,ye,Me){const je={id:lt??null,type:de,geometry:ye,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(de==="Point"||de==="MultiPoint"||de==="LineString")Ht(je,ye);else if(de==="Polygon")Ht(je,ye[0]);else if(de==="MultiLineString")for(const Qe of ye)Ht(je,Qe);else if(de==="MultiPolygon")for(const Qe of ye)Ht(je,Qe[0]);return je}function Ht(lt,de){for(let ye=0;ye<de.length;ye+=3)lt.minX=Math.min(lt.minX,de[ye]),lt.minY=Math.min(lt.minY,de[ye+1]),lt.maxX=Math.max(lt.maxX,de[ye]),lt.maxY=Math.max(lt.maxY,de[ye+1])}function ii(lt,de,ye,Me){if(!de.geometry)return;const je=de.geometry.coordinates;if(je&&je.length===0)return;const Qe=de.geometry.type,nt=Math.pow(ye.tolerance/((1<<ye.maxZoom)*ye.extent),2);let yt=[],tt=de.id;if(ye.promoteId?tt=de.properties[ye.promoteId]:ye.generateId&&(tt=Me||0),Qe==="Point")di(je,yt);else if(Qe==="MultiPoint")for(const Et of je)di(Et,yt);else if(Qe==="LineString")Qi(je,yt,nt,!1);else if(Qe==="MultiLineString"){if(ye.lineMetrics){for(const Et of je)yt=[],Qi(Et,yt,nt,!1),lt.push(Ot(tt,"LineString",yt,de.properties));return}Ri(je,yt,nt,!1)}else if(Qe==="Polygon")Ri(je,yt,nt,!0);else{if(Qe!=="MultiPolygon"){if(Qe==="GeometryCollection"){for(const Et of de.geometry.geometries)ii(lt,{id:tt,geometry:Et,properties:de.properties},ye,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Et of je){const St=[];Ri(Et,St,nt,!0),yt.push(St)}}lt.push(Ot(tt,Qe,yt,de.properties))}function di(lt,de){de.push(_n(lt[0]),Zr(lt[1]),0)}function Qi(lt,de,ye,Me){let je,Qe,nt=0;for(let tt=0;tt<lt.length;tt++){const Et=_n(lt[tt][0]),St=Zr(lt[tt][1]);de.push(Et,St,0),tt>0&&(nt+=Me?(je*St-Et*Qe)/2:Math.sqrt(Math.pow(Et-je,2)+Math.pow(St-Qe,2))),je=Et,Qe=St}const yt=de.length-3;de[2]=1,ki(de,0,yt,ye),de[yt+2]=1,de.size=Math.abs(nt),de.start=0,de.end=de.size}function Ri(lt,de,ye,Me){for(let je=0;je<lt.length;je++){const Qe=[];Qi(lt[je],Qe,ye,Me),de.push(Qe)}}function _n(lt){return lt/360+.5}function Zr(lt){const de=Math.sin(lt*Math.PI/180),ye=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return ye<0?0:ye>1?1:ye}function Cr(lt,de,ye,Me,je,Qe,nt,yt){if(Me/=de,Qe>=(ye/=de)&&nt<Me)return lt;if(nt<ye||Qe>=Me)return null;const tt=[];for(const Et of lt){const St=Et.geometry;let ut=Et.type;const jt=je===0?Et.minX:Et.minY,He=je===0?Et.maxX:Et.maxY;if(jt>=ye&&He<Me){tt.push(Et);continue}if(He<ye||jt>=Me)continue;let ni=[];if(ut==="Point"||ut==="MultiPoint")Pl(St,ni,ye,Me,je);else if(ut==="LineString")aa(St,ni,ye,Me,je,!1,yt.lineMetrics);else if(ut==="MultiLineString")li(St,ni,ye,Me,je,!1);else if(ut==="Polygon")li(St,ni,ye,Me,je,!0);else if(ut==="MultiPolygon")for(const Pi of St){const ci=[];li(Pi,ci,ye,Me,je,!0),ci.length&&ni.push(ci)}if(ni.length){if(yt.lineMetrics&&ut==="LineString"){for(const Pi of ni)tt.push(Ot(Et.id,ut,Pi,Et.tags));continue}ut!=="LineString"&&ut!=="MultiLineString"||(ni.length===1?(ut="LineString",ni=ni[0]):ut="MultiLineString"),ut!=="Point"&&ut!=="MultiPoint"||(ut=ni.length===3?"Point":"MultiPoint"),tt.push(Ot(Et.id,ut,ni,Et.tags))}}return tt.length?tt:null}function Pl(lt,de,ye,Me,je){for(let Qe=0;Qe<lt.length;Qe+=3){const nt=lt[Qe+je];nt>=ye&&nt<=Me&&Ms(de,lt[Qe],lt[Qe+1],lt[Qe+2])}}function aa(lt,de,ye,Me,je,Qe,nt){let yt=hc(lt);const tt=je===0?Va:dc;let Et,St,ut=lt.start;for(let ci=0;ci<lt.length-3;ci+=3){const ai=lt[ci],Ai=lt[ci+1],tr=lt[ci+2],Wi=lt[ci+3],ur=lt[ci+4],bi=je===0?ai:Ai,fr=je===0?Wi:ur;let Kn=!1;nt&&(Et=Math.sqrt(Math.pow(ai-Wi,2)+Math.pow(Ai-ur,2))),bi<ye?fr>ye&&(St=tt(yt,ai,Ai,Wi,ur,ye),nt&&(yt.start=ut+Et*St)):bi>Me?fr<Me&&(St=tt(yt,ai,Ai,Wi,ur,Me),nt&&(yt.start=ut+Et*St)):Ms(yt,ai,Ai,tr),fr<ye&&bi>=ye&&(St=tt(yt,ai,Ai,Wi,ur,ye),Kn=!0),fr>Me&&bi<=Me&&(St=tt(yt,ai,Ai,Wi,ur,Me),Kn=!0),!Qe&&Kn&&(nt&&(yt.end=ut+Et*St),de.push(yt),yt=hc(lt)),nt&&(ut+=Et)}let jt=lt.length-3;const He=lt[jt],ni=lt[jt+1],Pi=je===0?He:ni;Pi>=ye&&Pi<=Me&&Ms(yt,He,ni,lt[jt+2]),jt=yt.length-3,Qe&&jt>=3&&(yt[jt]!==yt[0]||yt[jt+1]!==yt[1])&&Ms(yt,yt[0],yt[1],yt[2]),yt.length&&de.push(yt)}function hc(lt){const de=[];return de.size=lt.size,de.start=lt.start,de.end=lt.end,de}function li(lt,de,ye,Me,je,Qe){for(const nt of lt)aa(nt,de,ye,Me,je,Qe,!1)}function Ms(lt,de,ye,Me){lt.push(de,ye,Me)}function Va(lt,de,ye,Me,je,Qe){const nt=(Qe-de)/(Me-de);return Ms(lt,Qe,ye+(je-ye)*nt,1),nt}function dc(lt,de,ye,Me,je,Qe){const nt=(Qe-ye)/(je-ye);return Ms(lt,de+(Me-de)*nt,Qe,1),nt}function qr(lt,de){const ye=[];for(let Me=0;Me<lt.length;Me++){const je=lt[Me],Qe=je.type;let nt;if(Qe==="Point"||Qe==="MultiPoint"||Qe==="LineString")nt=Ga(je.geometry,de);else if(Qe==="MultiLineString"||Qe==="Polygon"){nt=[];for(const yt of je.geometry)nt.push(Ga(yt,de))}else if(Qe==="MultiPolygon"){nt=[];for(const yt of je.geometry){const tt=[];for(const Et of yt)tt.push(Ga(Et,de));nt.push(tt)}}ye.push(Ot(je.id,Qe,nt,je.tags))}return ye}function Ga(lt,de){const ye=[];ye.size=lt.size,lt.start!==void 0&&(ye.start=lt.start,ye.end=lt.end);for(let Me=0;Me<lt.length;Me+=3)ye.push(lt[Me]+de,lt[Me+1],lt[Me+2]);return ye}function va(lt,de){if(lt.transformed)return lt;const ye=1<<lt.z,Me=lt.x,je=lt.y;for(const Qe of lt.features){const nt=Qe.geometry,yt=Qe.type;if(Qe.geometry=[],yt===1)for(let tt=0;tt<nt.length;tt+=2)Qe.geometry.push(Ao(nt[tt],nt[tt+1],de,ye,Me,je));else for(let tt=0;tt<nt.length;tt++){const Et=[];for(let St=0;St<nt[tt].length;St+=2)Et.push(Ao(nt[tt][St],nt[tt][St+1],de,ye,Me,je));Qe.geometry.push(Et)}}return lt.transformed=!0,lt}function Ao(lt,de,ye,Me,je,Qe){return[Math.round(ye*(lt*Me-je)),Math.round(ye*(de*Me-Qe))]}function $a(lt,de,ye,Me,je){const Qe=de===je.maxZoom?0:je.tolerance/((1<<de)*je.extent),nt={features:[],numPoints:0,numSimplified:0,numFeatures:lt.length,source:null,x:ye,y:Me,z:de,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const yt of lt)Ru(nt,yt,Qe,je);return nt}function Ru(lt,de,ye,Me){const je=de.geometry,Qe=de.type,nt=[];if(lt.minX=Math.min(lt.minX,de.minX),lt.minY=Math.min(lt.minY,de.minY),lt.maxX=Math.max(lt.maxX,de.maxX),lt.maxY=Math.max(lt.maxY,de.maxY),Qe==="Point"||Qe==="MultiPoint")for(let yt=0;yt<je.length;yt+=3)nt.push(je[yt],je[yt+1]),lt.numPoints++,lt.numSimplified++;else if(Qe==="LineString")zl(nt,je,lt,ye,!1,!1);else if(Qe==="MultiLineString"||Qe==="Polygon")for(let yt=0;yt<je.length;yt++)zl(nt,je[yt],lt,ye,Qe==="Polygon",yt===0);else if(Qe==="MultiPolygon")for(let yt=0;yt<je.length;yt++){const tt=je[yt];for(let Et=0;Et<tt.length;Et++)zl(nt,tt[Et],lt,ye,!0,Et===0)}if(nt.length){let yt=de.tags||null;if(Qe==="LineString"&&Me.lineMetrics){yt={};for(const Et in de.tags)yt[Et]=de.tags[Et];yt.mapbox_clip_start=je.start/je.size,yt.mapbox_clip_end=je.end/je.size}const tt={geometry:nt,type:Qe==="Polygon"||Qe==="MultiPolygon"?3:Qe==="LineString"||Qe==="MultiLineString"?2:1,tags:yt};de.id!==null&&(tt.id=de.id),lt.features.push(tt)}}function zl(lt,de,ye,Me,je,Qe){const nt=Me*Me;if(Me>0&&de.size<(je?nt:Me))return void(ye.numPoints+=de.length/3);const yt=[];for(let tt=0;tt<de.length;tt+=3)(Me===0||de[tt+2]>nt)&&(ye.numSimplified++,yt.push(de[tt],de[tt+1])),ye.numPoints++;je&&function(tt,Et){let St=0;for(let ut=0,jt=tt.length,He=jt-2;ut<jt;He=ut,ut+=2)St+=(tt[ut]-tt[He])*(tt[ut+1]+tt[He+1]);if(St>0===Et)for(let ut=0,jt=tt.length;ut<jt/2;ut+=2){const He=tt[ut],ni=tt[ut+1];tt[ut]=tt[jt-2-ut],tt[ut+1]=tt[jt-1-ut],tt[jt-2-ut]=He,tt[jt-1-ut]=ni}}(yt,Qe),lt.push(yt)}const ba={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class pc{constructor(de,ye){const Me=(ye=this.options=function(Qe,nt){for(const yt in nt)Qe[yt]=nt[yt];return Qe}(Object.create(ba),ye)).debug;if(Me&&console.time("preprocess data"),ye.maxZoom<0||ye.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ye.promoteId&&ye.generateId)throw new Error("promoteId and generateId cannot be used together.");let je=function(Qe,nt){const yt=[];if(Qe.type==="FeatureCollection")for(let tt=0;tt<Qe.features.length;tt++)ii(yt,Qe.features[tt],nt,tt);else ii(yt,Qe.type==="Feature"?Qe:{geometry:Qe},nt);return yt}(de,ye);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ye.indexMaxZoom,ye.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),je=function(Qe,nt){const yt=nt.buffer/nt.extent;let tt=Qe;const Et=Cr(Qe,1,-1-yt,yt,0,-1,2,nt),St=Cr(Qe,1,1-yt,2+yt,0,-1,2,nt);return(Et||St)&&(tt=Cr(Qe,1,-yt,1+yt,0,-1,2,nt)||[],Et&&(tt=qr(Et,1).concat(tt)),St&&(tt=tt.concat(qr(St,-1)))),tt}(je,ye),je.length&&this.splitTile(je,0,0,0),Me&&(je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(de,ye,Me,je,Qe,nt,yt){const tt=[de,ye,Me,je],Et=this.options,St=Et.debug;for(;tt.length;){je=tt.pop(),Me=tt.pop(),ye=tt.pop(),de=tt.pop();const ut=1<<ye,jt=Ha(ye,Me,je);let He=this.tiles[jt];if(!He&&(St>1&&console.time("creation"),He=this.tiles[jt]=$a(de,ye,Me,je,Et),this.tileCoords.push({z:ye,x:Me,y:je}),St)){St>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ye,Me,je,He.numFeatures,He.numPoints,He.numSimplified),console.timeEnd("creation"));const Kn=`z${ye}`;this.stats[Kn]=(this.stats[Kn]||0)+1,this.total++}if(He.source=de,Qe==null){if(ye===Et.indexMaxZoom||He.numPoints<=Et.indexMaxPoints)continue}else{if(ye===Et.maxZoom||ye===Qe)continue;if(Qe!=null){const Kn=Qe-ye;if(Me!==nt>>Kn||je!==yt>>Kn)continue}}if(He.source=null,de.length===0)continue;St>1&&console.time("clipping");const ni=.5*Et.buffer/Et.extent,Pi=.5-ni,ci=.5+ni,ai=1+ni;let Ai=null,tr=null,Wi=null,ur=null,bi=Cr(de,ut,Me-ni,Me+ci,0,He.minX,He.maxX,Et),fr=Cr(de,ut,Me+Pi,Me+ai,0,He.minX,He.maxX,Et);de=null,bi&&(Ai=Cr(bi,ut,je-ni,je+ci,1,He.minY,He.maxY,Et),tr=Cr(bi,ut,je+Pi,je+ai,1,He.minY,He.maxY,Et),bi=null),fr&&(Wi=Cr(fr,ut,je-ni,je+ci,1,He.minY,He.maxY,Et),ur=Cr(fr,ut,je+Pi,je+ai,1,He.minY,He.maxY,Et),fr=null),St>1&&console.timeEnd("clipping"),tt.push(Ai||[],ye+1,2*Me,2*je),tt.push(tr||[],ye+1,2*Me,2*je+1),tt.push(Wi||[],ye+1,2*Me+1,2*je),tt.push(ur||[],ye+1,2*Me+1,2*je+1)}}getTile(de,ye,Me){de=+de,ye=+ye,Me=+Me;const je=this.options,{extent:Qe,debug:nt}=je;if(de<0||de>24)return null;const yt=1<<de,tt=Ha(de,ye=ye+yt&yt-1,Me);if(this.tiles[tt])return va(this.tiles[tt],Qe);nt>1&&console.log("drilling down to z%d-%d-%d",de,ye,Me);let Et,St=de,ut=ye,jt=Me;for(;!Et&&St>0;)St--,ut>>=1,jt>>=1,Et=this.tiles[Ha(St,ut,jt)];return Et&&Et.source?(nt>1&&(console.log("found parent tile z%d-%d-%d",St,ut,jt),console.time("drilling down")),this.splitTile(Et.source,St,ut,jt,de,ye,Me),nt>1&&console.timeEnd("drilling down"),this.tiles[tt]?va(this.tiles[tt],Qe):null):null}}function Ha(lt,de,ye){return 32*((1<<lt)*ye+de)+lt}function en(lt,de){return de?lt.properties[de]:lt.id}function sa(lt,de){if(lt==null)return!0;if(lt.type==="Feature")return en(lt,de)!=null;if(lt.type==="FeatureCollection"){const ye=new Set;for(const Me of lt.features){const je=en(Me,de);if(je==null||ye.has(je))return!1;ye.add(je)}return!0}return!1}function oa(lt,de){const ye=new Map;if(lt!=null)if(lt.type==="Feature")ye.set(en(lt,de),lt);else for(const Me of lt.features)ye.set(en(Me,de),Me);return ye}class Mh extends Ve{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(de,ye){return B._(this,void 0,void 0,function*(){const Me=de.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const je=this._geoJSONIndex.getTile(Me.z,Me.x,Me.y);if(!je)return null;const Qe=new We(je.features);let nt=zt(Qe);return nt.byteOffset===0&&nt.byteLength===nt.buffer.byteLength||(nt=new Uint8Array(nt)),{vectorTile:Qe,rawData:nt.buffer}})}loadData(de){return B._(this,void 0,void 0,function*(){var ye;(ye=this._pendingRequest)===null||ye===void 0||ye.abort();const Me=!!(de&&de.request&&de.request.collectResourceTiming)&&new B.cM(de.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(de,this._pendingRequest),this._geoJSONIndex=de.cluster?new Yt(function({superclusterOptions:nt,clusterProperties:yt}){if(!yt||!nt)return nt;const tt={},Et={},St={accumulated:null,zoom:0},ut={properties:null},jt=Object.keys(yt);for(const He of jt){const[ni,Pi]=yt[He],ci=B.cT(Pi),ai=B.cT(typeof ni=="string"?[ni,["accumulated"],["get",He]]:ni);tt[He]=ci.value,Et[He]=ai.value}return nt.map=He=>{ut.properties=He;const ni={};for(const Pi of jt)ni[Pi]=tt[Pi].evaluate(St,ut);return ni},nt.reduce=(He,ni)=>{ut.properties=ni;for(const Pi of jt)St.accumulated=He[Pi],He[Pi]=Et[Pi].evaluate(St,ut)},nt}(de)).load((yield this._pendingData).features):(je=yield this._pendingData,new pc(je,de.geojsonVtOptions)),this.loaded={};const Qe={};if(Me){const nt=Me.finish();nt&&(Qe.resourceTiming={},Qe.resourceTiming[de.source]=JSON.parse(JSON.stringify(nt)))}return Qe}catch(Qe){if(delete this._pendingRequest,B.cx(Qe))return{abandoned:!0};throw Qe}var je})}getData(){return B._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(de){const ye=this.loaded;return ye&&ye[de.uid]?super.reloadTile(de):this.loadTile(de)}loadAndProcessGeoJSON(de,ye){return B._(this,void 0,void 0,function*(){let Me=yield this.loadGeoJSON(de,ye);if(delete this._pendingRequest,typeof Me!="object")throw new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`);if(rt(Me,!0),de.filter){const je=B.cT(de.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(je.result==="error")throw new Error(je.value.map(nt=>`${nt.key}: ${nt.message}`).join(", "));Me={type:"FeatureCollection",features:Me.features.filter(nt=>je.value.evaluate({zoom:0},nt))}}return Me})}loadGeoJSON(de,ye){return B._(this,void 0,void 0,function*(){const{promoteId:Me}=de;if(de.request){const je=yield B.j(de.request,ye);return this._dataUpdateable=sa(je.data,Me)?oa(je.data,Me):void 0,je.data}if(typeof de.data=="string")try{const je=JSON.parse(de.data);return this._dataUpdateable=sa(je,Me)?oa(je,Me):void 0,je}catch{throw new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`)}if(!de.dataDiff)throw new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${de.source}`);return function(je,Qe,nt){var yt,tt,Et,St;if(Qe.removeAll&&je.clear(),Qe.remove)for(const ut of Qe.remove)je.delete(ut);if(Qe.add)for(const ut of Qe.add){const jt=en(ut,nt);jt!=null&&je.set(jt,ut)}if(Qe.update)for(const ut of Qe.update){let jt=je.get(ut.id);if(jt==null)continue;const He=!ut.removeAllProperties&&(((yt=ut.removeProperties)===null||yt===void 0?void 0:yt.length)>0||((tt=ut.addOrUpdateProperties)===null||tt===void 0?void 0:tt.length)>0);if((ut.newGeometry||ut.removeAllProperties||He)&&(jt=Object.assign({},jt),je.set(ut.id,jt),He&&(jt.properties=Object.assign({},jt.properties))),ut.newGeometry&&(jt.geometry=ut.newGeometry),ut.removeAllProperties)jt.properties={};else if(((Et=ut.removeProperties)===null||Et===void 0?void 0:Et.length)>0)for(const ni of ut.removeProperties)Object.prototype.hasOwnProperty.call(jt.properties,ni)&&delete jt.properties[ni];if(((St=ut.addOrUpdateProperties)===null||St===void 0?void 0:St.length)>0)for(const{key:ni,value:Pi}of ut.addOrUpdateProperties)jt.properties[ni]=Pi}}(this._dataUpdateable,de.dataDiff,Me),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(de){return B._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(de){return this._geoJSONIndex.getClusterExpansionZoom(de.clusterId)}getClusterChildren(de){return this._geoJSONIndex.getChildren(de.clusterId)}getClusterLeaves(de){return this._geoJSONIndex.getLeaves(de.clusterId,de.limit,de.offset)}}class Eo{constructor(de){this.self=de,this.actor=new B.J(de),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ye,Me)=>{if(this.externalWorkerSourceTypes[ye])throw new Error(`Worker source with name "${ye}" already registered.`);this.externalWorkerSourceTypes[ye]=Me},this.self.addProtocol=B.cz,this.self.removeProtocol=B.cA,this.self.registerRTLTextPlugin=ye=>{B.cU.setMethods(ye)},this.actor.registerMessageHandler("LDT",(ye,Me)=>this._getDEMWorkerSource(ye,Me.source).loadTile(Me)),this.actor.registerMessageHandler("RDT",(ye,Me)=>B._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ye,Me.source).removeTile(Me)})),this.actor.registerMessageHandler("GCEZ",(ye,Me)=>B._(this,void 0,void 0,function*(){return this._getWorkerSource(ye,Me.type,Me.source).getClusterExpansionZoom(Me)})),this.actor.registerMessageHandler("GCC",(ye,Me)=>B._(this,void 0,void 0,function*(){return this._getWorkerSource(ye,Me.type,Me.source).getClusterChildren(Me)})),this.actor.registerMessageHandler("GCL",(ye,Me)=>B._(this,void 0,void 0,function*(){return this._getWorkerSource(ye,Me.type,Me.source).getClusterLeaves(Me)})),this.actor.registerMessageHandler("LD",(ye,Me)=>this._getWorkerSource(ye,Me.type,Me.source).loadData(Me)),this.actor.registerMessageHandler("GD",(ye,Me)=>this._getWorkerSource(ye,Me.type,Me.source).getData()),this.actor.registerMessageHandler("LT",(ye,Me)=>this._getWorkerSource(ye,Me.type,Me.source).loadTile(Me)),this.actor.registerMessageHandler("RT",(ye,Me)=>this._getWorkerSource(ye,Me.type,Me.source).reloadTile(Me)),this.actor.registerMessageHandler("AT",(ye,Me)=>this._getWorkerSource(ye,Me.type,Me.source).abortTile(Me)),this.actor.registerMessageHandler("RMT",(ye,Me)=>this._getWorkerSource(ye,Me.type,Me.source).removeTile(Me)),this.actor.registerMessageHandler("RS",(ye,Me)=>B._(this,void 0,void 0,function*(){if(!this.workerSources[ye]||!this.workerSources[ye][Me.type]||!this.workerSources[ye][Me.type][Me.source])return;const je=this.workerSources[ye][Me.type][Me.source];delete this.workerSources[ye][Me.type][Me.source],je.removeSource!==void 0&&je.removeSource(Me)})),this.actor.registerMessageHandler("RM",ye=>B._(this,void 0,void 0,function*(){delete this.layerIndexes[ye],delete this.availableImages[ye],delete this.workerSources[ye],delete this.demWorkerSources[ye]})),this.actor.registerMessageHandler("SR",(ye,Me)=>B._(this,void 0,void 0,function*(){this.referrer=Me})),this.actor.registerMessageHandler("SRPS",(ye,Me)=>this._syncRTLPluginState(ye,Me)),this.actor.registerMessageHandler("IS",(ye,Me)=>B._(this,void 0,void 0,function*(){this.self.importScripts(Me)})),this.actor.registerMessageHandler("SI",(ye,Me)=>this._setImages(ye,Me)),this.actor.registerMessageHandler("UL",(ye,Me)=>B._(this,void 0,void 0,function*(){this._getLayerIndex(ye).update(Me.layers,Me.removedIds)})),this.actor.registerMessageHandler("SL",(ye,Me)=>B._(this,void 0,void 0,function*(){this._getLayerIndex(ye).replace(Me)}))}_setImages(de,ye){return B._(this,void 0,void 0,function*(){this.availableImages[de]=ye;for(const Me in this.workerSources[de]){const je=this.workerSources[de][Me];for(const Qe in je)je[Qe].availableImages=ye}})}_syncRTLPluginState(de,ye){return B._(this,void 0,void 0,function*(){return yield B.cU.syncState(ye,this.self.importScripts)})}_getAvailableImages(de){let ye=this.availableImages[de];return ye||(ye=[]),ye}_getLayerIndex(de){let ye=this.layerIndexes[de];return ye||(ye=this.layerIndexes[de]=new h),ye}_getWorkerSource(de,ye,Me){if(this.workerSources[de]||(this.workerSources[de]={}),this.workerSources[de][ye]||(this.workerSources[de][ye]={}),!this.workerSources[de][ye][Me]){const je={sendAsync:(Qe,nt)=>(Qe.targetMapId=de,this.actor.sendAsync(Qe,nt))};switch(ye){case"vector":this.workerSources[de][ye][Me]=new Ve(je,this._getLayerIndex(de),this._getAvailableImages(de));break;case"geojson":this.workerSources[de][ye][Me]=new Mh(je,this._getLayerIndex(de),this._getAvailableImages(de));break;default:this.workerSources[de][ye][Me]=new this.externalWorkerSourceTypes[ye](je,this._getLayerIndex(de),this._getAvailableImages(de))}}return this.workerSources[de][ye][Me]}_getDEMWorkerSource(de,ye){return this.demWorkerSources[de]||(this.demWorkerSources[de]={}),this.demWorkerSources[de][ye]||(this.demWorkerSources[de][ye]=new Ee),this.demWorkerSources[de][ye]}}return B.i(self)&&(self.worker=new Eo(self)),Eo}),J("index",["exports","./shared"],function(B,h){var oe="5.6.0";function ge(){var y=new h.A(4);return h.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}let Te,Ve;const Ee={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(y,e,r){const c=requestAnimationFrame(_=>{f(),e(_)}),{unsubscribe:f}=h.s(y.signal,"abort",()=>{f(),cancelAnimationFrame(c),r(h.c())},!1)},frameAsync(y){return new Promise((e,r)=>{this.frame(y,e,r)})},getImageData(y,e=0){return this.getImageCanvasContext(y).getImageData(-e,-e,y.width+2*e,y.height+2*e)},getImageCanvasContext(y){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=y.width,e.height=y.height,r.drawImage(y,0,0,y.width,y.height),r},resolveURL:y=>(Te||(Te=document.createElement("a")),Te.href=y,Te.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ve==null&&(Ve=matchMedia("(prefers-reduced-motion: reduce)")),Ve.matches)}};class pe{static testProp(e){if(!pe.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in pe.docStyle)return e[r];return e[0]}static create(e,r,c){const f=window.document.createElement(e);return r!==void 0&&(f.className=r),c&&c.appendChild(f),f}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){pe.docStyle&&pe.selectProp&&(pe.userSelect=pe.docStyle[pe.selectProp],pe.docStyle[pe.selectProp]="none")}static enableDrag(){pe.docStyle&&pe.selectProp&&(pe.docStyle[pe.selectProp]=pe.userSelect)}static setTransform(e,r){e.style[pe.transformProp]=r}static addEventListener(e,r,c,f={}){e.addEventListener(r,c,"passive"in f?f:f.capture)}static removeEventListener(e,r,c,f={}){e.removeEventListener(r,c,"passive"in f?f:f.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",pe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",pe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",pe.suppressClickInternal,!0)},0)}static getScale(e){const r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,c){const f=r.boundingClientRect;return new h.P((c.clientX-f.left)/r.x-e.clientLeft,(c.clientY-f.top)/r.y-e.clientTop)}static mousePos(e,r){const c=pe.getScale(e);return pe.getPoint(e,c,r)}static touchPos(e,r){const c=[],f=pe.getScale(e);for(let _=0;_<r.length;_++)c.push(pe.getPoint(e,f,r[_]));return c}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),c=r.querySelectorAll("script");for(const f of c)f.remove();return pe.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){const c=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!c.includes("javascript:")&&!c.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const r=e.children;for(const c of r)pe.removeAttributes(c),pe.clean(c)}static removeAttributes(e){for(const{name:r,value:c}of e.attributes)pe.isPossiblyDangerous(r,c)&&e.removeAttribute(r)}}pe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,pe.selectProp=pe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),pe.transformProp=pe.testProp(["transform","WebkitTransform"]);const Se={supported:!1,testSupport:function(y){!Ie&&rt&&(Oe?We(y):Ne=y)}};let Ne,rt,Ie=!1,Oe=!1;function We(y){const e=y.createTexture();y.bindTexture(y.TEXTURE_2D,e);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,rt),y.isContextLost())return;Se.supported=!0}catch{}y.deleteTexture(e),Ie=!0}var ct;typeof document<"u"&&(rt=document.createElement("img"),rt.onload=()=>{Ne&&We(Ne),Ne=null,Oe=!0},rt.onerror=()=>{Ie=!0,Ne=null},rt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let e,r,c,f;y.resetRequestQueue=()=>{e=[],r=0,c=0,f={}},y.addThrottleControl=L=>{const V=c++;return f[V]=L,V},y.removeThrottleControl=L=>{delete f[L],M()},y.getImage=(L,V,q=!0)=>new Promise((K,W)=>{Se.supported&&(L.headers||(L.headers={}),L.headers.accept="image/webp,*/*"),h.e(L,{type:"image"}),e.push({abortController:V,requestParameters:L,supportImageRefresh:q,state:"queued",onError:te=>{W(te)},onSuccess:te=>{K(te)}}),M()});const _=L=>h._(this,void 0,void 0,function*(){L.state="running";const{requestParameters:V,supportImageRefresh:q,onError:K,onSuccess:W,abortController:te}=L,he=q===!1&&!h.i(self)&&!h.g(V.url)&&(!V.headers||Object.keys(V.headers).reduce((ke,ze)=>ke&&ze==="accept",!0));r++;const Ae=he?P(V,te):h.m(V,te);try{const ke=yield Ae;delete L.abortController,L.state="completed",ke.data instanceof HTMLImageElement||h.b(ke.data)?W(ke):ke.data&&W({data:yield(Ce=ke.data,typeof createImageBitmap=="function"?h.f(Ce):h.h(Ce)),cacheControl:ke.cacheControl,expires:ke.expires})}catch(ke){delete L.abortController,K(ke)}finally{r--,M()}var Ce}),M=()=>{const L=(()=>{for(const V of Object.keys(f))if(f[V]())return!0;return!1})()?h.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let V=r;V<L&&e.length>0;V++){const q=e.shift();q.abortController.signal.aborted?V--:_(q)}},P=(L,V)=>new Promise((q,K)=>{const W=new Image,te=L.url,he=L.credentials;he&&he==="include"?W.crossOrigin="use-credentials":(he&&he==="same-origin"||!h.d(te))&&(W.crossOrigin="anonymous"),V.signal.addEventListener("abort",()=>{W.src="",K(h.c())}),W.fetchPriority="high",W.onload=()=>{W.onerror=W.onload=null,q({data:W})},W.onerror=()=>{W.onerror=W.onload=null,V.signal.aborted||K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},W.src=te})}(ct||(ct={})),ct.resetRequestQueue();class Ke{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function pt(y){const e=[];if(typeof y=="string")e.push({id:"default",url:y});else if(y&&y.length>0){const r=[];for(const{id:c,url:f}of y){const _=`${c}${f}`;r.indexOf(_)===-1&&(r.push(_),e.push({id:c,url:f}))}}return e}function Pt(y,e,r){try{const c=new URL(y);return c.pathname+=`${e}${r}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${y}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Ue(y){const{userImage:e}=y;return!!(e&&e.render&&e.render())&&(y.data.replace(new Uint8Array(e.data.buffer)),!0)}class zt extends h.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:r,promiseResolve:c}of this.requestors)c(this._getImagesForIds(r));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const c=r.spriteData;r.data=new h.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let c=!0;const f=r.data||r.spriteData;return this._validateStretch(r.stretchX,f&&f.width)||(this.fire(new h.k(new Error(`Image "${e}" has invalid "stretchX" value`))),c=!1),this._validateStretch(r.stretchY,f&&f.height)||(this.fire(new h.k(new Error(`Image "${e}" has invalid "stretchY" value`))),c=!1),this._validateContent(r.content,r)||(this.fire(new h.k(new Error(`Image "${e}" has invalid "content" value`))),c=!1),c}_validateStretch(e,r){if(!e)return!0;let c=0;for(const f of e){if(f[0]<c||f[1]<f[0]||r<f[1])return!1;c=f[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;const c=r.spriteData,f=c&&c.width||r.data.width,_=c&&c.height||r.data.height;return!(e[0]<0||f<e[0]||e[1]<0||_<e[1]||e[2]<0||f<e[2]||e[3]<0||_<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,c=!0){const f=this.getImage(e);if(c&&(f.data.width!==r.data.width||f.data.height!==r.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=f.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){const r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,c)=>{let f=!0;if(!this.isLoaded())for(const _ of e)this.images[_]||(f=!1);this.isLoaded()||f?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){const r={};for(const c of e){let f=this.getImage(c);f||(this.fire(new h.l("styleimagemissing",{id:c})),f=this.getImage(c)),f?r[c]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:h.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){const r=this.patterns[e],c=this.getImage(e);if(!c)return null;if(r&&r.position.version===c.version)return r.position;if(r)r.position.version=c.version;else{const f={w:c.data.width+2,h:c.data.height+2,x:0,y:0},_=new h.I(f,c);this.patterns[e]={bin:f,position:_}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.T(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const _ in this.patterns)e.push(this.patterns[_].bin);const{w:r,h:c}=h.p(e),f=this.atlasImage;f.resize({width:r||1,height:c||1});for(const _ in this.patterns){const{bin:M}=this.patterns[_],P=M.x+1,L=M.y+1,V=this.getImage(_).data,q=V.width,K=V.height;h.R.copy(V,f,{x:0,y:0},{x:P,y:L},{width:q,height:K}),h.R.copy(V,f,{x:0,y:K-1},{x:P,y:L-1},{width:q,height:1}),h.R.copy(V,f,{x:0,y:0},{x:P,y:L+K},{width:q,height:1}),h.R.copy(V,f,{x:q-1,y:0},{x:P-1,y:L},{width:1,height:K}),h.R.copy(V,f,{x:0,y:0},{x:P+q,y:L},{width:1,height:K})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const c=this.getImage(r);c||h.w(`Image with ID: "${r}" was not found`),Ue(c)&&this.updateImage(r,c)}}}const _t=1e20;function Dt(y,e,r,c,f,_,M,P,L){for(let V=e;V<e+c;V++)ri(y,r*_+V,_,f,M,P,L);for(let V=r;V<r+f;V++)ri(y,V*_+e,1,c,M,P,L)}function ri(y,e,r,c,f,_,M){_[0]=0,M[0]=-1e20,M[1]=_t,f[0]=y[e];for(let P=1,L=0,V=0;P<c;P++){f[P]=y[e+P*r];const q=P*P;do{const K=_[L];V=(f[P]-f[K]+q-K*K)/(P-K)/2}while(V<=M[L]&&--L>-1);L++,_[L]=P,M[L]=V,M[L+1]=_t}for(let P=0,L=0;P<c;P++){for(;M[L+1]<P;)L++;const V=_[L],q=P-V;y[e+P*r]=f[V]+q*q}}class Yt{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return h._(this,void 0,void 0,function*(){const r=[];for(const _ in e)for(const M of e[_])r.push(this._getAndCacheGlyphsPromise(_,M));const c=yield Promise.all(r),f={};for(const{stack:_,id:M,glyph:P}of c)f[_]||(f[_]={}),f[_][M]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};return f})}_getAndCacheGlyphsPromise(e,r){return h._(this,void 0,void 0,function*(){let c=this.entries[e];c||(c=this.entries[e]={glyphs:{},requests:{},ranges:{}});let f=c.glyphs[r];if(f!==void 0)return{stack:e,id:r,glyph:f};if(f=this._tinySDF(c,e,r),f)return c.glyphs[r]=f,{stack:e,id:r,glyph:f};const _=Math.floor(r/256);if(256*_>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[_])return{stack:e,id:r,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[_]){const P=Yt.loadGlyphRange(e,_,this.url,this.requestManager);c.requests[_]=P}const M=yield c.requests[_];for(const P in M)this._doesCharSupportLocalGlyph(+P)||(c.glyphs[+P]=M[+P]);return c.ranges[_]=!0,{stack:e,id:r,glyph:M[r]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||h.u["CJK Unified Ideographs"](e)||h.u["Hangul Syllables"](e)||h.u.Hiragana(e)||h.u.Katakana(e)||h.u["CJK Symbols and Punctuation"](e)||h.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,c){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let _=e.tinySDF;if(!_){let P="400";/bold/i.test(r)?P="900":/medium/i.test(r)?P="500":/light/i.test(r)&&(P="200"),_=e.tinySDF=new Yt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:P})}const M=_.draw(String.fromCharCode(c));return{id:c,bitmap:new h.q({width:M.width||60,height:M.height||60},M.data),metrics:{width:M.glyphWidth/2||24,height:M.glyphHeight/2||24,left:M.glyphLeft/2+.5||0,top:M.glyphTop/2-27.5||-8,advance:M.glyphAdvance/2||24,isDoubleResolution:!0}}}}Yt.loadGlyphRange=function(y,e,r,c){return h._(this,void 0,void 0,function*(){const f=256*e,_=f+255,M=c.transformRequest(r.replace("{fontstack}",y).replace("{range}",`${f}-${_}`),"Glyphs"),P=yield h.n(M,new AbortController);if(!P||!P.data)throw new Error(`Could not load glyph range. range: ${e}, ${f}-${_}`);const L={};for(const V of h.o(P.data))L[V.id]=V;return L})},Yt.TinySDF=class{constructor({fontSize:y=24,buffer:e=3,radius:r=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:M="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=r;const P=this.size=y+4*e,L=this._createCanvas(P),V=this.ctx=L.getContext("2d",{willReadFrequently:!0});V.font=`${M} ${_} ${y}px ${f}`,V.textBaseline="alphabetic",V.textAlign="left",V.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(y){const e=document.createElement("canvas");return e.width=e.height=y,e}draw(y){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(y),M=Math.ceil(r),P=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),L=Math.min(this.size-this.buffer,M+Math.ceil(c)),V=P+2*this.buffer,q=L+2*this.buffer,K=Math.max(V*q,0),W=new Uint8ClampedArray(K),te={data:W,width:V,height:q,glyphWidth:P,glyphHeight:L,glyphTop:M,glyphLeft:0,glyphAdvance:e};if(P===0||L===0)return te;const{ctx:he,buffer:Ae,gridInner:Ce,gridOuter:ke}=this;he.clearRect(Ae,Ae,P,L),he.fillText(y,Ae,Ae+M);const ze=he.getImageData(Ae,Ae,P,L);ke.fill(_t,0,K),Ce.fill(0,0,K);for(let Le=0;Le<L;Le++)for(let De=0;De<P;De++){const Ge=ze.data[4*(Le*P+De)+3]/255;if(Ge===0)continue;const Ye=(Le+Ae)*V+De+Ae;if(Ge===1)ke[Ye]=0,Ce[Ye]=_t;else{const Re=.5-Ge;ke[Ye]=Re>0?Re*Re:0,Ce[Ye]=Re<0?Re*Re:0}}Dt(ke,0,0,V,q,V,this.f,this.v,this.z),Dt(Ce,Ae,Ae,P,L,V,this.f,this.v,this.z);for(let Le=0;Le<K;Le++){const De=Math.sqrt(ke[Le])-Math.sqrt(Ce[Le]);W[Le]=Math.round(255-255*(De/this.radius+this.cutoff))}return te}};class yi{constructor(){this.specification=h.v.light.position}possiblyEvaluate(e,r){return h.B(e.expression.evaluate(r))}interpolate(e,r,c){return{x:h.C.number(e.x,r.x,c),y:h.C.number(e.y,r.y,c),z:h.C.number(e.z,r.z,c)}}}let wi;class gt extends h.E{constructor(e){super(),wi=wi||new h.r({anchor:new h.D(h.v.light.anchor),position:new yi,color:new h.D(h.v.light.color),intensity:new h.D(h.v.light.intensity)}),this._transitionable=new h.t(wi),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(h.x,e,r))for(const c in e){const f=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,c){return(!c||c.validate!==!1)&&h.y(this,e.call(h.z,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:h.v}))}}const It=new h.r({"sky-color":new h.D(h.v.sky["sky-color"]),"horizon-color":new h.D(h.v.sky["horizon-color"]),"fog-color":new h.D(h.v.sky["fog-color"]),"fog-ground-blend":new h.D(h.v.sky["fog-ground-blend"]),"horizon-fog-blend":new h.D(h.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new h.D(h.v.sky["sky-horizon-blend"]),"atmosphere-blend":new h.D(h.v.sky["atmosphere-blend"])});class ti extends h.E{constructor(e){super(),this._transitionable=new h.t(It),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.F(0))}setSky(e,r={}){if(!this._validate(h.G,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in e){const f=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,c={}){return(c==null?void 0:c.validate)!==!1&&h.y(this,e.call(h.z,h.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:h.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class ki{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){const c=e.join(",")+String(r);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(e,r)),this.dashEntry[c]}getDashRanges(e,r,c){const f=[];let _=e.length%2==1?-e[e.length-1]*c:0,M=e[0]*c,P=!0;f.push({left:_,right:M,isDash:P,zeroLength:e[0]===0});let L=e[0];for(let V=1;V<e.length;V++){P=!P;const q=e[V];_=L*c,L+=q,M=L*c,f.push({left:_,right:M,isDash:P,zeroLength:q===0})}return f}addRoundDash(e,r,c){const f=r/2;for(let _=-c;_<=c;_++){const M=this.width*(this.nextRow+c+_);let P=0,L=e[P];for(let V=0;V<this.width;V++){V/L.right>1&&(L=e[++P]);const q=Math.abs(V-L.left),K=Math.abs(V-L.right),W=Math.min(q,K);let te;const he=_/c*(f+1);if(L.isDash){const Ae=f-Math.abs(he);te=Math.sqrt(W*W+Ae*Ae)}else te=f-Math.sqrt(W*W+he*he);this.data[M+V]=Math.max(0,Math.min(255,te+128))}}}addRegularDash(e){for(let P=e.length-1;P>=0;--P){const L=e[P],V=e[P+1];L.zeroLength?e.splice(P,1):V&&V.isDash===L.isDash&&(V.left=L.left,e.splice(P,1))}const r=e[0],c=e[e.length-1];r.isDash===c.isDash&&(r.left=c.left-this.width,c.right=r.right+this.width);const f=this.width*this.nextRow;let _=0,M=e[_];for(let P=0;P<this.width;P++){P/M.right>1&&(M=e[++_]);const L=Math.abs(P-M.left),V=Math.abs(P-M.right),q=Math.min(L,V);this.data[f+P]=Math.max(0,Math.min(255,(M.isDash?q:-q)+128))}}addDash(e,r){const c=r?7:0,f=2*c+1;if(this.nextRow+f>this.height)return h.w("LineAtlas out of space"),null;let _=0;for(let P=0;P<e.length;P++)_+=e[P];if(_!==0){const P=this.width/_,L=this.getDashRanges(e,this.width,P);r?this.addRoundDash(L,P,c):this.addRegularDash(L)}const M={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:_};return this.nextRow+=f,this.dirty=!0,M}bind(e){const r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const qe="maplibre_preloaded_worker_pool";class Ot{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ot.workerCount;)this.workers.push(new Worker(h.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[qe]}numActive(){return Object.keys(this.active).length}}const Ht=Math.floor(Ee.hardwareConcurrency/2);let ii,di;function Qi(){return ii||(ii=new Ot),ii}Ot.workerCount=h.H(globalThis)?Math.max(Math.min(Ht,3),1):1;class Ri{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const c=this.workerPool.acquire(r);for(let f=0;f<c.length;f++){const _=new h.J(c[f],r);_.name=`Worker ${f}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){const c=[];for(const f of this.actors)c.push(f.sendAsync({type:e,data:r}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(const c of this.actors)c.registerMessageHandler(e,r)}}function _n(){return di||(di=new Ri(Qi(),h.K),di.registerMessageHandler("GR",(y,e,r)=>h.m(e,r))),di}function Zr(y,e){const r=h.L();return h.M(r,r,[1,1,0]),h.N(r,r,[.5*y.width,.5*y.height,1]),y.calculatePosMatrix?h.O(r,r,y.calculatePosMatrix(e.toUnwrapped())):r}function Cr(y,e,r,c,f,_,M){var P;const L=function(W,te,he){if(W)for(const Ae of W){const Ce=te[Ae];if(Ce&&Ce.source===he&&Ce.type==="fill-extrusion")return!0}else for(const Ae in te){const Ce=te[Ae];if(Ce.source===he&&Ce.type==="fill-extrusion")return!0}return!1}((P=f==null?void 0:f.layers)!==null&&P!==void 0?P:null,e,y.id),V=_.maxPitchScaleFactor(),q=y.tilesIn(c,V,L);q.sort(Pl);const K=[];for(const W of q)K.push({wrappedTileID:W.tileID.wrapped().key,queryResults:W.tile.queryRenderedFeatures(e,r,y._state,W.queryGeometry,W.cameraQueryGeometry,W.scale,f,_,V,Zr(y.transform,W.tileID),M?(te,he)=>M(W.tileID,te,he):void 0)});return function(W,te){for(const he in W)for(const Ae of W[he])aa(Ae,te);return W}(function(W){const te={},he={};for(const Ae of W){const Ce=Ae.queryResults,ke=Ae.wrappedTileID,ze=he[ke]=he[ke]||{};for(const Le in Ce){const De=Ce[Le],Ge=ze[Le]=ze[Le]||{},Ye=te[Le]=te[Le]||[];for(const Re of De)Ge[Re.featureIndex]||(Ge[Re.featureIndex]=!0,Ye.push(Re))}}return te}(K),y)}function Pl(y,e){const r=y.tileID,c=e.tileID;return r.overscaledZ-c.overscaledZ||r.canonical.y-c.canonical.y||r.wrap-c.wrap||r.canonical.x-c.canonical.x}function aa(y,e){const r=y.feature,c=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=c}function hc(y,e,r){return h._(this,void 0,void 0,function*(){let c=y;if(y.url?c=(yield h.j(e.transformRequest(y.url,"Source"),r)).data:yield Ee.frameAsync(r),!c)return null;const f=h.Q(h.e(c,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(f.vectorLayerIds=c.vector_layers.map(_=>_.id)),f})}class li{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof h.S?new h.S(e.lng,e.lat):h.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof h.S?new h.S(e.lng,e.lat):h.S.convert(e),this}extend(e){const r=this._sw,c=this._ne;let f,_;if(e instanceof h.S)f=e,_=e;else{if(!(e instanceof li))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(li.convert(e)):this.extend(h.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(h.S.convert(e)):this;if(f=e._sw,_=e._ne,!f||!_)return this}return r||c?(r.lng=Math.min(f.lng,r.lng),r.lat=Math.min(f.lat,r.lat),c.lng=Math.max(_.lng,c.lng),c.lat=Math.max(_.lat,c.lat)):(this._sw=new h.S(f.lng,f.lat),this._ne=new h.S(_.lng,_.lat)),this}getCenter(){return new h.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.S(this.getWest(),this.getNorth())}getSouthEast(){return new h.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:c}=h.S.convert(e);let f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(e){return e instanceof li?e:e&&new li(e)}static fromLngLat(e,r=0){const c=360*r/40075017,f=c/Math.cos(Math.PI/180*e.lat);return new li(new h.S(e.lng-f,e.lat-c),new h.S(e.lng+f,e.lat+c))}adjustAntiMeridian(){const e=new h.S(this._sw.lng,this._sw.lat),r=new h.S(this._ne.lng,this._ne.lat);return new li(e,e.lng>r.lng?new h.S(r.lng+360,r.lat):r)}}class Ms{constructor(e,r,c){this.bounds=li.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=c||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),c=Math.floor(h.V(this.bounds.getWest())*r),f=Math.floor(h.U(this.bounds.getNorth())*r),_=Math.ceil(h.V(this.bounds.getEast())*r),M=Math.ceil(h.U(this.bounds.getSouth())*r);return e.x>=c&&e.x<_&&e.y>=f&&e.y<M}}class Va extends h.E{constructor(e,r,c,f){if(super(),this.id=e,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.e(this,h.Q(r,["url","scheme","tileSize","promoteId"])),this._options=h.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield hc(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(h.e(this,e),e.bounds&&(this.tileBounds=new Ms(e.bounds,this.minzoom,this.maxzoom)),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new h.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.e({},this._options)}loadTile(e){return h._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};c.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((_,M)=>{e.reloadPromise={resolve:_,reject:M}})}else e.actor=this.dispatcher.getActor(),f="LT";e.abortController=new AbortController;try{const _=yield e.actor.sendAsync({type:f,data:c},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,_)}catch(_){if(delete e.abortController,e.aborted)return;if(_&&_.status!==404)throw _;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){const c=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(c.resolve).catch(c.reject)}}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class dc extends h.E{constructor(e,r,c,f){super(),this.id=e,this.dispatcher=c,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.e({type:"raster"},r),h.e(this,h.Q(r,["url","scheme","tileSize"]))}load(){return h._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield hc(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(h.e(this,r),r.bounds&&(this.tileBounds=new Ms(r.bounds,this.minzoom,this.maxzoom)),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this.fire(new h.k(r))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return h.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return h._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const c=yield ct.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&(c.cacheControl||c.expires)&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const f=this.map.painter.context,_=f.gl,M=c.data;e.texture=this.map.painter.getTileTexture(M.width),e.texture?e.texture.update(M,{useMipmap:!0}):(e.texture=new h.T(f,M,_.RGBA,{useMipmap:!0}),e.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}})}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class qr extends dc{constructor(e,r,c,f){super(e,r,c,f),this.type="raster-dem",this.maxzoom=22,this._options=h.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return h._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const f=yield ct.getImage(c,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){const _=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const M=h.b(_)&&h.W()?_:yield this.readImageNow(_),P={type:this.type,uid:e.uid,source:this.id,rawImageData:M,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const L=yield e.actor.sendAsync({type:"LDT",data:P});e.dem=L,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}})}readImageNow(e){return h._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&h.X()){const r=e.width+2,c=e.height+2;try{return new h.R({width:r,height:c},yield h.Y(e,-1,-1,r,c))}catch{}}return Ee.getImageData(e,1)})}_getNeighboringTiles(e){const r=e.canonical,c=Math.pow(2,r.z),f=(r.x-1+c)%c,_=r.x===0?e.wrap-1:e.wrap,M=(r.x+1+c)%c,P=r.x+1===c?e.wrap+1:e.wrap,L={};return L[new h.Z(e.overscaledZ,_,r.z,f,r.y).key]={backfilled:!1},L[new h.Z(e.overscaledZ,P,r.z,M,r.y).key]={backfilled:!1},r.y>0&&(L[new h.Z(e.overscaledZ,_,r.z,f,r.y-1).key]={backfilled:!1},L[new h.Z(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},L[new h.Z(e.overscaledZ,P,r.z,M,r.y-1).key]={backfilled:!1}),r.y+1<c&&(L[new h.Z(e.overscaledZ,_,r.z,f,r.y+1).key]={backfilled:!1},L[new h.Z(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},L[new h.Z(e.overscaledZ,P,r.z,M,r.y+1).key]={backfilled:!1}),L}unloadTile(e){return h._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Ga extends h.E{constructor(e,r,c,f){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(f),this._data=r.data,this._options=h.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&h.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=h.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:h.$,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(r.clusterMaxZoom),minPoints:Math.max(2,r.clusterMinPoints||2),extent:h.$,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(h.$/this.tileSize)}_getClusterMaxZoom(e){const r=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||h.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${r}"`),r}load(){return h._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return h._(this,void 0,void 0,function*(){const e=h.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(r=>r.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return h._(this,void 0,void 0,function*(){const e=new li,r=yield this.getData();let c;switch(r.type){case"FeatureCollection":c=r.features.map(f=>this.getCoordinatesFromGeometry(f.geometry)).flat(1/0);break;case"Feature":c=this.getCoordinatesFromGeometry(r.geometry);break;default:c=this.getCoordinatesFromGeometry(r)}if(c.length==0)return e;for(let f=0;f<c.length-1;f+=2)e.extend([c[f],c[f+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:c}})}_updateWorkerData(e){return h._(this,void 0,void 0,function*(){const r=h.e({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(Ee.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new h.l("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new h.l("dataabort",{dataType:"source"}));let f=null;c.resourceTiming&&c.resourceTiming[this.id]&&(f=c.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&h.e(_,{resourceTiming:f}),this.fire(new h.l("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new h.l("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new h.l("dataabort",{dataType:"source"}));this.fire(new h.k(c))}})}loaded(){return this._pendingLoads===0}loadTile(e){return h._(this,void 0,void 0,function*(){const r=e.actor?"RT":"LT";e.actor=this.actor;const c={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};e.abortController=new AbortController;const f=yield this.actor.sendAsync({type:r,data:c},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(f,this.map.painter,r==="RT")})}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class va extends h.E{constructor(e,r,c,f){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=c,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=r}load(e){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield ct.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new h.k(r))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(h.a0.fromLngLat);var c;return this.tileID=function(f){const _=h.a1.fromPoints(f),M=_.width(),P=_.height(),L=Math.max(M,P),V=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),q=Math.pow(2,V);return new h.a3(V,Math.floor((_.minX+_.maxX)/2*q),Math.floor((_.minY+_.maxY)/2*q))}(r),this.terrainTileRanges=this._getOverlappingTileRanges(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(f=>this.tileID.getTilePoint(f)._round()),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new h.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new h.T(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,c=!0)}c&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return h._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:r,minY:c,maxX:f,maxY:_}=h.a1.fromPoints(e),M={};for(let P=0;P<=h.a2;P++){const L=Math.pow(2,P),V=Math.floor(r*L),q=Math.floor(c*L),K=Math.floor(f*L),W=Math.floor(_*L);M[P]={minTileX:V,minTileY:q,maxTileX:K,maxTileY:W}}return M}}class Ao extends va{constructor(e,r,c,f){super(e,r,c,f),this.roundZoom=!0,this.type="video",this.options=r}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield h.a4(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new h.k(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new h.k(new h.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new h.T(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,c=!0)}c&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class $a extends va{constructor(e,r,c,f){super(e,r,c,f),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(M=>typeof M!="number"))||this.fire(new h.k(new h.a5(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.k(new h.a5(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new h.k(new h.a5(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new h.k(new h.a5(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.k(new h.a5(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return h._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,c=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.T(r,this.canvas,c.RGBA,{premultiply:!0});let f=!1;for(const _ in this.tiles){const M=this.tiles[_];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,f=!0)}f&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Ru={},zl=y=>{switch(y){case"geojson":return Ga;case"image":return va;case"raster":return dc;case"raster-dem":return qr;case"vector":return Va;case"video":return Ao;case"canvas":return $a}return Ru[y]},ba="RTLPluginLoaded";class pc extends h.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=_n()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return h._(this,arguments,void 0,function*(r,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Ee.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return h._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.l(ba))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ha=null;function en(){return Ha||(Ha=new pc),Ha}class sa{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=h.a6(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(f,_){const M={};if(!_)return M;for(const P of f){const L=P.layerIds.map(V=>_.getLayer(V)).filter(Boolean);if(L.length!==0){P.layers=L,P.stateDependentLayerIds&&(P.stateDependentLayers=P.stateDependentLayerIds.map(V=>L.filter(q=>q.id===V)[0]));for(const V of L)M[V.id]=P}}return M}(e.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof h.a8){if(this.hasSymbolBuckets=!0,!c)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof h.a8&&_.hasRTLText){this.hasRTLText=!0,en().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(f).queryRadius(_))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new h.a7}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new h.T(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new h.T(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,c,f,_,M,P,L,V,q,K){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:_,scale:M,tileSize:this.tileSize,pixelPosMatrix:q,transform:L,params:P,queryPadding:this.queryPadding*V,getElevation:K},e,r,c):{}}querySourceFeatures(e,r){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),_=r&&r.sourceLayer?r.sourceLayer:"",M=f._geojsonTileLayer||f[_];if(!M)return;const P=h.a9(r&&r.filter),{z:L,x:V,y:q}=this.tileID.canonical,K={z:L,x:V,y:q};for(let W=0;W<M.length;W++){const te=M.feature(W);if(P.needGeometry){const Ce=h.aa(te,!0);if(!P.filter(new h.F(this.tileID.overscaledZ),Ce,this.tileID.canonical))continue}else if(!P.filter(new h.F(this.tileID.overscaledZ),te))continue;const he=c.getId(te,_),Ae=new h.ab(te,L,V,q,he);Ae.tile=K,e.push(Ae)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const c=h.ac(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(r)if(this.expirationTime<r)f=!0;else{const _=this.expirationTime-r;_?this.expirationTime=c+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!r.style.hasLayer(f))continue;const _=this.buckets[f],M=_.layers[0].sourceLayer||"_geojsonTileLayer",P=c[M],L=e[M];if(!P||!L||Object.keys(L).length===0)continue;_.update(L,P,this.imageAtlas&&this.imageAtlas.patternPositions||{});const V=r&&r.style&&r.style.getLayer(f);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ee.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ee.now()+e}setDependencies(e,r){const c={};for(const f of r)c[f]=!0;this.dependencies[e]=c}hasDependency(e,r){for(const c of e){const f=this.dependencies[c];if(f){for(const _ of r)if(f[_])return!0}}return!1}}class oa{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,c){const f=e.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const _={value:r,timeout:void 0};if(c!==void 0&&(_.timeout=setTimeout(()=>{this.remove(e,_)},c)),this.data[f].push(_),this.order.push(f),this.order.length>this.max){const M=this._getAndRemoveByKey(this.order[0]);M&&this.onRemove(M)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const c=e.wrapped().key,f=r===void 0?0:this.data[c].indexOf(r),_=this.data[c][f];return this.data[c].splice(f,1),_.timeout&&clearTimeout(_.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(_.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const c in this.data)for(const f of this.data[c])e(f.value)||r.push(f);for(const c of r)this.remove(c.value.tileID,c)}}class Mh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,c){const f=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},h.e(this.stateChanges[e][f],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const _ in this.state[e])_!==f&&(this.deletedStates[e][_]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][f]===null){this.deletedStates[e][f]={};for(const _ in this.state[e][f])c[_]||(this.deletedStates[e][f][_]=null)}else for(const _ in c)this.deletedStates[e]&&this.deletedStates[e][f]&&this.deletedStates[e][f][_]===null&&delete this.deletedStates[e][f][_]}removeFeatureState(e,r,c){if(this.deletedStates[e]===null)return;const f=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&r!==void 0)this.deletedStates[e][f]!==null&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][c]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][f])for(c in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][c]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,r){const c=String(r),f=h.e({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const _=this.deletedStates[e][r];if(_===null)return{};for(const M in _)delete f[M]}return f}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const M in this.stateChanges[f])this.state[f][M]||(this.state[f][M]={}),h.e(this.state[f][M],this.stateChanges[f][M]),_[M]=this.state[f][M];c[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(this.deletedStates[f]===null)for(const M in this.state[f])_[M]={},this.state[f][M]={};else for(const M in this.deletedStates[f]){if(this.deletedStates[f][M]===null)this.state[f][M]={};else for(const P of Object.keys(this.deletedStates[f][M]))delete this.state[f][M][P];_[M]=this.state[f][M]}c[f]=c[f]||{},h.e(c[f],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in e)e[f].setFeatureState(c,r)}}const Eo=89.25;function lt(y,e){const r=h.ag(e.lat,-85.051129,h.ah);return new h.P(h.V(e.lng)*y,h.U(r)*y)}function de(y,e){return new h.a0(e.x/y,e.y/y).toLngLat()}function ye(y){return y.cameraToCenterDistance*Math.min(.85*Math.tan(h.ad(90-y.pitch)),Math.tan(h.ad(Eo-y.pitch)))}function Me(y,e){const r=y.canonical,c=e/h.ae(r.z),f=r.x+Math.pow(2,r.z)*y.wrap,_=h.af(new Float64Array(16));return h.M(_,_,[f*c,r.y*c,0]),h.N(_,_,[c/h.$,c/h.$,1]),_}function je(y,e,r,c,f){const _=h.a0.fromLngLat(y,e),M=f*h.ai(1,y.lat),P=M*Math.cos(h.ad(r)),L=Math.sqrt(M*M-P*P),V=L*Math.sin(h.ad(-c)),q=L*Math.cos(h.ad(-c));return new h.a0(_.x+V,_.y+q,_.z+P)}function Qe(y,e,r){const c=e.intersectsFrustum(y);if(!r||c===0)return c;const f=e.intersectsPlane(r);return f===0?0:c===2&&f===2?2:1}function nt(y,e,r){let c=0;const f=(r-e)/10;for(let _=0;_<10;_++)c+=f*Math.pow(Math.cos(e+(_+.5)/10*(r-e)),y);return c}function yt(y,e){return function(r,c,f,_,M){const P=2*((y-1)/h.aj(Math.cos(h.ad(Eo-M))/Math.cos(h.ad(Eo)))-1),L=Math.acos(f/_),V=2*nt(P-1,0,h.ad(M/2)),q=Math.min(h.ad(Eo),L+h.ad(M/2)),K=nt(P-1,Math.min(q,L-h.ad(M/2)),q),W=Math.atan(c/f),te=Math.hypot(c,f);let he=r;return he+=h.aj(_/te/Math.max(.5,Math.cos(h.ad(M/2)))),he+=P*h.aj(Math.cos(W))/2,he-=h.aj(Math.max(1,K/V/e))/2,he}}const tt=yt(9.314,3);function Et(y,e){const r=(e.roundZoom?Math.round:Math.floor)(y.zoom+h.aj(y.tileSize/e.tileSize));return Math.max(0,r)}function St(y,e){const r=y.getCameraFrustum(),c=y.getClippingPlane(),f=y.screenPointToMercatorCoordinate(y.getCameraPoint()),_=h.a0.fromLngLat(y.center,y.elevation);f.z=_.z+Math.cos(y.pitchInRadians)*y.cameraToCenterDistance/y.worldSize;const M=y.getCoveringTilesDetailsProvider(),P=M.allowVariableZoom(y,e),L=Et(y,e),V=e.minzoom||0,q=e.maxzoom!==void 0?e.maxzoom:y.maxZoom,K=Math.min(Math.max(0,L),q),W=Math.pow(2,K),te=[W*f.x,W*f.y,0],he=[W*_.x,W*_.y,0],Ae=Math.hypot(_.x-f.x,_.y-f.y),Ce=Math.abs(_.z-f.z),ke=Math.hypot(Ae,Ce),ze=Ge=>({zoom:0,x:0,y:0,wrap:Ge,fullyVisible:!1}),Le=[],De=[];if(y.renderWorldCopies&&M.allowWorldCopies())for(let Ge=1;Ge<=3;Ge++)Le.push(ze(-Ge)),Le.push(ze(Ge));for(Le.push(ze(0));Le.length>0;){const Ge=Le.pop(),Ye=Ge.x,Re=Ge.y;let it=Ge.fullyVisible;const vt={x:Ye,y:Re,z:Ge.zoom},ot=M.getTileBoundingVolume(vt,Ge.wrap,y.elevation,e);if(!it){const Kt=Qe(r,ot,c);if(Kt===0)continue;it=Kt===2}const ft=M.distanceToTile2d(f.x,f.y,vt,ot);let wt=L;P&&(wt=(e.calculateTileZoom||tt)(y.zoom+h.aj(y.tileSize/e.tileSize),ft,Ce,ke,y.fov)),wt=(e.roundZoom?Math.round:Math.floor)(wt),wt=Math.max(0,wt);const ei=Math.min(wt,q);if(Ge.wrap=M.getWrap(_,vt,Ge.wrap),Ge.zoom>=ei){if(Ge.zoom<V)continue;const Kt=K-Ge.zoom,Lt=te[0]-.5-(Ye<<Kt),pi=te[1]-.5-(Re<<Kt),Hi=e.reparseOverscaled?Math.max(Ge.zoom,wt):Ge.zoom;De.push({tileID:new h.Z(Ge.zoom===q?Hi:Ge.zoom,Ge.wrap,Ge.zoom,Ye,Re),distanceSq:h.ak([he[0]-.5-Ye,he[1]-.5-Re]),tileDistanceToCamera:Math.sqrt(Lt*Lt+pi*pi)})}else for(let Kt=0;Kt<4;Kt++)Le.push({zoom:Ge.zoom+1,x:(Ye<<1)+Kt%2,y:(Re<<1)+(Kt>>1),wrap:Ge.wrap,fullyVisible:it})}return De.sort((Ge,Ye)=>Ge.distanceSq-Ye.distanceSq).map(Ge=>Ge.tileID)}const ut=h.a1.fromPoints([new h.P(0,0),new h.P(h.$,h.$)]);class jt extends h.E{constructor(e,r,c){super(),this.id=e,this.dispatcher=c,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,_,M,P)=>{const L=new(zl(_.type))(f,_,M,P);if(L.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${L.id}`);return L})(e,r,c,this),this._tiles={},this._cache=new oa(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mh,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,c){return h._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,c)}catch(f){e.state="errored",f.status!==404?this._source.fire(new h.k(f,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new h.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const c=this._tiles[r];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(He).map(e=>e.key)}getRenderableIds(e){const r=[];for(const c in this._tiles)this._isIdRenderable(c,e)&&r.push(this._tiles[c]);return e?r.sort((c,f)=>{const _=c.tileID,M=f.tileID,P=new h.P(_.canonical.x,_.canonical.y)._rotate(-this.transform.bearingInRadians),L=new h.P(M.canonical.x,M.canonical.y)._rotate(-this.transform.bearingInRadians);return _.overscaledZ-M.overscaledZ||L.y-P.y||L.x-P.x}).map(c=>c.tileID.key):r.map(c=>c.tileID).sort(He).map(c=>c.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)e?this._reloadTile(r,"expired"):this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(e,r){return h._(this,void 0,void 0,function*(){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=r),yield this._loadTile(c,e,r))})}_tileLoaded(e,r,c){e.timeAdded=Ee.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new h.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const r=this.getRenderableIds();for(let f=0;f<r.length;f++){const _=r[f];if(e.neighboringTiles&&e.neighboringTiles[_]){const M=this.getTileByID(_);c(e,M),c(M,e)}}function c(f,_){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let M=_.tileID.canonical.x-f.tileID.canonical.x;const P=_.tileID.canonical.y-f.tileID.canonical.y,L=Math.pow(2,f.tileID.canonical.z),V=_.tileID.key;M===0&&P===0||Math.abs(P)>1||(Math.abs(M)>1&&(Math.abs(M+L)===1?M+=L:Math.abs(M-L)===1&&(M-=L)),_.dem&&f.dem&&(f.dem.backfillBorder(_.dem,M,P),f.neighboringTiles&&f.neighboringTiles[V]&&(f.neighboringTiles[V].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,c,f){for(const _ in this._tiles){let M=this._tiles[_];if(f[_]||!M.hasData()||M.tileID.overscaledZ<=r||M.tileID.overscaledZ>c)continue;let P=M.tileID;for(;M&&M.tileID.overscaledZ>r+1;){const V=M.tileID.scaledTo(M.tileID.overscaledZ-1);M=this._tiles[V.key],M&&M.hasData()&&(P=V)}let L=P;for(;L.overscaledZ>r;)if(L=L.scaledTo(L.overscaledZ-1),e[L.key]||e[L.canonical.key]){f[P.key]=P;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=r?c:null}for(let c=e.overscaledZ-1;c>=r;c--){const f=e.scaledTo(c),_=this._getLoadedTile(f);if(_)return _}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,c=Math.ceil(e.height/this._source.tileSize)+1,f=Math.floor(r*c*(this._maxTileCacheZoomLevels===null?h.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(_)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const c={};for(const f in this._tiles){const _=this._tiles[f];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+r),c[_.tileID.key]=_}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(e,r,c,f,_,M){const P={},L={},V=Object.keys(e),q=Ee.now();for(const K of V){const W=e[K],te=this._tiles[K];if(!te||te.fadeEndTime!==0&&te.fadeEndTime<=q)continue;const he=this.findLoadedParent(W,r),Ae=this.findLoadedSibling(W),Ce=he||Ae||null;Ce&&(this._addTile(Ce.tileID),P[Ce.tileID.key]=Ce.tileID),L[K]=W}this._retainLoadedChildren(L,f,c,e);for(const K in P)e[K]||(this._coveredTiles[K]=!0,e[K]=P[K]);if(M){const K={},W={};for(const te of _)this._tiles[te.key].hasData()?K[te.key]=te:W[te.key]=te;for(const te in W){const he=W[te].children(this._source.maxzoom);this._tiles[he[0].key]&&this._tiles[he[1].key]&&this._tiles[he[2].key]&&this._tiles[he[3].key]&&(K[he[0].key]=e[he[0].key]=he[0],K[he[1].key]=e[he[1].key]=he[1],K[he[2].key]=e[he[2].key]=he[2],K[he[3].key]=e[he[3].key]=he[3],delete W[te])}for(const te in W){const he=W[te],Ae=this.findLoadedParent(he,this._source.minzoom),Ce=this.findLoadedSibling(he),ke=Ae||Ce||null;if(ke){K[ke.tileID.key]=e[ke.tileID.key]=ke.tileID;for(const ze in K)K[ze].isChildOf(ke.tileID)&&delete K[ze]}}for(const te in this._tiles)K[te]||(this._coveredTiles[te]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;let c;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(q=>new h.Z(q.canonical.z,q.wrap,q.canonical.z,q.canonical.x,q.canonical.y)):(c=St(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter(q=>this._source.hasTile(q)))):c=[];const f=Et(e,this._source),_=Math.max(f-jt.maxOverzooming,this._source.minzoom),M=Math.max(f+jt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const q={};for(const K of c)if(K.canonical.z>this._source.minzoom){const W=K.scaledTo(K.canonical.z-1);q[W.key]=W;const te=K.scaledTo(Math.max(this._source.minzoom,Math.min(K.canonical.z,5)));q[te.key]=te}c=c.concat(Object.values(q))}const P=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,P&&this.fire(new h.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const L=this._updateRetainedTiles(c,f);ni(this._source.type)&&this._updateCoveredAndRetainedTiles(L,_,M,f,c,r);for(const q in L)this._tiles[q].clearFadeHold();const V=h.al(this._tiles,L);for(const q of V){const K=this._tiles[q];K.hasSymbolBuckets&&!K.holdingForFade()?K.setHoldDuration(this.map._fadeDuration):K.hasSymbolBuckets&&!K.symbolFadeFinished()||this._removeTile(q)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var c;const f={},_={},M=Math.max(r-jt.maxOverzooming,this._source.minzoom),P=Math.max(r+jt.maxUnderzooming,this._source.minzoom),L={};for(const V of e){const q=this._addTile(V);f[V.key]=V,q.hasData()||r<this._source.maxzoom&&(L[V.key]=V)}this._retainLoadedChildren(L,r,P,f);for(const V of e){let q=this._tiles[V.key];if(q.hasData())continue;if(r+1>this._source.maxzoom){const W=V.children(this._source.maxzoom)[0],te=this.getTile(W);if(te&&te.hasData()){f[W.key]=W;continue}}else{const W=V.children(this._source.maxzoom);if(f[W[0].key]&&f[W[1].key]&&f[W[2].key]&&f[W[3].key])continue}let K=q.wasRequested();for(let W=V.overscaledZ-1;W>=M;--W){const te=V.scaledTo(W);if(_[te.key])break;if(_[te.key]=!0,q=this.getTile(te),!q&&K&&(q=this._addTile(te)),q){const he=q.hasData();if((he||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||K)&&(f[te.key]=te),K=q.wasRequested(),he)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let c,f=this._tiles[e].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}r.push(f.key);const _=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(_),c)break;f=_}for(const _ of r)this._loadedParentTiles[_]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const r=this._tiles[e].tileID,c=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=c}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const c=r;return r||(r=new sa(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,c||this._source.fire(new h.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=r.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}refreshTiles(e){for(const r in this._tiles)(this._isIdRenderable(r)||this._tiles[r].state=="errored")&&e.some(c=>c.equals(this._tiles[r].tileID.canonical))&&this._reloadTile(r,"expired")}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){const r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,c){const f=[],_=this.transform;if(!_)return f;const M=_.getCoveringTilesDetailsProvider().allowWorldCopies(),P=c?_.getCameraQueryGeometry(e):e,L=te=>_.screenPointToMercatorCoordinate(te,this.terrain),V=this.transformBbox(e,L,!M),q=this.transformBbox(P,L,!M),K=this.getIds(),W=h.a1.fromPoints(q);for(let te=0;te<K.length;te++){const he=this._tiles[K[te]];if(he.holdingForFade())continue;const Ae=M?[he.tileID]:[he.tileID.unwrapTo(-1),he.tileID.unwrapTo(0)],Ce=Math.pow(2,_.zoom-he.tileID.overscaledZ),ke=r*he.queryPadding*h.$/he.tileSize/Ce;for(const ze of Ae){const Le=W.map(De=>ze.getTilePoint(new h.a0(De.x,De.y)));if(Le.expandBy(ke),Le.intersects(ut)){const De=V.map(Ye=>ze.getTilePoint(Ye)),Ge=q.map(Ye=>ze.getTilePoint(Ye));f.push({tile:he,tileID:M?ze:ze.unwrapTo(0),queryGeometry:De,cameraQueryGeometry:Ge,scale:Ce})}}}return f}transformBbox(e,r,c){let f=e.map(r);if(c){const _=h.a1.fromPoints(e);_.shrinkBy(.001*Math.min(_.width(),_.height()));const M=_.map(r);h.a1.fromPoints(f).covers(M)||(f=f.map(P=>P.x>.5?new h.a0(P.x-1,P.y,P.z):P))}return f}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(ni(this._source.type)){const e=Ee.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,c){this._state.updateState(e=e||"_geojsonTileLayer",r,c)}removeFeatureState(e,r,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,c)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,c){const f=this._tiles[e];f&&f.setDependencies(r,c)}reloadTilesForDependencies(e,r){for(const c in this._tiles)this._tiles[c].hasDependency(e,r)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(e,r))}}function He(y,e){const r=Math.abs(2*y.wrap)-+(y.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return y.overscaledZ-e.overscaledZ||c-r||e.canonical.y-y.canonical.y||e.canonical.x-y.canonical.x}function ni(y){return y==="raster"||y==="image"||y==="video"}jt.maxOverzooming=10,jt.maxUnderzooming=3;class Pi{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=h.ag(e,0,1);let r=1,c=this._distances[r];const f=e*this.paddedLength+this.padding;for(;c<f&&r<this._distances.length;)c=this._distances[++r];const _=r-1,M=this._distances[_],P=c-M,L=P>0?(f-M)/P:0;return this.points[_].mult(1-L).add(this.points[r].mult(L))}}function ci(y,e){let r=!0;return y==="always"||y!=="never"&&e!=="never"||(r=!1),r}class ai{constructor(e,r,c){const f=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(e/c),this.yCellCount=Math.ceil(r/c);for(let M=0;M<this.xCellCount*this.yCellCount;M++)f.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,c,f,_){this._forEachCell(r,c,f,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(_)}insertCircle(e,r,c,f){this._forEachCell(r-f,c-f,r+f,c+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(c),this.circles.push(f)}_insertBoxCell(e,r,c,f,_,M){this.boxCells[_].push(M)}_insertCircleCell(e,r,c,f,_,M){this.circleCells[_].push(M)}_query(e,r,c,f,_,M,P){if(c<0||e>this.width||f<0||r>this.height)return[];const L=[];if(e<=0&&r<=0&&this.width<=c&&this.height<=f){if(_)return[{key:null,x1:e,y1:r,x2:c,y2:f}];for(let V=0;V<this.boxKeys.length;V++)L.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const q=this.circles[3*V],K=this.circles[3*V+1],W=this.circles[3*V+2];L.push({key:this.circleKeys[V],x1:q-W,y1:K-W,x2:q+W,y2:K+W})}}else this._forEachCell(e,r,c,f,this._queryCell,L,{hitTest:_,overlapMode:M,seenUids:{box:{},circle:{}}},P);return L}query(e,r,c,f){return this._query(e,r,c,f,!1,null)}hitTest(e,r,c,f,_,M){return this._query(e,r,c,f,!0,_,M).length>0}hitTestCircle(e,r,c,f,_){const M=e-c,P=e+c,L=r-c,V=r+c;if(P<0||M>this.width||V<0||L>this.height)return!1;const q=[];return this._forEachCell(M,L,P,V,this._queryCellCircle,q,{hitTest:!0,overlapMode:f,circle:{x:e,y:r,radius:c},seenUids:{box:{},circle:{}}},_),q.length>0}_queryCell(e,r,c,f,_,M,P,L){const{seenUids:V,hitTest:q,overlapMode:K}=P,W=this.boxCells[_];if(W!==null){const he=this.bboxes;for(const Ae of W)if(!V.box[Ae]){V.box[Ae]=!0;const Ce=4*Ae,ke=this.boxKeys[Ae];if(e<=he[Ce+2]&&r<=he[Ce+3]&&c>=he[Ce+0]&&f>=he[Ce+1]&&(!L||L(ke))&&(!q||!ci(K,ke.overlapMode))&&(M.push({key:ke,x1:he[Ce],y1:he[Ce+1],x2:he[Ce+2],y2:he[Ce+3]}),q))return!0}}const te=this.circleCells[_];if(te!==null){const he=this.circles;for(const Ae of te)if(!V.circle[Ae]){V.circle[Ae]=!0;const Ce=3*Ae,ke=this.circleKeys[Ae];if(this._circleAndRectCollide(he[Ce],he[Ce+1],he[Ce+2],e,r,c,f)&&(!L||L(ke))&&(!q||!ci(K,ke.overlapMode))){const ze=he[Ce],Le=he[Ce+1],De=he[Ce+2];if(M.push({key:ke,x1:ze-De,y1:Le-De,x2:ze+De,y2:Le+De}),q)return!0}}}return!1}_queryCellCircle(e,r,c,f,_,M,P,L){const{circle:V,seenUids:q,overlapMode:K}=P,W=this.boxCells[_];if(W!==null){const he=this.bboxes;for(const Ae of W)if(!q.box[Ae]){q.box[Ae]=!0;const Ce=4*Ae,ke=this.boxKeys[Ae];if(this._circleAndRectCollide(V.x,V.y,V.radius,he[Ce+0],he[Ce+1],he[Ce+2],he[Ce+3])&&(!L||L(ke))&&!ci(K,ke.overlapMode))return M.push(!0),!0}}const te=this.circleCells[_];if(te!==null){const he=this.circles;for(const Ae of te)if(!q.circle[Ae]){q.circle[Ae]=!0;const Ce=3*Ae,ke=this.circleKeys[Ae];if(this._circlesCollide(he[Ce],he[Ce+1],he[Ce+2],V.x,V.y,V.radius)&&(!L||L(ke))&&!ci(K,ke.overlapMode))return M.push(!0),!0}}}_forEachCell(e,r,c,f,_,M,P,L){const V=this._convertToXCellCoord(e),q=this._convertToYCellCoord(r),K=this._convertToXCellCoord(c),W=this._convertToYCellCoord(f);for(let te=V;te<=K;te++)for(let he=q;he<=W;he++)if(_.call(this,e,r,c,f,this.xCellCount*he+te,M,P,L))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,c,f,_,M){const P=f-e,L=_-r,V=c+M;return V*V>P*P+L*L}_circleAndRectCollide(e,r,c,f,_,M,P){const L=(M-f)/2,V=Math.abs(e-(f+L));if(V>L+c)return!1;const q=(P-_)/2,K=Math.abs(r-(_+q));if(K>q+c)return!1;if(V<=L||K<=q)return!0;const W=V-L,te=K-q;return W*W+te*te<=c*c}}function Ai(y,e,r){const c=h.L();if(!y){const{vecSouth:K,vecEast:W}=Wi(e),te=ge();te[0]=W[0],te[1]=W[1],te[2]=K[0],te[3]=K[1],f=te,(q=(M=(_=te)[0])*(V=_[3])-(L=_[2])*(P=_[1]))&&(f[0]=V*(q=1/q),f[1]=-P*q,f[2]=-L*q,f[3]=M*q),c[0]=te[0],c[1]=te[1],c[4]=te[2],c[5]=te[3]}var f,_,M,P,L,V,q;return h.N(c,c,[1/r,1/r,1]),c}function tr(y,e,r,c){if(y){const f=h.L();if(!e){const{vecSouth:_,vecEast:M}=Wi(r);f[0]=M[0],f[1]=M[1],f[4]=_[0],f[5]=_[1]}return h.N(f,f,[c,c,1]),f}return r.pixelsToClipSpaceMatrix}function Wi(y){const e=Math.cos(y.rollInRadians),r=Math.sin(y.rollInRadians),c=Math.cos(y.pitchInRadians),f=Math.cos(y.bearingInRadians),_=Math.sin(y.bearingInRadians),M=h.aq();M[0]=-f*c*r-_*e,M[1]=-_*c*r+f*e;const P=h.ar(M);P<1e-9?h.as(M):h.at(M,M,1/P);const L=h.aq();L[0]=f*c*e-_*r,L[1]=_*c*e+f*r;const V=h.ar(L);return V<1e-9?h.as(L):h.at(L,L,1/V),{vecEast:L,vecSouth:M}}function ur(y,e,r,c){let f;c?(f=[y,e,c(y,e),1],h.av(f,f,r)):(f=[y,e,0,1],Ll(f,f,r));const _=f[3];return{point:new h.P(f[0]/_,f[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function bi(y,e){return .5+y/e*.5}function fr(y,e){return y.x>=-e[0]&&y.x<=e[0]&&y.y>=-e[1]&&y.y<=e[1]}function Kn(y,e,r,c,f,_,M,P,L,V,q,K,W){const te=r?y.textSizeData:y.iconSizeData,he=h.am(te,e.transform.zoom),Ae=[256/e.width*2+1,256/e.height*2+1],Ce=r?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;Ce.clear();const ke=y.lineVertexArray,ze=r?y.text.placedSymbolArray:y.icon.placedSymbolArray,Le=e.transform.width/e.transform.height;let De=!1;for(let Ge=0;Ge<ze.length;Ge++){const Ye=ze.get(Ge);if(Ye.hidden||Ye.writingMode===h.an.vertical&&!De){Qo(Ye.numGlyphs,Ce);continue}De=!1;const Re=new h.P(Ye.anchorX,Ye.anchorY),it={getElevation:W,pitchedLabelPlaneMatrix:c,lineVertexArray:ke,pitchWithMap:_,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:Re,unwrappedTileID:L,width:V,height:q,translation:K},vt=Mi(Ye.anchorX,Ye.anchorY,it);if(!fr(vt.point,Ae)){Qo(Ye.numGlyphs,Ce);continue}const ot=bi(e.transform.cameraToCenterDistance,vt.signedDistanceFromCamera),ft=h.ao(te,he,Ye),wt=_?ft*e.transform.getPitchedTextCorrection(Ye.anchorX,Ye.anchorY,L)/ot:ft*ot,ei=Ur({projectionContext:it,pitchedLabelPlaneMatrixInverse:f,symbol:Ye,fontSize:wt,flip:!1,keepUpright:M,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:Ce,aspectRatio:Le,rotateToLine:P});De=ei.useVertical,(ei.notEnoughRoom||De||ei.needsFlipping&&Ur({projectionContext:it,pitchedLabelPlaneMatrixInverse:f,symbol:Ye,fontSize:wt,flip:!0,keepUpright:M,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:Ce,aspectRatio:Le,rotateToLine:P}).notEnoughRoom)&&Qo(Ye.numGlyphs,Ce)}r?y.text.dynamicLayoutVertexBuffer.updateData(Ce):y.icon.dynamicLayoutVertexBuffer.updateData(Ce)}function Wt(y,e,r,c,f,_,M,P){const L=_.glyphStartIndex+_.numGlyphs,V=_.lineStartIndex,q=_.lineStartIndex+_.lineLength,K=e.getoffsetX(_.glyphStartIndex),W=e.getoffsetX(L-1),te=wa(y*K,r,c,f,_.segment,V,q,P,M);if(!te)return null;const he=wa(y*W,r,c,f,_.segment,V,q,P,M);return he?P.projectionCache.anyProjectionOccluded?null:{first:te,last:he}:null}function Cn(y,e,r,c){return y===h.an.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*c?{useVertical:!0}:(y===h.an.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function Ur(y){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:c,fontSize:f,flip:_,keepUpright:M,glyphOffsetArray:P,dynamicLayoutVertexArray:L,aspectRatio:V,rotateToLine:q}=y,K=f/24,W=c.lineOffsetX*K,te=c.lineOffsetY*K;let he;if(c.numGlyphs>1){const Ae=c.glyphStartIndex+c.numGlyphs,Ce=c.lineStartIndex,ke=c.lineStartIndex+c.lineLength,ze=Wt(K,P,W,te,_,c,q,e);if(!ze)return{notEnoughRoom:!0};const Le=Fi(ze.first.point.x,ze.first.point.y,e,r),De=Fi(ze.last.point.x,ze.last.point.y,e,r);if(M&&!_){const Ge=Cn(c.writingMode,Le,De,V);if(Ge)return Ge}he=[ze.first];for(let Ge=c.glyphStartIndex+1;Ge<Ae-1;Ge++){const Ye=wa(K*P.getoffsetX(Ge),W,te,_,c.segment,Ce,ke,e,q);if(!Ye)return{notEnoughRoom:!0};he.push(Ye)}he.push(ze.last)}else{if(M&&!_){const Ce=Jt(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ke=c.lineStartIndex+c.segment+1,ze=new h.P(e.lineVertexArray.getx(ke),e.lineVertexArray.gety(ke)),Le=Jt(ze.x,ze.y,e),De=Le.signedDistanceFromCamera>0?Le.point:es(e.tileAnchorPoint,ze,Ce,1,e),Ge=Fi(Ce.x,Ce.y,e,r),Ye=Fi(De.x,De.y,e,r),Re=Cn(c.writingMode,Ge,Ye,V);if(Re)return Re}const Ae=wa(K*P.getoffsetX(c.glyphStartIndex),W,te,_,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,e,q);if(!Ae||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};he=[Ae]}for(const Ae of he)h.au(L,Ae.point,Ae.angle);return{}}function es(y,e,r,c,f){const _=y.add(y.sub(e)._unit()),M=Jt(_.x,_.y,f).point,P=r.sub(M);return r.add(P._mult(c/P.mag()))}function Cs(y,e,r){const c=e.projectionCache;if(c.projections[y])return c.projections[y];const f=new h.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),_=Jt(f.x,f.y,e);if(_.signedDistanceFromCamera>0)return c.projections[y]=_.point,c.anyProjectionOccluded=c.anyProjectionOccluded||_.isOccluded,_.point;const M=y-r.direction;return es(r.distanceFromAnchor===0?e.tileAnchorPoint:new h.P(e.lineVertexArray.getx(M),e.lineVertexArray.gety(M)),f,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,e)}function Jt(y,e,r){const c=y+r.translation[0],f=e+r.translation[1];let _;return r.pitchWithMap?(_=ur(c,f,r.pitchedLabelPlaneMatrix,r.getElevation),_.isOccluded=!1):(_=r.transform.projectTileCoordinates(c,f,r.unwrappedTileID,r.getElevation),_.point.x=(.5*_.point.x+.5)*r.width,_.point.y=(.5*-_.point.y+.5)*r.height),_}function Fi(y,e,r,c){if(r.pitchWithMap){const f=[y,e,0,1];return h.av(f,f,c),r.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],r.unwrappedTileID,r.getElevation).point}return{x:y/r.width*2-1,y:e/r.height*2-1}}function Mi(y,e,r){return r.transform.projectTileCoordinates(y,e,r.unwrappedTileID,r.getElevation)}function Dr(y,e,r){return y._unit()._perp()._mult(e*r)}function Qc(y,e,r,c,f,_,M,P,L){if(P.projectionCache.offsets[y])return P.projectionCache.offsets[y];const V=r.add(e);if(y+L.direction<c||y+L.direction>=f)return P.projectionCache.offsets[y]=V,V;const q=Cs(y+L.direction,P,L),K=Dr(q.sub(r),M,L.direction),W=r.add(K),te=q.add(K);return P.projectionCache.offsets[y]=h.aw(_,V,W,te)||V,P.projectionCache.offsets[y]}function wa(y,e,r,c,f,_,M,P,L){const V=c?y-e:y+e;let q=V>0?1:-1,K=0;c&&(q*=-1,K=Math.PI),q<0&&(K+=Math.PI);let W,te=q>0?_+f:_+f+1;P.projectionCache.cachedAnchorPoint?W=P.projectionCache.cachedAnchorPoint:(W=Jt(P.tileAnchorPoint.x,P.tileAnchorPoint.y,P).point,P.projectionCache.cachedAnchorPoint=W);let he,Ae,Ce=W,ke=W,ze=0,Le=0;const De=Math.abs(V),Ge=[];let Ye;for(;ze+Le<=De;){if(te+=q,te<_||te>=M)return null;ze+=Le,ke=Ce,Ae=he;const vt={absOffsetX:De,direction:q,distanceFromAnchor:ze,previousVertex:ke};if(Ce=Cs(te,P,vt),r===0)Ge.push(ke),Ye=Ce.sub(ke);else{let ot;const ft=Ce.sub(ke);ot=ft.mag()===0?Dr(Cs(te+q,P,vt).sub(Ce),r,q):Dr(ft,r,q),Ae||(Ae=ke.add(ot)),he=Qc(te,ot,Ce,_,M,Ae,r,P,vt),Ge.push(Ae),Ye=he.sub(Ae)}Le=Ye.mag()}const Re=Ye._mult((De-ze)/Le)._add(Ae||ke),it=K+Math.atan2(Ce.y-ke.y,Ce.x-ke.x);return Ge.push(Re),{point:Re,angle:L?it:0,path:Ge}}const Zi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Qo(y,e){for(let r=0;r<y;r++){const c=e.length;e.resize(c+4),e.float32.set(Zi,3*c)}}function Ll(y,e,r){const c=e[0],f=e[1];return y[0]=r[0]*c+r[4]*f+r[12],y[1]=r[1]*c+r[5]*f+r[13],y[3]=r[3]*c+r[7]*f+r[15],y}const fn=100;class Iu{constructor(e,r=new ai(e.width+200,e.height+200,25),c=new ai(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=c,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+fn,this.screenBottomBoundary=e.height+fn,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,c,f,_,M,P,L,V,q,K,W){const te=this.projectAndGetPerspectiveRatio(e.anchorPointX+L[0],e.anchorPointY+L[1],_,q,W),he=c*te.perspectiveRatio;let Ae;if(M||P)Ae=this._projectCollisionBox(e,he,f,_,M,P,L,te,q,K,W);else{const Ye=te.x+(K?K.x*he:0),Re=te.y+(K?K.y*he:0);Ae={allPointsOccluded:!1,box:[Ye+e.x1*he,Re+e.y1*he,Ye+e.x2*he,Re+e.y2*he]}}const[Ce,ke,ze,Le]=Ae.box,De=M?Ae.allPointsOccluded:te.isOccluded;let Ge=De;return Ge||(Ge=te.perspectiveRatio<this.perspectiveRatioCutoff),Ge||(Ge=!this.isInsideGrid(Ce,ke,ze,Le)),Ge||r!=="always"&&this.grid.hitTest(Ce,ke,ze,Le,r,V)?{box:[Ce,ke,ze,Le],placeable:!1,offscreen:!1,occluded:De}:{box:[Ce,ke,ze,Le],placeable:!0,offscreen:this.isOffscreen(Ce,ke,ze,Le),occluded:De}}placeCollisionCircles(e,r,c,f,_,M,P,L,V,q,K,W,te,he){const Ae=[],Ce=new h.P(r.anchorX,r.anchorY),ke=this.getPerspectiveRatio(Ce.x,Ce.y,M,he),ze=(V?_*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,M)/ke:_*ke)/h.aA,Le={getElevation:he,pitchedLabelPlaneMatrix:P,lineVertexArray:c,pitchWithMap:V,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Ce,unwrappedTileID:M,width:this.transform.width,height:this.transform.height,translation:te},De=Wt(ze,f,r.lineOffsetX*ze,r.lineOffsetY*ze,!1,r,!1,Le);let Ge=!1,Ye=!1,Re=!0;if(De){const it=.5*K*ke+W,vt=new h.P(-100,-100),ot=new h.P(this.screenRightBoundary,this.screenBottomBoundary),ft=new Pi,wt=De.first,ei=De.last;let Kt=[];for(let Hi=wt.path.length-1;Hi>=1;Hi--)Kt.push(wt.path[Hi]);for(let Hi=1;Hi<ei.path.length;Hi++)Kt.push(ei.path[Hi]);const Lt=2.5*it;if(V){const Hi=this.projectPathToScreenSpace(Kt,Le);Kt=Hi.some(xr=>xr.signedDistanceFromCamera<=0)?[]:Hi.map(xr=>xr.point)}let pi=[];if(Kt.length>0){const Hi=Kt[0].clone(),xr=Kt[0].clone();for(let Xi=1;Xi<Kt.length;Xi++)Hi.x=Math.min(Hi.x,Kt[Xi].x),Hi.y=Math.min(Hi.y,Kt[Xi].y),xr.x=Math.max(xr.x,Kt[Xi].x),xr.y=Math.max(xr.y,Kt[Xi].y);pi=Hi.x>=vt.x&&xr.x<=ot.x&&Hi.y>=vt.y&&xr.y<=ot.y?[Kt]:xr.x<vt.x||Hi.x>ot.x||xr.y<vt.y||Hi.y>ot.y?[]:h.ax([Kt],vt.x,vt.y,ot.x,ot.y)}for(const Hi of pi){ft.reset(Hi,.25*it);let xr=0;xr=ft.length<=.5*it?1:Math.ceil(ft.paddedLength/Lt)+1;for(let Xi=0;Xi<xr;Xi++){const jr=Xi/Math.max(xr-1,1),tn=ft.lerp(jr),cr=tn.x+fn,nr=tn.y+fn;Ae.push(cr,nr,it,0);const Fr=cr-it,Gn=nr-it,hr=cr+it,$n=nr+it;if(Re=Re&&this.isOffscreen(Fr,Gn,hr,$n),Ye=Ye||this.isInsideGrid(Fr,Gn,hr,$n),e!=="always"&&this.grid.hitTestCircle(cr,nr,it,e,q)&&(Ge=!0,!L))return{circles:[],offscreen:!1,collisionDetected:Ge}}}}return{circles:!L&&Ge||!Ye||ke<this.perspectiveRatioCutoff?[]:Ae,offscreen:Re,collisionDetected:Ge}}projectPathToScreenSpace(e,r){const c=function(f,_){const M=h.L();return h.ap(M,_.pitchedLabelPlaneMatrix),f.map(P=>{const L=ur(P.x,P.y,M,_.getElevation),V=_.transform.projectTileCoordinates(L.point.x,L.point.y,_.unwrappedTileID,_.getElevation);return V.point.x=(.5*V.point.x+.5)*_.width,V.point.y=(.5*-V.point.y+.5)*_.height,V})}(e,r);return function(f){let _=0,M=0,P=0,L=0;for(let V=0;V<f.length;V++)f[V].isOccluded?(P=V+1,L=0):(L++,L>M&&(M=L,_=P));return f.slice(_,_+M)}(c)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[],c=new h.a1;for(const K of e){const W=new h.P(K.x+fn,K.y+fn);c.extend(W),r.push(W)}const{minX:f,minY:_,maxX:M,maxY:P}=c,L=this.grid.query(f,_,M,P).concat(this.ignoredGrid.query(f,_,M,P)),V={},q={};for(const K of L){const W=K.key;if(V[W.bucketInstanceId]===void 0&&(V[W.bucketInstanceId]={}),V[W.bucketInstanceId][W.featureIndex])continue;const te=[new h.P(K.x1,K.y1),new h.P(K.x2,K.y1),new h.P(K.x2,K.y2),new h.P(K.x1,K.y2)];h.ay(r,te)&&(V[W.bucketInstanceId][W.featureIndex]=!0,q[W.bucketInstanceId]===void 0&&(q[W.bucketInstanceId]=[]),q[W.bucketInstanceId].push(W.featureIndex))}return q}insertCollisionBox(e,r,c,f,_,M){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:M,overlapMode:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,c,f,_,M){const P=c?this.ignoredGrid:this.grid,L={bucketInstanceId:f,featureIndex:_,collisionGroupID:M,overlapMode:r};for(let V=0;V<e.length;V+=4)P.insertCircle(L,e[V],e[V+1],e[V+2])}projectAndGetPerspectiveRatio(e,r,c,f,_){if(_){let M;f?(M=[e,r,f(e,r),1],h.av(M,M,_)):(M=[e,r,0,1],Ll(M,M,_));const P=M[3];return{x:(M[0]/P+1)/2*this.transform.width+fn,y:(-M[1]/P+1)/2*this.transform.height+fn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P*.5,isOccluded:!1,signedDistanceFromCamera:P}}{const M=this.transform.projectTileCoordinates(e,r,c,f);return{x:(M.point.x+1)/2*this.transform.width+fn,y:(1-M.point.y)/2*this.transform.height+fn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/M.signedDistanceFromCamera*.5,isOccluded:M.isOccluded,signedDistanceFromCamera:M.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,c,f){const _=this.transform.projectTileCoordinates(e,r,c,f);return .5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5}isOffscreen(e,r,c,f){return c<fn||e>=this.screenRightBoundary||f<fn||r>this.screenBottomBoundary}isInsideGrid(e,r,c,f){return c>=0&&e<this.gridRightBoundary&&f>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=h.af([]);return h.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,c,f,_,M,P,L,V,q,K){let W=1,te=0,he=0,Ae=1;const Ce=e.anchorPointX+P[0],ke=e.anchorPointY+P[1];if(M&&!_){const Kt=this.projectAndGetPerspectiveRatio(Ce+1,ke,f,V,K),Lt=Kt.x-L.x,pi=Math.atan((Kt.y-L.y)/Lt)+(Lt<0?Math.PI:0),Hi=Math.sin(pi),xr=Math.cos(pi);W=xr,te=Hi,he=-Hi,Ae=xr}else if(!M&&_){const Kt=Wi(this.transform);W=Kt.vecEast[0],te=Kt.vecEast[1],he=Kt.vecSouth[0],Ae=Kt.vecSouth[1]}let ze=L.x,Le=L.y,De=r;_&&(ze=Ce,Le=ke,De=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),De*=this.transform.getPitchedTextCorrection(Ce,ke,f),q||(De*=h.ag(.5+L.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),q&&(ze+=W*q.x*De+he*q.y*De,Le+=te*q.x*De+Ae*q.y*De);const Ge=e.x1*De,Ye=e.x2*De,Re=(Ge+Ye)/2,it=e.y1*De,vt=e.y2*De,ot=(it+vt)/2,ft=[{offsetX:Ge,offsetY:it},{offsetX:Re,offsetY:it},{offsetX:Ye,offsetY:it},{offsetX:Ye,offsetY:ot},{offsetX:Ye,offsetY:vt},{offsetX:Re,offsetY:vt},{offsetX:Ge,offsetY:vt},{offsetX:Ge,offsetY:ot}];let wt=[];for(const{offsetX:Kt,offsetY:Lt}of ft)wt.push(new h.P(ze+W*Kt+he*Lt,Le+te*Kt+Ae*Lt));let ei=!1;if(_){const Kt=wt.map(Lt=>this.projectAndGetPerspectiveRatio(Lt.x,Lt.y,f,V,K));ei=Kt.some(Lt=>!Lt.isOccluded),wt=Kt.map(Lt=>new h.P(Lt.x,Lt.y))}else ei=!0;return{box:h.az(wt),allPointsOccluded:!ei}}}class Jo{constructor(e,r,c,f){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):f&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class hs{constructor(e,r,c,f,_){this.text=new Jo(e?e.text:null,r,c,_),this.icon=new Jo(e?e.icon:null,r,f,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ds{constructor(e,r,c){this.text=e,this.icon=r,this.skipFade=c}}class la{constructor(e,r,c,f,_){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=c,this.bucketIndex=f,this.tileID=_}}class Vr{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:c=>c.collisionGroupID===r}}return this.collisionGroups[e]}}function fc(y,e,r,c,f){const{horizontalAlign:_,verticalAlign:M}=h.aG(y);return new h.P(-(_-.5)*e+c[0]*f,-(M-.5)*r+c[1]*f)}class Er{constructor(e,r,c,f,_){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new Iu(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Vr(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const r=this.terrain;return r?(c,f)=>r.getElevation(e,c,f):null}getBucketParts(e,r,c,f){const _=c.getBucket(r),M=c.latestFeatureIndex;if(!_||!M||r.id!==_.layerIds[0])return;const P=c.collisionBoxArray,L=_.layers[0].layout,V=_.layers[0].paint,q=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),K=c.tileSize/h.$,W=c.tileID.toUnwrapped(),te=L.get("text-rotation-alignment")==="map",he=h.aB(c,1,this.transform.zoom),Ae=h.aC(this.collisionIndex.transform,c,V.get("text-translate"),V.get("text-translate-anchor")),Ce=h.aC(this.collisionIndex.transform,c,V.get("icon-translate"),V.get("icon-translate-anchor")),ke=Ai(te,this.transform,he);this.retainedQueryData[_.bucketInstanceId]=new la(_.bucketInstanceId,M,_.sourceLayerIndex,_.index,c.tileID);const ze={bucket:_,layout:L,translationText:Ae,translationIcon:Ce,unwrappedTileID:W,pitchedLabelPlaneMatrix:ke,scale:q,textPixelRatio:K,holdingForFade:c.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:h.am(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(f)for(const Le of _.sortKeyRanges){const{sortKey:De,symbolInstanceStart:Ge,symbolInstanceEnd:Ye}=Le;e.push({sortKey:De,symbolInstanceStart:Ge,symbolInstanceEnd:Ye,parameters:ze})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:ze})}attemptAnchorPlacement(e,r,c,f,_,M,P,L,V,q,K,W,te,he,Ae,Ce,ke,ze,Le,De){const Ge=h.aD[e.textAnchor],Ye=[e.textOffset0,e.textOffset1],Re=fc(Ge,c,f,Ye,_),it=this.collisionIndex.placeCollisionBox(r,W,L,V,q,P,M,Ce,K.predicate,Le,Re,De);if((!ze||this.collisionIndex.placeCollisionBox(ze,W,L,V,q,P,M,ke,K.predicate,Le,Re,De).placeable)&&it.placeable){let vt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID].text&&(vt=this.prevPlacement.variableOffsets[te.crossTileID].anchor),te.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[te.crossTileID]={textOffset:Ye,width:c,height:f,anchor:Ge,textBoxScale:_,prevAnchor:vt},this.markUsedJustification(he,Ge,te,Ae),he.allowVerticalPlacement&&(this.markUsedOrientation(he,Ae,te),this.placedOrientations[te.crossTileID]=Ae),{shift:Re,placedGlyphBoxes:it}}}placeLayerBucketPart(e,r,c){const{bucket:f,layout:_,translationText:M,translationIcon:P,unwrappedTileID:L,pitchedLabelPlaneMatrix:V,textPixelRatio:q,holdingForFade:K,collisionBoxArray:W,partiallyEvaluatedTextSize:te,collisionGroup:he}=e.parameters,Ae=_.get("text-optional"),Ce=_.get("icon-optional"),ke=h.aE(_,"text-overlap","text-allow-overlap"),ze=ke==="always",Le=h.aE(_,"icon-overlap","icon-allow-overlap"),De=Le==="always",Ge=_.get("text-rotation-alignment")==="map",Ye=_.get("text-pitch-alignment")==="map",Re=_.get("icon-text-fit")!=="none",it=_.get("symbol-z-order")==="viewport-y",vt=ze&&(De||!f.hasIconData()||Ce),ot=De&&(ze||!f.hasTextData()||Ae);!f.collisionArrays&&W&&f.deserializeCollisionBoxes(W);const ft=this.retainedQueryData[f.bucketInstanceId].tileID,wt=this._getTerrainElevationFunc(ft),ei=this.transform.getFastPathSimpleProjectionMatrix(ft),Kt=(Lt,pi,Hi)=>{var xr,Xi;if(r[Lt.crossTileID])return;if(K)return void(this.placements[Lt.crossTileID]=new ds(!1,!1,!1));let jr=!1,tn=!1,cr=!0,nr=null,Fr={box:null,placeable:!1,offscreen:null,occluded:!1},Gn={placeable:!1},hr=null,$n=null,Jn=null,Yl=0,wl=0,Ka=0;pi.textFeatureIndex?Yl=pi.textFeatureIndex:Lt.useRuntimeCollisionCircles&&(Yl=Lt.featureIndex),pi.verticalTextFeatureIndex&&(wl=pi.verticalTextFeatureIndex);const Bs=pi.textBox;if(Bs){const ya=mr=>{let Br=h.an.horizontal;if(f.allowVerticalPlacement&&!mr&&this.prevPlacement){const ea=this.prevPlacement.placedOrientations[Lt.crossTileID];ea&&(this.placedOrientations[Lt.crossTileID]=ea,Br=ea,this.markUsedOrientation(f,Br,Lt))}return Br},Un=(mr,Br)=>{if(f.allowVerticalPlacement&&Lt.numVerticalGlyphVertices>0&&pi.verticalTextBox){for(const ea of f.writingModes)if(ea===h.an.vertical?(Fr=Br(),Gn=Fr):Fr=mr(),Fr&&Fr.placeable)break}else Fr=mr()},Go=Lt.textAnchorOffsetStartIndex,Ss=Lt.textAnchorOffsetEndIndex;if(Ss===Go){const mr=(Br,ea)=>{const gn=this.collisionIndex.placeCollisionBox(Br,ke,q,ft,L,Ye,Ge,M,he.predicate,wt,void 0,ei);return gn&&gn.placeable&&(this.markUsedOrientation(f,ea,Lt),this.placedOrientations[Lt.crossTileID]=ea),gn};Un(()=>mr(Bs,h.an.horizontal),()=>{const Br=pi.verticalTextBox;return f.allowVerticalPlacement&&Lt.numVerticalGlyphVertices>0&&Br?mr(Br,h.an.vertical):{box:null,offscreen:null}}),ya(Fr&&Fr.placeable)}else{let mr=h.aD[(Xi=(xr=this.prevPlacement)===null||xr===void 0?void 0:xr.variableOffsets[Lt.crossTileID])===null||Xi===void 0?void 0:Xi.anchor];const Br=(gn,lh,Vh)=>{const ch=gn.x2-gn.x1,Ns=gn.y2-gn.y1,Dc=Lt.textBoxScale,wn=Re&&Le==="never"?lh:null;let Gr=null,Ra=ke==="never"?1:2,uh="never";mr&&Ra++;for(let Ln=0;Ln<Ra;Ln++){for(let Qa=Go;Qa<Ss;Qa++){const Sn=f.textAnchorOffsets.get(Qa);if(mr&&Sn.textAnchor!==mr)continue;const Ql=this.attemptAnchorPlacement(Sn,gn,ch,Ns,Dc,Ge,Ye,q,ft,L,he,uh,Lt,f,Vh,M,P,wn,wt);if(Ql&&(Gr=Ql.placedGlyphBoxes,Gr&&Gr.placeable))return jr=!0,nr=Ql.shift,Gr}mr?mr=null:uh=ke}return c&&!Gr&&(Gr={box:this.collisionIndex.placeCollisionBox(Bs,"always",q,ft,L,Ye,Ge,M,he.predicate,wt,void 0,ei).box,offscreen:!1,placeable:!1,occluded:!1}),Gr};Un(()=>Br(Bs,pi.iconBox,h.an.horizontal),()=>{const gn=pi.verticalTextBox;return f.allowVerticalPlacement&&(!Fr||!Fr.placeable)&&Lt.numVerticalGlyphVertices>0&&gn?Br(gn,pi.verticalIconBox,h.an.vertical):{box:null,occluded:!0,offscreen:null}}),Fr&&(jr=Fr.placeable,cr=Fr.offscreen);const ea=ya(Fr&&Fr.placeable);if(!jr&&this.prevPlacement){const gn=this.prevPlacement.variableOffsets[Lt.crossTileID];gn&&(this.variableOffsets[Lt.crossTileID]=gn,this.markUsedJustification(f,gn.anchor,Lt,ea))}}}if(hr=Fr,jr=hr&&hr.placeable,cr=hr&&hr.offscreen,Lt.useRuntimeCollisionCircles){const ya=f.text.placedSymbolArray.get(Lt.centerJustifiedTextSymbolIndex),Un=h.ao(f.textSizeData,te,ya),Go=_.get("text-padding");$n=this.collisionIndex.placeCollisionCircles(ke,ya,f.lineVertexArray,f.glyphOffsetArray,Un,L,V,c,Ye,he.predicate,Lt.collisionCircleDiameter,Go,M,wt),$n.circles.length&&$n.collisionDetected&&!c&&h.w("Collisions detected, but collision boxes are not shown"),jr=ze||$n.circles.length>0&&!$n.collisionDetected,cr=cr&&$n.offscreen}if(pi.iconFeatureIndex&&(Ka=pi.iconFeatureIndex),pi.iconBox){const ya=Un=>this.collisionIndex.placeCollisionBox(Un,Le,q,ft,L,Ye,Ge,P,he.predicate,wt,Re&&nr?nr:void 0,ei);Gn&&Gn.placeable&&pi.verticalIconBox?(Jn=ya(pi.verticalIconBox),tn=Jn.placeable):(Jn=ya(pi.iconBox),tn=Jn.placeable),cr=cr&&Jn.offscreen}const Wl=Ae||Lt.numHorizontalGlyphVertices===0&&Lt.numVerticalGlyphVertices===0,Kl=Ce||Lt.numIconVertices===0;Wl||Kl?Kl?Wl||(tn=tn&&jr):jr=tn&&jr:tn=jr=tn&&jr;const Lc=tn&&Jn.placeable;if(jr&&hr.placeable&&this.collisionIndex.insertCollisionBox(hr.box,ke,_.get("text-ignore-placement"),f.bucketInstanceId,Gn&&Gn.placeable&&wl?wl:Yl,he.ID),Lc&&this.collisionIndex.insertCollisionBox(Jn.box,Le,_.get("icon-ignore-placement"),f.bucketInstanceId,Ka,he.ID),$n&&jr&&this.collisionIndex.insertCollisionCircles($n.circles,ke,_.get("text-ignore-placement"),f.bucketInstanceId,Yl,he.ID),c&&this.storeCollisionData(f.bucketInstanceId,Hi,pi,hr,Jn,$n),Lt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Lt.crossTileID]=new ds((jr||vt)&&!(hr!=null&&hr.occluded),(tn||ot)&&!(Jn!=null&&Jn.occluded),cr||f.justReloaded),r[Lt.crossTileID]=!0};if(it){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Lt=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let pi=Lt.length-1;pi>=0;--pi){const Hi=Lt[pi];Kt(f.symbolInstances.get(Hi),f.collisionArrays[Hi],Hi)}}else for(let Lt=e.symbolInstanceStart;Lt<e.symbolInstanceEnd;Lt++)Kt(f.symbolInstances.get(Lt),f.collisionArrays[Lt],Lt);f.justReloaded=!1}storeCollisionData(e,r,c,f,_,M){if(c.textBox||c.iconBox){let P,L;this.collisionBoxArrays.has(e)?P=this.collisionBoxArrays.get(e):(P=new Map,this.collisionBoxArrays.set(e,P)),P.has(r)?L=P.get(r):(L={text:null,icon:null},P.set(r,L)),c.textBox&&(L.text=f.box),c.iconBox&&(L.icon=_.box)}if(M){let P=this.collisionCircleArrays[e];P===void 0&&(P=this.collisionCircleArrays[e]=[]);for(let L=0;L<M.circles.length;L+=4)P.push(M.circles[L+0]-fn),P.push(M.circles[L+1]-fn),P.push(M.circles[L+2]),P.push(M.collisionDetected?1:0)}}markUsedJustification(e,r,c,f){let _;_=f===h.an.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[h.aF(r)];const M=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const P of M)P>=0&&(e.text.placedSymbolArray.get(P).crossTileID=_>=0&&P!==_?0:c.crossTileID)}markUsedOrientation(e,r,c){const f=r===h.an.horizontal||r===h.an.horizontalOnly?r:0,_=r===h.an.vertical?r:0,M=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const P of M)e.text.placedSymbolArray.get(P).placedOrientation=f;c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let c=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const f=r?r.symbolFadeChange(e):1,_=r?r.opacities:{},M=r?r.variableOffsets:{},P=r?r.placedOrientations:{};for(const L in this.placements){const V=this.placements[L],q=_[L];q?(this.opacities[L]=new hs(q,f,V.text,V.icon),c=c||V.text!==q.text.placed||V.icon!==q.icon.placed):(this.opacities[L]=new hs(null,f,V.text,V.icon,V.skipFade),c=c||V.text||V.icon)}for(const L in _){const V=_[L];if(!this.opacities[L]){const q=new hs(V,f,!1,!1);q.isHidden()||(this.opacities[L]=q,c=c||V.text.placed||V.icon.placed)}}for(const L in M)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=M[L]);for(const L in P)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=P[L]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const c={};for(const f of r){const _=f.getBucket(e);_&&f.latestFeatureIndex&&e.id===_.layerIds[0]&&this.updateBucketOpacities(_,f.tileID,c,f.collisionBoxArray)}}updateBucketOpacities(e,r,c,f){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const _=e.layers[0],M=_.layout,P=new hs(null,0,!1,!1,!0),L=M.get("text-allow-overlap"),V=M.get("icon-allow-overlap"),q=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),K=M.get("text-rotation-alignment")==="map",W=M.get("text-pitch-alignment")==="map",te=M.get("icon-text-fit")!=="none",he=new hs(null,0,L&&(V||!e.hasIconData()||M.get("icon-optional")),V&&(L||!e.hasTextData()||M.get("text-optional")),!0);!e.collisionArrays&&f&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(f);const Ae=(ke,ze,Le)=>{for(let De=0;De<ze/4;De++)ke.opacityVertexArray.emplaceBack(Le);ke.hasVisibleVertices=ke.hasVisibleVertices||Le!==ju},Ce=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ke=0;ke<e.symbolInstances.length;ke++){const ze=e.symbolInstances.get(ke),{numHorizontalGlyphVertices:Le,numVerticalGlyphVertices:De,crossTileID:Ge}=ze;let Ye=this.opacities[Ge];c[Ge]?Ye=P:Ye||(Ye=he,this.opacities[Ge]=Ye),c[Ge]=!0;const Re=ze.numIconVertices>0,it=this.placedOrientations[ze.crossTileID],vt=it===h.an.vertical,ot=it===h.an.horizontal||it===h.an.horizontalOnly;if(Le>0||De>0){const wt=Ou(Ye.text);Ae(e.text,Le,vt?ju:wt),Ae(e.text,De,ot?ju:wt);const ei=Ye.text.isHidden();[ze.rightJustifiedTextSymbolIndex,ze.centerJustifiedTextSymbolIndex,ze.leftJustifiedTextSymbolIndex].forEach(pi=>{pi>=0&&(e.text.placedSymbolArray.get(pi).hidden=ei||vt?1:0)}),ze.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ze.verticalPlacedTextSymbolIndex).hidden=ei||ot?1:0);const Kt=this.variableOffsets[ze.crossTileID];Kt&&this.markUsedJustification(e,Kt.anchor,ze,it);const Lt=this.placedOrientations[ze.crossTileID];Lt&&(this.markUsedJustification(e,"left",ze,Lt),this.markUsedOrientation(e,Lt,ze))}if(Re){const wt=Ou(Ye.icon),ei=!(te&&ze.verticalPlacedIconSymbolIndex&&vt);ze.placedIconSymbolIndex>=0&&(Ae(e.icon,ze.numIconVertices,ei?wt:ju),e.icon.placedSymbolArray.get(ze.placedIconSymbolIndex).hidden=Ye.icon.isHidden()),ze.verticalPlacedIconSymbolIndex>=0&&(Ae(e.icon,ze.numVerticalIconVertices,ei?ju:wt),e.icon.placedSymbolArray.get(ze.verticalPlacedIconSymbolIndex).hidden=Ye.icon.isHidden())}const ft=Ce&&Ce.has(ke)?Ce.get(ke):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const wt=e.collisionArrays[ke];if(wt){let ei=new h.P(0,0);if(wt.textBox||wt.verticalTextBox){let Kt=!0;if(q){const Lt=this.variableOffsets[Ge];Lt?(ei=fc(Lt.anchor,Lt.width,Lt.height,Lt.textOffset,Lt.textBoxScale),K&&ei._rotate(W?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Kt=!1}if(wt.textBox||wt.verticalTextBox){let Lt;wt.textBox&&(Lt=vt),wt.verticalTextBox&&(Lt=ot),mc(e.textCollisionBox.collisionVertexArray,Ye.text.placed,!Kt||Lt,ft.text,ei.x,ei.y)}}if(wt.iconBox||wt.verticalIconBox){const Kt=!!(!ot&&wt.verticalIconBox);let Lt;wt.iconBox&&(Lt=Kt),wt.verticalIconBox&&(Lt=!Kt),mc(e.iconCollisionBox.collisionVertexArray,Ye.icon.placed,Lt,ft.icon,te?ei.x:0,te?ei.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const c=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*c>e}setStale(){this.stale=!0}}function mc(y,e,r,c,f,_){c&&c.length!==0||(c=[0,0,0,0]);const M=c[0]-fn,P=c[1]-fn,L=c[2]-fn,V=c[3]-fn;y.emplaceBack(e?1:0,r?1:0,f||0,_||0,M,P),y.emplaceBack(e?1:0,r?1:0,f||0,_||0,L,P),y.emplaceBack(e?1:0,r?1:0,f||0,_||0,L,V),y.emplaceBack(e?1:0,r?1:0,f||0,_||0,M,V)}const Dl=Math.pow(2,25),el=Math.pow(2,24),ps=Math.pow(2,17),_d=Math.pow(2,16),yp=Math.pow(2,9),ko=Math.pow(2,8),xd=Math.pow(2,1);function Ou(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const e=y.placed?1:0,r=Math.floor(127*y.opacity);return r*Dl+e*el+r*ps+e*_d+r*yp+e*ko+r*xd+e}const ju=0;class As{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,c,f,_){const M=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(M,f,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((P,L)=>P.sortKey-L.sortKey));this._currentPartIndex<M.length;)if(r.placeLayerBucketPart(M[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,_())return!0;return!1}}class gc{constructor(e,r,c,f,_,M,P,L){this.placement=new Er(e,r,M,P,L),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(e,r,c){const f=Ee.now(),_=()=>!this._forceFullPlacement&&Ee.now()-f>2;for(;this._currentPlacementIndex>=0;){const M=r[e[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=P)&&(!M.maxzoom||M.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new As(M)),this._inProgressLayer.continuePlacement(c[M.source],this.placement,this._showCollisionBoxes,M,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Rl=512/h.$/2;class Jc{constructor(e,r,c){this.tileID=e,this.bucketInstanceId=c,this._symbolsByKey={};const f=new Map;for(let _=0;_<r.length;_++){const M=r.get(_),P=M.key,L=f.get(P);L?L.push(M):f.set(P,[M])}for(const[_,M]of f){const P={positions:M.map(L=>({x:Math.floor(L.anchorX*Rl),y:Math.floor(L.anchorY*Rl)})),crossTileIDs:M.map(L=>L.crossTileID)};if(P.positions.length>128){const L=new h.aH(P.positions.length,16,Uint16Array);for(const{x:V,y:q}of P.positions)L.add(V,q);L.finish(),delete P.positions,P.index=L}this._symbolsByKey[_]=P}}getScaledCoordinates(e,r){const{x:c,y:f,z:_}=this.tileID.canonical,{x:M,y:P,z:L}=r.canonical,V=Rl/Math.pow(2,L-_),q=(P*h.$+e.anchorY)*V,K=f*h.$*Rl;return{x:Math.floor((M*h.$+e.anchorX)*V-c*h.$*Rl),y:Math.floor(q-K)}}findMatches(e,r,c){const f=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let _=0;_<e.length;_++){const M=e.get(_);if(M.crossTileID)continue;const P=this._symbolsByKey[M.key];if(!P)continue;const L=this.getScaledCoordinates(M,r);if(P.index){const V=P.index.range(L.x-f,L.y-f,L.x+f,L.y+f).sort();for(const q of V){const K=P.crossTileIDs[q];if(!c[K]){c[K]=!0,M.crossTileID=K;break}}}else if(P.positions)for(let V=0;V<P.positions.length;V++){const q=P.positions[V],K=P.crossTileIDs[V];if(Math.abs(q.x-L.x)<=f&&Math.abs(q.y-L.y)<=f&&!c[K]){c[K]=!0,M.crossTileID=K;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Ws{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ch{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const c in this.indexes){const f=this.indexes[c],_={};for(const M in f){const P=f[M];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+r),_[P.tileID.key]=P}this.indexes[c]=_}this.lng=e}addBucket(e,r,c){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let _=0;_<r.symbolInstances.length;_++)r.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const f=this.usedCrossTileIDs[e.overscaledZ];for(const _ in this.indexes){const M=this.indexes[_];if(Number(_)>e.overscaledZ)for(const P in M){const L=M[P];L.tileID.isChildOf(e)&&L.findMatches(r.symbolInstances,e,f)}else{const P=M[e.scaledTo(Number(_)).key];P&&P.findMatches(r.symbolInstances,e,f)}}for(let _=0;_<r.symbolInstances.length;_++){const M=r.symbolInstances.get(_);M.crossTileID||(M.crossTileID=c.generate(),f[M.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Jc(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const c of r.getCrossTileIDsLists())for(const f of c)delete this.usedCrossTileIDs[e][f]}removeStaleBuckets(e){let r=!1;for(const c in this.indexes){const f=this.indexes[c];for(const _ in f)e[f[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,f[_]),delete f[_],r=!0)}return r}}class Sa{constructor(){this.layerIndexes={},this.crossTileIDs=new Ws,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,c){let f=this.layerIndexes[e.id];f===void 0&&(f=this.layerIndexes[e.id]=new Ch);let _=!1;const M={};f.handleWrapJump(c);for(const P of r){const L=P.getBucket(e);L&&e.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(P.tileID,L,this.crossTileIDs)&&(_=!0),M[L.bucketInstanceId]=!0)}return f.removeStaleBuckets(M)&&(_=!0),_}pruneUnusedLayers(e){const r={};e.forEach(c=>{r[c]=!0});for(const c in this.layerIndexes)r[c]||delete this.layerIndexes[c]}}var fs="void main() {fragColor=vec4(1.0);}";const Po={prelude:ar(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ar("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ar("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ar(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ar(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ar(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ar(fs,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ar(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ar(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ar("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ar("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:ar(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(textureSize(u_elevation_stops,0)[0]);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int num_elevation_stops=textureSize(u_elevation_stops,0)[0];int r=(num_elevation_stops-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(textureSize(u_color_stops,0)[0]);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:ar("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ar(fs,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ar(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ar(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ar(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ar(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ar(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ar(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ar(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ar(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:
basic_hillshade(deriv);break;case COMBINED:
combined_hillshade(deriv);break;case IGOR:
igor_hillshade(deriv);break;case MULTIDIRECTIONAL:
multidirectional_hillshade(deriv);break;case STANDARD:
default:
standard_hillshade(deriv);break;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ar(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ar(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ar(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ar(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ar(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ar(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ar(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ar(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ar("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ar("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ar("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ar("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ar(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ar("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ar(y,e){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=e.match(/in ([\w]+) ([\w]+)/g),f=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=_?_.concat(f):f,P={};return{fragmentSource:y=y.replace(r,(L,V,q,K,W)=>(P[W]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${W}
in ${q} ${K} ${W};
#else
uniform ${q} ${K} u_${W};
#endif
`:`
#ifdef HAS_UNIFORM_u_${W}
    ${q} ${K} ${W} = u_${W};
#endif
`)),vertexSource:e=e.replace(r,(L,V,q,K,W)=>{const te=K==="float"?"vec2":"vec4",he=W.match(/color/)?"color":te;return P[W]?V==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${q} ${te} a_${W};
out ${q} ${K} ${W};
#else
uniform ${q} ${K} u_${W};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${q} ${K} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${he}(a_${W}, u_${W}_t);
#else
    ${q} ${K} ${W} = u_${W};
#endif
`:V==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${q} ${te} a_${W};
#else
uniform ${q} ${K} u_${W};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${q} ${K} ${W} = a_${W};
#else
    ${q} ${K} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${q} ${K} ${W} = unpack_mix_${he}(a_${W}, u_${W}_t);
#else
    ${q} ${K} ${W} = u_${W};
#endif
`}),staticAttributes:c,staticUniforms:M}}class zo{constructor(e,r,c){this.vertexBuffer=e,this.indexBuffer=r,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ms=h.aI([{name:"a_pos",type:"Int16",components:2}]);const Lo="#define PROJECTION_MERCATOR",vd="mercator";class eu{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return vd}get shaderDefine(){return Lo}get shaderPreludeCode(){return Po.projectionMercator}get vertexShaderPreludeCode(){return Po.projectionMercator.vertexSource}get subdivisionGranularity(){return h.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,c,f,_){if(this._cachedMesh)return this._cachedMesh;const M=new h.aK;M.emplaceBack(0,0),M.emplaceBack(h.$,0),M.emplaceBack(0,h.$),M.emplaceBack(h.$,h.$);const P=e.createVertexBuffer(M,ms.members),L=h.aL.simpleSegment(0,0,4,2),V=new h.aM;V.emplaceBack(1,0,2),V.emplaceBack(1,2,3);const q=e.createIndexBuffer(V);return this._cachedMesh=new zo(P,q,L),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Za{constructor(e=0,r=0,c=0,f=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(c)||c<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=c,this.right=f}interpolate(e,r,c){return r.top!=null&&e.top!=null&&(this.top=h.C.number(e.top,r.top,c)),r.bottom!=null&&e.bottom!=null&&(this.bottom=h.C.number(e.bottom,r.bottom,c)),r.left!=null&&e.left!=null&&(this.left=h.C.number(e.left,r.left,c)),r.right!=null&&e.right!=null&&(this.right=h.C.number(e.right,r.right,c)),this}getCenter(e,r){const c=h.ag((this.left+e-this.right)/2,0,e),f=h.ag((this.top+r-this.bottom)/2,0,r);return new h.P(c,f)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Za(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Es(y,e){if(!y.renderWorldCopies||y.lngRange)return;const r=e.lng-y.center.lng;e.lng+=r>180?-360:r<-180?360:0}function Ui(y){return Math.max(0,Math.floor(y))}class Do{constructor(e,r,c,f,_,M){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=M===void 0||!!M,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=_??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new h.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ui(this._zoom),this._scale=h.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Za,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,c){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Ui(this._zoom),this._scale=h.ae(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Za(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!c&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=h.aN(e,-180,180)*Math.PI/180;var c,f,_,M,P,L,V,q,K;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=ge(),c=this._rotationMatrix,_=-this._bearingInRadians,M=(f=this._rotationMatrix)[0],P=f[1],L=f[2],V=f[3],q=Math.sin(_),K=Math.cos(_),c[0]=M*K+L*q,c[1]=P*K+V*q,c[2]=M*-q+L*K,c[3]=P*-q+V*K)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=h.ag(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const r=e/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return h.aO(this._fovInRadians)}setFov(e){e=h.ag(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=h.ad(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=h.ae(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,r){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,c){this._unmodified=!1,this._edgeInsets.interpolate(e,r,c),this._constrain(),this._calcMatrices()}resize(e,r,c=!0){this._width=e,this._height=r,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new li([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,h.ah])}getConstrained(e,r){return this._callbacks.getConstrained(e,r)}getCameraQueryGeometry(e,r){if(r.length===1)return[r[0],e];{const{minX:c,minY:f,maxX:_,maxY:M}=h.a1.fromPoints(r).extend(e);return[new h.P(c,f),new h.P(_,f),new h.P(_,M),new h.P(c,M),new h.P(c,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:r,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(c),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=h.af(new Float64Array(16));h.N(e,e,[this._width/2,-this._height/2,1]),h.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=h.af(new Float64Array(16)),h.N(e,e,[1,-1,1]),h.M(e,e,[-1,-1,0]),h.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,c,f){const _=c!==void 0?c:this.bearing,M=f=f!==void 0?f:this.pitch,P=h.a0.fromLngLat(e,r),L=-Math.cos(h.ad(M)),V=Math.sin(h.ad(M)),q=V*Math.sin(h.ad(_)),K=-V*Math.cos(h.ad(_));let W=this.elevation;const te=r-W;let he;L*te>=0||Math.abs(L)<.1?(he=1e4,W=r+he*L):he=-te/L;let Ae,Ce,ke=h.aP(1,P.y),ze=0;do{if(ze+=1,ze>10)break;Ce=he/ke,Ae=new h.a0(P.x+q*Ce,P.y+K*Ce),ke=1/Ae.meterInMercatorCoordinateUnits()}while(Math.abs(he-Ce*ke)>1e-12);return{center:Ae.toLngLat(),elevation:W,zoom:h.aj(this.height/2/Math.tan(this.fovInRadians/2)/Ce/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=h.ai(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/r,f=h.a0.fromLngLat(this.center,this.elevation),_=je(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=e;const M=this.calculateCenterFromCameraLngLatAlt(_.toLngLat(),h.aP(_.z,f.y),this.bearing,this.pitch);this._elevation=M.elevation,this._center=M.center,this.setZoom(M.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=h.ai(1,this.center.lat)*this.worldSize;return je(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/h.$,1/r/h.$]}}class Il{constructor(e,r){this.min=e,this.max=r,this.center=h.aQ([],h.aR([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],c=h.aS(this.min),f=h.aS(this.max);for(let _=0;_<r.length;_++)c[_]=r[_]?this.min[_]:this.center[_],f[_]=r[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new Il(c,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let c=0;c<e.planes.length;c++){const f=this.intersectsPlane(e.planes[c]);if(f===0)return 0;f===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],c=e[3];for(let f=0;f<3;f++)e[f]>0?(r+=e[f]*this.min[f],c+=e[f]*this.max[f]):(c+=e[f]*this.min[f],r+=e[f]*this.max[f]);return r>=0?2:c<0?0:1}}class Bu{distanceToTile2d(e,r,c,f){const _=f.distanceX([e,r]),M=f.distanceY([e,r]);return Math.hypot(_,M)}getWrap(e,r,c){return c}getTileBoundingVolume(e,r,c,f){var _,M;let P=c,L=c;if(f!=null&&f.terrain){const q=new h.Z(e.z,r,e.z,e.x,e.y),K=f.terrain.getMinMaxElevation(q);P=(_=K.minElevation)!==null&&_!==void 0?_:c,L=(M=K.maxElevation)!==null&&M!==void 0?M:c}const V=1<<e.z;return new Il([r+e.x/V,e.y/V,P],[r+(e.x+1)/V,(e.y+1)/V,L])}allowVariableZoom(e,r){const c=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,f=h.ag(78.5-c/2,0,60);return!!r.terrain||e.pitch>f}allowWorldCopies(){return!0}prepareNextFrame(){}}class ca{constructor(e,r,c){this.points=e,this.planes=r,this.aabb=c}static fromInvProjectionMatrix(e,r=1,c=0,f,_){const M=_?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],P=Math.pow(2,c),L=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(W=>function(te,he,Ae,Ce){const ke=h.av([],te,he),ze=1/ke[3]/Ae*Ce;return h.aX(ke,ke,[ze,ze,1/ke[3],ze])}(W,e,r,P));f&&function(W,te,he,Ae){const Ce=Ae?4:0,ke=Ae?0:4;let ze=0;const Le=[],De=[];for(let Re=0;Re<4;Re++){const it=h.aT([],W[Re+ke],W[Re+Ce]),vt=h.aY(it);h.aQ(it,it,1/vt),Le.push(vt),De.push(it)}for(let Re=0;Re<4;Re++){const it=h.aZ(W[Re+Ce],De[Re],he);ze=it!==null&&it>=0?Math.max(ze,it):Math.max(ze,Le[Re])}const Ge=function(Re,it){const vt=h.aT([],Re[it[0]],Re[it[1]]),ot=h.aT([],Re[it[2]],Re[it[1]]),ft=[0,0,0,0];return h.aU(ft,h.aV([],vt,ot)),ft[3]=-h.aW(ft,Re[it[0]]),ft}(W,te),Ye=function(Re,it){const vt=h.a_(Re),ot=h.a$([],Re,1/vt),ft=h.aT([],it,h.aQ([],ot,h.aW(it,ot))),wt=h.a_(ft);if(wt>0){const ei=Math.sqrt(1-ot[3]*ot[3]),Kt=h.aQ([],ot,-ot[3]),Lt=h.aR([],Kt,h.aQ([],ft,ei/wt));return h.b0(it,Lt)}return null}(he,Ge);if(Ye!==null){const Re=Ye/h.aW(De[0],Ge);ze=Math.min(ze,Re)}for(let Re=0;Re<4;Re++){const it=Math.min(ze,Le[Re]);W[Re+ke]=[W[Re+Ce][0]+De[Re][0]*it,W[Re+Ce][1]+De[Re][1]*it,W[Re+Ce][2]+De[Re][2]*it,1]}}(L,M[0],f,_);const V=M.map(W=>{const te=h.aT([],L[W[0]],L[W[1]]),he=h.aT([],L[W[2]],L[W[1]]),Ae=h.aU([],h.aV([],te,he)),Ce=-h.aW(Ae,L[W[1]]);return Ae.concat(Ce)}),q=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],K=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const W of L)for(let te=0;te<3;te++)q[te]=Math.min(q[te],W[te]),K[te]=Math.max(K[te],W[te]);return new ca(L,V,new Il(q,K))}}class an{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,c){return this._helper.interpolatePadding(e,r,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,c=!0){this._helper.resize(e,r,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}constructor(e,r,c,f,_){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Do({calcMatrices:()=>{this._calcMatrices()},getConstrained:(M,P)=>this.getConstrained(M,P)},e,r,c,f,_),this._coveringTilesDetailsProvider=new Bu}clone(){const e=new an;return e.apply(this),e}apply(e,r,c){this._helper.apply(e,r,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new h.b1(0,e)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new h.P(0,0)),f=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,0)),_=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,this._helper._height)),M=this.screenPointToMercatorCoordinate(new h.P(0,this._helper._height)),P=Math.floor(Math.min(c.x,f.x,_.x,M.x)),L=Math.floor(Math.max(c.x,f.x,_.x,M.x)),V=1;for(let q=P-V;q<=L+V;q++)q!==0&&r.push(new h.b1(q,e))}return r}getCameraFrustum(){return ca.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const r=this.screenPointToLocation(this.centerPoint,e),c=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(e,r){const c=h.ai(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(r,c),_=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),M=h.a0.fromLngLat(e),P=new h.a0(M.x-(f.x-_.x),M.y-(f.y-_.y));this.setCenter(P==null?void 0:P.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(h.a0.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(h.a0.fromLngLat(e))}screenPointToLocation(e,r){var c;return(c=this.screenPointToMercatorCoordinate(e,r))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){const c=r.pointCoordinate(e);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const c=r||0,f=[e.x,e.y,0,1],_=[e.x,e.y,1,1];h.av(f,f,this._pixelMatrixInverse),h.av(_,_,this._pixelMatrixInverse);const M=f[3],P=_[3],L=f[1]/M,V=_[1]/P,q=f[2]/M,K=_[2]/P,W=q===K?0:(c-q)/(K-q);return new h.a0(h.C.number(f[0]/M,_[0]/P,W)/this.worldSize,h.C.number(L,V,W)/this.worldSize,c)}coordinatePoint(e,r=0,c=this._pixelMatrix){const f=[e.x*this.worldSize,e.y*this.worldSize,r,1];return h.av(f,f,c),new h.P(f[0]/f[3],f[1]/f[3])}getBounds(){const e=Math.max(0,this._helper._height/2-ye(this));return new li().extend(this.screenPointToLocation(new h.P(0,e))).extend(this.screenPointToLocation(new h.P(this._helper._width,e))).extend(this.screenPointToLocation(new h.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new h.P(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-ye(this)}calculatePosMatrix(e,r=!1,c){var f;const _=(f=e.key)!==null&&f!==void 0?f:h.b2(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),M=r?this._alignedPosMatrixCache:this._posMatrixCache;if(M.has(_)){const V=M.get(_);return c?V.f32:V.f64}const P=Me(e,this.worldSize);h.O(P,r?this._alignedProjMatrix:this._viewProjMatrix,P);const L={f64:P,f32:new Float32Array(P)};return M.set(_,L),c?L.f32:L.f64}calculateFogMatrix(e){const r=e.key,c=this._fogMatrixCacheF32;if(c.has(r))return c.get(r);const f=Me(e,this.worldSize);return h.O(f,this._fogMatrix,f),c.set(r,new Float32Array(f)),c.get(r)}getConstrained(e,r){r=h.ag(+r,this.minZoom,this.maxZoom);const c={center:new h.S(e.lng,e.lat),zoom:r};let f=this._helper._lngRange;this._helper._renderWorldCopies||f!==null||(f=[-179.9999999999,180-1e-10]);const _=this.tileSize*h.ae(c.zoom);let M=0,P=_,L=0,V=_,q=0,K=0;const{x:W,y:te}=this.size;if(this._helper._latRange){const Le=this._helper._latRange;M=h.U(Le[1])*_,P=h.U(Le[0])*_,P-M<te&&(q=te/(P-M))}f&&(L=h.aN(h.V(f[0])*_,0,_),V=h.aN(h.V(f[1])*_,0,_),V<L&&(V+=_),V-L<W&&(K=W/(V-L)));const{x:he,y:Ae}=lt(_,e);let Ce,ke;const ze=Math.max(K||0,q||0);if(ze){const Le=new h.P(K?(V+L)/2:he,q?(P+M)/2:Ae);return c.center=de(_,Le).wrap(),c.zoom+=h.aj(ze),c}if(this._helper._latRange){const Le=te/2;Ae-Le<M&&(ke=M+Le),Ae+Le>P&&(ke=P-Le)}if(f){const Le=(L+V)/2;let De=he;this._helper._renderWorldCopies&&(De=h.aN(he,Le-_/2,Le+_/2));const Ge=W/2;De-Ge<L&&(Ce=L+Ge),De+Ge>V&&(Ce=V-Ge)}if(Ce!==void 0||ke!==void 0){const Le=new h.P(Ce??he,ke??Ae);c.center=de(_,Le).wrap()}return c}calculateCenterFromCameraLngLatAlt(e,r,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,c,f)}_calculateNearFarZIfNeeded(e,r,c){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),_=e-f*this._helper._pixelPerMeter/Math.cos(r),M=f<0?_:e,P=Math.PI/2+this.pitchInRadians,L=h.ad(this.fov)*(Math.abs(Math.cos(h.ad(this.roll)))*this.height+Math.abs(Math.sin(h.ad(this.roll)))*this.width)/this.height*(.5+c.y/this.height),V=Math.sin(L)*M/Math.sin(h.ag(Math.PI-P-L,.01,Math.PI-.01)),q=ye(this),K=Math.atan(q/this._helper.cameraToCenterDistance),W=h.ad(.75),te=K>W?2*K*(.5+c.y/(2*q)):W,he=Math.sin(te)*M/Math.sin(h.ag(Math.PI-P-te,.01,Math.PI-.01)),Ae=Math.min(V,he);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*Ae+M),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=lt(this.worldSize,this.center),c=r.x,f=r.y;this._helper._pixelPerMeter=h.ai(1,this.center.lat)*this.worldSize;const _=h.ad(Math.min(this.pitch,Eo)),M=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(_));let P;this._calculateNearFarZIfNeeded(M,_,e),P=new Float64Array(16),h.b3(P,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),h.ap(this._invProjMatrix,P),P[8]=2*-e.x/this._helper._width,P[9]=2*e.y/this._helper._height,this._projectionMatrix=h.b4(P),h.N(P,P,[1,-1,1]),h.M(P,P,[0,0,-this._helper.cameraToCenterDistance]),h.b5(P,P,-this.rollInRadians),h.b6(P,P,this.pitchInRadians),h.b5(P,P,-this.bearingInRadians),h.M(P,P,[-c,-f,0]),this._mercatorMatrix=h.N([],P,[this.worldSize,this.worldSize,this.worldSize]),h.N(P,P,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=h.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,P),h.M(P,P,[0,0,-this.elevation]),this._viewProjMatrix=P,this._invViewProjMatrix=h.ap([],P);const L=[0,0,-1,1];h.av(L,L,this._invViewProjMatrix),this._cameraPosition=[L[0]/L[3],L[1]/L[3],L[2]/L[3]],this._fogMatrix=new Float64Array(16),h.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,M,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,h.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),h.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),h.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),h.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),h.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),h.M(this._fogMatrix,this._fogMatrix,[-c,-f,0]),h.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),h.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=h.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,P);const V=this._helper._width%2/2,q=this._helper._height%2/2,K=Math.cos(this.bearingInRadians),W=Math.sin(-this.bearingInRadians),te=c-Math.round(c)+K*V+W*q,he=f-Math.round(f)+K*q+W*V,Ae=new Float64Array(P);if(h.M(Ae,Ae,[te>.5?te-1:te,he>.5?he-1:he,0]),this._alignedProjMatrix=Ae,P=h.ap(new Float64Array(16),this._pixelMatrix),!P)throw new Error("failed to invert matrix");this._pixelMatrixInverse=P,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new h.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return h.av(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=h.ai(1,this.center.lat)*this.worldSize;return je(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const c=h.a0.fromLngLat(e),f=[c.x*this.worldSize,c.y*this.worldSize,r,1];return h.av(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(e){const{overscaledTileID:r,aligned:c,applyTerrainMatrix:f}=e,_=this._helper.getMercatorTileCoordinates(r),M=r?this.calculatePosMatrix(r,c,!0):null;let P;return P=r&&r.terrainRttPosMatrix32f&&f?r.terrainRttPosMatrix32f:M||h.b7(),{mainMatrix:P,tileMercatorCoords:_,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:P}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,c){return 1}transformLightDirection(e){return h.aS(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,c,f){const _=this.calculatePosMatrix(c);let M;f?(M=[e,r,f(e,r),1],h.av(M,M,_)):(M=[e,r,0,1],Ll(M,M,_));const P=M[3];return{point:new h.P(M[0]/P,M[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}populateCache(e){for(const r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){const c=h.a0.fromLngLat(e,r),f=c.meterInMercatorCoordinateUnits(),_=h.b8();return h.M(_,_,[c.x,c.y,c.z]),h.b5(_,_,Math.PI),h.b6(_,_,Math.PI/2),h.N(_,_,[-f,f,f]),_}getProjectionDataForCustomLayer(e=!0){const r=new h.Z(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),f=Me(r,this.worldSize);h.O(f,this._viewProjMatrix,f),c.tileMercatorCoords=[0,0,1,1];const _=[h.$,h.$,this.worldSize/this._helper.pixelsPerMeter],M=h.b9();return h.N(M,f,_),c.fallbackMatrix=M,c.mainMatrix=M,c}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Jr(){h.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Bn(y){if(y.useSlerp)if(y.k<1){const e=h.ba(y.startEulerAngles.roll,y.startEulerAngles.pitch,y.startEulerAngles.bearing),r=h.ba(y.endEulerAngles.roll,y.endEulerAngles.pitch,y.endEulerAngles.bearing),c=new Float64Array(4);h.bb(c,e,r,y.k);const f=h.bc(c);y.tr.setRoll(f.roll),y.tr.setPitch(f.pitch),y.tr.setBearing(f.bearing)}else y.tr.setRoll(y.endEulerAngles.roll),y.tr.setPitch(y.endEulerAngles.pitch),y.tr.setBearing(y.endEulerAngles.bearing);else y.tr.setRoll(h.C.number(y.startEulerAngles.roll,y.endEulerAngles.roll,y.k)),y.tr.setPitch(h.C.number(y.startEulerAngles.pitch,y.endEulerAngles.pitch,y.k)),y.tr.setBearing(h.C.number(y.startEulerAngles.bearing,y.endEulerAngles.bearing,y.k))}function kr(y,e,r,c,f){const _=f.padding,M=lt(f.worldSize,r.getNorthWest()),P=lt(f.worldSize,r.getNorthEast()),L=lt(f.worldSize,r.getSouthEast()),V=lt(f.worldSize,r.getSouthWest()),q=h.ad(-c),K=M.rotate(q),W=P.rotate(q),te=L.rotate(q),he=V.rotate(q),Ae=new h.P(Math.max(K.x,W.x,he.x,te.x),Math.max(K.y,W.y,he.y,te.y)),Ce=new h.P(Math.min(K.x,W.x,he.x,te.x),Math.min(K.y,W.y,he.y,te.y)),ke=Ae.sub(Ce),ze=(f.width-(_.left+_.right+e.left+e.right))/ke.x,Le=(f.height-(_.top+_.bottom+e.top+e.bottom))/ke.y;if(Le<0||ze<0)return void Jr();const De=Math.min(h.aj(f.scale*Math.min(ze,Le)),y.maxZoom),Ge=h.P.convert(y.offset),Ye=new h.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(h.ad(c)),Re=Ge.add(Ye).mult(f.scale/h.ae(De));return{center:de(f.worldSize,M.add(L).div(2).sub(Re)),zoom:De,bearing:c}}class ks{get useGlobeControls(){return!1}handlePanInertia(e,r){return{easingOffset:e,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,c){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(c,e.around)}cameraForBoxAndBearing(e,r,c,f,_){return kr(e,r,c,f,_)}handleJumpToCenterZoom(e,r){e.zoom!==(r.zoom!==void 0?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(h.S.convert(r.center))}handleEaseTo(e,r){const c=e.zoom,f=e.padding,_={roll:e.roll,pitch:e.pitch,bearing:e.bearing},M={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},P=r.zoom!==void 0,L=!e.isPaddingEqual(r.padding);let V=!1;const q=P?+r.zoom:e.zoom;let K=e.centerPoint.add(r.offsetAsPoint);const W=e.screenPointToLocation(K),{center:te,zoom:he}=e.getConstrained(h.S.convert(r.center||W),q??c);Es(e,te);const Ae=lt(e.worldSize,W),Ce=lt(e.worldSize,te).sub(Ae),ke=h.ae(he-c);return V=he!==c,{easeFunc:ze=>{if(V&&e.setZoom(h.C.number(c,he,ze)),h.bd(_,M)||Bn({startEulerAngles:_,endEulerAngles:M,tr:e,k:ze,useSlerp:_.roll!=M.roll}),L&&(e.interpolatePadding(f,r.padding,ze),K=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const Le=h.ae(e.zoom-c),De=he>c?Math.min(2,ke):Math.max(.5,ke),Ge=Math.pow(De,1-ze),Ye=de(e.worldSize,Ae.add(Ce.mult(ze*Ge)).mult(Le));e.setLocationAtPoint(e.renderWorldCopies?Ye.wrap():Ye,K)}},isZooming:V,elevationCenter:te}}handleFlyTo(e,r){const c=r.zoom!==void 0,f=e.zoom,_=e.getConstrained(h.S.convert(r.center||r.locationAtOffset),c?+r.zoom:f),M=_.center,P=_.zoom;Es(e,M);const L=lt(e.worldSize,r.locationAtOffset),V=lt(e.worldSize,M).sub(L),q=V.mag(),K=h.ae(P-f);let W;if(r.minZoom!==void 0){const te=Math.min(+r.minZoom,f,P),he=e.getConstrained(M,te).zoom;W=h.ae(he-f)}return{easeFunc:(te,he,Ae,Ce)=>{e.setZoom(te===1?P:f+h.aj(he));const ke=te===1?M:de(e.worldSize,L.add(V.mult(Ae)).mult(he));e.setLocationAtPoint(e.renderWorldCopies?ke.wrap():ke,Ce)},scaleOfZoom:K,targetCenter:M,scaleOfMinZoom:W,pixelPathLength:q}}}class Vi{constructor(e,r,c){this.blendFunction=e,this.blendColor=r,this.mask=c}}Vi.Replace=[1,0],Vi.disabled=new Vi(Vi.Replace,h.be.transparent,[!1,!1,!1,!1]),Vi.unblended=new Vi(Vi.Replace,h.be.transparent,[!0,!0,!0,!0]),Vi.alphaBlended=new Vi([1,771],h.be.transparent,[!0,!0,!0,!0]);const ua=2305;class Oi{constructor(e,r,c){this.enable=e,this.mode=r,this.frontFace=c}}Oi.disabled=new Oi(!1,1029,ua),Oi.backCCW=new Oi(!0,1029,ua),Oi.frontCCW=new Oi(!0,1028,ua);class Gi{constructor(e,r,c){this.func=e,this.mask=r,this.range=c}}Gi.ReadOnly=!1,Gi.ReadWrite=!0,Gi.disabled=new Gi(519,Gi.ReadOnly,[0,1]);const Ps=7680;class Li{constructor(e,r,c,f,_,M){this.test=e,this.ref=r,this.mask=c,this.fail=f,this.depthFail=_,this.pass=M}}Li.disabled=new Li({func:519,mask:0},0,0,Ps,Ps,Ps);const An=new WeakMap;function En(y){var e;if(An.has(y))return An.get(y);{const r=(e=y.getParameter(y.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return An.set(y,r),r}}class tl{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,c=r.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const f=new h.aK;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const _=new h.aM;_.emplaceBack(0,1,2),this._fullscreenTriangle=new zo(r.createVertexBuffer(f,ms.members),r.createIndexBuffer(_),h.aL.simpleSegment(0,0,f.length,_.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(c.TEXTURE1);const M=c.createTexture();c.bindTexture(c.TEXTURE_2D,M),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(M),En(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const c=this._cachedRenderContext.context,f=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:h.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,f.TRIANGLES,Gi.disabled,Li.disabled,Vi.unblended,Oi.disabled,((_,M)=>({u_input:_,u_output_expected:M}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&En(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const _=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:_}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&En(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return h.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=tl._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}}const ha=h.$/128;function Nu(y,e){const r=y.granularity!==void 0?Math.max(y.granularity,1):1,c=r+(y.generateBorders?2:0),f=r+(y.extendToNorthPole||y.generateBorders?1:0)+(y.extendToSouthPole||y.generateBorders?1:0),_=c+1,M=f+1,P=y.generateBorders?-1:0,L=y.generateBorders||y.extendToNorthPole?-1:0,V=r+(y.generateBorders?1:0),q=r+(y.generateBorders||y.extendToSouthPole?1:0),K=_*M,W=c*f*6,te=_*M>65536;if(te&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const he=te||e==="32bit",Ae=new Int16Array(2*K);let Ce=0;for(let Le=L;Le<=q;Le++)for(let De=P;De<=V;De++){let Ge=De/r*h.$;De===-1&&(Ge=-64),De===r+1&&(Ge=h.$+ha);let Ye=Le/r*h.$;Le===-1&&(Ye=y.extendToNorthPole?h.bg:-64),Le===r+1&&(Ye=y.extendToSouthPole?h.bh:h.$+ha),Ae[Ce++]=Ge,Ae[Ce++]=Ye}const ke=he?new Uint32Array(W):new Uint16Array(W);let ze=0;for(let Le=0;Le<f;Le++)for(let De=0;De<c;De++){const Ge=De+1+Le*_,Ye=De+(Le+1)*_,Re=De+1+(Le+1)*_;ke[ze++]=De+Le*_,ke[ze++]=Ye,ke[ze++]=Ge,ke[ze++]=Ge,ke[ze++]=Ye,ke[ze++]=Re}return{vertices:Ae.buffer.slice(0),indices:ke.buffer.slice(0),uses32bitIndices:he}}const da=new h.aJ({fill:new h.bi(128,2),line:new h.bi(512,0),tile:new h.bi(128,32),stencil:new h.bi(128,1),circle:3});class zs{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Po.projectionGlobe}get vertexShaderPreludeCode(){return Po.projectionMercator.vertexSource}get subdivisionGranularity(){return da}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new tl(e));const r=h.U(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(r,c),_=Ee.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=_);const M=Math.min(Math.max((_-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=h.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,h.bk(M))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,r,c,f,_){const M=(_==="stencil"?da.stencil:da.tile).getGranularityForZoomLevel(r.z);return this._getMesh(e,{granularity:M,generateBorders:c,extendToNorthPole:r.y===0&&f,extendToSouthPole:r.y===(1<<r.z)-1&&f})}_getMesh(e,r){const c=this._getMeshKey(r);if(c in this._tileMeshCache)return this._tileMeshCache[c];const f=function(_,M){const P=Nu(M,"16bit"),L=h.aK.deserialize({arrayBuffer:P.vertices,length:P.vertices.byteLength/2/2}),V=h.aM.deserialize({arrayBuffer:P.indices,length:P.indices.byteLength/2/3});return new zo(_.createVertexBuffer(L,ms.members),_.createIndexBuffer(V),h.aL.simpleSegment(0,0,L.length,V.length))}(e,r);return this._tileMeshCache[c]=f,f}recalculate(e){}hasTransition(){const e=Ee.now();let r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const il=new h.r({type:new h.D(h.v.projection.type)});class Ol extends h.E{constructor(e){super(),this._transitionable=new h.t(il),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.F(0)),this._mercatorProjection=new eu,this._verticalPerspectiveProjection=new zs}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof h.bl){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,c,f,_){return this.currentProjection.getMeshFromTileID(e,r,c,f,_)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function tu(y){const e=sn(y.worldSize,y.center.lat);return 2*Math.PI*e}function Ks(y,e,r,c,f){const _=1/(1<<f),M=e/h.$*_+c*_,P=h.bn((y/h.$*_+r*_)*Math.PI*2+Math.PI,2*Math.PI),L=2*Math.atan(Math.exp(Math.PI-M*Math.PI*2))-.5*Math.PI,V=Math.cos(L),q=new Float64Array(3);return q[0]=Math.sin(P)*V,q[1]=Math.sin(L),q[2]=Math.cos(P)*V,q}function Vn(y){return function(e,r){const c=Math.cos(r),f=new Float64Array(3);return f[0]=Math.sin(e)*c,f[1]=Math.sin(r),f[2]=Math.cos(e)*c,f}(y.lng*Math.PI/180,y.lat*Math.PI/180)}function sn(y,e){return y/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Ta(y){const e=Math.asin(y[1])/Math.PI*180,r=Math.sqrt(y[0]*y[0]+y[2]*y[2]);if(r>1e-6){const c=y[0]/r,f=Math.acos(y[2]/r),_=(c>0?f:-f)/Math.PI*180;return new h.S(h.aN(_,-180,180),e)}return new h.S(0,e)}function yc(y){return Math.cos(y*Math.PI/180)}function Nn(y,e){const r=yc(y),c=yc(e);return h.aj(c/r)}function iu(y,e){const r=y.rotate(e.bearingInRadians),c=e.zoom+Nn(e.center.lat,0),f=h.bj(1/yc(e.center.lat),1/yc(Math.min(Math.abs(e.center.lat),60)),h.bm(c,7,3,0,1)),_=360/tu({worldSize:e.worldSize,center:{lat:e.center.lat}});return new h.S(e.center.lng-r.x*_*f,h.ag(e.center.lat+r.y*_,-85.051129,h.ah))}function Ro(y){const e=.5*y,r=Math.sin(e),c=Math.cos(e);return Math.log(r+c)-Math.log(c-r)}function ru(y,e,r,c){const f=y.lat+r*c;if(Math.abs(r)>1){const _=(Math.sign(y.lat+r)!==Math.sign(y.lat)?-Math.abs(y.lat):Math.abs(y.lat))*Math.PI/180,M=Math.abs(y.lat+r)*Math.PI/180,P=Ro(_+c*(M-_)),L=Ro(_),V=Ro(M);return new h.S(y.lng+e*((P-L)/(V-L)),f)}return new h.S(y.lng+e*c,f)}class Fu{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,r,c,f){const _=`${e.z}_${e.x}_${e.y}_${f!=null&&f.terrain?"t":""}`,M=this._cache.get(_);if(M)return M;const P=this._cachePrevious.get(_);if(P)return this._cache.set(_,P),P;const L=this._boundingVolumeFactory(e,r,c,f);return this._cache.set(_,L),this._hadAnyChanges=!0,L}}class rl{constructor(e,r,c,f){this.min=c,this.max=f,this.points=e,this.planes=r}static fromAabb(e,r){const c=[];for(let f=0;f<8;f++)c.push([1&~f?e[0]:r[0],(f>>1&1)==1?r[1]:e[1],(f>>2&1)==1?r[2]:e[2]]);return new rl(c,[[-1,0,0,r[0]],[1,0,0,-e[0]],[0,-1,0,r[1]],[0,1,0,-e[1]],[0,0,-1,r[2]],[0,0,1,-e[2]]],e,r)}static fromCenterSizeAngles(e,r,c){const f=h.bq([],c[0],c[1],c[2]),_=h.br([],[r[0],0,0],f),M=h.br([],[0,r[1],0],f),P=h.br([],[0,0,r[2]],f),L=[...e],V=[...e];for(let K=0;K<8;K++)for(let W=0;W<3;W++){const te=e[W]+_[W]*(1&~K?-1:1)+M[W]*((K>>1&1)==1?1:-1)+P[W]*((K>>2&1)==1?1:-1);L[W]=Math.min(L[W],te),V[W]=Math.max(V[W],te)}const q=[];for(let K=0;K<8;K++){const W=[...e];h.aR(W,W,h.aQ([],_,1&~K?-1:1)),h.aR(W,W,h.aQ([],M,(K>>1&1)==1?1:-1)),h.aR(W,W,h.aQ([],P,(K>>2&1)==1?1:-1)),q.push(W)}return new rl(q,[[..._,-h.aW(_,q[0])],[...M,-h.aW(M,q[0])],[...P,-h.aW(P,q[0])],[-_[0],-_[1],-_[2],-h.aW(_,q[7])],[-M[0],-M[1],-M[2],-h.aW(M,q[7])],[-P[0],-P[1],-P[2],-h.aW(P,q[7])]],L,V)}intersectsFrustum(e){let r=!0;const c=this.points.length,f=this.planes.length,_=e.planes.length,M=e.points.length;for(let P=0;P<_;P++){const L=e.planes[P];let V=0;for(let q=0;q<c;q++){const K=this.points[q];L[0]*K[0]+L[1]*K[1]+L[2]*K[2]+L[3]>=0&&V++}if(V===0)return 0;V<c&&(r=!1)}if(r)return 2;for(let P=0;P<f;P++){const L=this.planes[P];let V=0;for(let q=0;q<M;q++){const K=e.points[q];L[0]*K[0]+L[1]*K[1]+L[2]*K[2]+L[3]>=0&&V++}if(V===0)return 0}return 1}intersectsPlane(e){const r=this.points.length;let c=0;for(let f=0;f<r;f++){const _=this.points[f];e[0]*_[0]+e[1]*_[1]+e[2]*_[2]+e[3]>=0&&c++}return c===r?2:c===0?0:1}}function Qs(y,e,r){const c=y-e;return c<0?-c:Math.max(0,c-r)}function Ah(y,e,r,c,f){const _=y-r;let M;return M=_<0?Math.min(-_,1+_-f):_>1?Math.min(Math.max(_-f,0),1-_):0,Math.max(M,Qs(e,c,f))}class ef{constructor(){this._boundingVolumeCache=new Fu(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,r,c,f){const _=1<<c.z,M=1/_,P=c.x/_,L=c.y/_;let V=2;return V=Math.min(V,Ah(e,r,P,L,M)),V=Math.min(V,Ah(e,r,P+.5,-L-M,M)),V=Math.min(V,Ah(e,r,P+.5,2-L-M,M)),V}getWrap(e,r,c){const f=1<<r.z,_=1/f,M=r.x/f,P=Qs(e.x,M,_),L=Qs(e.x,M-1,_),V=Qs(e.x,M+1,_),q=Math.min(P,L,V);return q===V?1:q===L?-1:0}allowVariableZoom(e,r){return Et(e,r)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,r,c,f){return this._boundingVolumeCache.getTileBoundingVolume(e,r,c,f)}_computeTileBoundingVolume(e,r,c,f){var _,M;let P=c,L=c;if(f!=null&&f.terrain){const V=new h.Z(e.z,r,e.z,e.x,e.y),q=f.terrain.getMinMaxElevation(V);P=(_=q.minElevation)!==null&&_!==void 0?_:c,L=(M=q.maxElevation)!==null&&M!==void 0?M:c}if(P/=h.bt,L/=h.bt,P+=1,L+=1,e.z<=0)return rl.fromAabb([-L,-L,-L],[L,L,L]);if(e.z===1)return rl.fromAabb([e.x===0?-L:0,e.y===0?0:-L,-L],[e.x===0?0:L,e.y===0?L:0,L]);{const V=[Ks(0,0,e.x,e.y,e.z),Ks(h.$,0,e.x,e.y,e.z),Ks(h.$,h.$,e.x,e.y,e.z),Ks(0,h.$,e.x,e.y,e.z)],q=[];for(const ft of V)q.push(h.aQ([],ft,L));if(L!==P)for(const ft of V)q.push(h.aQ([],ft,P));e.y===0&&q.push([0,1,0]),e.y===(1<<e.z)-1&&q.push([0,-1,0]);const K=[1,1,1],W=[-1,-1,-1];for(const ft of q)for(let wt=0;wt<3;wt++)K[wt]=Math.min(K[wt],ft[wt]),W[wt]=Math.max(W[wt],ft[wt]);const te=Ks(h.$/2,h.$/2,e.x,e.y,e.z),he=h.aV([],[0,1,0],te);h.aU(he,he);const Ae=h.aV([],te,he);h.aU(Ae,Ae);const Ce=h.aV([],V[2],V[1]);h.aU(Ce,Ce);const ke=h.aV([],V[0],V[3]);h.aU(ke,ke),q.push(h.aQ([],te,L)),e.y>=(1<<e.z)/2&&q.push(h.aQ([],Ks(h.$/2,0,e.x,e.y,e.z),L)),e.y<(1<<e.z)/2&&q.push(h.aQ([],Ks(h.$/2,h.$,e.x,e.y,e.z),L));const ze=kn(te,q),Le=kn(Ae,q),De=[-te[0],-te[1],-te[2],ze.max],Ge=[te[0],te[1],te[2],-ze.min],Ye=[-Ae[0],-Ae[1],-Ae[2],Le.max],Re=[Ae[0],Ae[1],Ae[2],-Le.min],it=[...Ce,0],vt=[...ke,0],ot=[];return e.y===0?ot.push(h.bs(vt,it,De),h.bs(vt,it,Ge)):ot.push(h.bs(Ye,it,De),h.bs(Ye,it,Ge),h.bs(Ye,vt,De),h.bs(Ye,vt,Ge)),e.y===(1<<e.z)-1?ot.push(h.bs(vt,it,De),h.bs(vt,it,Ge)):ot.push(h.bs(Re,it,De),h.bs(Re,it,Ge),h.bs(Re,vt,De),h.bs(Re,vt,Ge)),new rl(ot,[De,Ge,Ye,Re,it,vt],K,W)}}}function kn(y,e){let r=1/0,c=-1/0;for(const f of e){const _=h.aW(y,f);r=Math.min(r,_),c=Math.max(c,_)}return{min:r,max:c}}class _c{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,c){return this._helper.interpolatePadding(e,r,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=h.bu(),this._projectionMatrix=h.b8(),this._globeViewProjMatrix32f=h.b7(),this._globeViewProjMatrixNoCorrection=h.b8(),this._globeViewProjMatrixNoCorrectionInverted=h.b8(),this._globeProjMatrixInverted=h.b8(),this._cameraPosition=h.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Do({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new ef}clone(){const e=new _c;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=h.bo();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:r,applyGlobeMatrix:c}=e,f=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,c=this.cameraToCenterDistance/e,f=Math.sin(r)*c,_=Math.cos(r)*c+1,M=1/Math.sqrt(f*f+_*_)*1;let P=-f,L=_;const V=Math.sqrt(P*P+L*L);P/=V,L/=V;const q=[0,P,L];h.bv(q,q,[0,0,0],-this.bearingInRadians),h.bw(q,q,[0,0,0],-1*this.center.lat*Math.PI/180),h.bx(q,q,[0,0,0],this.center.lng*Math.PI/180);const K=1/h.aY(q);return h.aQ(q,q,K),[...q,-M*K]}isLocationOccluded(e){return!this.isSurfacePointVisible(Vn(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,f=Math.cos(c),_=[Math.sin(r)*f,Math.sin(c),Math.cos(r)*f],M=[_[2],0,-_[0]],P=[0,0,0];h.aV(P,M,_),h.aU(M,M),h.aU(P,P);const L=[0,0,0];return h.aU(L,[M[0]*e[0]+P[0]*e[1]+_[0]*e[2],M[1]*e[0]+P[1]*e[1]+_[1]*e[2],M[2]*e[0]+P[2]*e[1]+_[2]*e[2]]),L}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,c){const f=function(P,L,V){const q=1/(1<<V.z);return new h.a0(P/h.$*q+V.x*q,L/h.$*q+V.y*q)}(e,r,c.canonical),_=(M=f.y,[h.bn(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-M*Math.PI*2))-.5*Math.PI]);var M;return this.getCircleRadiusCorrection()/Math.cos(_[1])}projectTileCoordinates(e,r,c,f){const _=c.canonical,M=Ks(e,r,_.x,_.y,_.z),P=1+(f?f(e,r):0)/h.bt,L=[M[0]*P,M[1]*P,M[2]*P,1];h.av(L,L,this._globeViewProjMatrixNoCorrection);const V=this._cachedClippingPlane,q=V[0]*M[0]+V[1]*M[1]+V[2]*M[2]+V[3]<0;return{point:new h.P(L[0]/L[3],L[1]/L[3]),signedDistanceFromCamera:L[3],isOccluded:q}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=sn(this.worldSize,this.center.lat),r=h.b9(),c=h.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),h.b3(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;r[8]=2*-f.x/this._helper._width,r[9]=2*f.y/this._helper._height,this._projectionMatrix=h.b4(r),this._globeProjMatrixInverted=h.b9(),h.ap(this._globeProjMatrixInverted,r),h.M(r,r,[0,0,-this.cameraToCenterDistance]),h.b5(r,r,this.rollInRadians),h.b6(r,r,-this.pitchInRadians),h.b5(r,r,this.bearingInRadians),h.M(r,r,[0,0,-e]);const _=h.bo();_[0]=e,_[1]=e,_[2]=e,h.b6(c,r,this.center.lat*Math.PI/180),h.by(c,c,-this.center.lng*Math.PI/180),h.N(c,c,_),this._globeViewProjMatrixNoCorrection=c,h.b6(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),h.by(r,r,-this.center.lng*Math.PI/180),h.N(r,r,_),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=h.b9(),h.ap(this._globeViewProjMatrixNoCorrectionInverted,c);const M=h.bo();this._cameraPosition=h.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/e,h.bv(this._cameraPosition,this._cameraPosition,M,-this.rollInRadians),h.bw(this._cameraPosition,this._cameraPosition,M,this.pitchInRadians),h.bv(this._cameraPosition,this._cameraPosition,M,-this.bearingInRadians),h.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),h.bw(this._cameraPosition,this._cameraPosition,M,-this.center.lat*Math.PI/180),h.bx(this._cameraPosition,this._cameraPosition,M,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const P=h.b4(this._globeViewProjMatrixNoCorrectionInverted);h.N(P,P,[1,1,-1]),this._cachedFrustum=ca.fromInvProjectionMatrix(P,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){h.w("calculateFogMatrix is not supported on globe projection.");const r=h.b9();return h.af(r),r}getVisibleUnwrappedCoordinates(e){return[new h.b1(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&h.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=Vn(e);h.aQ(c,c,1+r/h.bt);const f=h.bu();return h.av(f,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,c=[new h.P(0,0),new h.P(e,0),new h.P(this.width,0),new h.P(this.width,r),new h.P(this.width,this.height),new h.P(e,this.height),new h.P(0,this.height),new h.P(0,r)],f=[];for(const K of c)f.push(this.unprojectScreenPoint(K));let _=0,M=0,P=0,L=0;const V=this.center;for(const K of f){const W=h.bz(V.lng,K.lng),te=h.bz(V.lat,K.lat);W<M&&(M=W),W>_&&(_=W),te<L&&(L=te),te>P&&(P=te)}const q=[V.lng+M,V.lat+L,V.lng+_,V.lat+P];return this.isSurfacePointOnScreen([0,1,0])&&(q[3]=90,q[0]=-180,q[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(q[1]=-90,q[0]=-180,q[2]=180),new li(q)}getConstrained(e,r){const c=h.ag(e.lat,-85.051129,h.ah),f=h.ag(+r,this.minZoom+Nn(0,c),this.maxZoom);return{center:new h.S(e.lng,c),zoom:f}}calculateCenterFromCameraLngLatAlt(e,r,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,c,f)}setLocationAtPoint(e,r){const c=Vn(this.unprojectScreenPoint(r)),f=Vn(e),_=h.bo();h.bA(_);const M=h.bo();h.bx(M,c,_,-this.center.lng*Math.PI/180),h.bw(M,M,_,this.center.lat*Math.PI/180);const P=f[0]*f[0]+f[2]*f[2],L=M[0]*M[0];if(P<L)return;const V=Math.sqrt(P-L),q=-V,K=h.bB(f[0],f[2],M[0],V),W=h.bB(f[0],f[2],M[0],q),te=h.bo();h.bx(te,f,_,-K);const he=h.bB(te[1],te[2],M[1],M[2]),Ae=h.bo();h.bx(Ae,f,_,-W);const Ce=h.bB(Ae[1],Ae[2],M[1],M[2]),ke=.5*Math.PI,ze=he>=-ke&&he<=ke,Le=Ce>=-ke&&Ce<=ke;let De,Ge;if(ze&&Le){const vt=this.center.lng*Math.PI/180,ot=this.center.lat*Math.PI/180;h.bC(K,vt)+h.bC(he,ot)<h.bC(W,vt)+h.bC(Ce,ot)?(De=K,Ge=he):(De=W,Ge=Ce)}else if(ze)De=K,Ge=he;else{if(!Le)return;De=W,Ge=Ce}const Ye=De/Math.PI*180,Re=Ge/Math.PI*180,it=this.center.lat;this.setCenter(new h.S(Ye,h.ag(Re,-90,90))),this.setZoom(this.zoom+Nn(it,this.center.lat))}locationToScreenPoint(e,r){const c=Vn(e);if(r){const f=r.getElevationForLngLatZoom(e,this._helper._tileZoom);h.aQ(c,c,1+f/h.bt)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(e){const r=h.bu();return h.av(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new h.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const c=r.pointCoordinate(e);if(c)return c}return h.a0.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var c;return(c=this.screenPointToMercatorCoordinate(e,r))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(e,r){const c=this._cameraPosition,f=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(c,f)}getRayDirectionFromPixel(e){const r=h.bu();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,h.av(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const c=h.bo();c[0]=r[0]-this._cameraPosition[0],c[1]=r[1]-this._cameraPosition[1],c[2]=r[2]-this._cameraPosition[2];const f=h.bo();return h.aU(f,c),f}isSurfacePointVisible(e){const r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=h.bu();return h.av(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const c=h.aW(e,r),f=h.bo(),_=h.bo();h.aQ(_,r,c),h.aT(f,e,_);const M=1-h.aW(f,f);if(M<0)return null;const P=h.aW(e,e)-1,L=-c+(c<0?1:-1)*Math.sqrt(M),V=P/L,q=L;return{tMin:Math.min(V,q),tMax:Math.max(V,q)}}unprojectScreenPoint(e){const r=this._cameraPosition,c=this.getRayDirectionFromPixel(e),f=this.rayPlanetIntersection(r,c);if(f){const q=h.bo();h.aR(q,r,[c[0]*f.tMin,c[1]*f.tMin,c[2]*f.tMin]);const K=h.bo();return h.aU(K,q),Ta(K)}const _=this._cachedClippingPlane,M=_[0]*c[0]+_[1]*c[1]+_[2]*c[2],P=-h.b0(_,r)/M,L=h.bo();if(P>0)h.aR(L,r,[c[0]*P,c[1]*P,c[2]*P]);else{const q=h.bo();h.aR(q,r,[2*c[0],2*c[1],2*c[2]]);const K=h.b0(this._cachedClippingPlane,q);h.aT(L,q,[this._cachedClippingPlane[0]*K,this._cachedClippingPlane[1]*K,this._cachedClippingPlane[2]*K])}const V=function(q){const K=h.bo();return K[0]=q[0]*-q[3],K[1]=q[1]*-q[3],K[2]=q[2]*-q[3],{center:K,radius:Math.sqrt(1-q[3]*q[3])}}(_);return Ta(function(q,K,W){const te=h.bo();h.aT(te,W,q);const he=h.bo();return h.bp(he,q,te,K/h.a_(te)),he}(V.center,V.radius,L))}getMatrixForModel(e,r){const c=h.S.convert(e),f=1/h.bt,_=h.b8();return h.by(_,_,c.lng/180*Math.PI),h.b6(_,_,-c.lat/180*Math.PI),h.M(_,_,[0,0,1+r/h.bt]),h.b6(_,_,.5*Math.PI),h.N(_,_,[f,f,f]),_}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new h.Z(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class ts{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,c){return this._helper.interpolatePadding(e,r,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,c=!0){this._helper.resize(e,r,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Do({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new an,this._verticalPerspectiveTransform=new _c}clone(){const e=new ts;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const r=this._mercatorTransform.getProjectionData(e),c=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:r.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return h.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return h.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,c){const f=this._mercatorTransform.getPitchedTextCorrection(e,r,c),_=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,c);return h.bj(f,_,this._globeness)}projectTileCoordinates(e,r,c,f){return this.currentTransform.projectTileCoordinates(e,r,c,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,c,f)}setLocationAtPoint(e,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return c.fallbackMatrix=r.mainMatrix,c}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Ma{get useGlobeControls(){return!0}handlePanInertia(e,r){const c=iu(e,r);return Math.abs(c.lng-r.center.lng)>180&&(c.lng=r.center.lng+179.5*Math.sign(c.lng-r.center.lng)),{easingCenter:c,easingOffset:new h.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const c=e.around,f=r.screenPointToLocation(c);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const _=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const M=r.zoom-_;if(M===0)return;const P=h.bz(r.center.lng,f.lng),L=P/(Math.abs(P/180)+1),V=h.bz(r.center.lat,f.lat),q=r.getRayDirectionFromPixel(c),K=r.cameraPosition,W=-1*h.aW(K,q),te=h.bo();h.aR(te,K,[q[0]*W,q[1]*W,q[2]*W]);const he=h.aY(te)-1,Ae=Math.exp(.5*-Math.max(he-.3,0)),Ce=sn(r.worldSize,r.center.lat)/Math.min(r.width,r.height),ke=h.bm(Ce,.9,.5,1,.25),ze=(1-h.ae(-M))*Math.min(Ae,ke),Le=r.center.lat,De=r.zoom,Ge=new h.S(r.center.lng+L*ze,h.ag(r.center.lat+V*ze,-85.051129,h.ah));r.setLocationAtPoint(f,c);const Ye=r.center,Re=h.bm(Math.abs(P),45,85,0,1),it=h.bm(Ce,.75,.35,0,1),vt=Math.pow(Math.max(Re,it),.25),ot=h.bz(Ye.lng,Ge.lng),ft=h.bz(Ye.lat,Ge.lat);r.setCenter(new h.S(Ye.lng+ot*vt,Ye.lat+ft*vt).wrap()),r.setZoom(De+Nn(Le,r.center.lat))}handleMapControlsPan(e,r,c){if(!e.panDelta)return;const f=r.center.lat,_=r.zoom;r.setCenter(iu(e.panDelta,r).wrap()),r.setZoom(_+Nn(f,r.center.lat))}cameraForBoxAndBearing(e,r,c,f,_){const M=kr(e,r,c,f,_),P=r.left/_.width*2-1,L=(_.width-r.right)/_.width*2-1,V=r.top/_.height*-2+1,q=(_.height-r.bottom)/_.height*-2+1,K=h.bz(c.getWest(),c.getEast())<0,W=K?c.getEast():c.getWest(),te=K?c.getWest():c.getEast(),he=Math.max(c.getNorth(),c.getSouth()),Ae=Math.min(c.getNorth(),c.getSouth()),Ce=W+.5*h.bz(W,te),ke=he+.5*h.bz(he,Ae),ze=_.clone();ze.setCenter(M.center),ze.setBearing(M.bearing),ze.setPitch(0),ze.setRoll(0),ze.setZoom(M.zoom);const Le=ze.modelViewProjectionMatrix,De=[Vn(c.getNorthWest()),Vn(c.getNorthEast()),Vn(c.getSouthWest()),Vn(c.getSouthEast()),Vn(new h.S(te,ke)),Vn(new h.S(W,ke)),Vn(new h.S(Ce,he)),Vn(new h.S(Ce,Ae))],Ge=Vn(M.center);let Ye=Number.POSITIVE_INFINITY;for(const Re of De)P<0&&(Ye=Ma.getLesserNonNegativeNonNull(Ye,Ma.solveVectorScale(Re,Ge,Le,"x",P))),L>0&&(Ye=Ma.getLesserNonNegativeNonNull(Ye,Ma.solveVectorScale(Re,Ge,Le,"x",L))),V>0&&(Ye=Ma.getLesserNonNegativeNonNull(Ye,Ma.solveVectorScale(Re,Ge,Le,"y",V))),q<0&&(Ye=Ma.getLesserNonNegativeNonNull(Ye,Ma.solveVectorScale(Re,Ge,Le,"y",q)));if(Number.isFinite(Ye)&&Ye!==0)return M.zoom=ze.zoom+h.aj(Ye),M;Jr()}handleJumpToCenterZoom(e,r){const c=e.center.lat,f=e.getConstrained(r.center?h.S.convert(r.center):e.center,e.zoom).center;e.setCenter(f.wrap());const _=r.zoom!==void 0?+r.zoom:e.zoom+Nn(c,f.lat);e.zoom!==_&&e.setZoom(_)}handleEaseTo(e,r){const c=e.zoom,f=e.center,_=e.padding,M={roll:e.roll,pitch:e.pitch,bearing:e.bearing},P={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},L=r.zoom!==void 0,V=!e.isPaddingEqual(r.padding);let q=!1;const K=r.center?h.S.convert(r.center):f,W=e.getConstrained(K,c).center;Es(e,W);const te=e.clone();te.setCenter(W),te.setZoom(L?+r.zoom:c+Nn(f.lat,K.lat)),te.setBearing(r.bearing);const he=new h.P(h.ag(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),h.ag(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));te.setLocationAtPoint(W,he);const Ae=(r.offset&&r.offsetAsPoint.mag())>0?te.center:W,Ce=L?+r.zoom:c+Nn(f.lat,Ae.lat),ke=c+Nn(f.lat,0),ze=Ce+Nn(Ae.lat,0),Le=h.bz(f.lng,Ae.lng),De=h.bz(f.lat,Ae.lat),Ge=h.ae(ze-ke);return q=Ce!==c,{easeFunc:Ye=>{if(h.bd(M,P)||Bn({startEulerAngles:M,endEulerAngles:P,tr:e,k:Ye,useSlerp:M.roll!=P.roll}),V&&e.interpolatePadding(_,r.padding,Ye),r.around)h.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const Re=ze>ke?Math.min(2,Ge):Math.max(.5,Ge),it=Math.pow(Re,1-Ye),vt=ru(f,Le,De,Ye*it);e.setCenter(vt.wrap())}if(q){const Re=h.C.number(ke,ze,Ye)+Nn(0,e.center.lat);e.setZoom(Re)}},isZooming:q,elevationCenter:Ae}}handleFlyTo(e,r){const c=r.zoom!==void 0,f=e.center,_=e.zoom,M=e.padding,P=!e.isPaddingEqual(r.padding),L=e.getConstrained(h.S.convert(r.center||r.locationAtOffset),_).center,V=c?+r.zoom:e.zoom+Nn(e.center.lat,L.lat),q=e.clone();q.setCenter(L),q.setZoom(V),q.setBearing(r.bearing);const K=new h.P(h.ag(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),h.ag(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));q.setLocationAtPoint(L,K);const W=q.center;Es(e,W);const te=function(De,Ge,Ye){const Re=Vn(Ge),it=Vn(Ye),vt=h.aW(Re,it),ot=Math.acos(vt),ft=tu(De);return ot/(2*Math.PI)*ft}(e,f,W),he=_+Nn(f.lat,0),Ae=V+Nn(W.lat,0),Ce=h.ae(Ae-he);let ke;if(typeof r.minZoom=="number"){const De=+r.minZoom+Nn(W.lat,0),Ge=Math.min(De,he,Ae)+Nn(0,W.lat),Ye=e.getConstrained(W,Ge).zoom+Nn(W.lat,0);ke=h.ae(Ye-he)}const ze=h.bz(f.lng,W.lng),Le=h.bz(f.lat,W.lat);return{easeFunc:(De,Ge,Ye,Re)=>{const it=ru(f,ze,Le,Ye);P&&e.interpolatePadding(M,r.padding,De);const vt=De===1?W:it;e.setCenter(vt.wrap());const ot=he+h.aj(Ge);e.setZoom(De===1?V:ot+Nn(0,vt.lat))},scaleOfZoom:Ce,targetCenter:W,scaleOfMinZoom:ke,pixelPathLength:te}}static solveVectorScale(e,r,c,f,_){const M=f==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],P=[c[3],c[7],c[11],c[15]],L=e[0]*M[0]+e[1]*M[1]+e[2]*M[2],V=e[0]*P[0]+e[1]*P[1]+e[2]*P[2],q=r[0]*M[0]+r[1]*M[1]+r[2]*M[2],K=r[0]*P[0]+r[1]*P[1]+r[2]*P[2];return q+_*V===L+_*K||P[3]*(L-q)+M[3]*(K-V)+L*K==q*V?null:(q+M[3]-_*K-_*P[3])/(q-L-_*K+_*V)}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}}class Uu{constructor(e){this._globe=e,this._mercatorCameraHelper=new ks,this._verticalPerspectiveCameraHelper=new Ma}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,c){this.currentHelper.handleMapControlsPan(e,r,c)}cameraForBoxAndBearing(e,r,c,f,_){return this.currentHelper.cameraForBoxAndBearing(e,r,c,f,_)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}}const xc=(y,e)=>h.y(y,e&&e.filter(r=>r.identifier!=="source.canvas")),nu=h.bD();class Eh extends h.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const f=this.sourceCaches[c].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[c].reload()}},this.map=e,this.dispatcher=new Ri(Qi(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,f)=>this.getGlyphs(c,f)),this.dispatcher.registerMessageHandler("GI",(c,f)=>this.getImages(c,f)),this.imageManager=new zt,this.imageManager.setEventedParent(this),this.glyphManager=new Yt(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new ki(256,512),this.crossTileSymbolIndex=new Sa,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",h.bF()),en().on(ba,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const f=this.sourceCaches[c.sourceId];if(!f)return;const _=f.getSource();if(_&&_.vectorLayerIds)for(const M in this._layers){const P=this._layers[M];P.source===_.id&&this._validateLayer(P)}})}setGlobalStateProperty(e,r){var c,f,_;this._checkLoaded();const M=r===null?(_=(f=(c=this.stylesheet.state)===null||c===void 0?void 0:c[e])===null||f===void 0?void 0:f.default)!==null&&_!==void 0?_:null:r;if(h.bG(M,this._globalState[e]))return this;this._globalState[e]=M;const P=this._findGlobalStateAffectedSources([e]);for(const L in this.sourceCaches)P.has(L)&&(this._reloadSource(L),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const r=[];for(const f in e)!h.bG(this._globalState[f],e[f].default)&&(r.push(f),this._globalState[f]=e[f].default);const c=this._findGlobalStateAffectedSources(r);for(const f in this.sourceCaches)c.has(f)&&(this._reloadSource(f),this._changed=!0)}_findGlobalStateAffectedSources(e){if(e.length===0)return new Set;const r=new Set;for(const c in this._layers){const f=this._layers[c],_=f.getLayoutAffectingGlobalStateRefs();for(const M of e)_.has(M)&&r.add(f.source)}return r}loadURL(e,r={},c){this.fire(new h.l("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const f=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const _=this._loadStyleRequest;h.j(f,this._loadStyleRequest).then(M=>{this._loadStyleRequest=null,this._load(M.data,r,c)}).catch(M=>{this._loadStyleRequest=null,M&&!_.signal.aborted&&this.fire(new h.k(M))})}loadJSON(e,r={},c){this.fire(new h.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Ee.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,c)}).catch(()=>{})}loadEmpty(){this.fire(new h.l("dataloading",{dataType:"style"})),this._load(nu,{validate:!1})}_load(e,r,c){var f,_,M;const P=r.transformStyle?r.transformStyle(c,e):e;if(!r.validate||!xc(this,h.z(P))){this._loaded=!0,this.stylesheet=P;for(const L in P.sources)this.addSource(L,P.sources[L],{validate:!1});P.sprite?this._loadSprite(P.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(P.glyphs),this._createLayers(),this.light=new gt(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new ti(this.stylesheet.sky),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.setGlobalState((M=this.stylesheet.state)!==null&&M!==void 0?M:null),this.fire(new h.l("data",{dataType:"style"})),this.fire(new h.l("style.load"))}}_createLayers(){const e=h.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of e){const c=h.bI(r);c.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=c}}_loadSprite(e,r=!1,c=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(_,M,P,L){return h._(this,void 0,void 0,function*(){const V=pt(_),q=P>1?"@2x":"",K={},W={};for(const{id:te,url:he}of V){const Ae=M.transformRequest(Pt(he,q,".json"),"SpriteJSON");K[te]=h.j(Ae,L);const Ce=M.transformRequest(Pt(he,q,".png"),"SpriteImage");W[te]=ct.getImage(Ce,L)}return yield Promise.all([...Object.values(K),...Object.values(W)]),function(te,he){return h._(this,void 0,void 0,function*(){const Ae={};for(const Ce in te){Ae[Ce]={};const ke=Ee.getImageCanvasContext((yield he[Ce]).data),ze=(yield te[Ce]).data;for(const Le in ze){const{width:De,height:Ge,x:Ye,y:Re,sdf:it,pixelRatio:vt,stretchX:ot,stretchY:ft,content:wt,textFitWidth:ei,textFitHeight:Kt}=ze[Le];Ae[Ce][Le]={data:null,pixelRatio:vt,sdf:it,stretchX:ot,stretchY:ft,content:wt,textFitWidth:ei,textFitHeight:Kt,spriteData:{width:De,height:Ge,x:Ye,y:Re,context:ke}}}}return Ae})}(K,W)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(_=>{if(this._spriteRequest=null,_)for(const M in _){this._spritesImagesIds[M]=[];const P=this._spritesImagesIds[M]?this._spritesImagesIds[M].filter(L=>!(L in _)):[];for(const L of P)this.imageManager.removeImage(L),this._changedImages[L]=!0;for(const L in _[M]){const V=M==="default"?L:`${M}:${L}`;this._spritesImagesIds[M].push(V),V in this.imageManager.images?this.imageManager.updateImage(V,_[M][L],!1):this.imageManager.addImage(V,_[M][L]),r&&(this._changedImages[V]=!0)}}}).catch(_=>{this._spriteRequest=null,f=_,this.fire(new h.k(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"})),c&&c(f)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const c=e.sourceLayer;if(!c)return;const f=r.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(c)===-1)&&this.fire(new h.k(new Error(`Source layer "${c}" does not exist on source "${f.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const c=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?h.bJ(c):c);const f=[];for(const _ of e)if(c[_]){const M=r?h.bJ(c[_]):c[_];f.push(M)}return f}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const r=Object.keys(this._layers);for(const c of r){const f=this._layers[c];f.type!=="custom"&&(e[c]=f.serialize())}return e}hasTransitions(){var e,r,c;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const f=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(f.length||_.length)&&this._updateWorkerLayers(f,_);for(const M in this._updatedSources){const P=this._updatedSources[M];if(P==="reload")this._reloadSource(M);else{if(P!=="clear")throw new Error(`Invalid action ${P}`);this._clearSource(M)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const c={};for(const f in this.sourceCaches){const _=this.sourceCaches[f];c[f]=_.used,_.used=!1}for(const f of this._order){const _=this._layers[f];_.recalculate(e,this._availableImages),!_.isHidden(e.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const f in c){const _=this.sourceCaches[f];!!c[f]!=!!_.used&&_.fire(new h.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new h.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var c;this._checkLoaded();const f=this.serialize();if(e=r.transformStyle?r.transformStyle(f,e):e,((c=r.validate)===null||c===void 0||c)&&xc(this,h.z(e)))return!1;(e=h.bJ(e)).layers=h.bH(e.layers);const _=h.bK(f,e),M=this._getOperationsToPerform(_);if(M.unimplemented.length>0)throw new Error(`Unimplemented: ${M.unimplemented.join(", ")}.`);if(M.operations.length===0)return!1;for(const P of M.operations)P();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const r=[],c=[];for(const f of e)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":r.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":r.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,f.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setSky":r.push(()=>this.setSky.apply(this,f.args));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setGlobalState":r.push(()=>this.setGlobalState.apply(this,f.args));break;case"setTransition":r.push(()=>{});break;default:c.push(f.command)}return{operations:r,unimplemented:c}}addImage(e,r){if(this.getImage(e))return this.fire(new h.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new h.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,c={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(h.z.source,`sources.${e}`,r,null,c))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const f=this.sourceCaches[e]=new jt(e,r,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:e})),f.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===e)return this.fire(new h.k(new Error(`Source "${e}" cannot be removed while layer "${c}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new h.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const c=this.sourceCaches[e].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,c={}){this._checkLoaded();const f=e.id;if(this.getLayer(f))return void this.fire(new h.k(new Error(`Layer "${f}" already exists on this map.`)));let _;if(e.type==="custom"){if(xc(this,h.bL(e)))return;_=h.bI(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(f,e.source),e=h.bJ(e),e=h.e(e,{source:f})),this._validate(h.z.layer,`layers.${f}`,e,{arrayIndex:-1},c))return;_=h.bI(e),this._validateLayer(_),_.setEventedParent(this,{layer:{id:f}})}const M=r?this._order.indexOf(r):this._order.length;if(r&&M===-1)this.fire(new h.k(new Error(`Cannot add layer "${f}" before non-existing layer "${r}".`)));else{if(this._order.splice(M,0,f),this._layerOrderChanged=!0,this._layers[f]=_,this._removedLayers[f]&&_.source&&_.type!=="custom"){const P=this._removedLayers[f];delete this._removedLayers[f],P.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new h.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const c=this._order.indexOf(e);this._order.splice(c,1);const f=r?this._order.indexOf(r):this._order.length;r&&f===-1?this.fire(new h.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(f,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new h.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const c=this._order.indexOf(e);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,c){this._checkLoaded();const f=this.getLayer(e);f?f.minzoom===r&&f.maxzoom===c||(r!=null&&(f.minzoom=r),c!=null&&(f.maxzoom=c),this._updateLayer(f)):this.fire(new h.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,c={}){this._checkLoaded();const f=this.getLayer(e);if(f){if(!h.bG(f.filter,r))return r==null?(f.setFilter(void 0),void this._updateLayer(f)):void(this._validate(h.z.filter,`layers.${f.id}.filter`,r,null,c)||(f.setFilter(h.bJ(r)),this._updateLayer(f)))}else this.fire(new h.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return h.bJ(this.getLayer(e).filter)}setLayoutProperty(e,r,c,f={}){this._checkLoaded();const _=this.getLayer(e);_?h.bG(_.getLayoutProperty(r),c)||(_.setLayoutProperty(r,c,f),this._updateLayer(_)):this.fire(new h.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const c=this.getLayer(e);if(c)return c.getLayoutProperty(r);this.fire(new h.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,c,f={}){this._checkLoaded();const _=this.getLayer(e);_?h.bG(_.getPaintProperty(r),c)||(_.setPaintProperty(r,c,f)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new h.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const c=e.source,f=e.sourceLayer,_=this.sourceCaches[c];if(_===void 0)return void this.fire(new h.k(new Error(`The source '${c}' does not exist in the map's style.`)));const M=_.getSource().type;M==="geojson"&&f?this.fire(new h.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):M!=="vector"||f?(e.id===void 0&&this.fire(new h.k(new Error("The feature id parameter must be provided."))),_.setFeatureState(f,e.id,r)):this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const c=e.source,f=this.sourceCaches[c];if(f===void 0)return void this.fire(new h.k(new Error(`The source '${c}' does not exist in the map's style.`)));const _=f.getSource().type,M=_==="vector"?e.sourceLayer:void 0;_!=="vector"||M?r&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new h.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(M,e.id,r):this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,c=e.sourceLayer,f=this.sourceCaches[r];if(f!==void 0)return f.getSource().type!=="vector"||c?(e.id===void 0&&this.fire(new h.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(c,e.id)):void this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return h.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=h.bM(this.sourceCaches,_=>_.serialize()),r=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,f=this.stylesheet;return h.bN({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:e,layers:r,terrain:c},_=>_!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const r=M=>this._layers[M].type==="fill-extrusion",c={},f=[];for(let M=this._order.length-1;M>=0;M--){const P=this._order[M];if(r(P)){c[P]=M;for(const L of e){const V=L[P];if(V)for(const q of V)f.push(q)}}}f.sort((M,P)=>P.intersectionZ-M.intersectionZ);const _=[];for(let M=this._order.length-1;M>=0;M--){const P=this._order[M];if(r(P))for(let L=f.length-1;L>=0;L--){const V=f[L].feature;if(c[V.layer.id]<M)break;_.push(V),f.pop()}else for(const L of e){const V=L[P];if(V)for(const q of V)_.push(q.feature)}}return _}queryRenderedFeatures(e,r,c){r&&r.filter&&this._validate(h.z.filter,"queryRenderedFeatures.filter",r.filter,null,r);const f={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new h.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const V of r.layers){const q=this._layers[V];if(!q)return this.fire(new h.k(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];f[q.source]=!0}}const _=[];r.availableImages=this._availableImages;const M=this._serializedAllLayers(),P=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,L=Object.assign(Object.assign({},r),{layers:P});for(const V in this.sourceCaches)r.layers&&!f[V]||_.push(Cr(this.sourceCaches[V],this._layers,M,e,L,c,this.map.terrain?(q,K,W)=>this.map.terrain.getElevation(q,K,W):void 0));return this.placement&&_.push(function(V,q,K,W,te,he,Ae){const Ce={},ke=he.queryRenderedSymbols(W),ze=[];for(const Le of Object.keys(ke).map(Number))ze.push(Ae[Le]);ze.sort(Pl);for(const Le of ze){const De=Le.featureIndex.lookupSymbolFeatures(ke[Le.bucketInstanceId],q,Le.bucketIndex,Le.sourceLayerIndex,te.filter,te.layers,te.availableImages,V);for(const Ge in De){const Ye=Ce[Ge]=Ce[Ge]||[],Re=De[Ge];Re.sort((it,vt)=>{const ot=Le.featureSortOrder;if(ot){const ft=ot.indexOf(it.featureIndex);return ot.indexOf(vt.featureIndex)-ft}return vt.featureIndex-it.featureIndex});for(const it of Re)Ye.push(it)}}return function(Le,De,Ge){for(const Ye in Le)for(const Re of Le[Ye])aa(Re,Ge[De[Ye].source]);return Le}(Ce,V,K)}(this._layers,M,this.sourceCaches,e,L,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(e,r){r&&r.filter&&this._validate(h.z.filter,"querySourceFeatures.filter",r.filter,null,r);const c=this.sourceCaches[e];return c?function(f,_){const M=f.getRenderableIds().map(V=>f.getTileByID(V)),P=[],L={};for(let V=0;V<M.length;V++){const q=M[V],K=q.tileID.canonical.key;L[K]||(L[K]=!0,q.querySourceFeatures(P,_))}return P}(c,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const c=this.light.getLight();let f=!1;for(const M in e)if(!h.bG(e[M],c[M])){f=!0;break}if(!f)return;const _={now:Ee.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(_)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const c=this.getSky();let f=!1;if(!e&&!c)return;if(e&&!c)f=!0;else if(!e&&c)f=!0;else for(const M in e)if(!h.bG(e[M],c[M])){f=!0;break}if(!f)return;const _={now:Ee.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(_)}_setProjectionInternal(e){const r=function(c){if(Array.isArray(c)){const f=new Ol({type:c});return{projection:f,transform:new ts,cameraHelper:new Uu(f)}}switch(c){case"mercator":return{projection:new eu,transform:new an,cameraHelper:new ks};case"globe":{const f=new Ol({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new ts,cameraHelper:new Uu(f)}}case"vertical-perspective":return{projection:new zs,transform:new _c,cameraHelper:new Ma};default:return h.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new eu,transform:new an,cameraHelper:new ks}}}(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(e,r,c,f,_={}){return(!_||_.validate!==!1)&&xc(this,e.call(h.z,h.e({key:r,style:this.serialize(),value:c,styleSpec:h.v},f)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),en().off(ba,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const c=this.sourceCaches[r];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,c,f,_=!1){let M=!1,P=!1;const L={};for(const V of this._order){const q=this._layers[V];if(q.type!=="symbol")continue;if(!L[q.source]){const W=this.sourceCaches[q.source];L[q.source]=W.getRenderableIds(!0).map(te=>W.getTileByID(te)).sort((te,he)=>he.tileID.overscaledZ-te.tileID.overscaledZ||(te.tileID.isLessThan(he.tileID)?-1:1))}const K=this.crossTileSymbolIndex.addLayer(q,L[q.source],e.center.lng);M=M||K}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ee.now(),e.zoom))&&(this.pauseablePlacement=new gc(e,this.map.terrain,this._order,_,r,c,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ee.now()),P=!0),M&&this.pauseablePlacement.placement.setStale()),P||M)for(const V of this._order){const q=this._layers[V];q.type==="symbol"&&this.placement.updateLayerOpacities(q,L[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ee.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return h._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[r.source];return f&&f.setDependencies(r.tileID.key,r.type,r.icons),c})}getGlyphs(e,r){return h._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(r.stacks),f=this.sourceCaches[r.source];return f&&f.setDependencies(r.tileID.key,r.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(h.z.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,c={},f){this._checkLoaded();const _=[{id:e,url:r}],M=[...pt(this.stylesheet.sprite),..._];this._validate(h.z.sprite,"sprite",M,null,c)||(this.stylesheet.sprite=M,this._loadSprite(_,!0,f))}removeSprite(e){this._checkLoaded();const r=pt(this.stylesheet.sprite);if(r.find(c=>c.id===e)){if(this._spritesImagesIds[e])for(const c of this._spritesImagesIds[e])this.imageManager.removeImage(c),this._changedImages[c]=!0;r.splice(r.findIndex(c=>c.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}else this.fire(new h.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return pt(this.stylesheet.sprite)}setSprite(e,r={},c){this._checkLoaded(),e&&this._validate(h.z.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,c):(this._unloadSprite(),c&&c(null)))}}var bd=h.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class tf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,c,f,_,M,P,L,V){this.context=e;let q=this.boundPaintVertexBuffers.length!==f.length;for(let K=0;!q&&K<f.length;K++)this.boundPaintVertexBuffers[K]!==f[K]&&(q=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==c||q||this.boundIndexBuffer!==_||this.boundVertexOffset!==M||this.boundDynamicVertexBuffer!==P||this.boundDynamicVertexBuffer2!==L||this.boundDynamicVertexBuffer3!==V?this.freshBind(r,c,f,_,M,P,L,V):(e.bindVertexArray.set(this.vao),P&&P.bind(),_&&_.dynamicDraw&&_.bind(),L&&L.bind(),V&&V.bind())}freshBind(e,r,c,f,_,M,P,L){const V=e.numAttributes,q=this.context,K=q.gl;this.vao&&this.destroy(),this.vao=q.createVertexArray(),q.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=f,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=P,this.boundDynamicVertexBuffer3=L,r.enableAttributes(K,e);for(const W of c)W.enableAttributes(K,e);M&&M.enableAttributes(K,e),P&&P.enableAttributes(K,e),L&&L.enableAttributes(K,e),r.bind(),r.setVertexAttribPointers(K,e,_);for(const W of c)W.bind(),W.setVertexAttribPointers(K,e,_);M&&(M.bind(),M.setVertexAttribPointers(K,e,_)),f&&f.bind(),P&&(P.bind(),P.setVertexAttribPointers(K,e,_)),L&&(L.bind(),L.setVertexAttribPointers(K,e,_)),q.currentNumAttributes=V}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const rf=(y,e,r,c,f)=>({u_texture:0,u_ele_delta:y,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):h.be.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:r?r.calculateFogBlendOpacity(c):0,u_horizon_color:r?r.properties.get("horizon-color"):h.be.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),nf={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function kh(y){const e=[];for(let r=0;r<y.length;r++){if(y[r]===null)continue;const c=y[r].split(" ");e.push(c.pop())}return e}class Ph{constructor(e,r,c,f,_,M,P,L,V=[]){const q=e.gl;this.program=q.createProgram();const K=kh(r.staticAttributes),W=c?c.getBinderAttributes():[],te=K.concat(W),he=Po.prelude.staticUniforms?kh(Po.prelude.staticUniforms):[],Ae=P.staticUniforms?kh(P.staticUniforms):[],Ce=r.staticUniforms?kh(r.staticUniforms):[],ke=c?c.getBinderUniforms():[],ze=he.concat(Ae).concat(Ce).concat(ke),Le=[];for(const ot of ze)Le.indexOf(ot)<0&&Le.push(ot);const De=c?c.defines():[];En(q)&&De.unshift("#version 300 es"),_&&De.push("#define OVERDRAW_INSPECTOR;"),M&&De.push("#define TERRAIN3D;"),L&&De.push(L),V&&De.push(...V);let Ge=De.concat(Po.prelude.fragmentSource,P.fragmentSource,r.fragmentSource).join(`
`),Ye=De.concat(Po.prelude.vertexSource,P.vertexSource,r.vertexSource).join(`
`);En(q)||(Ge=function(ot){return ot.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Ge),Ye=function(ot){return ot.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ye));const Re=q.createShader(q.FRAGMENT_SHADER);if(q.isContextLost())return void(this.failedToCreate=!0);if(q.shaderSource(Re,Ge),q.compileShader(Re),!q.getShaderParameter(Re,q.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${q.getShaderInfoLog(Re)}`);q.attachShader(this.program,Re);const it=q.createShader(q.VERTEX_SHADER);if(q.isContextLost())return void(this.failedToCreate=!0);if(q.shaderSource(it,Ye),q.compileShader(it),!q.getShaderParameter(it,q.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${q.getShaderInfoLog(it)}`);q.attachShader(this.program,it),this.attributes={};const vt={};this.numAttributes=te.length;for(let ot=0;ot<this.numAttributes;ot++)te[ot]&&(q.bindAttribLocation(this.program,ot,te[ot]),this.attributes[te[ot]]=ot);if(q.linkProgram(this.program),!q.getProgramParameter(this.program,q.LINK_STATUS))throw new Error(`Program failed to link: ${q.getProgramInfoLog(this.program)}`);q.deleteShader(it),q.deleteShader(Re);for(let ot=0;ot<Le.length;ot++){const ft=Le[ot];if(ft&&!vt[ft]){const wt=q.getUniformLocation(this.program,ft);wt&&(vt[ft]=wt)}}this.fixedUniforms=f(e,vt),this.terrainUniforms=((ot,ft)=>({u_depth:new h.bO(ot,ft.u_depth),u_terrain:new h.bO(ot,ft.u_terrain),u_terrain_dim:new h.bf(ot,ft.u_terrain_dim),u_terrain_matrix:new h.bQ(ot,ft.u_terrain_matrix),u_terrain_unpack:new h.bR(ot,ft.u_terrain_unpack),u_terrain_exaggeration:new h.bf(ot,ft.u_terrain_exaggeration)}))(e,vt),this.projectionUniforms=((ot,ft)=>({u_projection_matrix:new h.bQ(ot,ft.u_projection_matrix),u_projection_tile_mercator_coords:new h.bR(ot,ft.u_projection_tile_mercator_coords),u_projection_clipping_plane:new h.bR(ot,ft.u_projection_clipping_plane),u_projection_transition:new h.bf(ot,ft.u_projection_transition),u_projection_fallback_matrix:new h.bQ(ot,ft.u_projection_fallback_matrix)}))(e,vt),this.binderUniforms=c?c.getUniforms(e,vt):[]}draw(e,r,c,f,_,M,P,L,V,q,K,W,te,he,Ae,Ce,ke,ze,Le){const De=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(c),e.setStencilMode(f),e.setColorMode(_),e.setCullFace(M),L){e.activeTexture.set(De.TEXTURE2),De.bindTexture(De.TEXTURE_2D,L.depthTexture),e.activeTexture.set(De.TEXTURE3),De.bindTexture(De.TEXTURE_2D,L.texture);for(const Ye in this.terrainUniforms)this.terrainUniforms[Ye].set(L[Ye])}if(V)for(const Ye in V)this.projectionUniforms[nf[Ye]].set(V[Ye]);if(P)for(const Ye in this.fixedUniforms)this.fixedUniforms[Ye].set(P[Ye]);Ce&&Ce.setUniforms(e,this.binderUniforms,he,{zoom:Ae});let Ge=0;switch(r){case De.LINES:Ge=2;break;case De.TRIANGLES:Ge=3;break;case De.LINE_STRIP:Ge=1}for(const Ye of te.get()){const Re=Ye.vaos||(Ye.vaos={});(Re[q]||(Re[q]=new tf)).bind(e,this,K,Ce?Ce.getPaintVertexBuffers():[],W,Ye.vertexOffset,ke,ze,Le),De.drawElements(r,Ye.primitiveLength*Ge,De.UNSIGNED_SHORT,Ye.primitiveOffset*Ge*2)}}}function jl(y,e,r){const c=1/h.aB(r,1,e.transform.tileZoom),f=Math.pow(2,r.tileID.overscaledZ),_=r.tileSize*Math.pow(2,e.transform.tileZoom)/f,M=_*(r.tileID.canonical.x+r.tileID.wrap*f),P=_*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[c,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[M>>16,P>>16],u_pixel_coord_lower:[65535&M,65535&P]}}const nl=(y,e,r,c)=>{const f=y.style.light,_=f.properties.get("position"),M=[_.x,_.y,_.z],P=h.bU();f.properties.get("anchor")==="viewport"&&h.bV(P,y.transform.bearingInRadians),h.bW(M,M,P);const L=y.transform.transformLightDirection(M),V=f.properties.get("color");return{u_lightpos:M,u_lightpos_globe:L,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:c}},wd=(y,e,r,c,f,_,M)=>h.e(nl(y,e,r,c),jl(_,y,M),{u_height_factor:-Math.pow(2,f.overscaledZ)/M.tileSize/8}),Vu=(y,e,r,c)=>h.e(jl(e,y,r),{u_fill_translate:c}),Ls=(y,e)=>({u_world:y,u_fill_translate:e}),vc=(y,e,r,c,f)=>h.e(Vu(y,e,r,f),{u_world:c}),Gu=(y,e,r,c,f)=>{const _=y.transform;let M,P,L=0;if(r.paint.get("circle-pitch-alignment")==="map"){const V=h.aB(e,1,_.zoom);M=!0,P=[V,V],L=V/(h.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*f}else M=!1,P=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+M,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:P,u_globe_extrude_scale:L,u_translate:c}},bc=y=>({u_pixel_extrude_scale:[1/y.width,1/y.height]}),Io=y=>({u_viewport_size:[y.width,y.height]}),_p=(y,e=1)=>({u_color:y,u_overlay:0,u_overlay_scale:e}),$u=(y,e,r,c)=>{const f=h.aB(y,1,e)/(h.$*Math.pow(2,y.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:h.aB(y,1,e),u_intensity:r,u_globe_extrude_scale:f}},zh=(y,e,r,c)=>{const f=h.L();h.bX(f,0,y.width,y.height,0,0,1);const _=y.context.gl;return{u_matrix:f,u_world:[_.drawingBufferWidth,_.drawingBufferHeight],u_image:r,u_color_ramp:c,u_opacity:e.paint.get("heatmap-opacity")}},al=(y,e,r)=>{const c=r.paint.get("hillshade-accent-color");let f;switch(r.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const _=r.getIlluminationProperties();for(let M=0;M<_.directionRadians.length;M++)r.paint.get("hillshade-illumination-anchor")==="viewport"&&(_.directionRadians[M]+=y.transform.bearingInRadians);return{u_image:0,u_latrange:sl(0,e.tileID),u_exaggeration:r.paint.get("hillshade-exaggeration"),u_altitudes:_.altitudeRadians,u_azimuths:_.directionRadians,u_accent:c,u_method:f,u_highlights:_.highlightColor,u_shadows:_.shadowColor}},Hu=(y,e)=>{const r=e.stride,c=h.L();return h.bX(c,0,h.$,-8192,0,0,1),h.M(c,c,[0,-8192,0]),{u_matrix:c,u_image:1,u_dimension:[r,r],u_zoom:y.overscaledZ,u_unpack:e.getUnpackVector()}};function sl(y,e){const r=Math.pow(2,e.canonical.z),c=e.canonical.y;return[new h.a0(0,c/r).toLngLat().lat,new h.a0(0,(c+1)/r).toLngLat().lat]}const Zu=(y,e)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_opacity:y.paint.get("color-relief-opacity")}),qu=(y,e,r,c)=>{const f=y.transform;return{u_translation:Xu(y,e,r),u_ratio:c/h.aB(e,1,f.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},ol=(y,e,r,c,f)=>h.e(qu(y,e,r,c),{u_image:0,u_image_height:f}),ll=(y,e,r,c,f)=>{const _=y.transform,M=Js(e,_);return{u_translation:Xu(y,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:c/h.aB(e,1,_.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[M,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Sd=(y,e,r,c,f,_)=>{const M=y.lineAtlas,P=Js(e,y.transform),L=r.layout.get("line-cap")==="round",V=M.getDash(f.from,L),q=M.getDash(f.to,L),K=V.width*_.fromScale,W=q.width*_.toScale;return h.e(qu(y,e,r,c),{u_patternscale_a:[P/K,-V.height/2],u_patternscale_b:[P/W,-q.height/2],u_sdfgamma:M.width/(256*Math.min(K,W)*y.pixelRatio)/2,u_image:0,u_tex_y_a:V.y,u_tex_y_b:q.y,u_mix:_.t})};function Js(y,e){return 1/h.aB(y,1,e.tileZoom)}function Xu(y,e,r){return h.aC(y.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const gs=(y,e,r,c,f)=>{return{u_tl_parent:y,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(M=c.paint.get("raster-saturation"),M>0?1-1/(1.001-M):-M),u_contrast_factor:(_=c.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:wc(c.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var _,M};function wc(y){y*=Math.PI/180;const e=Math.sin(y),r=Math.cos(y);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const Lh=(y,e,r,c,f,_,M,P,L,V,q,K,W)=>{const te=M.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_pitch:te.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:te.width/te.height,u_fade_change:M.options.fadeDuration?M.symbolFadeChange:1,u_label_plane_matrix:P,u_coord_matrix:L,u_is_text:+q,u_pitch_with_map:+c,u_is_along_line:f,u_is_variable_anchor:_,u_texsize:K,u_texture:0,u_translation:V,u_pitched_scale:W}},Bl=(y,e,r,c,f,_,M,P,L,V,q,K,W,te)=>{const he=M.transform;return h.e(Lh(y,e,r,c,f,_,M,P,L,V,q,K,te),{u_gamma_scale:c?Math.cos(he.pitch*Math.PI/180)*he.cameraToCenterDistance:1,u_device_pixel_ratio:M.pixelRatio,u_is_halo:1})},Td=(y,e,r,c,f,_,M,P,L,V,q,K,W)=>h.e(Bl(y,e,r,c,f,_,M,P,L,V,!0,q,0,W),{u_texsize_icon:K,u_texture_icon:1}),Dh=(y,e)=>({u_opacity:y,u_color:e}),af=(y,e,r,c,f)=>h.e(function(_,M,P,L){const V=P.imageManager.getPattern(_.from.toString()),q=P.imageManager.getPattern(_.to.toString()),{width:K,height:W}=P.imageManager.getPixelSize(),te=Math.pow(2,L.tileID.overscaledZ),he=L.tileSize*Math.pow(2,P.transform.tileZoom)/te,Ae=he*(L.tileID.canonical.x+L.tileID.wrap*te),Ce=he*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[K,W],u_mix:M.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:M.fromScale,u_scale_b:M.toScale,u_tile_units_to_pixels:1/h.aB(L,1,P.transform.tileZoom),u_pixel_coord_upper:[Ae>>16,Ce>>16],u_pixel_coord_lower:[65535&Ae,65535&Ce]}}(r,f,e,c),{u_opacity:y}),xp=(y,e)=>{},pa={fillExtrusion:(y,e)=>({u_lightpos:new h.bS(y,e.u_lightpos),u_lightpos_globe:new h.bS(y,e.u_lightpos_globe),u_lightintensity:new h.bf(y,e.u_lightintensity),u_lightcolor:new h.bS(y,e.u_lightcolor),u_vertical_gradient:new h.bf(y,e.u_vertical_gradient),u_opacity:new h.bf(y,e.u_opacity),u_fill_translate:new h.bT(y,e.u_fill_translate)}),fillExtrusionPattern:(y,e)=>({u_lightpos:new h.bS(y,e.u_lightpos),u_lightpos_globe:new h.bS(y,e.u_lightpos_globe),u_lightintensity:new h.bf(y,e.u_lightintensity),u_lightcolor:new h.bS(y,e.u_lightcolor),u_vertical_gradient:new h.bf(y,e.u_vertical_gradient),u_height_factor:new h.bf(y,e.u_height_factor),u_opacity:new h.bf(y,e.u_opacity),u_fill_translate:new h.bT(y,e.u_fill_translate),u_image:new h.bO(y,e.u_image),u_texsize:new h.bT(y,e.u_texsize),u_pixel_coord_upper:new h.bT(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bT(y,e.u_pixel_coord_lower),u_scale:new h.bS(y,e.u_scale),u_fade:new h.bf(y,e.u_fade)}),fill:(y,e)=>({u_fill_translate:new h.bT(y,e.u_fill_translate)}),fillPattern:(y,e)=>({u_image:new h.bO(y,e.u_image),u_texsize:new h.bT(y,e.u_texsize),u_pixel_coord_upper:new h.bT(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bT(y,e.u_pixel_coord_lower),u_scale:new h.bS(y,e.u_scale),u_fade:new h.bf(y,e.u_fade),u_fill_translate:new h.bT(y,e.u_fill_translate)}),fillOutline:(y,e)=>({u_world:new h.bT(y,e.u_world),u_fill_translate:new h.bT(y,e.u_fill_translate)}),fillOutlinePattern:(y,e)=>({u_world:new h.bT(y,e.u_world),u_image:new h.bO(y,e.u_image),u_texsize:new h.bT(y,e.u_texsize),u_pixel_coord_upper:new h.bT(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bT(y,e.u_pixel_coord_lower),u_scale:new h.bS(y,e.u_scale),u_fade:new h.bf(y,e.u_fade),u_fill_translate:new h.bT(y,e.u_fill_translate)}),circle:(y,e)=>({u_camera_to_center_distance:new h.bf(y,e.u_camera_to_center_distance),u_scale_with_map:new h.bO(y,e.u_scale_with_map),u_pitch_with_map:new h.bO(y,e.u_pitch_with_map),u_extrude_scale:new h.bT(y,e.u_extrude_scale),u_device_pixel_ratio:new h.bf(y,e.u_device_pixel_ratio),u_globe_extrude_scale:new h.bf(y,e.u_globe_extrude_scale),u_translate:new h.bT(y,e.u_translate)}),collisionBox:(y,e)=>({u_pixel_extrude_scale:new h.bT(y,e.u_pixel_extrude_scale)}),collisionCircle:(y,e)=>({u_viewport_size:new h.bT(y,e.u_viewport_size)}),debug:(y,e)=>({u_color:new h.bP(y,e.u_color),u_overlay:new h.bO(y,e.u_overlay),u_overlay_scale:new h.bf(y,e.u_overlay_scale)}),depth:xp,clippingMask:xp,heatmap:(y,e)=>({u_extrude_scale:new h.bf(y,e.u_extrude_scale),u_intensity:new h.bf(y,e.u_intensity),u_globe_extrude_scale:new h.bf(y,e.u_globe_extrude_scale)}),heatmapTexture:(y,e)=>({u_matrix:new h.bQ(y,e.u_matrix),u_world:new h.bT(y,e.u_world),u_image:new h.bO(y,e.u_image),u_color_ramp:new h.bO(y,e.u_color_ramp),u_opacity:new h.bf(y,e.u_opacity)}),hillshade:(y,e)=>({u_image:new h.bO(y,e.u_image),u_latrange:new h.bT(y,e.u_latrange),u_exaggeration:new h.bf(y,e.u_exaggeration),u_altitudes:new h.bZ(y,e.u_altitudes),u_azimuths:new h.bZ(y,e.u_azimuths),u_accent:new h.bP(y,e.u_accent),u_method:new h.bO(y,e.u_method),u_shadows:new h.bY(y,e.u_shadows),u_highlights:new h.bY(y,e.u_highlights)}),hillshadePrepare:(y,e)=>({u_matrix:new h.bQ(y,e.u_matrix),u_image:new h.bO(y,e.u_image),u_dimension:new h.bT(y,e.u_dimension),u_zoom:new h.bf(y,e.u_zoom),u_unpack:new h.bR(y,e.u_unpack)}),colorRelief:(y,e)=>({u_image:new h.bO(y,e.u_image),u_unpack:new h.bR(y,e.u_unpack),u_dimension:new h.bT(y,e.u_dimension),u_elevation_stops:new h.bO(y,e.u_elevation_stops),u_color_stops:new h.bO(y,e.u_color_stops),u_opacity:new h.bf(y,e.u_opacity)}),line:(y,e)=>({u_translation:new h.bT(y,e.u_translation),u_ratio:new h.bf(y,e.u_ratio),u_device_pixel_ratio:new h.bf(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bT(y,e.u_units_to_pixels)}),lineGradient:(y,e)=>({u_translation:new h.bT(y,e.u_translation),u_ratio:new h.bf(y,e.u_ratio),u_device_pixel_ratio:new h.bf(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bT(y,e.u_units_to_pixels),u_image:new h.bO(y,e.u_image),u_image_height:new h.bf(y,e.u_image_height)}),linePattern:(y,e)=>({u_translation:new h.bT(y,e.u_translation),u_texsize:new h.bT(y,e.u_texsize),u_ratio:new h.bf(y,e.u_ratio),u_device_pixel_ratio:new h.bf(y,e.u_device_pixel_ratio),u_image:new h.bO(y,e.u_image),u_units_to_pixels:new h.bT(y,e.u_units_to_pixels),u_scale:new h.bS(y,e.u_scale),u_fade:new h.bf(y,e.u_fade)}),lineSDF:(y,e)=>({u_translation:new h.bT(y,e.u_translation),u_ratio:new h.bf(y,e.u_ratio),u_device_pixel_ratio:new h.bf(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bT(y,e.u_units_to_pixels),u_patternscale_a:new h.bT(y,e.u_patternscale_a),u_patternscale_b:new h.bT(y,e.u_patternscale_b),u_sdfgamma:new h.bf(y,e.u_sdfgamma),u_image:new h.bO(y,e.u_image),u_tex_y_a:new h.bf(y,e.u_tex_y_a),u_tex_y_b:new h.bf(y,e.u_tex_y_b),u_mix:new h.bf(y,e.u_mix)}),raster:(y,e)=>({u_tl_parent:new h.bT(y,e.u_tl_parent),u_scale_parent:new h.bf(y,e.u_scale_parent),u_buffer_scale:new h.bf(y,e.u_buffer_scale),u_fade_t:new h.bf(y,e.u_fade_t),u_opacity:new h.bf(y,e.u_opacity),u_image0:new h.bO(y,e.u_image0),u_image1:new h.bO(y,e.u_image1),u_brightness_low:new h.bf(y,e.u_brightness_low),u_brightness_high:new h.bf(y,e.u_brightness_high),u_saturation_factor:new h.bf(y,e.u_saturation_factor),u_contrast_factor:new h.bf(y,e.u_contrast_factor),u_spin_weights:new h.bS(y,e.u_spin_weights),u_coords_top:new h.bR(y,e.u_coords_top),u_coords_bottom:new h.bR(y,e.u_coords_bottom)}),symbolIcon:(y,e)=>({u_is_size_zoom_constant:new h.bO(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bO(y,e.u_is_size_feature_constant),u_size_t:new h.bf(y,e.u_size_t),u_size:new h.bf(y,e.u_size),u_camera_to_center_distance:new h.bf(y,e.u_camera_to_center_distance),u_pitch:new h.bf(y,e.u_pitch),u_rotate_symbol:new h.bO(y,e.u_rotate_symbol),u_aspect_ratio:new h.bf(y,e.u_aspect_ratio),u_fade_change:new h.bf(y,e.u_fade_change),u_label_plane_matrix:new h.bQ(y,e.u_label_plane_matrix),u_coord_matrix:new h.bQ(y,e.u_coord_matrix),u_is_text:new h.bO(y,e.u_is_text),u_pitch_with_map:new h.bO(y,e.u_pitch_with_map),u_is_along_line:new h.bO(y,e.u_is_along_line),u_is_variable_anchor:new h.bO(y,e.u_is_variable_anchor),u_texsize:new h.bT(y,e.u_texsize),u_texture:new h.bO(y,e.u_texture),u_translation:new h.bT(y,e.u_translation),u_pitched_scale:new h.bf(y,e.u_pitched_scale)}),symbolSDF:(y,e)=>({u_is_size_zoom_constant:new h.bO(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bO(y,e.u_is_size_feature_constant),u_size_t:new h.bf(y,e.u_size_t),u_size:new h.bf(y,e.u_size),u_camera_to_center_distance:new h.bf(y,e.u_camera_to_center_distance),u_pitch:new h.bf(y,e.u_pitch),u_rotate_symbol:new h.bO(y,e.u_rotate_symbol),u_aspect_ratio:new h.bf(y,e.u_aspect_ratio),u_fade_change:new h.bf(y,e.u_fade_change),u_label_plane_matrix:new h.bQ(y,e.u_label_plane_matrix),u_coord_matrix:new h.bQ(y,e.u_coord_matrix),u_is_text:new h.bO(y,e.u_is_text),u_pitch_with_map:new h.bO(y,e.u_pitch_with_map),u_is_along_line:new h.bO(y,e.u_is_along_line),u_is_variable_anchor:new h.bO(y,e.u_is_variable_anchor),u_texsize:new h.bT(y,e.u_texsize),u_texture:new h.bO(y,e.u_texture),u_gamma_scale:new h.bf(y,e.u_gamma_scale),u_device_pixel_ratio:new h.bf(y,e.u_device_pixel_ratio),u_is_halo:new h.bO(y,e.u_is_halo),u_translation:new h.bT(y,e.u_translation),u_pitched_scale:new h.bf(y,e.u_pitched_scale)}),symbolTextAndIcon:(y,e)=>({u_is_size_zoom_constant:new h.bO(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bO(y,e.u_is_size_feature_constant),u_size_t:new h.bf(y,e.u_size_t),u_size:new h.bf(y,e.u_size),u_camera_to_center_distance:new h.bf(y,e.u_camera_to_center_distance),u_pitch:new h.bf(y,e.u_pitch),u_rotate_symbol:new h.bO(y,e.u_rotate_symbol),u_aspect_ratio:new h.bf(y,e.u_aspect_ratio),u_fade_change:new h.bf(y,e.u_fade_change),u_label_plane_matrix:new h.bQ(y,e.u_label_plane_matrix),u_coord_matrix:new h.bQ(y,e.u_coord_matrix),u_is_text:new h.bO(y,e.u_is_text),u_pitch_with_map:new h.bO(y,e.u_pitch_with_map),u_is_along_line:new h.bO(y,e.u_is_along_line),u_is_variable_anchor:new h.bO(y,e.u_is_variable_anchor),u_texsize:new h.bT(y,e.u_texsize),u_texsize_icon:new h.bT(y,e.u_texsize_icon),u_texture:new h.bO(y,e.u_texture),u_texture_icon:new h.bO(y,e.u_texture_icon),u_gamma_scale:new h.bf(y,e.u_gamma_scale),u_device_pixel_ratio:new h.bf(y,e.u_device_pixel_ratio),u_is_halo:new h.bO(y,e.u_is_halo),u_translation:new h.bT(y,e.u_translation),u_pitched_scale:new h.bf(y,e.u_pitched_scale)}),background:(y,e)=>({u_opacity:new h.bf(y,e.u_opacity),u_color:new h.bP(y,e.u_color)}),backgroundPattern:(y,e)=>({u_opacity:new h.bf(y,e.u_opacity),u_image:new h.bO(y,e.u_image),u_pattern_tl_a:new h.bT(y,e.u_pattern_tl_a),u_pattern_br_a:new h.bT(y,e.u_pattern_br_a),u_pattern_tl_b:new h.bT(y,e.u_pattern_tl_b),u_pattern_br_b:new h.bT(y,e.u_pattern_br_b),u_texsize:new h.bT(y,e.u_texsize),u_mix:new h.bf(y,e.u_mix),u_pattern_size_a:new h.bT(y,e.u_pattern_size_a),u_pattern_size_b:new h.bT(y,e.u_pattern_size_b),u_scale_a:new h.bf(y,e.u_scale_a),u_scale_b:new h.bf(y,e.u_scale_b),u_pixel_coord_upper:new h.bT(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bT(y,e.u_pixel_coord_lower),u_tile_units_to_pixels:new h.bf(y,e.u_tile_units_to_pixels)}),terrain:(y,e)=>({u_texture:new h.bO(y,e.u_texture),u_ele_delta:new h.bf(y,e.u_ele_delta),u_fog_matrix:new h.bQ(y,e.u_fog_matrix),u_fog_color:new h.bP(y,e.u_fog_color),u_fog_ground_blend:new h.bf(y,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new h.bf(y,e.u_fog_ground_blend_opacity),u_horizon_color:new h.bP(y,e.u_horizon_color),u_horizon_fog_blend:new h.bf(y,e.u_horizon_fog_blend),u_is_globe_mode:new h.bf(y,e.u_is_globe_mode)}),terrainDepth:(y,e)=>({u_ele_delta:new h.bf(y,e.u_ele_delta)}),terrainCoords:(y,e)=>({u_texture:new h.bO(y,e.u_texture),u_terrain_coords_id:new h.bf(y,e.u_terrain_coords_id),u_ele_delta:new h.bf(y,e.u_ele_delta)}),projectionErrorMeasurement:(y,e)=>({u_input:new h.bf(y,e.u_input),u_output_expected:new h.bf(y,e.u_output_expected)}),atmosphere:(y,e)=>({u_sun_pos:new h.bS(y,e.u_sun_pos),u_atmosphere_blend:new h.bf(y,e.u_atmosphere_blend),u_globe_position:new h.bS(y,e.u_globe_position),u_globe_radius:new h.bf(y,e.u_globe_radius),u_inv_proj_matrix:new h.bQ(y,e.u_inv_proj_matrix)}),sky:(y,e)=>({u_sky_color:new h.bP(y,e.u_sky_color),u_horizon_color:new h.bP(y,e.u_horizon_color),u_horizon:new h.bT(y,e.u_horizon),u_horizon_normal:new h.bT(y,e.u_horizon_normal),u_sky_horizon_blend:new h.bf(y,e.u_sky_horizon_blend),u_sky_blend:new h.bf(y,e.u_sky_blend)})};class au{constructor(e,r,c){this.context=e;const f=e.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Md={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Rh{constructor(e,r,c,f){this.length=r.length,this.attributes=c,this.itemSize=r.bytesPerElement,this.dynamicDraw=f,this.context=e;const _=e.gl;this.buffer=_.createBuffer(),e.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let c=0;c<this.attributes.length;c++){const f=r.attributes[this.attributes[c].name];f!==void 0&&e.enableVertexAttribArray(f)}}setVertexAttribPointers(e,r,c){for(let f=0;f<this.attributes.length;f++){const _=this.attributes[f],M=r.attributes[_.name];M!==void 0&&e.vertexAttribPointer(M,_.components,e[Md[_.type]],!1,this.itemSize,_.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class sr{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Yu extends sr{getDefault(){return h.be.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ds extends sr{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Cd extends sr{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Nl extends sr{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Fl extends sr{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class su extends sr{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Wu extends sr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class cl extends sr{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class ul extends sr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class eo extends sr{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class hl extends sr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class vp extends sr{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Sc extends sr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class Ad extends sr{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class bp extends sr{getDefault(){return h.be.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ed extends sr{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Tc extends sr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class ou extends sr{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Ih extends sr{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Mc extends sr{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Oo extends sr{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Cc extends sr{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class fa extends sr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ma extends sr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ys extends sr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Ca extends sr{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ul extends sr{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class dl extends sr{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;const c=this.gl;En(c)?c.bindVertexArray(e):(r=c.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Aa extends sr{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Rs extends sr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Ac extends sr{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Is extends sr{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class kd extends Is{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class to extends Is{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class io extends Is{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Pd="Framebuffer is not complete";class Ea{constructor(e,r,c,f,_){this.context=e,this.width=r,this.height=c;const M=e.gl,P=this.framebuffer=M.createFramebuffer();if(this.colorAttachment=new kd(e,P),f)this.depthAttachment=_?new io(e,P):new to(e,P);else if(_)throw new Error("Stencil cannot be set without depth");if(M.checkFramebufferStatus(M.FRAMEBUFFER)!==M.FRAMEBUFFER_COMPLETE)throw new Error(Pd)}destroy(){const e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){const c=this.depthAttachment.get();c&&e.deleteRenderbuffer(c)}e.deleteFramebuffer(this.framebuffer)}}class ir{constructor(e){var r,c;if(this.gl=e,this.clearColor=new Yu(this),this.clearDepth=new Ds(this),this.clearStencil=new Cd(this),this.colorMask=new Nl(this),this.depthMask=new Fl(this),this.stencilMask=new su(this),this.stencilFunc=new Wu(this),this.stencilOp=new cl(this),this.stencilTest=new ul(this),this.depthRange=new eo(this),this.depthTest=new hl(this),this.depthFunc=new vp(this),this.blend=new Sc(this),this.blendFunc=new Ad(this),this.blendColor=new bp(this),this.blendEquation=new Ed(this),this.cullFace=new Tc(this),this.cullFaceSide=new ou(this),this.frontFace=new Ih(this),this.program=new Mc(this),this.activeTexture=new Oo(this),this.viewport=new Cc(this),this.bindFramebuffer=new fa(this),this.bindRenderbuffer=new ma(this),this.bindTexture=new ys(this),this.bindVertexBuffer=new Ca(this),this.bindElementBuffer=new Ul(this),this.bindVertexArray=new dl(this),this.pixelStoreUnpack=new Aa(this),this.pixelStoreUnpackPremultiplyAlpha=new Rs(this),this.pixelStoreUnpackFlipY=new Ac(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),En(e)){this.HALF_FLOAT=e.HALF_FLOAT;const f=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!==null&&r!==void 0?r:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(c=e.RGB16F)!==null&&c!==void 0?c:f==null?void 0:f.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const f=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new au(this,e,r)}createVertexBuffer(e,r,c){return new Rh(this,e,r,c)}createRenderbuffer(e,r,c){const f=this.gl,_=f.createRenderbuffer();return this.bindRenderbuffer.set(_),f.renderbufferStorage(f.RENDERBUFFER,e,r,c),this.bindRenderbuffer.set(null),_}createFramebuffer(e,r,c,f){return new Ea(this,e,r,c,f)}clear({color:e,depth:r,stencil:c}){const f=this.gl;let _=0;e&&(_|=f.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(_|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),c!==void 0&&(_|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),f.clear(_)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){h.bG(e.blendFunction,Vi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return En(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return En(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let ga;function qa(y,e,r,c,f){const _=y.context,M=y.transform,P=_.gl,L=y.useProgram("collisionBox"),V=[];let q=0,K=0;for(let ke=0;ke<c.length;ke++){const ze=c[ke],Le=e.getTile(ze).getBucket(r);if(!Le)continue;const De=f?Le.textCollisionBox:Le.iconCollisionBox,Ge=Le.collisionCircleArray;Ge.length>0&&(V.push({circleArray:Ge,circleOffset:K,coord:ze}),q+=Ge.length/4,K=q),De&&L.draw(_,P.LINES,Gi.disabled,Li.disabled,y.colorModeForRenderPass(),Oi.disabled,bc(y.transform),y.style.map.terrain&&y.style.map.terrain.getTerrainData(ze),M.getProjectionData({overscaledTileID:ze,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,null,y.transform.zoom,null,null,De.collisionVertexBuffer)}if(!f||!V.length)return;const W=y.useProgram("collisionCircle"),te=new h.b_;te.resize(4*q),te._trim();let he=0;for(const ke of V)for(let ze=0;ze<ke.circleArray.length/4;ze++){const Le=4*ze,De=ke.circleArray[Le+0],Ge=ke.circleArray[Le+1],Ye=ke.circleArray[Le+2],Re=ke.circleArray[Le+3];te.emplace(he++,De,Ge,Ye,Re,0),te.emplace(he++,De,Ge,Ye,Re,1),te.emplace(he++,De,Ge,Ye,Re,2),te.emplace(he++,De,Ge,Ye,Re,3)}(!ga||ga.length<2*q)&&(ga=function(ke){const ze=2*ke,Le=new h.c0;Le.resize(ze),Le._trim();for(let De=0;De<ze;De++){const Ge=6*De;Le.uint16[Ge+0]=4*De+0,Le.uint16[Ge+1]=4*De+1,Le.uint16[Ge+2]=4*De+2,Le.uint16[Ge+3]=4*De+2,Le.uint16[Ge+4]=4*De+3,Le.uint16[Ge+5]=4*De+0}return Le}(q));const Ae=_.createIndexBuffer(ga,!0),Ce=_.createVertexBuffer(te,h.b$.members,!0);for(const ke of V){const ze=Io(y.transform);W.draw(_,P.TRIANGLES,Gi.disabled,Li.disabled,y.colorModeForRenderPass(),Oi.disabled,ze,y.style.map.terrain&&y.style.map.terrain.getTerrainData(ke.coord),null,r.id,Ce,Ae,h.aL.simpleSegment(0,2*ke.circleOffset,ke.circleArray.length,ke.circleArray.length/2),null,y.transform.zoom,null,null,null)}Ce.destroy(),Ae.destroy()}const Ar=h.af(new Float32Array(16));function ro(y,e,r,c,f,_){const{horizontalAlign:M,verticalAlign:P}=h.aG(y);return new h.P((-(M-.5)*e/f+c[0])*_,(-(P-.5)*r/f+c[1])*_)}function Oh(y,e,r,c,f,_){const M=e.tileAnchorPoint.add(new h.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let P=c.mult(_);r||(P=P.rotate(-f));const L=M.add(P);return ur(L.x,L.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(r){const P=Jt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(y),L=Math.atan(P.y/P.x)+(P.x<0?Math.PI:0);return y.add(c.rotate(L))}return y.add(c)}function Ku(y,e,r,c,f,_,M,P,L,V,q,K){const W=y.text.placedSymbolArray,te=y.text.dynamicLayoutVertexArray,he=y.icon.dynamicLayoutVertexArray,Ae={};te.clear();for(let Ce=0;Ce<W.length;Ce++){const ke=W.get(Ce),ze=ke.hidden||!ke.crossTileID||y.allowVerticalPlacement&&!ke.placedOrientation?null:c[ke.crossTileID];if(ze){const Le=new h.P(ke.anchorX,ke.anchorY),De={getElevation:K,width:f.width,height:f.height,pitchedLabelPlaneMatrix:_,pitchWithMap:r,transform:f,tileAnchorPoint:Le,translation:V,unwrappedTileID:q},Ge=r?Mi(Le.x,Le.y,De):Jt(Le.x,Le.y,De),Ye=bi(f.cameraToCenterDistance,Ge.signedDistanceFromCamera);let Re=h.ao(y.textSizeData,P,ke)*Ye/h.aA;r&&(Re*=y.tilePixelRatio/M);const{width:it,height:vt,anchor:ot,textOffset:ft,textBoxScale:wt}=ze,ei=ro(ot,it,vt,ft,wt,Re),Kt=f.getPitchedTextCorrection(Le.x+V[0],Le.y+V[1],q),Lt=Oh(Ge.point,De,e,ei,-f.bearingInRadians,Kt),pi=y.allowVerticalPlacement&&ke.placedOrientation===h.an.vertical?Math.PI/2:0;for(let Hi=0;Hi<ke.numGlyphs;Hi++)h.au(te,Lt,pi);L&&ke.associatedIconIndex>=0&&(Ae[ke.associatedIconIndex]={shiftedAnchor:Lt,angle:pi})}else Qo(ke.numGlyphs,te)}if(L){he.clear();const Ce=y.icon.placedSymbolArray;for(let ke=0;ke<Ce.length;ke++){const ze=Ce.get(ke);if(ze.hidden)Qo(ze.numGlyphs,he);else{const Le=Ae[ke];if(Le)for(let De=0;De<ze.numGlyphs;De++)h.au(he,Le.shiftedAnchor,Le.angle);else Qo(ze.numGlyphs,he)}}y.icon.dynamicLayoutVertexBuffer.updateData(he)}y.text.dynamicLayoutVertexBuffer.updateData(te)}function jo(y,e,r){return r.iconsInText&&e?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function Rr(y,e,r,c,f,_,M,P,L,V,q,K,W){const te=y.context,he=te.gl,Ae=y.transform,Ce=P==="map",ke=L==="map",ze=P!=="viewport"&&r.layout.get("symbol-placement")!=="point",Le=Ce&&!ke&&!ze,De=!r.layout.get("symbol-sort-key").isConstant();let Ge=!1;const Ye=y.getDepthModeForSublayer(0,Gi.ReadOnly),Re=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),it=[],vt=Ae.getCircleRadiusCorrection();for(const ot of c){const ft=e.getTile(ot),wt=ft.getBucket(r);if(!wt)continue;const ei=f?wt.text:wt.icon;if(!ei||!ei.segments.get().length||!ei.hasVisibleVertices)continue;const Kt=ei.programConfigurations.get(r.id),Lt=f||wt.sdfIcons,pi=f?wt.textSizeData:wt.iconSizeData,Hi=ke||Ae.pitch!==0,xr=y.useProgram(jo(Lt,f,wt),Kt),Xi=h.am(pi,Ae.zoom),jr=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ot);let tn,cr,nr,Fr,Gn=[0,0],hr=null;if(f)cr=ft.glyphAtlasTexture,nr=he.LINEAR,tn=ft.glyphAtlasTexture.size,wt.iconsInText&&(Gn=ft.imageAtlasTexture.size,hr=ft.imageAtlasTexture,Fr=Hi||y.options.rotating||y.options.zooming||pi.kind==="composite"||pi.kind==="camera"?he.LINEAR:he.NEAREST);else{const mr=r.layout.get("icon-size").constantOr(0)!==1||wt.iconsNeedLinear;cr=ft.imageAtlasTexture,nr=Lt||y.options.rotating||y.options.zooming||mr||Hi?he.LINEAR:he.NEAREST,tn=ft.imageAtlasTexture.size}const $n=h.aB(ft,1,y.transform.zoom),Jn=Ai(Ce,y.transform,$n),Yl=h.L();h.ap(Yl,Jn);const wl=tr(ke,Ce,y.transform,$n),Ka=h.aC(Ae,ft,_,M),Bs=Ae.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!W,applyTerrainMatrix:!0}),Wl=Re&&wt.hasTextData(),Kl=r.layout.get("icon-text-fit")!=="none"&&Wl&&wt.hasIconData();if(ze){const mr=y.style.map.terrain?(ea,gn)=>y.style.map.terrain.getElevation(ot,ea,gn):null,Br=r.layout.get("text-rotation-alignment")==="map";Kn(wt,y,f,Jn,Yl,ke,V,Br,ot.toUnwrapped(),Ae.width,Ae.height,Ka,mr)}const Lc=f&&Re||Kl,ya=ze||Lc?Ar:ke?Jn:y.transform.clipSpaceToPixelsMatrix,Un=Lt&&r.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Go;Go=Lt?wt.iconsInText?Td(pi.kind,Xi,Le,ke,ze,Lc,y,ya,wl,Ka,tn,Gn,vt):Bl(pi.kind,Xi,Le,ke,ze,Lc,y,ya,wl,Ka,f,tn,0,vt):Lh(pi.kind,Xi,Le,ke,ze,Lc,y,ya,wl,Ka,f,tn,vt);const Ss={program:xr,buffers:ei,uniformValues:Go,projectionData:Bs,atlasTexture:cr,atlasTextureIcon:hr,atlasInterpolation:nr,atlasInterpolationIcon:Fr,isSDF:Lt,hasHalo:Un};if(De&&wt.canOverlap){Ge=!0;const mr=ei.segments.get();for(const Br of mr)it.push({segments:new h.aL([Br]),sortKey:Br.sortKey,state:Ss,terrainData:jr})}else it.push({segments:ei.segments,sortKey:0,state:Ss,terrainData:jr})}Ge&&it.sort((ot,ft)=>ot.sortKey-ft.sortKey);for(const ot of it){const ft=ot.state;if(te.activeTexture.set(he.TEXTURE0),ft.atlasTexture.bind(ft.atlasInterpolation,he.CLAMP_TO_EDGE),ft.atlasTextureIcon&&(te.activeTexture.set(he.TEXTURE1),ft.atlasTextureIcon&&ft.atlasTextureIcon.bind(ft.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),ft.isSDF){const wt=ft.uniformValues;ft.hasHalo&&(wt.u_is_halo=1,Vl(ft.buffers,ot.segments,r,y,ft.program,Ye,q,K,wt,ft.projectionData,ot.terrainData)),wt.u_is_halo=0}Vl(ft.buffers,ot.segments,r,y,ft.program,Ye,q,K,ft.uniformValues,ft.projectionData,ot.terrainData)}}function Vl(y,e,r,c,f,_,M,P,L,V,q){const K=c.context;f.draw(K,K.gl.TRIANGLES,_,M,P,Oi.backCCW,L,q,V,r.id,y.layoutVertexBuffer,y.indexBuffer,e,r.paint,c.transform.zoom,y.programConfigurations.get(r.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function Ec(y,e,r,c,f){const _=y.context,M=_.gl,P=Li.disabled,L=new Vi([M.ONE,M.ONE],h.be.transparent,[!0,!0,!0,!0]),V=e.getBucket(r);if(!V)return;const q=c.key;let K=r.heatmapFbos.get(q);K||(K=xi(_,e.tileSize,e.tileSize),r.heatmapFbos.set(q,K)),_.bindFramebuffer.set(K.framebuffer),_.viewport.set([0,0,e.tileSize,e.tileSize]),_.clear({color:h.be.transparent});const W=V.programConfigurations.get(r.id),te=y.useProgram("heatmap",W,!f),he=y.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ae=y.style.map.terrain.getTerrainData(c);te.draw(_,M.TRIANGLES,Gi.disabled,P,L,Oi.disabled,$u(e,y.transform.zoom,r.paint.get("heatmap-intensity"),1),Ae,he,r.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,r.paint,y.transform.zoom,W)}function ka(y,e,r,c,f){const _=y.context,M=_.gl,P=y.transform;_.setColorMode(y.colorModeForRenderPass());const L=no(_,e),V=r.key,q=e.heatmapFbos.get(V);if(!q)return;_.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,q.colorAttachment.get()),_.activeTexture.set(M.TEXTURE1),L.bind(M.LINEAR,M.CLAMP_TO_EDGE);const K=P.getProjectionData({overscaledTileID:r,applyTerrainMatrix:f,applyGlobeMatrix:!c});y.useProgram("heatmapTexture").draw(_,M.TRIANGLES,Gi.disabled,Li.disabled,y.colorModeForRenderPass(),Oi.disabled,zh(y,e,0,1),null,K,e.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,e.paint,P.zoom),q.destroy(),e.heatmapFbos.delete(V)}function xi(y,e,r){var c,f;const _=y.gl,M=_.createTexture();_.bindTexture(_.TEXTURE_2D,M),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR);const P=(c=y.HALF_FLOAT)!==null&&c!==void 0?c:_.UNSIGNED_BYTE,L=(f=y.RGBA16F)!==null&&f!==void 0?f:_.RGBA;_.texImage2D(_.TEXTURE_2D,0,L,e,r,0,_.RGBA,P,null);const V=y.createFramebuffer(e,r,!1,!1);return V.colorAttachment.set(M),V}function no(y,e){return e.colorRampTexture||(e.colorRampTexture=new h.T(y,e.colorRamp,y.gl.RGBA)),e.colorRampTexture}function is(y,e,r,c,f){if(!r||!c||!c.imageAtlas)return;const _=c.imageAtlas.patternPositions;let M=_[r.to.toString()],P=_[r.from.toString()];if(!M&&P&&(M=P),!P&&M&&(P=M),!M||!P){const L=f.getPaintProperty(e);M=_[L],P=_[L]}M&&P&&y.setConstantPatternPositions(M,P)}function _s(y,e,r,c,f,_,M,P){const L=y.context.gl,V="fill-pattern",q=r.paint.get(V),K=q&&q.constantOr(1),W=r.getCrossfadeParameters();let te,he,Ae,Ce,ke;const ze=y.transform,Le=r.paint.get("fill-translate"),De=r.paint.get("fill-translate-anchor");M?(he=K&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",te=L.LINES):(he=K?"fillPattern":"fill",te=L.TRIANGLES);const Ge=q.constantOr(null);for(const Ye of c){const Re=e.getTile(Ye);if(K&&!Re.patternsLoaded())continue;const it=Re.getBucket(r);if(!it)continue;const vt=it.programConfigurations.get(r.id),ot=y.useProgram(he,vt),ft=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ye);K&&(y.context.activeTexture.set(L.TEXTURE0),Re.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),vt.updatePaintBuffers(W)),is(vt,V,Ge,Re,r);const wt=ze.getProjectionData({overscaledTileID:Ye,applyGlobeMatrix:!P,applyTerrainMatrix:!0}),ei=h.aC(ze,Re,Le,De);if(M){Ce=it.indexBuffer2,ke=it.segments2;const Lt=[L.drawingBufferWidth,L.drawingBufferHeight];Ae=he==="fillOutlinePattern"&&K?vc(y,W,Re,Lt,ei):Ls(Lt,ei)}else Ce=it.indexBuffer,ke=it.segments,Ae=K?Vu(y,W,Re,ei):{u_fill_translate:ei};const Kt=y.stencilModeForClipping(Ye);ot.draw(y.context,te,f,Kt,_,Oi.backCCW,Ae,ft,wt,r.id,it.layoutVertexBuffer,Ce,ke,r.paint,y.transform.zoom,vt)}}function Xa(y,e,r,c,f,_,M,P){const L=y.context,V=L.gl,q="fill-extrusion-pattern",K=r.paint.get(q),W=K.constantOr(1),te=r.getCrossfadeParameters(),he=r.paint.get("fill-extrusion-opacity"),Ae=K.constantOr(null),Ce=y.transform;for(const ke of c){const ze=e.getTile(ke),Le=ze.getBucket(r);if(!Le)continue;const De=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ke),Ge=Le.programConfigurations.get(r.id),Ye=y.useProgram(W?"fillExtrusionPattern":"fillExtrusion",Ge);W&&(y.context.activeTexture.set(V.TEXTURE0),ze.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Ge.updatePaintBuffers(te));const Re=Ce.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!P,applyTerrainMatrix:!0});is(Ge,q,Ae,ze,r);const it=h.aC(Ce,ze,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),vt=r.paint.get("fill-extrusion-vertical-gradient"),ot=W?wd(y,vt,he,it,ke,te,ze):nl(y,vt,he,it);Ye.draw(L,L.gl.TRIANGLES,f,_,M,Oi.backCCW,ot,De,Re,r.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,r.paint,y.transform.zoom,Ge,y.style.map.terrain&&Le.centroidVertexBuffer)}}function qi(y,e,r,c,f,_,M,P,L){var V;const q=y.style.projection,K=y.context,W=y.transform,te=K.gl,he=[`#define NUM_ILLUMINATION_SOURCES ${r.paint.get("hillshade-highlight-color").values.length}`],Ae=y.useProgram("hillshade",null,!1,he),Ce=!y.options.moving;for(const ke of c){const ze=e.getTile(ke),Le=ze.fbo;if(!Le)continue;const De=q.getMeshFromTileID(K,ke.canonical,P,!0,"raster"),Ge=(V=y.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(ke);K.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,Le.colorAttachment.get());const Ye=W.getProjectionData({overscaledTileID:ke,aligned:Ce,applyGlobeMatrix:!L,applyTerrainMatrix:!0});Ae.draw(K,te.TRIANGLES,_,f[ke.overscaledZ],M,Oi.backCCW,al(y,ze,r),Ge,Ye,r.id,De.vertexBuffer,De.indexBuffer,De.segments)}}function Bo(y,e,r,c,f,_,M,P,L){var V;const q=y.style.projection,K=y.context,W=y.transform,te=K.gl,he=y.useProgram("colorRelief"),Ae=!y.options.moving;let Ce=!0;for(const ke of c){const ze=e.getTile(ke),Le=ze.dem;if(Ce){const vt=te.getParameter(te.MAX_TEXTURE_SIZE),{elevationTexture:ot,colorTexture:ft}=r.getColorRampTextures(K,vt,Le.getUnpackVector());K.activeTexture.set(te.TEXTURE1),ot.bind(te.NEAREST,te.CLAMP_TO_EDGE),K.activeTexture.set(te.TEXTURE4),ft.bind(te.LINEAR,te.CLAMP_TO_EDGE),Ce=!1}if(!Le||!Le.data)continue;const De=Le.stride,Ge=Le.getPixels();if(K.activeTexture.set(te.TEXTURE0),K.pixelStoreUnpackPremultiplyAlpha.set(!1),ze.demTexture=ze.demTexture||y.getTileTexture(De),ze.demTexture){const vt=ze.demTexture;vt.update(Ge,{premultiply:!1}),vt.bind(te.LINEAR,te.CLAMP_TO_EDGE)}else ze.demTexture=new h.T(K,Ge,te.RGBA,{premultiply:!1}),ze.demTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const Ye=q.getMeshFromTileID(K,ke.canonical,P,!0,"raster"),Re=(V=y.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(ke),it=W.getProjectionData({overscaledTileID:ke,aligned:Ae,applyGlobeMatrix:!L,applyTerrainMatrix:!0});he.draw(K,te.TRIANGLES,_,f[ke.overscaledZ],M,Oi.backCCW,Zu(r,ze.dem),Re,it,r.id,Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)}}const Qu=[new h.P(0,0),new h.P(h.$,0),new h.P(h.$,h.$),new h.P(0,h.$)];function xn(y,e,r,c,f,_,M,P,L=!1,V=!1){const q=c[c.length-1].overscaledZ,K=y.context,W=K.gl,te=y.useProgram("raster"),he=y.transform,Ae=y.style.projection,Ce=y.colorModeForRenderPass(),ke=!y.options.moving;for(const ze of c){const Le=y.getDepthModeForSublayer(ze.overscaledZ-q,r.paint.get("raster-opacity")===1?Gi.ReadWrite:Gi.ReadOnly,W.LESS),De=e.getTile(ze);De.registerFadeDuration(r.paint.get("raster-fade-duration"));const Ge=e.findLoadedParent(ze,0),Ye=e.findLoadedSibling(ze),Re=vn(De,Ge||Ye||null,e,r,y.transform,y.style.map.terrain);let it,vt;const ot=r.paint.get("raster-resampling")==="nearest"?W.NEAREST:W.LINEAR;K.activeTexture.set(W.TEXTURE0),De.texture.bind(ot,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST),K.activeTexture.set(W.TEXTURE1),Ge?(Ge.texture.bind(ot,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST),it=Math.pow(2,Ge.tileID.overscaledZ-De.tileID.overscaledZ),vt=[De.tileID.canonical.x*it%1,De.tileID.canonical.y*it%1]):De.texture.bind(ot,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST),De.texture.useMipmap&&K.extTextureFilterAnisotropic&&y.transform.pitch>20&&W.texParameterf(W.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax);const ft=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ze),wt=he.getProjectionData({overscaledTileID:ze,aligned:ke,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),ei=gs(vt||[0,0],it||1,Re,r,P),Kt=Ae.getMeshFromTileID(K,ze.canonical,_,M,"raster");te.draw(K,W.TRIANGLES,Le,f?f[ze.overscaledZ]:Li.disabled,Ce,L?Oi.frontCCW:Oi.backCCW,ei,ft,wt,r.id,Kt.vertexBuffer,Kt.indexBuffer,Kt.segments)}}function vn(y,e,r,c,f,_){const M=c.paint.get("raster-fade-duration");if(!_&&M>0){const P=Ee.now(),L=(P-y.timeAdded)/M,V=e?(P-e.timeAdded)/M:-1,q=r.getSource(),K=Et(f,{tileSize:q.tileSize,roundZoom:q.roundZoom}),W=!e||Math.abs(e.tileID.overscaledZ-K)>Math.abs(y.tileID.overscaledZ-K),te=W&&y.refreshedUponExpiration?1:h.ag(W?L:1-V,0,1);return y.refreshedUponExpiration&&L>=1&&(y.refreshedUponExpiration=!1),e?{opacity:1,mix:1-te}:{opacity:te,mix:0}}return{opacity:1,mix:0}}const Mr=new h.be(1,0,0,1),Ya=new h.be(0,1,0,1),Os=new h.be(0,0,1,1),jh=new h.be(1,0,1,1),Gl=new h.be(0,1,1,1);function pl(y,e,r,c){fl(y,0,e+r/2,y.transform.width,r,c)}function Ju(y,e,r,c){fl(y,e-r/2,0,r,y.transform.height,c)}function fl(y,e,r,c,f,_){const M=y.context,P=M.gl;P.enable(P.SCISSOR_TEST),P.scissor(e*y.pixelRatio,r*y.pixelRatio,c*y.pixelRatio,f*y.pixelRatio),M.clear({color:_}),P.disable(P.SCISSOR_TEST)}function lu(y,e,r){const c=y.context,f=c.gl,_=y.useProgram("debug"),M=Gi.disabled,P=Li.disabled,L=y.colorModeForRenderPass(),V="$debug",q=y.style.map.terrain&&y.style.map.terrain.getTerrainData(r);c.activeTexture.set(f.TEXTURE0);const K=e.getTileByID(r.key).latestRawTileData,W=Math.floor((K&&K.byteLength||0)/1024),te=e.getTile(r).tileSize,he=512/Math.min(te,512)*(r.overscaledZ/y.transform.zoom)*.5;let Ae=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(Ae+=` => ${r.overscaledZ}`),function(ke,ze){ke.initDebugOverlayCanvas();const Le=ke.debugOverlayCanvas,De=ke.context.gl,Ge=ke.debugOverlayCanvas.getContext("2d");Ge.clearRect(0,0,Le.width,Le.height),Ge.shadowColor="white",Ge.shadowBlur=2,Ge.lineWidth=1.5,Ge.strokeStyle="white",Ge.textBaseline="top",Ge.font="bold 36px Open Sans, sans-serif",Ge.fillText(ze,5,5),Ge.strokeText(ze,5,5),ke.debugOverlayTexture.update(Le),ke.debugOverlayTexture.bind(De.LINEAR,De.CLAMP_TO_EDGE)}(y,`${Ae} ${W}kB`);const Ce=y.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(c,f.TRIANGLES,M,P,Vi.alphaBlended,Oi.disabled,_p(h.be.transparent,he),null,Ce,V,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),_.draw(c,f.LINE_STRIP,M,P,L,Oi.disabled,_p(h.be.red),q,Ce,V,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function on(y,e,r,c){const{isRenderingGlobe:f}=c,_=y.context,M=_.gl,P=y.transform,L=y.colorModeForRenderPass(),V=y.getDepthModeFor3D(),q=y.useProgram("terrain");_.bindFramebuffer.set(null),_.viewport.set([0,0,y.width,y.height]);for(const K of r){const W=e.getTerrainMesh(K.tileID),te=y.renderToTexture.getTexture(K),he=e.getTerrainData(K.tileID);_.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,te.texture);const Ae=e.getMeshFrameDelta(P.zoom),Ce=P.calculateFogMatrix(K.tileID.toUnwrapped()),ke=rf(Ae,Ce,y.style.sky,P.pitch,f),ze=P.getProjectionData({overscaledTileID:K.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});q.draw(_,M.TRIANGLES,V,Li.disabled,L,Oi.backCCW,ke,he,ze,"terrain",W.vertexBuffer,W.indexBuffer,W.segments)}}function js(y,e){if(!e.mesh){const r=new h.aK;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const c=new h.aM;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),e.mesh=new zo(y.createVertexBuffer(r,ms.members),y.createIndexBuffer(c),h.aL.simpleSegment(0,0,r.length,c.length))}return e.mesh}class rs{constructor(e,r){this.context=new ir(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=jt.maxUnderzooming+jt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Sa}resize(e,r,c){if(this.width=Math.floor(e*c),this.height=Math.floor(r*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const e=this.context,r=new h.aK;r.emplaceBack(0,0),r.emplaceBack(h.$,0),r.emplaceBack(0,h.$),r.emplaceBack(h.$,h.$),this.tileExtentBuffer=e.createVertexBuffer(r,ms.members),this.tileExtentSegments=h.aL.simpleSegment(0,0,4,2);const c=new h.aK;c.emplaceBack(0,0),c.emplaceBack(h.$,0),c.emplaceBack(0,h.$),c.emplaceBack(h.$,h.$),this.debugBuffer=e.createVertexBuffer(c,ms.members),this.debugSegments=h.aL.simpleSegment(0,0,4,5);const f=new h.c5;f.emplaceBack(0,0,0,0),f.emplaceBack(h.$,0,h.$,0),f.emplaceBack(0,h.$,0,h.$),f.emplaceBack(h.$,h.$,h.$,h.$),this.rasterBoundsBuffer=e.createVertexBuffer(f,bd.members),this.rasterBoundsSegments=h.aL.simpleSegment(0,0,4,2);const _=new h.aK;_.emplaceBack(0,0),_.emplaceBack(h.$,0),_.emplaceBack(0,h.$),_.emplaceBack(h.$,h.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(_,ms.members),this.rasterBoundsSegmentsPosOnly=h.aL.simpleSegment(0,0,4,5);const M=new h.aK;M.emplaceBack(0,0),M.emplaceBack(1,0),M.emplaceBack(0,1),M.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(M,ms.members),this.viewportSegments=h.aL.simpleSegment(0,0,4,2);const P=new h.c6;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(P);const L=new h.aM;L.emplaceBack(1,0,2),L.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(L);const V=this.context.gl;this.stencilClearMode=new Li({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.tileExtentMesh=new zo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=h.L();h.bX(c,0,this.width,this.height,0,0,1),h.N(c,c,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const f={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,Gi.disabled,this.stencilClearMode,Vi.disabled,Oi.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,c){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Vi.disabled),f.setDepthMode(Gi.disabled);const _={};for(const M of r)_[M.key]=this.nextStencilID++;this._renderTileMasks(_,r,c,!0),this._renderTileMasks(_,r,c,!1),this._tileClippingMaskIDs=_}_renderTileMasks(e,r,c,f){const _=this.context,M=_.gl,P=this.style.projection,L=this.transform,V=this.useProgram("clippingMask");for(const q of r){const K=e[q.key],W=this.style.map.terrain&&this.style.map.terrain.getTerrainData(q),te=P.getMeshFromTileID(this.context,q.canonical,f,!0,"stencil"),he=L.getProjectionData({overscaledTileID:q,applyGlobeMatrix:!c,applyTerrainMatrix:!0});V.draw(_,M.TRIANGLES,Gi.disabled,new Li({func:M.ALWAYS,mask:0},K,255,M.KEEP,M.KEEP,M.REPLACE),Vi.disabled,c?Oi.disabled:Oi.backCCW,null,W,he,"$clipping",te.vertexBuffer,te.indexBuffer,te.segments)}}_renderTilesDepthBuffer(){const e=this.context,r=e.gl,c=this.style.projection,f=this.transform,_=this.useProgram("depth"),M=this.getDepthModeFor3D(),P=St(f,{tileSize:f.tileSize});for(const L of P){const V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(L),q=c.getMeshFromTileID(this.context,L.canonical,!0,!0,"raster"),K=f.getProjectionData({overscaledTileID:L,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(e,r.TRIANGLES,M,Li.disabled,Vi.disabled,Oi.backCCW,null,V,K,"$clipping",q.vertexBuffer,q.indexBuffer,q.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new Li({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){const r=this.context.gl;return new Li({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const r=this.context.gl,c=e.sort((M,P)=>P.overscaledZ-M.overscaledZ),f=c[c.length-1].overscaledZ,_=c[0].overscaledZ-f+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const M={};for(let P=0;P<_;P++)M[P+f]=new Li({func:r.GEQUAL,mask:255},P+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=_,[M,c]}return[{[f]:Li.disabled},c]}stencilConfigForOverlapTwoPass(e){const r=this.context.gl,c=e.sort((M,P)=>P.overscaledZ-M.overscaledZ),f=c[c.length-1].overscaledZ,_=c[0].overscaledZ-f+1;if(this.clearStencil(),_>1){const M={},P={};for(let L=0;L<_;L++)M[L+f]=new Li({func:r.GREATER,mask:255},_+1+L,255,r.KEEP,r.KEEP,r.REPLACE),P[L+f]=new Li({func:r.GREATER,mask:255},1+L,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*_+1,[M,P,c]}return this.nextStencilID=3,[{[f]:new Li({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[f]:new Li({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},c]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Vi([e.CONSTANT_COLOR,e.ONE],new h.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Vi.unblended:Vi.alphaBlended}getDepthModeForSublayer(e,r,c){if(!this.opaquePassEnabledForLayer())return Gi.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Gi(c||this.context.gl.LEQUAL,r,[f,f])}getDepthModeFor3D(){return new Gi(this.context.gl.LEQUAL,Gi.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var c,f;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Ee.now()),this.imageManager.beginFrame();const _=this.style._order,M=this.style.sourceCaches,P={},L={},V={},q={isRenderingToTexture:!1,isRenderingGlobe:((c=e.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const W in M){const te=M[W];te.used&&te.prepare(this.context),P[W]=te.getVisibleCoordinates(!1),L[W]=P[W].slice().reverse(),V[W]=te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let W=0;W<_.length;W++)if(this.style._layers[_[W]].is3D()){this.opaquePassCutoff=W;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const W of _){const te=this.style._layers[W];if(!te.hasOffscreenPass()||te.isHidden(this.transform.zoom))continue;const he=L[te.source];(te.type==="custom"||he.length)&&this.renderLayer(this,M[te.source],te,he,q)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:W=>this.useProgram(W)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?h.be.black:h.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(W,te){const he=W.context,Ae=he.gl,Ce=((Ye,Re,it)=>{const vt=Math.cos(Re.rollInRadians),ot=Math.sin(Re.rollInRadians),ft=ye(Re),wt=Re.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ye.properties.get("sky-color"),u_horizon_color:Ye.properties.get("horizon-color"),u_horizon:[(Re.width/2-ft*ot)*it,(Re.height/2+ft*vt)*it],u_horizon_normal:[-ot,vt],u_sky_horizon_blend:Ye.properties.get("sky-horizon-blend")*Re.height/2*it,u_sky_blend:wt}})(te,W.style.map.transform,W.pixelRatio),ke=new Gi(Ae.LEQUAL,Gi.ReadWrite,[0,1]),ze=Li.disabled,Le=W.colorModeForRenderPass(),De=W.useProgram("sky"),Ge=js(he,te);De.draw(he,Ae.TRIANGLES,ke,ze,Le,Oi.disabled,Ce,null,void 0,"sky",Ge.vertexBuffer,Ge.indexBuffer,Ge.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const W=this.style._layers[_[this.currentLayer]],te=M[W.source],he=P[W.source];this._renderTileClippingMasks(W,he,!1),this.renderLayer(this,te,W,he,q)}this.renderPass="translucent";let K=!1;for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const W=this.style._layers[_[this.currentLayer]],te=M[W.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(W,q))continue;this.opaquePassEnabledForLayer()||K||(K=!0,q.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const he=(W.type==="symbol"?V:L)[W.source];this._renderTileClippingMasks(W,P[W.source],!!this.renderToTexture),this.renderLayer(this,te,W,he,q)}if(q.isRenderingGlobe&&function(W,te,he){const Ae=W.context,Ce=Ae.gl,ke=W.useProgram("atmosphere"),ze=new Gi(Ce.LEQUAL,Gi.ReadOnly,[0,1]),Le=W.transform,De=function(wt,ei){const Kt=wt.properties.get("position"),Lt=[-Kt.x,-Kt.y,-Kt.z],pi=h.af(new Float64Array(16));return wt.properties.get("anchor")==="map"&&(h.b5(pi,pi,ei.rollInRadians),h.b6(pi,pi,-ei.pitchInRadians),h.b5(pi,pi,ei.bearingInRadians),h.b6(pi,pi,ei.center.lat*Math.PI/180),h.by(pi,pi,-ei.center.lng*Math.PI/180)),h.c4(Lt,Lt,pi),Lt}(he,W.transform),Ge=Le.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ye=te.properties.get("atmosphere-blend")*Ge.projectionTransition;if(Ye===0)return;const Re=sn(Le.worldSize,Le.center.lat),it=Le.inverseProjectionMatrix,vt=new Float64Array(4);vt[3]=1,h.av(vt,vt,Le.modelViewProjectionMatrix),vt[0]/=vt[3],vt[1]/=vt[3],vt[2]/=vt[3],vt[3]=1,h.av(vt,vt,it),vt[0]/=vt[3],vt[1]/=vt[3],vt[2]/=vt[3],vt[3]=1;const ot=((wt,ei,Kt,Lt,pi)=>({u_sun_pos:wt,u_atmosphere_blend:ei,u_globe_position:Kt,u_globe_radius:Lt,u_inv_proj_matrix:pi}))(De,Ye,[vt[0],vt[1],vt[2]],Re,it),ft=js(Ae,te);ke.draw(Ae,Ce.TRIANGLES,ze,Li.disabled,Vi.alphaBlended,Oi.disabled,ot,null,null,"atmosphere",ft.vertexBuffer,ft.indexBuffer,ft.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const W=function(te,he){let Ae=null;const Ce=Object.values(te._layers).flatMap(De=>De.source&&!De.isHidden(he)?[te.sourceCaches[De.source]]:[]),ke=Ce.filter(De=>De.getSource().type==="vector"),ze=Ce.filter(De=>De.getSource().type!=="vector"),Le=De=>{(!Ae||Ae.getSource().maxzoom<De.getSource().maxzoom)&&(Ae=De)};return ke.forEach(De=>Le(De)),Ae||ze.forEach(De=>Le(De)),Ae}(this.style,this.transform.zoom);W&&function(te,he,Ae){for(let Ce=0;Ce<Ae.length;Ce++)lu(te,he,Ae[Ce])}(this,W,W.getVisibleCoordinates())}this.options.showPadding&&function(W){const te=W.transform.padding;pl(W,W.transform.height-(te.top||0),3,Mr),pl(W,te.bottom||0,3,Ya),Ju(W,te.left||0,3,Os),Ju(W,W.transform.width-(te.right||0),3,jh);const he=W.transform.centerPoint;(function(Ae,Ce,ke,ze){fl(Ae,Ce-1,ke-10,2,20,ze),fl(Ae,Ce-10,ke-1,20,2,ze)})(W,he.x,W.transform.height-he.y,Gl)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=e?!h.c7(r,c):!h.c8(r,c)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(h.c9(r,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(_,M){const P=_.context,L=P.gl,V=_.transform,q=Vi.unblended,K=new Gi(L.LEQUAL,Gi.ReadWrite,[0,1]),W=M.sourceCache.getRenderableTiles(),te=_.useProgram("terrainDepth");P.bindFramebuffer.set(M.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),P.clear({color:h.be.transparent,depth:1});for(const he of W){const Ae=M.getTerrainMesh(he.tileID),Ce=M.getTerrainData(he.tileID),ke=V.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ze={u_ele_delta:M.getMeshFrameDelta(V.zoom)};te.draw(P,L.TRIANGLES,K,Li.disabled,q,Oi.backCCW,ze,Ce,ke,"terrain",Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain),function(_,M){const P=_.context,L=P.gl,V=_.transform,q=Vi.unblended,K=new Gi(L.LEQUAL,Gi.ReadWrite,[0,1]),W=M.getCoordsTexture(),te=M.sourceCache.getRenderableTiles(),he=_.useProgram("terrainCoords");P.bindFramebuffer.set(M.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),P.clear({color:h.be.transparent,depth:1}),M.coordsIndex=[];for(const Ae of te){const Ce=M.getTerrainMesh(Ae.tileID),ke=M.getTerrainData(Ae.tileID);P.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,W.texture);const ze={u_terrain_coords_id:(255-M.coordsIndex.length)/255,u_texture:0,u_ele_delta:M.getMeshFrameDelta(V.zoom)},Le=V.getProjectionData({overscaledTileID:Ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});he.draw(P,L.TRIANGLES,K,Li.disabled,q,Oi.backCCW,ze,ke,Le,"terrain",Ce.vertexBuffer,Ce.indexBuffer,Ce.segments),M.coordsIndex.push(Ae.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain))}renderLayer(e,r,c,f,_){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(f||[]).length)&&(this.id=c.id,h.ca(c)?function(M,P,L,V,q,K){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:W}=K,te=Li.disabled,he=M.colorModeForRenderPass();(L._unevaluatedLayout.hasValue("text-variable-anchor")||L._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Ae,Ce,ke,ze,Le,De,Ge,Ye,Re){const it=Ce.transform,vt=Ce.style.map.terrain,ot=Le==="map",ft=De==="map";for(const wt of Ae){const ei=ze.getTile(wt),Kt=ei.getBucket(ke);if(!Kt||!Kt.text||!Kt.text.segments.get().length)continue;const Lt=h.am(Kt.textSizeData,it.zoom),pi=h.aB(ei,1,Ce.transform.zoom),Hi=Ai(ot,Ce.transform,pi),xr=ke.layout.get("icon-text-fit")!=="none"&&Kt.hasIconData();if(Lt){const Xi=Math.pow(2,it.zoom-ei.tileID.overscaledZ),jr=vt?(tn,cr)=>vt.getElevation(wt,tn,cr):null;Ku(Kt,ot,ft,Re,it,Hi,Xi,Lt,xr,h.aC(it,ei,Ge,Ye),wt.toUnwrapped(),jr)}}}(V,M,L,P,L.layout.get("text-rotation-alignment"),L.layout.get("text-pitch-alignment"),L.paint.get("text-translate"),L.paint.get("text-translate-anchor"),q),L.paint.get("icon-opacity").constantOr(1)!==0&&Rr(M,P,L,V,!1,L.paint.get("icon-translate"),L.paint.get("icon-translate-anchor"),L.layout.get("icon-rotation-alignment"),L.layout.get("icon-pitch-alignment"),L.layout.get("icon-keep-upright"),te,he,W),L.paint.get("text-opacity").constantOr(1)!==0&&Rr(M,P,L,V,!0,L.paint.get("text-translate"),L.paint.get("text-translate-anchor"),L.layout.get("text-rotation-alignment"),L.layout.get("text-pitch-alignment"),L.layout.get("text-keep-upright"),te,he,W),P.map.showCollisionBoxes&&(qa(M,P,L,V,!0),qa(M,P,L,V,!1))}(e,r,c,f,this.style.placement.variableOffsets,_):h.cb(c)?function(M,P,L,V,q){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:K}=q,W=L.paint.get("circle-opacity"),te=L.paint.get("circle-stroke-width"),he=L.paint.get("circle-stroke-opacity"),Ae=!L.layout.get("circle-sort-key").isConstant();if(W.constantOr(1)===0&&(te.constantOr(1)===0||he.constantOr(1)===0))return;const Ce=M.context,ke=Ce.gl,ze=M.transform,Le=M.getDepthModeForSublayer(0,Gi.ReadOnly),De=Li.disabled,Ge=M.colorModeForRenderPass(),Ye=[],Re=ze.getCircleRadiusCorrection();for(let it=0;it<V.length;it++){const vt=V[it],ot=P.getTile(vt),ft=ot.getBucket(L);if(!ft)continue;const wt=L.paint.get("circle-translate"),ei=L.paint.get("circle-translate-anchor"),Kt=h.aC(ze,ot,wt,ei),Lt=ft.programConfigurations.get(L.id),pi=M.useProgram("circle",Lt),Hi=ft.layoutVertexBuffer,xr=ft.indexBuffer,Xi=M.style.map.terrain&&M.style.map.terrain.getTerrainData(vt),jr={programConfiguration:Lt,program:pi,layoutVertexBuffer:Hi,indexBuffer:xr,uniformValues:Gu(M,ot,L,Kt,Re),terrainData:Xi,projectionData:ze.getProjectionData({overscaledTileID:vt,applyGlobeMatrix:!K,applyTerrainMatrix:!0})};if(Ae){const tn=ft.segments.get();for(const cr of tn)Ye.push({segments:new h.aL([cr]),sortKey:cr.sortKey,state:jr})}else Ye.push({segments:ft.segments,sortKey:0,state:jr})}Ae&&Ye.sort((it,vt)=>it.sortKey-vt.sortKey);for(const it of Ye){const{programConfiguration:vt,program:ot,layoutVertexBuffer:ft,indexBuffer:wt,uniformValues:ei,terrainData:Kt,projectionData:Lt}=it.state;ot.draw(Ce,ke.TRIANGLES,Le,De,Ge,Oi.backCCW,ei,Kt,Lt,L.id,ft,wt,it.segments,L.paint,M.transform.zoom,vt)}}(e,r,c,f,_):h.cc(c)?function(M,P,L,V,q){if(L.paint.get("heatmap-opacity")===0)return;const K=M.context,{isRenderingToTexture:W,isRenderingGlobe:te}=q;if(M.style.map.terrain){for(const he of V){const Ae=P.getTile(he);P.hasRenderableParent(he)||(M.renderPass==="offscreen"?Ec(M,Ae,L,he,te):M.renderPass==="translucent"&&ka(M,L,he,W,te))}K.viewport.set([0,0,M.width,M.height])}else M.renderPass==="offscreen"?function(he,Ae,Ce,ke){const ze=he.context,Le=ze.gl,De=he.transform,Ge=Li.disabled,Ye=new Vi([Le.ONE,Le.ONE],h.be.transparent,[!0,!0,!0,!0]);(function(Re,it,vt){const ot=Re.gl;Re.activeTexture.set(ot.TEXTURE1),Re.viewport.set([0,0,it.width/4,it.height/4]);let ft=vt.heatmapFbos.get(h.c1);ft?(ot.bindTexture(ot.TEXTURE_2D,ft.colorAttachment.get()),Re.bindFramebuffer.set(ft.framebuffer)):(ft=xi(Re,it.width/4,it.height/4),vt.heatmapFbos.set(h.c1,ft))})(ze,he,Ce),ze.clear({color:h.be.transparent});for(let Re=0;Re<ke.length;Re++){const it=ke[Re];if(Ae.hasRenderableParent(it))continue;const vt=Ae.getTile(it),ot=vt.getBucket(Ce);if(!ot)continue;const ft=ot.programConfigurations.get(Ce.id),wt=he.useProgram("heatmap",ft),ei=De.getProjectionData({overscaledTileID:it,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Kt=De.getCircleRadiusCorrection();wt.draw(ze,Le.TRIANGLES,Gi.disabled,Ge,Ye,Oi.backCCW,$u(vt,De.zoom,Ce.paint.get("heatmap-intensity"),Kt),null,ei,Ce.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,Ce.paint,De.zoom,ft)}ze.viewport.set([0,0,he.width,he.height])}(M,P,L,V):M.renderPass==="translucent"&&function(he,Ae){const Ce=he.context,ke=Ce.gl;Ce.setColorMode(he.colorModeForRenderPass());const ze=Ae.heatmapFbos.get(h.c1);ze&&(Ce.activeTexture.set(ke.TEXTURE0),ke.bindTexture(ke.TEXTURE_2D,ze.colorAttachment.get()),Ce.activeTexture.set(ke.TEXTURE1),no(Ce,Ae).bind(ke.LINEAR,ke.CLAMP_TO_EDGE),he.useProgram("heatmapTexture").draw(Ce,ke.TRIANGLES,Gi.disabled,Li.disabled,he.colorModeForRenderPass(),Oi.disabled,zh(he,Ae,0,1),null,null,Ae.id,he.viewportBuffer,he.quadTriangleIndexBuffer,he.viewportSegments,Ae.paint,he.transform.zoom))}(M,L)}(e,r,c,f,_):h.cd(c)?function(M,P,L,V,q){if(M.renderPass!=="translucent")return;const{isRenderingToTexture:K}=q,W=L.paint.get("line-opacity"),te=L.paint.get("line-width");if(W.constantOr(1)===0||te.constantOr(1)===0)return;const he=M.getDepthModeForSublayer(0,Gi.ReadOnly),Ae=M.colorModeForRenderPass(),Ce=L.paint.get("line-dasharray"),ke=L.paint.get("line-pattern"),ze=ke.constantOr(1),Le=L.paint.get("line-gradient"),De=L.getCrossfadeParameters(),Ge=ze?"linePattern":Ce?"lineSDF":Le?"lineGradient":"line",Ye=M.context,Re=Ye.gl,it=M.transform;let vt=!0;for(const ot of V){const ft=P.getTile(ot);if(ze&&!ft.patternsLoaded())continue;const wt=ft.getBucket(L);if(!wt)continue;const ei=wt.programConfigurations.get(L.id),Kt=M.context.program.get(),Lt=M.useProgram(Ge,ei),pi=vt||Lt.program!==Kt,Hi=M.style.map.terrain&&M.style.map.terrain.getTerrainData(ot),xr=ke.constantOr(null);if(xr&&ft.imageAtlas){const nr=ft.imageAtlas,Fr=nr.patternPositions[xr.to.toString()],Gn=nr.patternPositions[xr.from.toString()];Fr&&Gn&&ei.setConstantPatternPositions(Fr,Gn)}const Xi=it.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!K,applyTerrainMatrix:!0}),jr=it.getPixelScale(),tn=ze?ll(M,ft,L,jr,De):Ce?Sd(M,ft,L,jr,Ce,De):Le?ol(M,ft,L,jr,wt.lineClipsArray.length):qu(M,ft,L,jr);if(ze)Ye.activeTexture.set(Re.TEXTURE0),ft.imageAtlasTexture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),ei.updatePaintBuffers(De);else if(Ce&&(pi||M.lineAtlas.dirty))Ye.activeTexture.set(Re.TEXTURE0),M.lineAtlas.bind(Ye);else if(Le){const nr=wt.gradients[L.id];let Fr=nr.texture;if(L.gradientVersion!==nr.version){let Gn=256;if(L.stepInterpolant){const hr=P.getSource().maxzoom,$n=ot.canonical.z===hr?Math.ceil(1<<M.transform.maxZoom-ot.canonical.z):1;Gn=h.ag(h.c2(wt.maxLineLength/h.$*1024*$n),256,Ye.maxTextureSize)}nr.gradient=h.c3({expression:L.gradientExpression(),evaluationKey:"lineProgress",resolution:Gn,image:nr.gradient||void 0,clips:wt.lineClipsArray}),nr.texture?nr.texture.update(nr.gradient):nr.texture=new h.T(Ye,nr.gradient,Re.RGBA),nr.version=L.gradientVersion,Fr=nr.texture}Ye.activeTexture.set(Re.TEXTURE0),Fr.bind(L.stepInterpolant?Re.NEAREST:Re.LINEAR,Re.CLAMP_TO_EDGE)}const cr=M.stencilModeForClipping(ot);Lt.draw(Ye,Re.TRIANGLES,he,cr,Ae,Oi.disabled,tn,Hi,Xi,L.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,L.paint,M.transform.zoom,ei,wt.layoutVertexBuffer2),vt=!1}}(e,r,c,f,_):h.ce(c)?function(M,P,L,V,q){const K=L.paint.get("fill-color"),W=L.paint.get("fill-opacity");if(W.constantOr(1)===0)return;const{isRenderingToTexture:te}=q,he=M.colorModeForRenderPass(),Ae=L.paint.get("fill-pattern"),Ce=M.opaquePassEnabledForLayer()&&!Ae.constantOr(1)&&K.constantOr(h.be.transparent).a===1&&W.constantOr(0)===1?"opaque":"translucent";if(M.renderPass===Ce){const ke=M.getDepthModeForSublayer(1,M.renderPass==="opaque"?Gi.ReadWrite:Gi.ReadOnly);_s(M,P,L,V,ke,he,!1,te)}if(M.renderPass==="translucent"&&L.paint.get("fill-antialias")){const ke=M.getDepthModeForSublayer(L.getPaintProperty("fill-outline-color")?2:0,Gi.ReadOnly);_s(M,P,L,V,ke,he,!0,te)}}(e,r,c,f,_):h.cf(c)?function(M,P,L,V,q){const K=L.paint.get("fill-extrusion-opacity");if(K===0)return;const{isRenderingToTexture:W}=q;if(M.renderPass==="translucent"){const te=new Gi(M.context.gl.LEQUAL,Gi.ReadWrite,M.depthRangeFor3D);if(K!==1||L.paint.get("fill-extrusion-pattern").constantOr(1))Xa(M,P,L,V,te,Li.disabled,Vi.disabled,W),Xa(M,P,L,V,te,M.stencilModeFor3D(),M.colorModeForRenderPass(),W);else{const he=M.colorModeForRenderPass();Xa(M,P,L,V,te,Li.disabled,he,W)}}}(e,r,c,f,_):h.cg(c)?function(M,P,L,V,q){if(M.renderPass!=="offscreen"&&M.renderPass!=="translucent")return;const{isRenderingToTexture:K}=q,W=M.context,te=M.style.projection.useSubdivision,he=M.getDepthModeForSublayer(0,Gi.ReadOnly),Ae=M.colorModeForRenderPass();if(M.renderPass==="offscreen")(function(Ce,ke,ze,Le,De,Ge,Ye){const Re=Ce.context,it=Re.gl;for(const vt of ze){const ot=ke.getTile(vt),ft=ot.dem;if(!ft||!ft.data||!ot.needsHillshadePrepare)continue;const wt=ft.dim,ei=ft.stride,Kt=ft.getPixels();if(Re.activeTexture.set(it.TEXTURE1),Re.pixelStoreUnpackPremultiplyAlpha.set(!1),ot.demTexture=ot.demTexture||Ce.getTileTexture(ei),ot.demTexture){const pi=ot.demTexture;pi.update(Kt,{premultiply:!1}),pi.bind(it.NEAREST,it.CLAMP_TO_EDGE)}else ot.demTexture=new h.T(Re,Kt,it.RGBA,{premultiply:!1}),ot.demTexture.bind(it.NEAREST,it.CLAMP_TO_EDGE);Re.activeTexture.set(it.TEXTURE0);let Lt=ot.fbo;if(!Lt){const pi=new h.T(Re,{width:wt,height:wt,data:null},it.RGBA);pi.bind(it.LINEAR,it.CLAMP_TO_EDGE),Lt=ot.fbo=Re.createFramebuffer(wt,wt,!0,!1),Lt.colorAttachment.set(pi.texture)}Re.bindFramebuffer.set(Lt.framebuffer),Re.viewport.set([0,0,wt,wt]),Ce.useProgram("hillshadePrepare").draw(Re,it.TRIANGLES,De,Ge,Ye,Oi.disabled,Hu(ot.tileID,ft),null,null,Le.id,Ce.rasterBoundsBuffer,Ce.quadTriangleIndexBuffer,Ce.rasterBoundsSegments),ot.needsHillshadePrepare=!1}})(M,P,V,L,he,Li.disabled,Ae),W.viewport.set([0,0,M.width,M.height]);else if(M.renderPass==="translucent")if(te){const[Ce,ke,ze]=M.stencilConfigForOverlapTwoPass(V);qi(M,P,L,ze,Ce,he,Ae,!1,K),qi(M,P,L,ze,ke,he,Ae,!0,K)}else{const[Ce,ke]=M.getStencilConfigForOverlapAndUpdateStencilID(V);qi(M,P,L,ke,Ce,he,Ae,!1,K)}}(e,r,c,f,_):h.ch(c)?function(M,P,L,V,q){if(M.renderPass!=="translucent"||!V.length)return;const{isRenderingToTexture:K}=q,W=M.style.projection.useSubdivision,te=M.getDepthModeForSublayer(0,Gi.ReadOnly),he=M.colorModeForRenderPass();if(W){const[Ae,Ce,ke]=M.stencilConfigForOverlapTwoPass(V);Bo(M,P,L,ke,Ae,te,he,!1,K),Bo(M,P,L,ke,Ce,te,he,!0,K)}else{const[Ae,Ce]=M.getStencilConfigForOverlapAndUpdateStencilID(V);Bo(M,P,L,Ce,Ae,te,he,!1,K)}}(e,r,c,f,_):h.ci(c)?function(M,P,L,V,q){if(M.renderPass!=="translucent"||L.paint.get("raster-opacity")===0||!V.length)return;const{isRenderingToTexture:K}=q,W=P.getSource(),te=M.style.projection.useSubdivision;if(W instanceof va)xn(M,P,L,V,null,!1,!1,W.tileCoords,W.flippedWindingOrder,K);else if(te){const[he,Ae,Ce]=M.stencilConfigForOverlapTwoPass(V);xn(M,P,L,Ce,he,!1,!0,Qu,!1,K),xn(M,P,L,Ce,Ae,!0,!0,Qu,!1,K)}else{const[he,Ae]=M.getStencilConfigForOverlapAndUpdateStencilID(V);xn(M,P,L,Ae,he,!1,!0,Qu,!1,K)}}(e,r,c,f,_):h.cj(c)?function(M,P,L,V,q){const K=L.paint.get("background-color"),W=L.paint.get("background-opacity");if(W===0)return;const{isRenderingToTexture:te}=q,he=M.context,Ae=he.gl,Ce=M.style.projection,ke=M.transform,ze=ke.tileSize,Le=L.paint.get("background-pattern");if(M.isPatternMissing(Le))return;const De=!Le&&K.a===1&&W===1&&M.opaquePassEnabledForLayer()?"opaque":"translucent";if(M.renderPass!==De)return;const Ge=Li.disabled,Ye=M.getDepthModeForSublayer(0,De==="opaque"?Gi.ReadWrite:Gi.ReadOnly),Re=M.colorModeForRenderPass(),it=M.useProgram(Le?"backgroundPattern":"background"),vt=V||St(ke,{tileSize:ze,terrain:M.style.map.terrain});Le&&(he.activeTexture.set(Ae.TEXTURE0),M.imageManager.bind(M.context));const ot=L.getCrossfadeParameters();for(const ft of vt){const wt=ke.getProjectionData({overscaledTileID:ft,applyGlobeMatrix:!te,applyTerrainMatrix:!0}),ei=Le?af(W,M,Le,{tileID:ft,tileSize:ze},ot):Dh(W,K),Kt=M.style.map.terrain&&M.style.map.terrain.getTerrainData(ft),Lt=Ce.getMeshFromTileID(he,ft.canonical,!1,!0,"raster");it.draw(he,Ae.TRIANGLES,Ye,Ge,Re,Oi.backCCW,ei,Kt,wt,L.id,Lt.vertexBuffer,Lt.indexBuffer,Lt.segments)}}(e,0,c,f,_):h.ck(c)&&function(M,P,L,V){const{isRenderingGlobe:q}=V,K=M.context,W=L.implementation,te=M.style.projection,he=M.transform,Ae=he.getProjectionDataForCustomLayer(q),Ce={farZ:he.farZ,nearZ:he.nearZ,fov:he.fov*Math.PI/180,modelViewProjectionMatrix:he.modelViewProjectionMatrix,projectionMatrix:he.projectionMatrix,shaderData:{variantName:te.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${te.shaderPreludeCode.vertexSource}`,define:te.shaderDefine},defaultProjectionData:Ae},ke=W.renderingMode?W.renderingMode:"2d";if(M.renderPass==="offscreen"){const ze=W.prerender;ze&&(M.setCustomLayerDefaults(),K.setColorMode(M.colorModeForRenderPass()),ze.call(W,K.gl,Ce),K.setDirty(),M.setBaseState())}else if(M.renderPass==="translucent"){M.setCustomLayerDefaults(),K.setColorMode(M.colorModeForRenderPass()),K.setStencilMode(Li.disabled);const ze=ke==="3d"?M.getDepthModeFor3D():M.getDepthModeForSublayer(0,Gi.ReadOnly);K.setDepthMode(ze),W.render(K.gl,Ce),K.setDirty(),M.setBaseState(),K.bindFramebuffer.set(null)}}(e,0,c,_))}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const r=this.imageManager.getPattern(e.from.toString()),c=this.imageManager.getPattern(e.to.toString());return!r||!c}useProgram(e,r,c=!1,f=[]){this.cache=this.cache||{};const _=!!this.style.map.terrain,M=this.style.projection,P=c?Po.projectionMercator:M.shaderPreludeCode,L=c?Lo:M.shaderDefine,V=e+(r?r.cacheKey:"")+`/${c?vd:M.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(_?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[V]||(this.cache[V]=new Ph(this.context,Po[e],r,pa[e],this._showOverdrawInspector,_,P,L,f)),this.cache[V]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}}function No(y,e){let r,c=!1,f=null,_=null;const M=()=>{f=null,c&&(y.apply(_,r),f=setTimeout(M,e),c=!1)};return(...P)=>(c=!0,_=this,r=P,f||M(),f)}class ns{constructor(e){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:c,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const c=r.join("/");let f=c;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${c}`);let _=window.location.hash.replace(f,"");_.startsWith("#&")?_=_.slice(0,1)+_.slice(2):_==="#"&&(_="");let M=window.location.href.replace(/(#.+)?$/,_);M=M.replace("&&","&"),window.history.replaceState(window.history.state,null,M)},this._updateHash=No(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const r=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,f=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,f),M=Math.round(r.lng*_)/_,P=Math.round(r.lat*_)/_,L=this._map.getBearing(),V=this._map.getPitch();let q="";if(q+=e?`/${M}/${P}/${c}`:`${c}/${P}/${M}`,(L||V)&&(q+="/"+Math.round(10*L)/10),V&&(q+=`/${Math.round(V)}`),this._hashName){const K=this._hashName;let W=!1;const te=window.location.hash.slice(1).split("&").map(he=>{const Ae=he.split("=")[0];return Ae===K?(W=!0,`${Ae}=${q}`):he}).filter(he=>he);return W||te.push(`${K}=${q}`),`#${te.join("&")}`}return`#${q}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new h.S(+e[2],+e[1])}catch{return!1}const r=+e[0],c=+(e[3]||0),f=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&c>=-180&&c<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const xs={linearity:.3,easing:h.cl(0,0,.3,1)},as=h.e({deceleration:2500,maxSpeed:1400},xs),cu=h.e({deceleration:20,maxSpeed:1400},xs),$l=h.e({deceleration:1e3,maxSpeed:360},xs),Pa=h.e({deceleration:1e3,maxSpeed:90},xs),eh=h.e({deceleration:1e3,maxSpeed:360},xs);class Hl{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ee.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=Ee.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)r.zoom+=_.zoomDelta||0,r.bearing+=_.bearingDelta||0,r.pitch+=_.pitchDelta||0,r.roll+=_.rollDelta||0,_.panDelta&&r.pan._add(_.panDelta),_.around&&(r.around=_.around),_.pinchAround&&(r.pinchAround=_.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(r.pan.mag()){const _=Fo(r.pan.mag(),c,h.e({},as,e||{})),M=r.pan.mult(_.amount/r.pan.mag()),P=this._map.cameraHelper.handlePanInertia(M,this._map.transform);f.center=P.easingCenter,f.offset=P.easingOffset,Pn(f,_)}if(r.zoom){const _=Fo(r.zoom,c,cu);f.zoom=this._map.transform.zoom+_.amount,Pn(f,_)}if(r.bearing){const _=Fo(r.bearing,c,$l);f.bearing=this._map.transform.bearing+h.ag(_.amount,-179,179),Pn(f,_)}if(r.pitch){const _=Fo(r.pitch,c,Pa);f.pitch=this._map.transform.pitch+_.amount,Pn(f,_)}if(r.roll){const _=Fo(r.roll,c,eh);f.roll=this._map.transform.roll+h.ag(_.amount,-179,179),Pn(f,_)}if(f.zoom||f.bearing){const _=r.pinchAround===void 0?r.around:r.pinchAround;f.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),h.e(f,{noMoveStart:!0})}}function Pn(y,e){(!y.duration||y.duration<e.duration)&&(y.duration=e.duration,y.easing=e.easing)}function Fo(y,e,r){const{maxSpeed:c,linearity:f,deceleration:_}=r,M=h.ag(y*f/(e/1e3),-c,c),P=Math.abs(M)/(_*f);return{easing:r.easing,duration:1e3*P,amount:M*(P/2)}}class Wa extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,c,f={}){c=c instanceof MouseEvent?c:new MouseEvent(e,c);const _=pe.mousePos(r.getCanvas(),c),M=r.unproject(_);super(e,h.e({point:_,lngLat:M,originalEvent:c},f)),this._defaultPrevented=!1,this.target=r}}class ao extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,c){const f=e==="touchend"?c.changedTouches:c.touches,_=pe.touchPos(r.getCanvasContainer(),f),M=_.map(L=>r.unproject(L)),P=_.reduce((L,V,q,K)=>L.add(V.div(K.length)),new h.P(0,0));super(e,{points:_,point:P,lngLats:M,lngLat:r.unproject(P),originalEvent:c}),this._defaultPrevented=!1}}class uu extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,c){super(e,{originalEvent:c}),this._defaultPrevented=!1}}class wp{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new uu(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Wa(e.type,this._map,e))}mouseup(e){this._map.fire(new Wa(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Wa(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Wa(e.type,this._map,e))}mouseover(e){this._map.fire(new Wa(e.type,this._map,e))}mouseout(e){this._map.fire(new Wa(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ao(e.type,this._map,e))}touchmove(e){this._map.fire(new ao(e.type,this._map,e))}touchend(e){this._map.fire(new ao(e.type,this._map,e))}touchcancel(e){this._map.fire(new ao(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class zn{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Wa(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Wa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Wa(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zl{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(h.P.convert(e),this._map.terrain)}}class kc{constructor(e,r){this._map=e,this._tr=new Zl(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(pe.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const c=r;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=c,this._box||(this._box=pe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const _=Math.min(f.x,c.x),M=Math.max(f.x,c.x),P=Math.min(f.y,c.y),L=Math.max(f.y,c.y);pe.setTransform(this._box,`translate(${_}px,${P}px)`),this._box.style.width=M-_+"px",this._box.style.height=L-P+"px"}mouseupWindow(e,r){if(!this._active||e.button!==0)return;const c=this._startPos,f=r;if(this.reset(),pe.suppressClick(),c.x!==f.x||c.y!==f.y)return this._map.fire(new h.l("boxzoomend",{originalEvent:e})),{cameraAnimation:_=>_.fitScreenCoordinates(c,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(pe.remove(this._box),this._box=null),pe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new h.l(e,{originalEvent:r}))}}function ml(y,e){if(y.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${e.length}`);const r={};for(let c=0;c<y.length;c++)r[y[c].identifier]=e[c];return r}class Bh{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),c.length===this.numTouches&&(this.centroid=function(f){const _=new h.P(0,0);for(const M of f)_._add(M);return _.div(f.length)}(r),this.touches=ml(c,r)))}touchmove(e,r,c){if(this.aborted||!this.centroid)return;const f=ml(c,r);for(const _ in this.touches){const M=f[_];(!M||M.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(e,r,c){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class gl{constructor(e){this.singleTap=new Bh(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,c){this.singleTap.touchstart(e,r,c)}touchmove(e,r,c){this.singleTap.touchmove(e,r,c)}touchend(e,r,c){const f=this.singleTap.touchend(e,r,c);if(f){const _=e.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(f)<30;if(_&&M||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class yl{constructor(e){this._tr=new Zl(e),this._zoomIn=new gl({numTouches:1,numTaps:2}),this._zoomOut=new gl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,c){this._zoomIn.touchstart(e,r,c),this._zoomOut.touchstart(e,r,c)}touchmove(e,r,c){this._zoomIn.touchmove(e,r,c),this._zoomOut.touchmove(e,r,c)}touchend(e,r,c){const f=this._zoomIn.touchend(e,r,c),_=this._zoomOut.touchend(e,r,c),M=this._tr;return f?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:M.zoom+1,around:M.unproject(f)},{originalEvent:e})}):_?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:M.zoom-1,around:M.unproject(_)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class so{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const f=Array.isArray(r)?r[0]:r;return!this._moved&&f.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(c,f))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&pe.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ss=0,oo=2,zd={[ss]:1,[oo]:2};class bn{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const r=pe.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(r,c){const f=zd[c];return r.buttons===void 0||(r.buttons&f)!==f}(e,this._eventButton)}isValidEndEvent(e){return pe.mouseButton(e)===this._eventButton}}class _l{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Nh{constructor(e=new bn({checkCorrectEvent:()=>!0}),r=new _l){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(e,r,c){return e instanceof MouseEvent?r(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?c(e):void 0}startMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const th=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=e=>{e.preventDefault()}};class ih{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,r,c){return this._calculateTransform(e,r,c)}touchmove(e,r,c){if(this._active){if(!this._shouldBePrevented(c.length))return e.preventDefault(),this._calculateTransform(e,r,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,r,c){this._calculateTransform(e,r,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,c){c.length>0&&(this._active=!0);const f=ml(c,r),_=new h.P(0,0),M=new h.P(0,0);let P=0;for(const V in f){const q=f[V],K=this._touches[V];K&&(_._add(q),M._add(q.sub(K)),P++,f[V]=q)}if(this._touches=f,this._shouldBePrevented(P)||!M.mag())return;const L=M.div(P);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(P),panDelta:L}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,c){if(!this._firstTwoTouches)return;e.preventDefault();const[f,_]=this._firstTwoTouches,M=ql(c,r,f),P=ql(c,r,_);if(!M||!P)return;const L=this._aroundCenter?null:M.add(P).div(2);return this._move([M,P],L,e)}touchend(e,r,c){if(!this._firstTwoTouches)return;const[f,_]=this._firstTwoTouches,M=ql(c,r,f),P=ql(c,r,_);M&&P||(this._active&&pe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ql(y,e,r){for(let c=0;c<y.length;c++)if(y[c].identifier===r)return e[c]}function vs(y,e){return Math.log(y/e)/Math.LN2}class lo extends hu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const c=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(vs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vs(this._distance,c),pinchAround:r}}}function si(y,e){return 180*y.angleWith(e)/Math.PI}class Fh extends hu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,c){const f=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:si(this._vector,f),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,c=si(e,this._startVector);return Math.abs(c)<r}}function co(y){return Math.abs(y.y)>Math.abs(y.x)}class rh extends hu{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,c){super.touchstart(e,r,c),this._currentTouchCount=c.length}_start(e){this._lastPoints=e,co(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=e[0].sub(this._lastPoints[0]),_=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,_,c.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(f.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,c){if(this._valid!==void 0)return this._valid;const f=e.mag()>=2,_=r.mag()>=2;if(!f&&!_)return;if(!f||!_)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const M=e.y>0==r.y>0;return co(e)&&co(r)&&M}}const du={panStep:100,bearingStep:15,pitchStep:10};class bs{constructor(e){this._tr=new Zl(e);const r=du;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,c=0,f=0,_=0,M=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?c=-1:(e.preventDefault(),_=-1);break;case 39:e.shiftKey?c=1:(e.preventDefault(),_=1);break;case 38:e.shiftKey?f=1:(e.preventDefault(),M=-1);break;case 40:e.shiftKey?f=-1:(e.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(c=0,f=0),{cameraAnimation:P=>{const L=this._tr;P.easeTo({duration:300,easeId:"keyboardHandler",easing:nh,zoom:r?Math.round(L.zoom)+r*(e.shiftKey?2:1):L.zoom,bearing:L.bearing+c*this._bearingStep,pitch:L.pitch+f*this._pitchStep,offset:[-_*this._panStep,-M*this._panStep],center:L.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function nh(y){return y*(2-y)}const rr=4.000244140625,Uo=1/450;class xl{constructor(e,r){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=e,this._tr=new Zl(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Uo}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const c=Ee.now(),f=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,r!==0&&r%rr==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(f*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=pe.mousePos(this._map.getCanvas(),e),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(h.S.convert(c.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const P=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=P),typeof this._targetZoom=="number"&&(this._targetZoom+=P)}if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>rr?this._wheelZoomRate:this._defaultZoomRate;let L=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&L!==0&&(L=1/L);const V=typeof this._targetZoom!="number"?e.scale:h.ae(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),h.aj(V*L)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,c=this._startZoom,f=this._easing;let _,M=!1;if(this._type==="wheel"&&c&&f){const P=Ee.now()-this._lastWheelEventTime,L=Math.min((P+5)/200,1),V=f(L);_=h.C.number(c,r,V),L<1?this._frameId||(this._frameId=!0):M=!0}else _=r,M=!0;return this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=_,{noInertia:!0,needsRenderFrame:!M,zoomDelta:_-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=h.cn;if(this._prevEase){const c=this._prevEase,f=(Ee.now()-c.start)/c.duration,_=c.easing(f+.01)-c.easing(f),M=.27/Math.sqrt(_*_+1e-4)*.01,P=Math.sqrt(.0729-M*M);r=h.cl(M,P,.25,1)}return this._prevEase={start:Ee.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class uo{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ah{constructor(e){this._tr=new Zl(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ld{constructor(){this._tap=new gl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,c){if(!this._swipePoint)if(this._tapTime){const f=r[0],_=e.timeStamp-this._tapTime<500,M=this._tapPoint.dist(f)<30;_&&M?c.length>0&&(this._swipePoint=f,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(e,r,c)}touchmove(e,r,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const f=r[0],_=f.y-this._swipePoint.y;return this._swipePoint=f,e.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(e,r,c)}touchend(e,r,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const f=this._tap.touchend(e,r,c);f&&(this._tapTime=e.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pc{constructor(e,r,c){this._el=e,this._mousePan=r,this._touchPan=c}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Xl{constructor(e,r,c,f){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=c,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ho{constructor(e,r,c,f){this._el=e,this._touchZoom=r,this._touchRotate=c,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class pu{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=pe.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=r,this._container.appendChild(f);const _=document.createElement("div");_.className="maplibregl-mobile-message",_.textContent=c,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(pe.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new h.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const po=y=>y.zoom||y.drag||y.roll||y.pitch||y.rotate;class fo extends h.l{}function Uh(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta||y.rollDelta}class mo{constructor(e,r){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,_)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const M=f.type==="renderFrame"?void 0:f,P={needsRenderFrame:!1},L={},V={};for(const{handlerName:W,handler:te,allowed:he}of this._handlers){if(!te.isEnabled())continue;let Ae;if(this._blockedByActive(V,he,W))te.reset();else if(te[_||f.type]){if(h.co(f,_||f.type)){const Ce=pe.mousePos(this._map.getCanvas(),f);Ae=te[_||f.type](f,Ce)}else if(h.cp(f,_||f.type)){const Ce=this._getMapTouches(f.touches),ke=pe.touchPos(this._map.getCanvas(),Ce);Ae=te[_||f.type](f,ke,Ce)}else h.cq(_||f.type)||(Ae=te[_||f.type](f));this.mergeHandlerResult(P,L,Ae,W,M),Ae&&Ae.needsRenderFrame&&this._triggerRenderFrame()}(Ae||te.isActive())&&(V[W]=te)}const q={};for(const W in this._previousActiveHandlers)V[W]||(q[W]=M);this._previousActiveHandlers=V,(Object.keys(q).length||Uh(P))&&(this._changes.push([P,L,q]),this._triggerRenderFrame()),(Object.keys(V).length||Uh(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=P;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Hl(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,_,M]of this._listeners)pe.addEventListener(f,_,f===document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[e,r,c]of this._listeners)pe.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(e){const r=this._map,c=r.getCanvasContainer();this._add("mapEvent",new wp(r,e));const f=r.boxZoom=new kc(r,e);this._add("boxZoom",f),e.interactive&&e.boxZoom&&f.enable();const _=r.cooperativeGestures=new pu(r,e.cooperativeGestures);this._add("cooperativeGestures",_),e.cooperativeGestures&&_.enable();const M=new yl(r),P=new ah(r);r.doubleClickZoom=new uo(P,M),this._add("tapZoom",M),this._add("clickZoom",P),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const L=new Ld;this._add("tapDragZoom",L);const V=r.touchPitch=new rh(r);this._add("touchPitch",V),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const q=()=>r.project(r.getCenter()),K=function({enable:De,clickTolerance:Ge,aroundCenter:Ye=!0,minPixelCenterThreshold:Re=100,rotateDegreesPerPixelMoved:it=.8},vt){const ot=new bn({checkCorrectEvent:ft=>pe.mouseButton(ft)===0&&ft.ctrlKey||pe.mouseButton(ft)===2&&!ft.ctrlKey});return new so({clickTolerance:Ge,move:(ft,wt)=>{const ei=vt();if(Ye&&Math.abs(ei.y-ft.y)>Re)return{bearingDelta:h.cm(new h.P(ft.x,wt.y),wt,ei)};let Kt=(wt.x-ft.x)*it;return Ye&&wt.y<ei.y&&(Kt=-Kt),{bearingDelta:Kt}},moveStateManager:ot,enable:De,assignEvents:th})}(e,q),W=function({enable:De,clickTolerance:Ge,pitchDegreesPerPixelMoved:Ye=-.5}){const Re=new bn({checkCorrectEvent:it=>pe.mouseButton(it)===0&&it.ctrlKey||pe.mouseButton(it)===2});return new so({clickTolerance:Ge,move:(it,vt)=>({pitchDelta:(vt.y-it.y)*Ye}),moveStateManager:Re,enable:De,assignEvents:th})}(e),te=function({enable:De,clickTolerance:Ge,rollDegreesPerPixelMoved:Ye=.3},Re){const it=new bn({checkCorrectEvent:vt=>pe.mouseButton(vt)===2&&vt.ctrlKey});return new so({clickTolerance:Ge,move:(vt,ot)=>{const ft=Re();let wt=(ot.x-vt.x)*Ye;return ot.y<ft.y&&(wt=-wt),{rollDelta:wt}},moveStateManager:it,enable:De,assignEvents:th})}(e,q);r.dragRotate=new Xl(e,K,W,te),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",W,["mouseRotate","mouseRoll"]),this._add("mouseRoll",te,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const he=function({enable:De,clickTolerance:Ge}){const Ye=new bn({checkCorrectEvent:Re=>pe.mouseButton(Re)===0&&!Re.ctrlKey});return new so({clickTolerance:Ge,move:(Re,it)=>({around:it,panDelta:it.sub(Re)}),activateOnStart:!0,moveStateManager:Ye,enable:De,assignEvents:th})}(e),Ae=new ih(e,r);r.dragPan=new Pc(c,he,Ae),this._add("mousePan",he),this._add("touchPan",Ae,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const Ce=new Fh,ke=new lo;r.touchZoomRotate=new ho(c,ke,Ce,L),this._add("touchRotate",Ce,["touchPan","touchZoom"]),this._add("touchZoom",ke,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const ze=r.scrollZoom=new xl(r,()=>this._triggerRenderFrame());this._add("scrollZoom",ze,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const Le=r.keyboard=new bs(r);this._add("keyboard",Le),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new zn(r))}_add(e,r,c){this._handlers.push({handlerName:e,handler:r,allowed:c}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!po(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,c){for(const f in e)if(f!==c&&(!r||r.indexOf(f)<0))return!0;return!1}_getMapTouches(e){const r=[];for(const c of e)this._el.contains(c.target)&&r.push(c);return r}mergeHandlerResult(e,r,c,f,_){if(!c)return;h.e(e,c);const M={handlerName:f,originalEvent:c.originalEvent||_};c.zoomDelta!==void 0&&(r.zoom=M),c.panDelta!==void 0&&(r.drag=M),c.rollDelta!==void 0&&(r.roll=M),c.pitchDelta!==void 0&&(r.pitch=M),c.bearingDelta!==void 0&&(r.rotate=M)}_applyChanges(){const e={},r={},c={};for(const[f,_,M]of this._changes)f.panDelta&&(e.panDelta=(e.panDelta||new h.P(0,0))._add(f.panDelta)),f.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(e.rollDelta=(e.rollDelta||0)+f.rollDelta),f.around!==void 0&&(e.around=f.around),f.pinchAround!==void 0&&(e.pinchAround=f.pinchAround),f.noInertia&&(e.noInertia=f.noInertia),h.e(r,_),h.e(c,M);this._updateMapTransform(e,r,c),this._changes=[]}_updateMapTransform(e,r,c){const f=this._map,_=f._getTransformForUpdate(),M=f.terrain;if(!(Uh(e)||M&&this._terrainMovement))return this._fireEvents(r,c,!0);f._stop(!0);let{panDelta:P,zoomDelta:L,bearingDelta:V,pitchDelta:q,rollDelta:K,around:W,pinchAround:te}=e;te!==void 0&&(W=te),W=W||f.transform.centerPoint,M&&!_.isPointOnMapSurface(W)&&(W=_.centerPoint);const he={panDelta:P,zoomDelta:L,rollDelta:K,pitchDelta:q,bearingDelta:V,around:W};this._map.cameraHelper.useGlobeControls&&!_.isPointOnMapSurface(W)&&(W=_.centerPoint);const Ae=W.distSqr(_.centerPoint)<.01?_.center:_.screenPointToLocation(P?W.sub(P):W);M?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(he,_),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?_.setCenter(_.screenPointToLocation(_.centerPoint.sub(P))):this._map.cameraHelper.handleMapControlsPan(he,_,Ae):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(he,_,Ae))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(he,_),this._map.cameraHelper.handleMapControlsPan(he,_,Ae)),f._applyUpdatedTransform(_),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,c,!0)}_fireEvents(e,r,c){const f=po(this._eventsInProgress),_=po(e),M={};for(const K in e){const{originalEvent:W}=e[K];this._eventsInProgress[K]||(M[`${K}start`]=W),this._eventsInProgress[K]=e[K]}!f&&_&&this._fireEvent("movestart",_.originalEvent);for(const K in M)this._fireEvent(K,M[K]);_&&this._fireEvent("move",_.originalEvent);for(const K in e){const{originalEvent:W}=e[K];this._fireEvent(K,W)}const P={};let L;for(const K in this._eventsInProgress){const{handlerName:W,originalEvent:te}=this._eventsInProgress[K];this._handlersById[W].isActive()||(delete this._eventsInProgress[K],L=r[W]||te,P[`${K}end`]=L)}for(const K in P)this._fireEvent(K,P[K]);const V=po(this._eventsInProgress),q=(f||_)&&!V;if(q&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const K=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&K.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(K)}if(c&&q){this._updatingCamera=!0;const K=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),W=te=>te!==0&&-this._bearingSnap<te&&te<this._bearingSnap;!K||!K.essential&&Ee.prefersReducedMotion?(this._map.fire(new h.l("moveend",{originalEvent:L})),W(this._map.getBearing())&&this._map.resetNorth()):(W(K.bearing||this._map.getBearing())&&(K.bearing=0),K.freezeElevation=!0,this._map.easeTo(K,{originalEvent:L})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new h.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new fo("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Xr extends h.E{constructor(e,r,c){super(),this._renderFrameCallback=()=>{const f=Math.min((Ee.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=c.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new h.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,c){return e=h.P.convert(e).mult(-1),this.panTo(this.transform.center,h.e({offset:e},r),c)}panTo(e,r,c){return this.easeTo(h.e({center:e},r),c)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,c){return this.easeTo(h.e({zoom:e},r),c)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new h.l("movestart",r)).fire(new h.l("move",r)).fire(new h.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,c){return this.easeTo(h.e({bearing:e},r),c)}resetNorth(e,r){return this.rotateTo(0,h.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(h.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=li.convert(e).adjustAntiMeridian();const c=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),c,r)}_cameraForBoxAndBearing(e,r,c,f){const _={top:0,bottom:0,right:0,left:0};if(typeof(f=h.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const V=f.padding;f.padding={top:V,bottom:V,right:V,left:V}}const M=h.e(_,f.padding);f.padding=M;const P=this.transform,L=new li(e,r);return this.cameraHelper.cameraForBoxAndBearing(f,M,L,c,P)}fitBounds(e,r,c){return this._fitInternal(this.cameraForBounds(e,r),r,c)}fitScreenCoordinates(e,r,c,f,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(h.P.convert(e)),this.transform.screenPointToLocation(h.P.convert(r)),c,f),f,_)}_fitInternal(e,r,c){return e?(delete(r=h.e(e,r)).padding,r.linear?this.easeTo(r,c):this.flyTo(r,c)):this}jumpTo(e,r){this.stop();const c=this._getTransformForUpdate();let f=!1,_=!1,M=!1;const P=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,e);const L=c.zoom!==P;return"elevation"in e&&c.elevation!==+e.elevation&&c.setElevation(+e.elevation),"bearing"in e&&c.bearing!==+e.bearing&&(f=!0,c.setBearing(+e.bearing)),"pitch"in e&&c.pitch!==+e.pitch&&(_=!0,c.setPitch(+e.pitch)),"roll"in e&&c.roll!==+e.roll&&(M=!0,c.setRoll(+e.roll)),e.padding==null||c.isPaddingEqual(e.padding)||c.setPadding(e.padding),this._applyUpdatedTransform(c),this.fire(new h.l("movestart",r)).fire(new h.l("move",r)),L&&this.fire(new h.l("zoomstart",r)).fire(new h.l("zoom",r)).fire(new h.l("zoomend",r)),f&&this.fire(new h.l("rotatestart",r)).fire(new h.l("rotate",r)).fire(new h.l("rotateend",r)),_&&this.fire(new h.l("pitchstart",r)).fire(new h.l("pitch",r)).fire(new h.l("pitchend",r)),M&&this.fire(new h.l("rollstart",r)).fire(new h.l("roll",r)).fire(new h.l("rollend",r)),this.fire(new h.l("moveend",r))}calculateCameraOptionsFromTo(e,r,c,f=0){const _=h.a0.fromLngLat(e,r),M=h.a0.fromLngLat(c,f),P=M.x-_.x,L=M.y-_.y,V=M.z-_.z,q=Math.hypot(P,L,V);if(q===0)throw new Error("Can't calculate camera options with same From and To");const K=Math.hypot(P,L),W=h.aj(this.transform.cameraToCenterDistance/q/this.transform.tileSize),te=180*Math.atan2(P,-L)/Math.PI;let he=180*Math.acos(K/q)/Math.PI;return he=V<0?90-he:90+he,{center:M.toLngLat(),elevation:f,zoom:W,pitch:he,bearing:te}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,c,f,_){const M=this.transform.calculateCenterFromCameraLngLatAlt(e,r,c,f);return{center:M.center,elevation:M.elevation,zoom:M.zoom,bearing:c,pitch:f,roll:_}}easeTo(e,r){this._stop(!1,e.easeId),((e=h.e({offset:[0,0],duration:500,easing:h.cn},e)).animate===!1||!e.essential&&Ee.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),f=this.getBearing(),_=c.pitch,M=c.roll,P="bearing"in e?this._normalizeBearing(e.bearing,f):f,L="pitch"in e?+e.pitch:_,V="roll"in e?this._normalizeBearing(e.roll,M):M,q="padding"in e?e.padding:c.padding,K=h.P.convert(e.offset);let W,te;e.around&&(W=h.S.convert(e.around),te=c.locationToScreenPoint(W));const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Ae=this.cameraHelper.handleEaseTo(c,{bearing:P,pitch:L,roll:V,padding:q,around:W,aroundPoint:te,offsetAsPoint:K,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||f!==P,this._pitching=this._pitching||L!==_,this._rolling=this._rolling||V!==M,this._padding=!c.isPaddingEqual(q),this._zooming=this._zooming||Ae.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,he),this.terrain&&this._prepareElevation(Ae.elevationCenter),this._ease(Ce=>{Ae.easeFunc(Ce),this.terrain&&!e.freezeElevation&&this._updateElevation(Ce),this._applyUpdatedTransform(c),this._fireMoveEvents(r)},Ce=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,Ce)},e),this}_prepareEase(e,r,c={}){this._moving=!0,r||c.moving||this.fire(new h.l("movestart",e)),this._zooming&&!c.zooming&&this.fire(new h.l("zoomstart",e)),this._rotating&&!c.rotating&&this.fire(new h.l("rotatestart",e)),this._pitching&&!c.pitching&&this.fire(new h.l("pitchstart",e)),this._rolling&&!c.rolling&&this.fire(new h.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(c-(r-(c*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(h.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const r=e.getCameraLngLat(),c=e.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(r,e.zoom):0;if(c<f){const _=this.calculateCameraOptionsFromTo(r,f,e.center,e.elevation);return{pitch:_.pitch,zoom:_.zoom}}return{}}_applyUpdatedTransform(e){const r=[];if(r.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&r.push(f=>this.transformCameraUpdate(f)),!r.length)return;const c=e.clone();for(const f of r){const _=c.clone(),{center:M,zoom:P,roll:L,pitch:V,bearing:q,elevation:K}=f(_);M&&_.setCenter(M),K!==void 0&&_.setElevation(K),P!==void 0&&_.setZoom(P),L!==void 0&&_.setRoll(L),V!==void 0&&_.setPitch(V),q!==void 0&&_.setBearing(q),c.apply(_)}this.transform.apply(c)}_fireMoveEvents(e){this.fire(new h.l("move",e)),this._zooming&&this.fire(new h.l("zoom",e)),this._rotating&&this.fire(new h.l("rotate",e)),this._pitching&&this.fire(new h.l("pitch",e)),this._rolling&&this.fire(new h.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const c=this._zooming,f=this._rotating,_=this._pitching,M=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new h.l("zoomend",e)),f&&this.fire(new h.l("rotateend",e)),_&&this.fire(new h.l("pitchend",e)),M&&this.fire(new h.l("rollend",e)),this.fire(new h.l("moveend",e))}flyTo(e,r){if(!e.essential&&Ee.prefersReducedMotion){const wt=h.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(wt,r)}this.stop(),e=h.e({offset:[0,0],speed:1.2,curve:1.42,easing:h.cn},e);const c=this._getTransformForUpdate(),f=c.bearing,_=c.pitch,M=c.roll,P=c.padding,L="bearing"in e?this._normalizeBearing(e.bearing,f):f,V="pitch"in e?+e.pitch:_,q="roll"in e?this._normalizeBearing(e.roll,M):M,K="padding"in e?e.padding:c.padding,W=h.P.convert(e.offset);let te=c.centerPoint.add(W);const he=c.screenPointToLocation(te),Ae=this.cameraHelper.handleFlyTo(c,{bearing:L,pitch:V,roll:q,padding:K,locationAtOffset:he,offsetAsPoint:W,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let Ce=e.curve;const ke=Math.max(c.width,c.height),ze=ke/Ae.scaleOfZoom,Le=Ae.pixelPathLength;typeof Ae.scaleOfMinZoom=="number"&&(Ce=Math.sqrt(ke/Ae.scaleOfMinZoom/Le*2));const De=Ce*Ce;function Ge(wt){const ei=(ze*ze-ke*ke+(wt?-1:1)*De*De*Le*Le)/(2*(wt?ze:ke)*De*Le);return Math.log(Math.sqrt(ei*ei+1)-ei)}function Ye(wt){return(Math.exp(wt)-Math.exp(-wt))/2}function Re(wt){return(Math.exp(wt)+Math.exp(-wt))/2}const it=Ge(!1);let vt=function(wt){return Re(it)/Re(it+Ce*wt)},ot=function(wt){return ke*((Re(it)*(Ye(ei=it+Ce*wt)/Re(ei))-Ye(it))/De)/Le;var ei},ft=(Ge(!0)-it)/Ce;if(Math.abs(Le)<2e-6||!isFinite(ft)){if(Math.abs(ke-ze)<1e-6)return this.easeTo(e,r);const wt=ze<ke?-1:1;ft=Math.abs(Math.log(ze/ke))/Ce,ot=()=>0,vt=ei=>Math.exp(wt*Ce*ei)}return e.duration="duration"in e?+e.duration:1e3*ft/("screenSpeed"in e?+e.screenSpeed/Ce:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=f!==L,this._pitching=V!==_,this._rolling=q!==M,this._padding=!c.isPaddingEqual(K),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(Ae.targetCenter),this._ease(wt=>{const ei=wt*ft,Kt=1/vt(ei),Lt=ot(ei);this._rotating&&c.setBearing(h.C.number(f,L,wt)),this._pitching&&c.setPitch(h.C.number(_,V,wt)),this._rolling&&c.setRoll(h.C.number(M,q,wt)),this._padding&&(c.interpolatePadding(P,K,wt),te=c.centerPoint.add(W)),Ae.easeFunc(wt,Kt,Lt,te),this.terrain&&!e.freezeElevation&&this._updateElevation(wt),this._applyUpdatedTransform(c),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,r)}return e||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(e,r,c){c.animate===!1||c.duration===0?(e(1),r()):(this._easeStart=Ee.now(),this._easeOptions=c,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=h.aN(e,-180,180);const c=Math.abs(e-r);return Math.abs(e-360-r)<c&&(e-=360),Math.abs(e+360-r)<c&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(h.S.convert(e),this.transform.tileZoom):null}}const za={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class $i{constructor(e=za){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=pe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=pe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=pe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){pe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,r){const c=this._map._getUIString(`AttributionControl.${r}`);e.title=c,e.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const r=this._map.style.sourceCaches;for(const f in r){const _=r[f];if(_.used||_.usedForTerrain){const M=_.getSource();M.attribution&&e.indexOf(M.attribution)<0&&e.push(M.attribution)}}e=e.filter(f=>String(f).trim()),e.sort((f,_)=>f.length-_.length),e=e.filter((f,_)=>{for(let M=_+1;M<e.length;M++)if(e[M].indexOf(f)>=0)return!1;return!0});const c=e.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,e.length?(this._innerContainer.innerHTML=pe.sanitize(c),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ir{constructor(e={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=pe.create("div","maplibregl-ctrl");const r=pe.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){pe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class mn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,c=r?this._queue.concat(r):this._queue;for(const f of c)if(f.id===e)return void(f.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const c of r)if(!c.cancelled&&(c.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var sh=h.aI([{name:"a_pos3d",type:"Int16",components:3}]);class fu extends h.E{constructor(e){super(),this._lastTilesetChange=Ee.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const c={};for(const f of St(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),h.bX(f.terrainRttPosMatrix32f,0,h.$,h.$,0,0,1),this._tiles[f.key]=new sa(f,this.tileSize),this._lastTilesetChange=Ee.now());for(const f in this._tiles)c[f]||delete this._tiles[f]}freeRtt(e){for(const r in this._tiles){const c=this._tiles[r];(!e||c.tileID.equals(e)||c.tileID.isChildOf(e)||e.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,r){return r?this._getTerrainCoordsForTileRanges(e,r):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const r={};for(const c of this._renderableTilesKeys){const f=this._tiles[c].tileID,_=e.clone(),M=h.b9();if(f.canonical.equals(e.canonical))h.bX(M,0,h.$,h.$,0,0,1);else if(f.canonical.isChildOf(e.canonical)){const P=f.canonical.z-e.canonical.z,L=f.canonical.x-(f.canonical.x>>P<<P),V=f.canonical.y-(f.canonical.y>>P<<P),q=h.$>>P;h.bX(M,0,q,q,0,0,1),h.M(M,M,[-L*q,-V*q,0])}else{if(!e.canonical.isChildOf(f.canonical))continue;{const P=e.canonical.z-f.canonical.z,L=e.canonical.x-(e.canonical.x>>P<<P),V=e.canonical.y-(e.canonical.y>>P<<P),q=h.$>>P;h.bX(M,0,h.$,h.$,0,0,1),h.M(M,M,[L*q,V*q,0]),h.N(M,M,[1/2**P,1/2**P,0])}}_.terrainRttPosMatrix32f=new Float32Array(M),r[c]=_}return r}_getTerrainCoordsForTileRanges(e,r){const c={};for(const f of this._renderableTilesKeys){const _=this._tiles[f].tileID;if(!this._isWithinTileRanges(_,r))continue;const M=e.clone(),P=h.b9();if(_.canonical.z===e.canonical.z){const L=e.canonical.x-_.canonical.x,V=e.canonical.y-_.canonical.y;h.bX(P,0,h.$,h.$,0,0,1),h.M(P,P,[L*h.$,V*h.$,0])}else if(_.canonical.z>e.canonical.z){const L=_.canonical.z-e.canonical.z,V=_.canonical.x-(_.canonical.x>>L<<L),q=_.canonical.y-(_.canonical.y>>L<<L),K=e.canonical.x-(_.canonical.x>>L),W=e.canonical.y-(_.canonical.y>>L),te=h.$>>L;h.bX(P,0,te,te,0,0,1),h.M(P,P,[-V*te+K*h.$,-q*te+W*h.$,0])}else{const L=e.canonical.z-_.canonical.z,V=e.canonical.x-(e.canonical.x>>L<<L),q=e.canonical.y-(e.canonical.y>>L<<L),K=(e.canonical.x>>L)-_.canonical.x,W=(e.canonical.y>>L)-_.canonical.y,te=h.$<<L;h.bX(P,0,te,te,0,0,1),h.M(P,P,[V*h.$+K*te,q*h.$+W*te,0])}M.terrainRttPosMatrix32f=new Float32Array(P),c[f]=M}return c}getSourceTile(e,r){const c=this.sourceCache._source;let f=e.overscaledZ-this.deltaZoom;if(f>c.maxzoom&&(f=c.maxzoom),f<c.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(f).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!_||!_.dem)&&r)for(;f>=c.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(e.scaledTo(f--).key);return _}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,r){return r[e.canonical.z]&&e.canonical.x>=r[e.canonical.z].minTileX&&e.canonical.x<=r[e.canonical.z].maxTileX&&e.canonical.y>=r[e.canonical.z].minTileY&&e.canonical.y<=r[e.canonical.z].maxTileY}}class Yr{constructor(e,r,c){this._meshCache={},this.painter=e,this.sourceCache=new fu(r),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,c,f=h.$){var _;if(!(r>=0&&r<f&&c>=0&&c<f))return 0;const M=this.getTerrainData(e),P=(_=M.tile)===null||_===void 0?void 0:_.dem;if(!P)return 0;const L=h.cr([],[r/f*h.$,c/f*h.$],M.u_terrain_matrix),V=[L[0]*P.dim,L[1]*P.dim],q=Math.floor(V[0]),K=Math.floor(V[1]),W=V[0]-q,te=V[1]-K;return P.get(q,K)*(1-W)*(1-te)+P.get(q+1,K)*W*(1-te)+P.get(q,K+1)*(1-W)*te+P.get(q+1,K+1)*W*te}getElevationForLngLatZoom(e,r){if(!h.cs(r,e.wrap()))return 0;const{tileID:c,mercatorX:f,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(c,f%h.$,_%h.$,h.$)}getElevation(e,r,c,f=h.$){return this.getDEMElevation(e,r,c,f)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const f=this.painter.context,_=new h.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new h.T(f,_,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new h.T(f,new h.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.af([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const f=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new h.T(f,r.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),r.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const c=r&&r+r.tileID.key+e.key;if(c&&!this._demMatrixCache[c]){const f=this.sourceCache.sourceCache._source.maxzoom;let _=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=f?_=e.canonical.z-f:h.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const M=e.canonical.x-(e.canonical.x>>_<<_),P=e.canonical.y-(e.canonical.y>>_<<_),L=h.ct(new Float64Array(16),[1/(h.$<<_),1/(h.$<<_),0]);h.M(L,L,[M*h.$,P*h.$,0]),this._demMatrixCache[e.key]={matrix:L,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,c=r.width/devicePixelRatio,f=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new h.T(r.context,{width:c,height:f,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new h.T(r.context,{width:c,height:f,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(c,f,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,c,f))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,M=0;_<this._coordsTextureSize;_++)for(let P=0;P<this._coordsTextureSize;P++,M+=4)r[M+0]=255&P,r[M+1]=255&_,r[M+2]=P>>8<<4|_>>8,r[M+3]=0;const c=new h.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),f=new h.T(e,c,e.gl.RGBA,{premultiply:!1});return f.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),c=this.painter.context,f=c.gl,_=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),M=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),P=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(_,P-M-1,1,1,f.RGBA,f.UNSIGNED_BYTE,r),c.bindFramebuffer.set(null);const L=r[0]+(r[2]>>4<<8),V=r[1]+((15&r[2])<<8),q=this.coordsIndex[255-r[3]],K=q&&this.sourceCache.getTileByID(q);if(!K)return null;const W=this._coordsTextureSize,te=(1<<K.tileID.canonical.z)*W;return new h.a0((K.tileID.canonical.x*W+L)/te+K.tileID.wrap,(K.tileID.canonical.y*W+V)/te,this.getElevation(K.tileID,L,V,W))}depthAtPoint(e){const r=new Uint8Array(4),c=this.painter.context,f=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,r),c.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(e){var r;const c=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,f=c&&e.canonical.y===0,_=c&&e.canonical.y===(1<<e.canonical.z)-1,M=`m_${f?"n":""}_${_?"s":""}`;if(this._meshCache[M])return this._meshCache[M];const P=this.painter.context,L=new h.cu,V=new h.aM,q=this.meshSize,K=h.$/q,W=q*q;for(let Re=0;Re<=q;Re++)for(let it=0;it<=q;it++)L.emplaceBack(it*K,Re*K,0);for(let Re=0;Re<W;Re+=q+1)for(let it=0;it<q;it++)V.emplaceBack(it+Re,q+it+Re+1,q+it+Re+2),V.emplaceBack(it+Re,q+it+Re+2,it+Re+1);const te=L.length,he=te+(q+1),Ae=(q+1)*q,Ce=f?h.bg:0,ke=f?0:1,ze=_?h.bh:h.$,Le=_?0:1;for(let Re=0;Re<=q;Re++)L.emplaceBack(Re*K,Ce,ke);for(let Re=0;Re<=q;Re++)L.emplaceBack(Re*K,ze,Le);for(let Re=0;Re<q;Re++)V.emplaceBack(Ae+Re,he+Re,he+Re+1),V.emplaceBack(Ae+Re,he+Re+1,Ae+Re+1),V.emplaceBack(0+Re,te+Re+1,te+Re),V.emplaceBack(0+Re,0+Re+1,te+Re+1);const De=L.length,Ge=De+2*(q+1);for(const Re of[0,1])for(let it=0;it<=q;it++)for(const vt of[0,1])L.emplaceBack(Re*h.$,it*K,vt);for(let Re=0;Re<2*q;Re+=2)V.emplaceBack(De+Re,De+Re+1,De+Re+3),V.emplaceBack(De+Re,De+Re+3,De+Re+2),V.emplaceBack(Ge+Re,Ge+Re+3,Ge+Re+1),V.emplaceBack(Ge+Re,Ge+Re+2,Ge+Re+3);const Ye=new zo(P.createVertexBuffer(L,sh.members),P.createIndexBuffer(V),h.aL.simpleSegment(0,0,L.length,V.length));return this._meshCache[M]=Ye,Ye}getMeshFrameDelta(e){return 2*Math.PI*h.bt/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var c;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(c=this.getMinMaxElevation(f).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(e){const r=this.getTerrainData(e).tile,c={minElevation:null,maxElevation:null};return r&&r.dem&&(c.minElevation=r.dem.min*this.exaggeration,c.maxElevation=r.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(e,r){const c=h.a0.fromLngLat(e.wrap()),f=(1<<r)*h.$,_=c.x*f,M=c.y*f,P=Math.floor(_/h.$),L=Math.floor(M/h.$);return{tileID:new h.Z(r,0,r,P,L),mercatorX:_,mercatorY:M}}}class zc{constructor(e,r,c){this._context=e,this._size=r,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new h.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(c.texture),{id:e,fbo:r,texture:c,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const ui={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Ti{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new zc(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(c=>!e._layers[c].isHidden(r)),this._coordsAscending={};for(const c in e.sourceCaches){this._coordsAscending[c]={};const f=e.sourceCaches[c].getVisibleCoordinates(),_=e.sourceCaches[c].getSource(),M=_ instanceof va?_.terrainTileRanges:null;for(const P of f){const L=this.terrain.sourceCache.getTerrainCoords(P,M);for(const V in L)this._coordsAscending[c][V]||(this._coordsAscending[c][V]=[]),this._coordsAscending[c][V].push(L[V])}}this._coordsAscendingStr={};for(const c of e._order){const f=e._layers[c],_=f.source;if(ui[f.type]&&!this._coordsAscendingStr[_]){this._coordsAscendingStr[_]={};for(const M in this._coordsAscending[_])this._coordsAscendingStr[_][M]=this._coordsAscending[_][M].map(P=>P.key).sort().join()}}for(const c of this._renderableTiles)for(const f in this._coordsAscendingStr){const _=this._coordsAscendingStr[f][c.tileID.key];_&&_!==c.rttCoords[f]&&(c.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),f=e.type,_=this.painter,M=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(ui[f]&&(this._prevType&&ui[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(e.id),!M))return!0;if(ui[this._prevType]||ui[f]&&M){this._prevType=f;const P=this._stacks.length-1,L=this._stacks[P]||[];for(const V of this._renderableTiles){if(this.pool.isFull()&&(on(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(V),V.rtt[P]){const K=this.pool.getObjectForId(V.rtt[P].id);if(K.stamp===V.rtt[P].stamp){this.pool.useObject(K);continue}}const q=this.pool.getOrCreateFreeObject();this.pool.useObject(q),this.pool.stampObject(q),V.rtt[P]={id:q.id,stamp:q.stamp},_.context.bindFramebuffer.set(q.fbo.framebuffer),_.context.clear({color:h.be.transparent,stencil:0}),_.currentStencilSource=void 0;for(let K=0;K<L.length;K++){const W=_.style._layers[L[K]],te=W.source?this._coordsAscending[W.source][V.tileID.key]:[V.tileID];_.context.viewport.set([0,0,q.fbo.width,q.fbo.height]),_._renderTileClippingMasks(W,te,!0),_.renderLayer(_,_.style.sourceCaches[W.source],W,te,c),W.source&&(V.rttCoords[W.source]=this._coordsAscendingStr[W.source][V.tileID.key])}}return on(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),ui[f]}return!1}}const oh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Or=oe,Vo={hash:!1,interactive:!0,bearingSnap:7,attributionControl:za,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Fn={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Dd{constructor(e,r,c=!1){this.mousedown=_=>{this.startMove(_,pe.mousePos(this.element,_)),pe.addEventListener(window,"mousemove",this.mousemove),pe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.move(_,pe.mousePos(this.element,_))},this.mouseup=_=>{this._rotatePitchHanlder.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=pe.touchPos(this.element,_.targetTouches)[0],this.startMove(_,this._startPos),pe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=pe.touchPos(this.element,_.targetTouches)[0],this.move(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const f=new Nh;this._rotatePitchHanlder=new so({clickTolerance:3,move:(_,M)=>{const P=r.getBoundingClientRect(),L=new h.P((P.bottom-P.top)/2,(P.right-P.left)/2);return{bearingDelta:h.cm(new h.P(_.x,M.y),M,L),pitchDelta:c?-.5*(M.y-_.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=e,pe.addEventListener(r,"mousedown",this.mousedown),pe.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),pe.addEventListener(r,"touchcancel",this.reset)}startMove(e,r){this._rotatePitchHanlder.dragStart(e,r),pe.disableDrag()}move(e,r){const c=this.map,{bearingDelta:f,pitchDelta:_}=this._rotatePitchHanlder.dragMove(e,r)||{};f&&c.setBearing(c.getBearing()+f),_&&c.setPitch(c.getPitch()+_)}off(){const e=this.element;pe.removeEventListener(e,"mousedown",this.mousedown),pe.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),pe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.removeEventListener(window,"touchend",this.touchend),pe.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){pe.enableDrag(),pe.removeEventListener(window,"mousemove",this.mousemove),pe.removeEventListener(window,"mouseup",this.mouseup),pe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),pe.removeEventListener(window,"touchend",this.touchend)}}let Qn;function go(y,e,r,c=!1){if(c||!r.getCoveringTilesDetailsProvider().allowWorldCopies())return y==null?void 0:y.wrap();const f=new h.S(y.lng,y.lat);if(y=new h.S(y.lng,y.lat),e){const _=new h.S(y.lng-360,y.lat),M=new h.S(y.lng+360,y.lat),P=r.locationToScreenPoint(y).distSqr(e);r.locationToScreenPoint(_).distSqr(e)<P?y=_:r.locationToScreenPoint(M).distSqr(e)<P&&(y=M)}for(;Math.abs(y.lng-r.center.lng)>180;){const _=r.locationToScreenPoint(y);if(_.x>=0&&_.y>=0&&_.x<=r.width&&_.y<=r.height)break;y.lng>r.center.lng?y.lng-=360:y.lng+=360}return y.lng!==f.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(y))?y:f}const vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Wr(y,e,r){const c=y.classList;for(const f in vl)c.remove(`maplibregl-${r}-anchor-${f}`);c.add(`maplibregl-${r}-anchor-${e}`)}class er extends h.E{constructor(e){if(super(),this._onKeyPress=r=>{const c=r.code,f=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=r=>{const c=r.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()},this._update=r=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=go(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),pe.setTransform(this._element,`${vl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${f}`),Ee.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.l("dragstart"))),this.fire(new h.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.l("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=h.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=pe.create("div");const r=pe.createNS("http://www.w3.org/2000/svg","svg"),c=41,f=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${c}px`),r.setAttributeNS(null,"width",`${f}px`),r.setAttributeNS(null,"viewBox",`0 0 ${f} ${c}`);const _=pe.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const M=pe.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill-rule","nonzero");const P=pe.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(3.0, 29.0)"),P.setAttributeNS(null,"fill","#000000");const L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ke of L){const ze=pe.createNS("http://www.w3.org/2000/svg","ellipse");ze.setAttributeNS(null,"opacity","0.04"),ze.setAttributeNS(null,"cx","10.5"),ze.setAttributeNS(null,"cy","5.80029008"),ze.setAttributeNS(null,"rx",ke.rx),ze.setAttributeNS(null,"ry",ke.ry),P.appendChild(ze)}const V=pe.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const q=pe.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(q);const K=pe.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"opacity","0.25"),K.setAttributeNS(null,"fill","#000000");const W=pe.createNS("http://www.w3.org/2000/svg","path");W.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),K.appendChild(W);const te=pe.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"transform","translate(6.0, 7.0)"),te.setAttributeNS(null,"fill","#FFFFFF");const he=pe.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Ae=pe.createNS("http://www.w3.org/2000/svg","circle");Ae.setAttributeNS(null,"fill","#000000"),Ae.setAttributeNS(null,"opacity","0.25"),Ae.setAttributeNS(null,"cx","5.5"),Ae.setAttributeNS(null,"cy","5.5"),Ae.setAttributeNS(null,"r","5.4999962");const Ce=pe.createNS("http://www.w3.org/2000/svg","circle");Ce.setAttributeNS(null,"fill","#FFFFFF"),Ce.setAttributeNS(null,"cx","5.5"),Ce.setAttributeNS(null,"cy","5.5"),Ce.setAttributeNS(null,"r","5.4999962"),he.appendChild(Ae),he.appendChild(Ce),M.appendChild(P),M.appendChild(V),M.appendChild(K),M.appendChild(te),M.appendChild(he),r.appendChild(M),r.setAttributeNS(null,"height",c*this._scale+"px"),r.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(r),this._offset=h.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),Wr(this._element,this._anchor,"marker"),e&&e.className)for(const r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),pe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=h.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const f=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,c;const f=(r=this._map)===null||r===void 0?void 0:r.terrain,_=this._map.transform.isLocationOccluded(this._lngLat);if(!f||_){const te=_?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==te&&(this._element.style.opacity=te))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const M=this._map,P=M.terrain.depthAtPoint(this._pos),L=M.terrain.getElevationForLngLatZoom(this._lngLat,M.transform.tileZoom);if(M.transform.lngLatToCameraDepth(this._lngLat,L)-P<.006)return void(this._element.style.opacity=this._opacity);const V=-this._offset.y/M.transform.pixelsPerMeter,q=Math.sin(M.getPitch()*Math.PI/180)*V,K=M.terrain.depthAtPoint(new h.P(this._pos.x,this._pos.y-this._offset.y)),W=M.transform.lngLatToCameraDepth(this._lngLat,L+q)-K>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&W&&this._popup.remove(),this._element.style.opacity=W?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=h.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return(this._opacity===void 0||e===void 0&&r===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const La={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Kr=0,yo=!1;const bl={maxWidth:100,unit:"metric"};function _o(y,e,r){const c=r&&r.maxWidth||100,f=y._container.clientHeight/2,_=y._container.clientWidth/2,M=y.unproject([_-c/2,f]),P=y.unproject([_+c/2,f]),L=Math.round(y.project(P).x-y.project(M).x),V=Math.min(c,L,y._container.clientWidth),q=M.distanceTo(P);if(r&&r.unit==="imperial"){const K=3.2808*q;K>5280?ws(e,V,K/5280,y._getUIString("ScaleControl.Miles")):ws(e,V,K,y._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?ws(e,V,q/1852,y._getUIString("ScaleControl.NauticalMiles")):q>=1e3?ws(e,V,q/1e3,y._getUIString("ScaleControl.Kilometers")):ws(e,V,q,y._getUIString("ScaleControl.Meters"))}function ws(y,e,r,c){const f=function(_){const M=Math.pow(10,`${Math.floor(_)}`.length-1);let P=_/M;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(L){const V=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*V)/V}(P),M*P}(r);y.style.width=e*(f/r)+"px",y.innerHTML=`${f}&nbsp;${c}`}const Da={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},mu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function gu(y){if(y){if(typeof y=="number"){const e=Math.round(Math.abs(y)/Math.SQRT2);return{center:new h.P(0,0),top:new h.P(0,y),"top-left":new h.P(e,e),"top-right":new h.P(-e,e),bottom:new h.P(0,-y),"bottom-left":new h.P(e,-e),"bottom-right":new h.P(-e,-e),left:new h.P(y,0),right:new h.P(-y,0)}}if(y instanceof h.P||Array.isArray(y)){const e=h.P.convert(y);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:h.P.convert(y.center||[0,0]),top:h.P.convert(y.top||[0,0]),"top-left":h.P.convert(y["top-left"]||[0,0]),"top-right":h.P.convert(y["top-right"]||[0,0]),bottom:h.P.convert(y.bottom||[0,0]),"bottom-left":h.P.convert(y["bottom-left"]||[0,0]),"bottom-right":h.P.convert(y["bottom-right"]||[0,0]),left:h.P.convert(y.left||[0,0]),right:h.P.convert(y.right||[0,0])}}return gu(new h.P(0,0))}const yu=oe;B.AJAXError=h.cy,B.Event=h.l,B.Evented=h.E,B.LngLat=h.S,B.MercatorCoordinate=h.a0,B.Point=h.P,B.addProtocol=h.cz,B.config=h.a,B.removeProtocol=h.cA,B.AttributionControl=$i,B.BoxZoomHandler=kc,B.CanvasSource=$a,B.CooperativeGesturesHandler=pu,B.DoubleClickZoomHandler=uo,B.DragPanHandler=Pc,B.DragRotateHandler=Xl,B.EdgeInsets=Za,B.FullscreenControl=class extends h.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var e;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=r==null?void 0:r.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:h.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){pe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=pe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);pe.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},B.GeoJSONSource=Ga,B.GeolocateControl=class extends h.E{constructor(y){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new h.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new h.S(e.coords.longitude,e.coords.latitude),c=e.coords.accuracy,f=this._map.getBearing(),_=h.e({bearing:f},this.options.fitBoundsOptions),M=li.fromLngLat(r,c);this._map.fitBounds(M,_,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new h.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&yo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=pe.create("button","maplibregl-ctrl-geolocate",this._container),pe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){h.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=pe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new er({element:this._dotElement}),this._circleElement=pe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new er({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.l("trackuserlocationend")),this.fire(new h.l("userlocationlostfocus")))})}},this.options=h.e({},La,y)}onAdd(y){return this._map=y,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return h._(this,arguments,void 0,function*(e=!1){if(Qn!==void 0&&!e)return Qn;if(window.navigator.permissions===void 0)return Qn=!!window.navigator.geolocation,Qn;try{Qn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Qn=!!window.navigator.geolocation}return Qn})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),pe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Kr=0,yo=!1}_isOutOfMapMaxBounds(y){const e=this._map.getMaxBounds(),r=y.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),e=y.getSouthEast(),r=y.getNorthEast(),c=e.distanceTo(r),f=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return h.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Kr--,yo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.l("trackuserlocationstart")),this.fire(new h.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Kr++,Kr>1?(y={maximumAge:6e5,timeout:0},yo=!0):(y=this.options.positionOptions,yo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},B.GlobeControl=class{constructor(){this._toggleProjection=()=>{var y;const e=(y=this._map.getProjection())===null||y===void 0?void 0:y.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var y;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((y=this._map.getProjection())===null||y===void 0?void 0:y.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(y){return this._map=y,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=pe.create("button","maplibregl-ctrl-globe",this._container),pe.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){pe.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},B.Hash=ns,B.ImageSource=va,B.KeyboardHandler=bs,B.LngLatBounds=li,B.LogoControl=Ir,B.Map=class extends Xr{constructor(y){var e,r;h.cv.mark(h.cw.create);const c=Object.assign(Object.assign(Object.assign({},Vo),y),{canvasContextAttributes:Object.assign(Object.assign({},Vo.canvasContextAttributes),y.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new an,_=new ks;if(c.minZoom!==void 0&&f.setMinZoom(c.minZoom),c.maxZoom!==void 0&&f.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&f.setMinPitch(c.minPitch),c.maxPitch!==void 0&&f.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&f.setRenderWorldCopies(c.renderWorldCopies),super(f,_,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new mn,this._controls=[],this._mapId=h.a6(),this._contextLost=P=>{P.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new h.l("webglcontextlost",{originalEvent:P}))},this._contextRestored=P=>{this._setupPainter(),this.resize(),this._update(),this.fire(new h.l("webglcontextrestored",{originalEvent:P}))},this._onMapScroll=P=>{if(P.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},oh),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ct.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ke(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let P=!1;const L=No(V=>{this._trackResize&&!this._removed&&(this.resize(V),this.redraw())},50);this._resizeObserver=new ResizeObserver(V=>{P?L(V):P=!0}),this._resizeObserver.observe(this._container)}this.handlers=new mo(this,c),this._hash=c.hash&&new ns(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,h.e({},c.fitBoundsOptions,{duration:0}))));const M=typeof c.style=="string"||((r=(e=c.style)===null||e===void 0?void 0:e.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,M),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new $i(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new Ir,c.logoPosition),this.on("style.load",()=>{if(M||this._resizeTransform(),this.transform.unmodified){const P=h.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(P)}}),this.on("data",P=>{this._update(P.dataType==="style"),this.fire(new h.l(`${P.dataType}data`,P))}),this.on("dataloading",P=>{this.fire(new h.l(`${P.dataType}dataloading`,P))}),this.on("dataabort",P=>{this.fire(new h.l("sourcedataabort",P))})}_getMapId(){return this._mapId}setGlobalStateProperty(y,e){return this.style.setGlobalStateProperty(y,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(y,e){if(e===void 0&&(e=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new h.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=y.onAdd(this);this._controls.push(y);const c=this._controlPositions[e];return e.indexOf("bottom")!==-1?c.insertBefore(r,c.firstChild):c.appendChild(r),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new h.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(y);return e>-1&&this._controls.splice(e,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,e,r,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,e,r,c)}resize(y,e=!0){const[r,c]=this._containerDimensions(),f=this._getClampedPixelRatio(r,c);if(this._resizeCanvas(r,c,f),this.painter.resize(r,c,f),this.painter.overLimit()){const M=this.painter.context.gl;this._maxCanvasSize=[M.drawingBufferWidth,M.drawingBufferHeight];const P=this._getClampedPixelRatio(r,c);this._resizeCanvas(r,c,P),this.painter.resize(r,c,P)}this._resizeTransform(e);const _=!this._moving;return _&&(this.stop(),this.fire(new h.l("movestart",y)).fire(new h.l("move",y))),this.fire(new h.l("resize",y)),_&&this.fire(new h.l("moveend",y)),this}_resizeTransform(y=!0){var e;const[r,c]=this._containerDimensions();this.transform.resize(r,c,y),(e=this._requestedCameraState)===null||e===void 0||e.resize(r,c,y)}_getClampedPixelRatio(y,e){const{0:r,1:c}=this._maxCanvasSize,f=this.getPixelRatio(),_=y*f,M=e*f;return Math.min(_>r?r/_:1,M>c?c/M:1)*f}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(li.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.setMinZoom(y),this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.setMaxZoom(y),this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.setMinPitch(y),this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(y>=this.transform.minPitch)return this.transform.setMaxPitch(y),this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.setRenderWorldCopies(y),this._update()}project(y){return this.transform.locationToScreenPoint(h.S.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.screenPointToLocation(h.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,e,r){if(y==="mouseenter"||y==="mouseover"){let c=!1;return{layers:e,listener:r,delegates:{mousemove:_=>{const M=e.filter(L=>this.getLayer(L)),P=M.length!==0?this.queryRenderedFeatures(_.point,{layers:M}):[];P.length?c||(c=!0,r.call(this,new Wa(y,this,_.originalEvent,{features:P}))):c=!1},mouseout:()=>{c=!1}}}}if(y==="mouseleave"||y==="mouseout"){let c=!1;return{layers:e,listener:r,delegates:{mousemove:M=>{const P=e.filter(L=>this.getLayer(L));(P.length!==0?this.queryRenderedFeatures(M.point,{layers:P}):[]).length?c=!0:c&&(c=!1,r.call(this,new Wa(y,this,M.originalEvent)))},mouseout:M=>{c&&(c=!1,r.call(this,new Wa(y,this,M.originalEvent)))}}}}{const c=f=>{const _=e.filter(P=>this.getLayer(P)),M=_.length!==0?this.queryRenderedFeatures(f.point,{layers:_}):[];M.length&&(f.features=M,r.call(this,f),delete f.features)};return{layers:e,listener:r,delegates:{[y]:c}}}}_saveDelegatedListener(y,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(e)}_removeDelegatedListener(y,e,r){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const c=this._delegatedListeners[y];for(let f=0;f<c.length;f++){const _=c[f];if(_.listener===r&&_.layers.length===e.length&&_.layers.every(M=>e.includes(M))){for(const M in _.delegates)this.off(M,_.delegates[M]);return void c.splice(f,1)}}}on(y,e,r){if(r===void 0)return super.on(y,e);const c=typeof e=="string"?[e]:e,f=this._createDelegatedListener(y,c,r);this._saveDelegatedListener(y,f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return{unsubscribe:()=>{this._removeDelegatedListener(y,c,r)}}}once(y,e,r){if(r===void 0)return super.once(y,e);const c=typeof e=="string"?[e]:e,f=this._createDelegatedListener(y,c,r);for(const _ in f.delegates){const M=f.delegates[_];f.delegates[_]=(...P)=>{this._removeDelegatedListener(y,c,r),M(...P)}}this._saveDelegatedListener(y,f);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(y,e,r){return r===void 0?super.off(y,e):(this._removeDelegatedListener(y,typeof e=="string"?[e]:e,r),this)}queryRenderedFeatures(y,e){if(!this.style)return[];let r;const c=y instanceof h.P||Array.isArray(y),f=c?y:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(c?{}:y)||{},f instanceof h.P||typeof f[0]=="number")r=[h.P.convert(f)];else{const _=h.P.convert(f[0]),M=h.P.convert(f[1]);r=[_,new h.P(M.x,_.y),M,new h.P(_.x,M.y),_]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(y,e){return this.style.querySourceFeatures(y,e)}setStyle(y,e){return(e=h.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(y,e))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const e=this._locale[y];if(e==null)throw new Error(`Missing UI string '${y}'`);return e}_updateStyle(y,e){var r,c;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,e));const f=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Eh(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,e,f):this.style.loadJSON(y,e,f),this):((c=(r=this.style)===null||r===void 0?void 0:r.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Eh(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,e){if(typeof y=="string"){const r=this._requestManager.transformRequest(y,"Style");h.j(r,new AbortController).then(c=>{this._updateDiff(c.data,e)}).catch(c=>{c&&this.fire(new h.k(c))})}else typeof y=="object"&&this._updateDiff(y,e)}_updateDiff(y,e){try{this.style.setState(y,e)&&this._update(!0)}catch(r){h.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(y,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.w("There is no style added to the map.")}addSource(y,e){return this._lazyInitEmptyStyle(),this.style.addSource(y,e),this._update(!0)}isSourceLoaded(y){const e=this.style&&this.style.sourceCaches[y];if(e!==void 0)return e.loaded();this.fire(new h.k(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const e=this.style.sourceCaches[y.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&e.reload();for(const r in this.style._layers){const c=this.style._layers[r];c.type==="hillshade"&&c.source===y.source&&h.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),c.type==="color-relief"&&c.source===y.source&&h.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Yr(this.painter,e,y),this.painter.renderToTexture=new Ti(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{var c;r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==y.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((c=r.source)===null||c===void 0?void 0:c.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new h.l("terrain",{terrain:y})),this}getTerrain(){var y,e;return(e=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const e in y){const r=y[e]._tiles;for(const c in r){const f=r[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}setSourceTileLodParams(y,e,r){if(r){const c=this.getSource(r);if(!c)throw new Error(`There is no source with ID "${r}", cannot set LOD parameters`);c.calculateTileZoom=yt(Math.max(1,y),Math.max(1,e))}else for(const c in this.style.sourceCaches)this.style.sourceCaches[c].getSource().calculateTileZoom=yt(Math.max(1,y),Math.max(1,e));return this._update(!0),this}refreshTiles(y,e){const r=this.style.sourceCaches[y];if(!r)throw new Error(`There is no source cache with ID "${y}", cannot refresh tile`);e===void 0?r.reload(!0):r.refreshTiles(e.map(c=>new h.a3(c.z,c.x,c.y)))}addImage(y,e,r={}){const{pixelRatio:c=1,sdf:f=!1,stretchX:_,stretchY:M,content:P,textFitWidth:L,textFitHeight:V}=r;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||h.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new h.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:q,height:K,data:W}=e,te=e;return this.style.addImage(y,{data:new h.R({width:q,height:K},new Uint8Array(W)),pixelRatio:c,stretchX:_,stretchY:M,content:P,textFitWidth:L,textFitHeight:V,sdf:f,version:0,userImage:te}),te.onAdd&&te.onAdd(this,y),this}}{const{width:q,height:K,data:W}=Ee.getImageData(e);this.style.addImage(y,{data:new h.R({width:q,height:K},W),pixelRatio:c,stretchX:_,stretchY:M,content:P,textFitWidth:L,textFitHeight:V,sdf:f,version:0})}}updateImage(y,e){const r=this.style.getImage(y);if(!r)return this.fire(new h.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=e instanceof HTMLImageElement||h.b(e)?Ee.getImageData(e):e,{width:f,height:_,data:M}=c;if(f===void 0||_===void 0)return this.fire(new h.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==r.data.width||_!==r.data.height)return this.fire(new h.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const P=!(e instanceof HTMLImageElement||h.b(e));return r.data.replace(M,P),this.style.updateImage(y,r),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new h.k(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return ct.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,e){return this._lazyInitEmptyStyle(),this.style.addLayer(y,e),this._update(!0)}moveLayer(y,e){return this.style.moveLayer(y,e),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,e,r){return this.style.setLayerZoomRange(y,e,r),this._update(!0)}setFilter(y,e,r={}){return this.style.setFilter(y,e,r),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,e,r,c={}){return this.style.setPaintProperty(y,e,r,c),this._update(!0)}getPaintProperty(y,e){return this.style.getPaintProperty(y,e)}setLayoutProperty(y,e,r,c={}){return this.style.setLayoutProperty(y,e,r,c),this._update(!0)}getLayoutProperty(y,e){return this.style.getLayoutProperty(y,e)}setGlyphs(y,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,e,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,e,r,c=>{c||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,e,r=>{r||this._update(!0)}),this}setLight(y,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(y,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(y,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,e){return this.style.setFeatureState(y,e),this._update()}removeFeatureState(y,e){return this.style.removeFeatureState(y,e),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,e=0;return this._container&&(y=this._container.clientWidth||400,e=this._container.clientHeight||300),[y,e]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const e=this._canvasContainer=pe.create("div","maplibregl-canvas-container",y);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=pe.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),c=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],c);const f=this._controlContainer=pe.create("div","maplibregl-control-container",y),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{_[M]=pe.create("div",`maplibregl-ctrl-${M} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,e,r){this._canvas.width=Math.floor(r*y),this._canvas.height=Math.floor(r*e),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const y=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{e={requestedAttributes:y},c&&(e.statusMessage=c.statusMessage,e.type=c.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,y):this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y),!r){const c="Failed to initialize WebGL";throw e?(e.message=c,new Error(JSON.stringify(e))):new Error(c)}this.painter=new rs(r,this.transform),Se.testSupport(r)}migrateProjection(y,e){super.migrateProjection(y,e),this.painter.transform=y,this.fire(new h.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){var e,r,c,f,_;const M=this._idleTriggered?this._fadeDuration:0,P=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let L=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const K=this.transform.zoom,W=Ee.now();this.style.zoomHistory.update(K,W);const te=new h.F(K,{now:W,fadeDuration:M,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),he=te.crossFadingFactor();he===1&&he===this._crossFadingFactor||(L=!0,this._crossFadingFactor=he),this.style.update(te)}const V=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==P;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(_=this.style.projection)===null||_===void 0?void 0:_.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||V)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,M,this._crossSourceCollisions,V),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:M,showPadding:this.showPadding}),this.fire(new h.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.cv.mark(h.cw.load),this.fire(new h.l("load"))),this.style&&(this.style.hasTransitions()||L)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const q=this._sourcesDirty||this._styleDirty||this._placementDirty;return q||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.l("idle")),!this._loaded||this._fullyLoaded||q||(this._fullyLoaded=!0,h.cv.mark(h.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ct.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),pe.remove(this._canvasContainer),pe.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),h.cv.clearMetrics(),this._removed=!0,this.fire(new h.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Ee.frame(this._frameRequest,y=>{h.cv.frame(y),this._frameRequest=null;try{this._render(y)}catch(e){if(!h.cx(e)&&!function(r){return r.message===Pd}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Or}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(y){return this._lazyInitEmptyStyle(),this.style.setProjection(y),this._update(!0)}},B.MapMouseEvent=Wa,B.MapTouchEvent=ao,B.MapWheelEvent=uu,B.Marker=er,B.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const e=this._map.getZoom(),r=e===this._map.getMaxZoom(),c=e===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,r)=>{const c=this._map._getUIString(`NavigationControl.${r}`);e.title=c,e.setAttribute("aria-label",c)},this.options=h.e({},Fn,y),this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),pe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),pe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=pe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Dd(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){pe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,e){const r=pe.create("button",y,this._container);return r.type="button",r.addEventListener("click",e),r}},B.Popup=class extends h.E{constructor(y){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&pe.remove(this._content),this._container&&(pe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=pe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=pe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const M of this.options.className.split(" "))this._container.classList.add(M);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=go(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const r=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let c=this.options.anchor;const f=gu(this.options.offset);if(!c){const M=this._container.offsetWidth,P=this._container.offsetHeight;let L;L=r.y+f.bottom.y<P?["top"]:r.y>this._map.transform.height-P?["bottom"]:[],r.x<M/2?L.push("left"):r.x>this._map.transform.width-M/2&&L.push("right"),c=L.length===0?"bottom":L.join("-")}let _=r.add(f[c]);this.options.subpixelPositioning||(_=_.round()),pe.setTransform(this._container,`${vl[c]} translate(${_.x}px,${_.y}px)`),Wr(this._container,c,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=h.e(Object.create(Da),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=h.S.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const e=document.createDocumentFragment(),r=document.createElement("body");let c;for(r.innerHTML=y;c=r.firstChild,c;)e.appendChild(c);return this.setDOMContent(e)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=pe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=pe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(mu);y&&y.focus()}},B.RasterDEMTileSource=qr,B.RasterTileSource=dc,B.ScaleControl=class{constructor(y){this._onMove=()=>{_o(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,_o(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},bl),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){pe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},B.ScrollZoomHandler=xl,B.Style=Eh,B.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=pe.create("button","maplibregl-ctrl-terrain",this._container),pe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){pe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},B.TwoFingersTouchPitchHandler=rh,B.TwoFingersTouchRotateHandler=Fh,B.TwoFingersTouchZoomHandler=lo,B.TwoFingersTouchZoomRotateHandler=ho,B.VectorTileSource=Va,B.VideoSource=Ao,B.addSourceType=(y,e)=>h._(void 0,void 0,void 0,function*(){if(zl(y))throw new Error(`A source type called "${y}" already exists.`);((r,c)=>{Ru[r]=c})(y,e)}),B.clearPrewarmedResources=function(){const y=ii;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(qe),ii=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},B.createTileMesh=Nu,B.getMaxParallelImageRequests=function(){return h.a.MAX_PARALLEL_IMAGE_REQUESTS},B.getRTLTextPluginStatus=function(){return en().getRTLTextPluginStatus()},B.getVersion=function(){return yu},B.getWorkerCount=function(){return Ot.workerCount},B.getWorkerUrl=function(){return h.a.WORKER_URL},B.importScriptInWorkers=function(y){return _n().broadcast("IS",y)},B.prewarm=function(){Qi().acquire(qe)},B.setMaxParallelImageRequests=function(y){h.a.MAX_PARALLEL_IMAGE_REQUESTS=y},B.setRTLTextPlugin=function(y,e){return en().setRTLTextPlugin(y,e)},B.setWorkerCount=function(y){Ot.workerCount=y},B.setWorkerUrl=function(y){h.a.WORKER_URL=y}});var ce=Z;return ce})}($m)),$m.exports}var Yv=Xv();const ky=Ng(Yv),Wv="_wrapperLL_14fcw_1",Kg={wrapperLL:Wv},Kv=(S,F,Z)=>{S<F&&(S=F),S>Z&&(S=Z);const $=(S-F)/(Z-F),J=Math.round(255*$),ce=0,B=Math.round(255*(1-$));return`rgba(${J}, ${ce}, ${B}, 0.4)`},E_=S=>S<75?"#B5D839":S>=75&&S<=85?"#F3C868":"#FF6F59",eg=(S,F)=>typeof S!="object"||S===null?S:Array.isArray(S)?S.map(Z=>eg(Z,F)):Object.fromEntries(Object.entries(S).map(([Z,$])=>{const J=Z.replace(F,""),ce=eg($,F);return[J,ce]})),Qv="_wrapperNL_f7v1l_1",Jv="_title_f7v1l_25",eb="_close_f7v1l_45",tb="_rowcontainer_f7v1l_49",ib="_rowbodycontainer_f7v1l_51",rb="_gray_f7v1l_53",nb="_active_f7v1l_55",ab="_alignright_f7v1l_61",Nr={wrapperNL:Qv,title:Jv,close:eb,rowcontainer:tb,rowbodycontainer:ib,gray:rb,active:nb,alignright:ab},Jp=({bus:S,line:F,link:Z,type:$,side:J,displaybox:ce})=>{const B=na(),h=vi(_t=>_t.action.selectedAction),oe=vi(_t=>_t.action.selectedActionTemp),ge=vi(_t=>_t.defence.actionNumber),Te=vi(_t=>_t.attack.selectedAttackActions),Ve=vi(_t=>_t.defence.step),[Ee,pe]=be.useState(!1),[Se,Ne]=be.useState(!1),[rt,Ie]=be.useState(null),[Oe,We]=be.useState(!1),[ct,Ke]=be.useState(null),pt="/";be.useEffect(()=>{Ve==3&&pe(!1)},[Ve]),be.useEffect(()=>{pe(!!ce)},[ce]),be.useEffect(()=>{Te&&Te.length==1&&pe(!1)},[Te]),be.useEffect(()=>{if(S){pe(!0),Ke("");const _t=`${pt}single_bus_gen_easy`;fetch(_t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({bus_name:S}).toString()}).then(Dt=>Dt.json()).then(Dt=>{Dt=JSON.parse(Dt.data),Ne(Dt),Ie("gen")})}},[S]),be.useEffect(()=>{if(F){pe(!0),Ke("");const _t=`${pt}get_single_line`;fetch(_t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({line_name:F}).toString()}).then(Dt=>Dt.json()).then(Dt=>{Dt=JSON.parse(Dt.data),console.log(Dt),Ne(Dt),Ie("line")})}},[F]),be.useEffect(()=>{if(Z){pe(!0),Ke("");const _t=`${pt}get_single_link`;fetch(_t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({link_name:Z}).toString()}).then(Dt=>Dt.json()).then(Dt=>{Dt=JSON.parse(Dt.data),Ne(Dt),Ie("link")})}},[Z]);const Pt=_t=>{_t.preventDefault(),pe(!1)},Ue=(_t,Dt)=>{Ke(_t),zt(_t,"gen",Dt)},zt=(_t,Dt,ri)=>{if(J=="defence"){let Yt={};Dt=="gen"&&(Yt={actionId:h,type:Dt,name:S,carrier:_t,value:ri,credit:0,actionNumber:ge,defenceStep:Ve}),Dt=="line"&&(We(!0),Yt={actionId:h,type:Dt,name:_t,value:ri,carrier:"",credit:0,actionNumber:ge,defenceStep:Ve}),Dt=="link"&&(We(!0),Yt={actionId:h,type:Dt,name:_t,carrier:"",value:ri,credit:0,actionNumber:ge,defenceStep:Ve}),B(Am(Yt))}if(J=="attack"){if(rt=="gen"){const Yt=S+" ",yi=_t.replace(Yt,"");B(Eg({type:"attack",type2:"gen",node:S,carrier:yi})),We(gt=>!gt)}rt=="line"&&(We(!0),B(Eg({type:"attack",type2:"line",node:F,carrier:""}))),rt=="link"&&(We(!0),B(Eg({type:"attack",type2:"link",node:Z,carrier:""})))}};return be.useEffect(()=>{J=="defence"&&oe==null&&h>0&&pe(!1)},[oe,h]),H.jsx("div",{children:Ee&&H.jsxs("div",{className:Nr.wrapperNL,children:[rt=="gen"&&H.jsxs("div",{children:[H.jsxs("h3",{className:Nr.title,children:["Node ",S," composition"]}),H.jsx("a",{href:"#",className:Nr.close,onClick:Pt,children:H.jsx("img",{src:"images/close.png",alt:"Close"})}),H.jsxs("div",{className:Nr.rowcontainer,children:[H.jsx("div",{children:"Carrier"}),H.jsx("div",{children:"Available Capacity (MW)"})]}),H.jsx("div",{children:Object.entries(Se.p_nom).filter(([_t])=>_t&&!_t.includes("dsr")&&!_t.includes("lost-load")).map(([_t,Dt])=>{const ri=Dt*Se.p_max_pu[_t];return{key:_t,power:ri}}).filter(_t=>_t.power>0).sort((_t,Dt)=>Dt.power-_t.power).map(({key:_t,power:Dt})=>{const ri=_t===ct,Yt=Math.round(Dt)<=200;return H.jsxs("div",{onClick:Yt?void 0:()=>Ue(_t,Dt),className:`${Nr.rowbodycontainer} ${ri?Nr.active:Yt?Nr.gray:""}`,children:[H.jsx("div",{children:_t}),H.jsx("div",{className:Nr.alignright,children:Math.round(Dt)})]},_t)})})]}),rt=="line"&&H.jsxs("div",{children:[H.jsx("h3",{className:Nr.title,children:"Transmission line"}),H.jsx("a",{href:"#",className:Nr.close,onClick:Pt,children:H.jsx("img",{src:"images/close.png",alt:"Close"})}),H.jsxs("div",{className:Nr.rowcontainer,children:[H.jsx("div",{children:"Line ID"}),H.jsx("div",{children:"Capacity (MW)"})]}),Object.entries(Se).map(([_t,Dt])=>_t!==""&&Dt>0&&_t=="capacity"?H.jsxs("div",{onClick:()=>zt(F,"line",Math.round(Dt)),className:`${Nr.rowbodycontainer} ${Oe?Nr.active:""}`,children:[H.jsx("div",{children:F}),H.jsx("div",{className:Nr.alignright,children:Math.round(Dt)})]},_t):null)]}),rt=="link"&&H.jsxs("div",{children:[H.jsx("h3",{className:Nr.title,children:"Link"}),H.jsx("a",{href:"#",className:Nr.close,onClick:Pt,children:H.jsx("img",{src:"images/close.png",alt:"Close"})}),H.jsxs("div",{className:Nr.rowcontainer,children:[H.jsx("div",{children:"Link ID"}),H.jsx("div",{children:"Capacity (MW)"})]}),Object.entries(Se).map(([_t,Dt])=>_t=="capacity"&&Dt>0?H.jsxs("div",{onClick:()=>zt(Z,"link",Math.round(Dt)),className:`${Nr.rowbodycontainer} ${Oe?Nr.active:""}`,children:[H.jsx("div",{children:Z}),H.jsx("div",{className:Nr.alignright,children:Math.round(Dt)})]},_t):null)]})]})})},Py=({view:S,type:F,side:Z,displaybox:$})=>{const[J,ce]=be.useState(null),[B,h]=be.useState($),oe=vi(Se=>Se.ts.selectedTs),ge=vi(Se=>Se.ts.selectedTsValue),Te=be.useRef([]),Ve=be.useRef([]),Ee=be.useRef(!1),pe=be.useRef(!0);return be.useEffect(()=>{if(!S)return;Ee.current=!0,S.hasImage("arrow")||S.loadImage("/images/arrow.png",(Ie,Oe)=>{if(Ie||!Oe){console.error("Failed to load arrow image:",Ie);return}S.hasImage("arrow")||S.addImage("arrow",Oe)});const Se=new AbortController;return fetch("/lines_in_country",{signal:Se.signal}).then(Ie=>Ie.json()).then(Ie=>{const Oe=JSON.parse(Ie.data[0]),We=["EE","LV","LT"];Oe.forEach((ct,Ke)=>{const pt=ct.bus0.substr(0,2),Pt=ct.bus1.substr(0,2);if(!(We.includes(pt)||We.includes(Pt)||pt!==Pt))return;const zt=ct.bus0_coordinates,_t=ct.bus1_coordinates,Dt=oe===""?ct.line_flows:ct.line_flows_t[oe];oe===""?Math.abs(ct.average_utilization)*100:Math.round(Math.abs(Dt)*100/ct.capacity);const ri=Dt>0?[zt.x,zt.y]:[_t.x,_t.y],Yt=Dt>0?[_t.x,_t.y]:[zt.x,zt.y],yi=E_(ct.saturation_percent),wi=Math.max(1,Math.round(ct.capacity/1e3)),gt=`line-${Ke}`,It=`arrow-layer-${Ke}`,ti=`line-source-${Ke}`,ki={type:"Feature",properties:{name:ct.line_name},geometry:{type:"LineString",coordinates:[ri,Yt]}};S.getSource(ti)||(S.addSource(ti,{type:"geojson",data:ki}),S.addLayer({id:gt,type:"line",source:ti,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":yi,"line-width":wi*4}}),S.addLayer({id:It,type:"symbol",source:ti,layout:{"symbol-placement":"line","symbol-spacing":100,"icon-image":"arrow","icon-size":.5,"icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!0}}),Te.current.push(ti),Ve.current.push(gt,It),S.on("click",gt,qe=>{var di;const Ot=(di=qe.features)==null?void 0:di[0],Ht=S.queryRenderedFeatures(qe.point);if(!Ht.length)return;Ht[0].layer.id.startsWith("circle-layer")||(ce(Ot.properties.name),h(!0))}),S.on("mouseenter",gt,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",gt,()=>{S.getCanvas().style.cursor=""}))})}).catch(Ie=>{Ie.name!=="AbortError"&&console.error("Error fetching lines:",Ie)}),pe.current=!0,()=>{pe.current=!1,Ve.current.forEach(Ie=>{S&&S.getLayer(Ie)&&S.removeLayer(Ie)}),Te.current.forEach(Ie=>{S&&S.getSource(Ie)&&S.removeSource(Ie)}),Ve.current=[],Te.current=[]}},[S]),H.jsxs("div",{children:[H.jsx(Jp,{bus:"",line:J,link:"",type:F,side:Z,displaybox:B}),oe!==""&&H.jsx("div",{className:Kg.wrapperLL,children:H.jsx("p",{children:ge})})]})},sb=({view:S,type:F,side:Z,displaybox:$})=>{const[J,ce]=be.useState(null),[B,h]=be.useState($),oe=vi(Ne=>Ne.ts.selectedTs),ge=vi(Ne=>Ne.ts.selectedTsValue),Te=be.useRef([]),Ve=be.useRef([]),Ee=be.useRef(!0),Se="/lines_in_country";return be.useEffect(()=>{if(!S)return;S.hasImage("arrow")||S.loadImage("/images/arrow.png",(rt,Ie)=>{if(rt||!Ie){console.error("Failed to load arrow image:",rt);return}S.hasImage("arrow")||S.addImage("arrow",Ie)});const Ne=new AbortController;return fetch(Se,{signal:Ne.signal}).then(rt=>rt.json()).then(rt=>{const Ie=JSON.parse(rt.data[0]),Oe=["EE","LV","LT"],We=["181","297","295","299","301","303","180"];Ie.forEach((ct,Ke)=>{const pt=ct.bus0.substr(0,2),Pt=ct.bus1.substr(0,2);if(!(Oe.includes(pt)||Oe.includes(Pt)||pt!==Pt))return;const zt=ct.bus0_coordinates,_t=ct.bus1_coordinates,Dt=oe===""?ct.line_flows:ct.line_flows_t[oe];oe===""?Math.abs(ct.average_utilization)*100:Math.round(Math.abs(Dt)*100/ct.capacity);const ri=Dt>0?[zt.x,zt.y]:[_t.x,_t.y],Yt=Dt>0?[_t.x,_t.y]:[zt.x,zt.y],yi=Math.max(1,Math.round(ct.capacity/1e3));let wi="#958382";We.includes(ct.line_name)?wi="#0bb6e0":wi="#958382";const gt=`line-${Ke}`,It=`arrow-layer-${Ke}`,ti=`line-source-${Ke}`,ki={type:"Feature",properties:{name:ct.line_name},geometry:{type:"LineString",coordinates:[ri,Yt]}};S.getSource(ti)||(S.addSource(ti,{type:"geojson",data:ki}),S.addLayer({id:gt,type:"line",source:ti,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":wi,"line-width":yi*4}}),S.addLayer({id:It,type:"symbol",source:ti,layout:{"symbol-placement":"line","symbol-spacing":100,"icon-image":"arrow","icon-size":.5,"icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!0}}),wi=="#0bb6e0"&&(S.on("click",gt,qe=>{var di;const Ot=(di=qe.features)==null?void 0:di[0],Ht=S.queryRenderedFeatures(qe.point);if(!Ht.length)return;Ht[0].layer.id.startsWith("circle-layer")||(ce(Ot.properties.name),h(!0))}),S.on("mouseenter",gt,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",gt,()=>{S.getCanvas().style.cursor=""}))),Te.current.push(ti),Ve.current.push(gt,It)})}).catch(rt=>{rt.name!=="AbortError"&&console.error("Error fetching lines:",rt)}),Ee.current=!0,()=>{Ee.current=!1,Ve.current.forEach(rt=>{S&&S.getLayer(rt)&&S.removeLayer(rt)}),Te.current.forEach(rt=>{S&&S.getSource(rt)&&S.removeSource(rt)}),Ve.current=[],Te.current=[]}},[S,oe]),H.jsxs("div",{children:[H.jsx(Jp,{bus:"",line:J,link:"",type:F,side:Z,displaybox:B}),oe!==""&&H.jsx("div",{className:Kg.wrapperLL,children:H.jsx("p",{children:ge})})]})},zy=({view:S,type:F,side:Z,displaybox:$})=>{const[J,ce]=be.useState(null),[B,h]=be.useState($),ge="/lines_in_country",Te=vi(Ne=>Ne.ts.selectedTs),Ve=vi(Ne=>Ne.ts.selectedTsValue),Ee=be.useRef([]),pe=be.useRef([]),Se=be.useRef([]);return be.useEffect(()=>{if(!S)return;const Ne=new AbortController,rt=()=>{S.hasImage("arrow")||S.loadImage("/images/arrow.png",(Oe,We)=>{if(Oe||!We){console.error("Failed to load arrow image:",Oe);return}S.hasImage("arrow")||S.addImage("arrow",We)})};return(async()=>{try{rt();const We=await(await fetch(ge,{signal:Ne.signal})).json(),ct=JSON.parse(We.data[0]),Ke=["EE","LV","LT"];ct.forEach((pt,Pt)=>{const Ue=pt.bus0.substr(0,2),zt=pt.bus1.substr(0,2);if(!(Ke.includes(Ue)||Ke.includes(zt)||Ue!==zt))return;const{bus0_coordinates:Dt,bus1_coordinates:ri}=pt,Yt=Te===""?pt.line_flows:pt.line_flows_t[Te],yi=Te===""?Math.abs(pt.average_utilization)*100:Math.round(Math.abs(Yt)*100/pt.capacity),wi=Yt>0?[Dt.x,Dt.y]:[ri.x,ri.y],gt=Yt>0?[ri.x,ri.y]:[Dt.x,Dt.y],It="#0bb6e0",ti=Math.max(1,Math.round(pt.capacity/1e3)),ki=`line-${Pt}`,qe=`arrow-layer-${Pt}`,Ot=`line-source-${Pt}`,Ht={type:"Feature",properties:{name:pt.line_name},geometry:{type:"LineString",coordinates:[wi,gt]}};if(!S.getSource(Ot)){S.addSource(Ot,{type:"geojson",data:Ht}),S.addLayer({id:ki,type:"line",source:Ot,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":It,"line-width":ti*3}}),S.addLayer({id:qe,type:"symbol",source:Ot,layout:{"symbol-placement":"line","symbol-spacing":100,"icon-image":"arrow","icon-size":.5,"icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!0}});const ii=di=>{var Ri,_n;const Qi=(Ri=di.features)==null?void 0:Ri[0];Qi&&((_n=Qi.properties)!=null&&_n.name)&&(ce(Qi.properties.name),h(!0))};S.on("click",ki,ii),Se.current.push({type:"click",layerId:ki,handler:ii}),S.on("mouseenter",ki,()=>{S.getCanvas().style.cursor="pointer"}),Se.current.push({type:"mouseenter",layerId:ki,handler:()=>{S.getCanvas().style.cursor="pointer"}}),S.on("mouseleave",ki,()=>{S.getCanvas().style.cursor=""}),Se.current.push({type:"mouseleave",layerId:ki,handler:()=>{S.getCanvas().style.cursor=""}}),Ee.current.push(Ot),pe.current.push(ki,qe)}})}catch(Oe){Oe.name!=="AbortError"&&console.error("Error fetching or adding lines:",Oe)}})(),()=>{Se.current.forEach(({type:Oe,layerId:We,handler:ct})=>{S&&S.off&&S.off(Oe,We,ct)}),Se.current=[],pe.current.forEach(Oe=>{S&&S.getLayer(Oe)&&S.removeLayer(Oe)}),pe.current=[],Ee.current.forEach(Oe=>{S&&S.getSource(Oe)&&S.removeSource(Oe)}),Ee.current=[]}},[S,Te]),H.jsxs("div",{children:[H.jsx(Jp,{bus:"",line:J,link:"",type:F,side:Z,displaybox:B}),Te!==""&&H.jsx("div",{className:Kg.wrapperLL,children:H.jsx("p",{children:Ve})})]})},Ly=({view:S,type:F,side:Z,displaybox:$})=>{const[J,ce]=be.useState(null),[B,h]=be.useState($);vi(Se=>Se.ts.selectedTs);const ge="/links",Te=be.useRef([]),Ve=be.useRef([]),Ee=be.useRef(!1),pe=be.useRef(!0);return be.useEffect(()=>{if(!S)return;Ee.current=!0;const Se=new AbortController;return fetch(ge,{signal:Se.signal}).then(Ne=>Ne.json()).then(Ne=>{const rt=JSON.parse(Ne.data[0]),Ie=JSON.parse(Ne.data[1]);let Oe=0;rt.forEach(We=>{We.bus0,We.bus1;const ct=We.Link;let Ke=Math.round(We.length),pt="#E27728",Pt=null,Ue=null,zt=0;const _t=Ie.find(yi=>yi.line_name===We.Link);if(_t&&We.Link!=="TYNDP2020_33"&&We.Link!=="relation/3392010+2"&&We.Link!=="relation/8184631+2"){const yi=_t.line_flows,wi=Math.abs(yi);zt=Math.round(wi*100/(720*We.p_nom)),pt=E_(zt),zt===0&&(pt="#CCCCCC"),`${We.carrier}${Ke}${Math.round(yi)}${We.Link}`,yi>0?(Pt=[parseFloat(We.x),parseFloat(We.y)],Ue=[parseFloat(We.x_bus1),parseFloat(We.y_bus1)]):(Pt=[parseFloat(We.x_bus1),parseFloat(We.y_bus1)],Ue=[parseFloat(We.x),parseFloat(We.y)])}if(!Pt||!Ue)return;const Dt=`link-line-${Oe}`,ri=`link-source-${Oe}`,Yt={type:"Feature",properties:{name:ct},geometry:{type:"LineString",coordinates:[Pt,Ue]}};S.getSource(ri)||(S.addSource(ri,{type:"geojson",data:Yt}),S.addLayer({id:Dt,type:"line",source:ri,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":pt,"line-width":4}}),S.on("click",Dt,yi=>{var ti;const wi=(ti=yi.features)==null?void 0:ti[0],gt=S.queryRenderedFeatures(yi.point);if(!gt.length)return;gt[0].layer.id.startsWith("circle-layer")||(ce(wi.properties.name),h(!0))}),S.on("mouseenter",Dt,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",Dt,()=>{S.getCanvas().style.cursor=""}),Te.current.push(ri),Ve.current.push(Dt)),Oe++})}).catch(Ne=>console.error("Error fetching link data:",Ne)),pe.current=!0,()=>{pe.current=!1,Ve.current.forEach(Ne=>{S&&S.getLayer(Ne)&&S.removeLayer(Ne)}),Te.current.forEach(Ne=>{S&&S.getSource(Ne)&&S.removeSource(Ne)}),Ve.current=[],Te.current=[]}},[S]),H.jsx("div",{children:H.jsx(Jp,{bus:"",line:"",link:J,type:F,side:Z,displaybox:B})})},ob=({view:S,type:F,side:Z,displaybox:$})=>{vi(Se=>Se.ts.selectedTs);const[J,ce]=be.useState($),[B,h]=be.useState(null),oe=be.useRef([]),ge=be.useRef([]),Te=be.useRef(!1),Ve=be.useRef(!0),pe="/links";return be.useEffect(()=>{if(!S||Te.current)return;Te.current=!0;const Se=["relation/6886400+2","relation/8185455+2"];return fetch(pe).then(Ne=>Ne.json()).then(Ne=>{const rt=JSON.parse(Ne.data[0]),Ie=JSON.parse(Ne.data[1]);let Oe=0;rt.forEach(We=>{We.bus0,We.bus1;const ct=We.Link;let Ke=Math.round(We.length),pt="",Pt=null,Ue=null;const zt=Ie.find(Yt=>Yt.line_name===We.Link);if(zt&&We.Link!=="TYNDP2020_33"&&We.Link!=="relation/3392010+2 info"&&We.Link!=="relation/8184631+2"){const Yt=zt.line_flows,yi=Math.abs(Yt);Math.round(yi*100/(720*We.p_nom)),`${We.carrier}${Ke}${Math.round(Yt)}${We.Link}`,Yt>0?(Pt=[parseFloat(We.x),parseFloat(We.y)],Ue=[parseFloat(We.x_bus1),parseFloat(We.y_bus1)]):(Pt=[parseFloat(We.x_bus1),parseFloat(We.y_bus1)],Ue=[parseFloat(We.x),parseFloat(We.y)])}if(!Pt||!Ue)return;const _t=`link-line-${Oe}`,Dt=`link-source-${Oe}`,ri={type:"Feature",properties:{name:ct},geometry:{type:"LineString",coordinates:[Pt,Ue]}};S.getSource(Dt)||(S.addSource(Dt,{type:"geojson",data:ri}),ct==Se[0]||ct==Se[1]?pt="#0bb6e0":pt="#958382",S.addLayer({id:_t,type:"line",source:Dt,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":pt,"line-width":4}}),(ct==Se[0]||ct==Se[1])&&(S.on("click",_t,Yt=>{var It;const yi=(It=Yt.features)==null?void 0:It[0],wi=S.queryRenderedFeatures(Yt.point);if(!wi.length)return;wi[0].layer.id.startsWith("circle-layer")||(h(yi.properties.name),ce(!0))}),S.on("mouseenter",_t,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",_t,()=>{S.getCanvas().style.cursor=""}))),oe.current.push(Dt),ge.current.push(_t),Oe++})}).catch(Ne=>console.error("Error fetching link data:",Ne)),Ve.current=!0,()=>{Ve.current=!1,ge.current.forEach(Ne=>{S&&S.getLayer(Ne)&&S.removeLayer(Ne)}),oe.current.forEach(Ne=>{S&&S.getSource(Ne)&&S.removeSource(Ne)}),ge.current=[],oe.current=[]}},[S]),H.jsx("div",{children:H.jsx(Jp,{bus:"",line:"",link:B,type:F,side:Z,displaybox:J})})},Dy=({view:S,type:F,side:Z,displaybox:$})=>{const J=vi(pe=>pe.ts.selectedTs),[ce,B]=be.useState($),[h,oe]=be.useState(null),ge=be.useRef([]),Te=be.useRef([]),Ee="/links";return be.useEffect(()=>{if(S)return fetch(Ee).then(pe=>pe.json()).then(pe=>{const Se=JSON.parse(pe.data[0]),Ne=JSON.parse(pe.data[1]);let rt=0;Se.forEach(Ie=>{Ie.bus0,Ie.bus1;const Oe=Ie.Link;let We=Math.round(Ie.length),ct="#FF00FF",Ke=null,pt=null,Pt=0;const Ue=Ne.find(ri=>ri.line_name===Ie.Link);if(Ue&&Ie.Link!=="TYNDP2020_33"&&Ie.Link!=="relation/3392010+2"&&Ie.Link!=="relation/8184631+2"&&Ie.Link!=="relation/3391954+2"){const ri=Ue.line_flows,Yt=Math.abs(ri);Pt=Math.round(Yt*100/(720*Ie.p_nom)),Pt===0&&(ct="#CCCCCC"),`${Ie.carrier}${We}${Math.round(ri)}${Ie.Link}`,ri>0?(Ke=[parseFloat(Ie.x),parseFloat(Ie.y)],pt=[parseFloat(Ie.x_bus1),parseFloat(Ie.y_bus1)]):(Ke=[parseFloat(Ie.x_bus1),parseFloat(Ie.y_bus1)],pt=[parseFloat(Ie.x),parseFloat(Ie.y)])}if(!Ke||!pt)return;const zt=`link-line-${rt}`,_t=`link-source-${rt}`,Dt={type:"Feature",properties:{name:Oe},geometry:{type:"LineString",coordinates:[Ke,pt]}};!S.getSource(_t)&&!ge.current.includes(_t)&&(S.addSource(_t,{type:"geojson",data:Dt}),S.addLayer({id:zt,type:"line",source:_t,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":ct,"line-width":4}}),S.on("click",zt,ri=>{var gt;const Yt=(gt=ri.features)==null?void 0:gt[0],yi=S.queryRenderedFeatures(ri.point);if(!yi.length)return;yi[0].layer.id.startsWith("circle-layer")||(oe(Yt.properties.name),B(!0))}),S.on("mouseenter",zt,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",zt,()=>{S.getCanvas().style.cursor=""}),ge.current.push(_t),Te.current.push(zt)),rt++})}).catch(pe=>console.error("Error fetching link data:",pe)),()=>{console.log(Te.current),Te.current.forEach(pe=>{S&&S.getLayer(pe)&&S.removeLayer(pe)}),ge.current.forEach(pe=>{S&&S.getSource(pe)&&S.removeSource(pe)}),Te.current=[],ge.current=[]}},[S,J]),H.jsx("div",{children:H.jsx(Jp,{bus:"",line:"",link:h,type:F,side:Z,displaybox:ce})})},lb="_legend_3h1zo_9",cb="_box_3h1zo_13",ub="_box1_3h1zo_1",hb="_box2_3h1zo_1",db="_box10_3h1zo_1",pb="_boxg_3h1zo_25",fb="_boxr_3h1zo_27",mb="_boxg2_3h1zo_29",gb="_boxr2_3h1zo_31",yb="_legendAttack_3h1zo_35",Yc={legend:lb,box:cb,box1:ub,box2:hb,box10:db,boxg:pb,boxr:fb,boxg2:mb,boxr2:gb,legendAttack:yb},_b="_wrapperNL_1pc7c_1",xb="_title_1pc7c_25",vb="_title2_1pc7c_45",bb="_textrow_1pc7c_53",wb="_title3_1pc7c_61",Sb="_title4_1pc7c_61",Tb="_title5_1pc7c_61",Mb="_close_1pc7c_75",Cb="_rowcontainer_1pc7c_79",Ab="_rowbodycontainer_1pc7c_81",Eb="_rowcontainer2_1pc7c_83",kb="_rowcontainer3_1pc7c_85",Pb="_rowcontainer4_1pc7c_87",zb="_alignright_1pc7c_95",Ys={wrapperNL:_b,title:xb,title2:vb,textrow:bb,title3:wb,title4:Sb,title5:Tb,close:Mb,rowcontainer:Cb,rowbodycontainer:Ab,rowcontainer2:Eb,rowcontainer3:kb,rowcontainer4:Pb,alignright:zb};var Hm={exports:{}},Lb=Hm.exports,Ry;function Db(){return Ry||(Ry=1,function(S,F){(function(Z,$){Z._Highcharts=$(),S.exports=Z._Highcharts})(typeof window>"u"?Lb:window,()=>(()=>{var ap;let Z,$;var J,ce,B,h,oe,ge,Te,Ve,Ee,pe,Se,Ne,rt,Ie,Oe,We,ct,Ke,pt={};pt.d=(R,s)=>{for(var u in s)pt.o(s,u)&&!pt.o(R,u)&&Object.defineProperty(R,u,{enumerable:!0,get:s[u]})},pt.o=(R,s)=>Object.prototype.hasOwnProperty.call(R,s);var Pt={};pt.d(Pt,{default:()=>Af}),function(R){var s,u,p,g,b,T,C;R.SVG_NS="http://www.w3.org/2000/svg",R.product="Highcharts",R.version="12.2.0",R.win=typeof window<"u"?window:{},R.doc=R.win.document,R.svg=!!((p=(u=(s=R.doc)==null?void 0:s.createElementNS)==null?void 0:u.call(s,R.SVG_NS,"svg"))!=null&&p.createSVGRect),R.pageLang=(T=(b=(g=R.doc)==null?void 0:g.documentElement)==null?void 0:b.closest("[lang]"))==null?void 0:T.lang,R.userAgent=((C=R.win.navigator)==null?void 0:C.userAgent)||"",R.isChrome=R.win.chrome,R.isFirefox=R.userAgent.indexOf("Firefox")!==-1,R.isMS=/(edge|msie|trident)/i.test(R.userAgent)&&!R.win.opera,R.isSafari=!R.isChrome&&R.userAgent.indexOf("Safari")!==-1,R.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(R.userAgent),R.isWebKit=R.userAgent.indexOf("AppleWebKit")!==-1,R.deg2rad=2*Math.PI/360,R.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],R.noop=function(){},R.supportsPassiveEvents=function(){let E=!1;if(!R.isMS){let D=Object.defineProperty({},"passive",{get:function(){E=!0}});R.win.addEventListener&&R.win.removeEventListener&&(R.win.addEventListener("testPassive",R.noop,D),R.win.removeEventListener("testPassive",R.noop,D))}return E}(),R.charts=[],R.composed=[],R.dateFormats={},R.seriesTypes={},R.symbolSizes={},R.chartCount=0}(J||(J={}));let Ue=J,{charts:zt,doc:_t,win:Dt}=Ue;function ri(R,s,u,p){let g=s?"Highcharts error":"Highcharts warning";R===32&&(R=`${g}: Deprecated member`);let b=ki(R),T=b?`${g} #${R}: www.highcharts.com/errors/${R}/`:R.toString();if(p!==void 0){let C="";b&&(T+="?"),Cr(p,function(E,D){C+=`
 - ${D}: ${E}`,b&&(T+=encodeURI(D)+"="+encodeURI(E))}),T+=C}aa(Ue,"displayError",{chart:u,code:R,message:T,params:p},function(){if(s)throw Error(T);Dt.console&&ri.messages.indexOf(T)===-1&&console.warn(T)}),ri.messages.push(T)}function Yt(R,s){return parseInt(R,s||10)}function yi(R){return typeof R=="string"}function wi(R){let s=Object.prototype.toString.call(R);return s==="[object Array]"||s==="[object Array Iterator]"}function gt(R,s){return!!R&&typeof R=="object"&&(!s||!wi(R))}function It(R){return gt(R)&&typeof R.nodeType=="number"}function ti(R){let s=R==null?void 0:R.constructor;return!!(gt(R,!0)&&!It(R)&&(s!=null&&s.name)&&s.name!=="Object")}function ki(R){return typeof R=="number"&&!isNaN(R)&&R<1/0&&R>-1/0}function qe(R){return R!=null}function Ot(R,s,u){let p,g=yi(s)&&!qe(u),b=(T,C)=>{qe(T)?R.setAttribute(C,T):g?(p=R.getAttribute(C))||C!=="class"||(p=R.getAttribute(C+"Name")):R.removeAttribute(C)};return yi(s)?b(u,s):Cr(s,b),p}function Ht(R){return wi(R)?R:[R]}function ii(R,s){let u;for(u in R||(R={}),s)R[u]=s[u];return R}function di(){let R=arguments,s=R.length;for(let u=0;u<s;u++){let p=R[u];if(p!=null)return p}}function Qi(R,s){ii(R.style,s)}function Ri(R){return Math.pow(10,Math.floor(Math.log(R)/Math.LN10))}function _n(R,s){return R>1e14?R:parseFloat(R.toPrecision(s||14))}(ri||(ri={})).messages=[],Math.easeInOutSine=function(R){return-.5*(Math.cos(Math.PI*R)-1)};let Zr=Array.prototype.find?function(R,s){return R.find(s)}:function(R,s){let u,p=R.length;for(u=0;u<p;u++)if(s(R[u],u))return R[u]};function Cr(R,s,u){for(let p in R)Object.hasOwnProperty.call(R,p)&&s.call(u||R[p],R[p],p,R)}function Pl(R,s,u){function p(T,C){let E=R.removeEventListener;E&&E.call(R,T,C,!1)}function g(T){let C,E;R.nodeName&&(s?(C={})[s]=!0:C=T,Cr(C,function(D,N){if(T[N])for(E=T[N].length;E--;)p(N,T[N][E].fn)}))}let b=typeof R=="function"&&R.prototype||R;if(Object.hasOwnProperty.call(b,"hcEvents")){let T=b.hcEvents;if(s){let C=T[s]||[];u?(T[s]=C.filter(function(E){return u!==E.fn}),p(s,u)):(g(T),T[s]=[])}else g(T),delete b.hcEvents}}function aa(R,s,u,p){if(u=u||{},(_t==null?void 0:_t.createEvent)&&(R.dispatchEvent||R.fireEvent&&R!==Ue)){let g=_t.createEvent("Events");g.initEvent(s,!0,!0),u=ii(g,u),R.dispatchEvent?R.dispatchEvent(u):R.fireEvent(s,u)}else if(R.hcEvents){u.target||ii(u,{preventDefault:function(){u.defaultPrevented=!0},target:R,type:s});let g=[],b=R,T=!1;for(;b.hcEvents;)Object.hasOwnProperty.call(b,"hcEvents")&&b.hcEvents[s]&&(g.length&&(T=!0),g.unshift.apply(g,b.hcEvents[s])),b=Object.getPrototypeOf(b);T&&g.sort((C,E)=>C.order-E.order),g.forEach(C=>{C.fn.call(R,u)===!1&&u.preventDefault()})}p&&!u.defaultPrevented&&p.call(R,u)}let hc=function(){let R=Math.random().toString(36).substring(2,9)+"-",s=0;return function(){return"highcharts-"+(Z?"":R)+s++}}();Dt.jQuery&&(Dt.jQuery.fn.highcharts=function(){let R=[].slice.call(arguments);if(this[0])return R[0]?(new Ue[yi(R[0])?R.shift():"Chart"](this[0],R[0],R[1]),this):zt[Ot(this[0],"data-highcharts-chart")]});let li={addEvent:function(R,s,u,p={}){let g=typeof R=="function"&&R.prototype||R;Object.hasOwnProperty.call(g,"hcEvents")||(g.hcEvents={});let b=g.hcEvents;Ue.Point&&R instanceof Ue.Point&&R.series&&R.series.chart&&(R.series.chart.runTrackerClick=!0);let T=R.addEventListener;T&&T.call(R,s,u,!!Ue.supportsPassiveEvents&&{passive:p.passive===void 0?s.indexOf("touch")!==-1:p.passive,capture:!1}),b[s]||(b[s]=[]);let C={fn:u,order:typeof p.order=="number"?p.order:1/0};return b[s].push(C),b[s].sort((E,D)=>E.order-D.order),function(){Pl(R,s,u)}},arrayMax:function(R){let s=R.length,u=R[0];for(;s--;)R[s]>u&&(u=R[s]);return u},arrayMin:function(R){let s=R.length,u=R[0];for(;s--;)R[s]<u&&(u=R[s]);return u},attr:Ot,clamp:function(R,s,u){return R>s?R<u?R:u:s},clearTimeout:function(R){qe(R)&&clearTimeout(R)},correctFloat:_n,createElement:function(R,s,u,p,g){let b=_t.createElement(R);return s&&ii(b,s),g&&Qi(b,{padding:"0",border:"none",margin:"0"}),u&&Qi(b,u),p&&p.appendChild(b),b},crisp:function(R,s=0,u){let p=s%2/2,g=u?-1:1;return(Math.round(R*g-p)+p)*g},css:Qi,defined:qe,destroyObjectProperties:function(R,s,u){Cr(R,function(p,g){p!==s&&(p!=null&&p.destroy)&&p.destroy(),(p!=null&&p.destroy||!u)&&delete R[g]})},diffObjects:function(R,s,u,p){let g={};return function b(T,C,E,D){let N=u?C:T;Cr(T,function(I,U){if(!D&&p&&p.indexOf(U)>-1&&C[U]){I=Ht(I),E[U]=[];for(let X=0;X<Math.max(I.length,C[U].length);X++)C[U][X]&&(I[X]===void 0?E[U][X]=C[U][X]:(E[U][X]={},b(I[X],C[U][X],E[U][X],D+1)))}else gt(I,!0)&&!I.nodeType?(E[U]=wi(I)?[]:{},b(I,C[U]||{},E[U],D+1),Object.keys(E[U]).length===0&&(U!=="colorAxis"||D!==0)&&delete E[U]):(T[U]!==C[U]||U in T&&!(U in C))&&U!=="__proto__"&&U!=="constructor"&&(E[U]=N[U])})}(R,s,g,0),g},discardElement:function(R){var s;(s=R==null?void 0:R.parentElement)==null||s.removeChild(R)},erase:function(R,s){let u=R.length;for(;u--;)if(R[u]===s){R.splice(u,1);break}},error:ri,extend:ii,extendClass:function(R,s){let u=function(){};return u.prototype=new R,ii(u.prototype,s),u},find:Zr,fireEvent:aa,getAlignFactor:(R="")=>({center:.5,right:1,middle:.5,bottom:1})[R]||0,getClosestDistance:function(R,s){let u,p,g,b=!s;return R.forEach(T=>{if(T.length>1)for(g=T.length-1;g>0;g--)(p=T[g]-T[g-1])<0&&!b?(s==null||s(),s=void 0):p&&(u===void 0||p<u)&&(u=p)}),u},getMagnitude:Ri,getNestedProperty:function(R,s){let u=R.split(".");for(;u.length&&qe(s);){let p=u.shift();if(p===void 0||p==="__proto__")return;if(p==="this"){let b;return gt(s)&&(b=s["@this"]),b??s}let g=s[p.replace(/[\\'"]/g,"")];if(!qe(g)||typeof g=="function"||typeof g.nodeType=="number"||g===Dt)return;s=g}return s},getStyle:function R(s,u,p){var T;let g;if(u==="width"){let C=Math.min(s.offsetWidth,s.scrollWidth),E=(T=s.getBoundingClientRect)==null?void 0:T.call(s).width;return E<C&&E>=C-1&&(C=Math.floor(E)),Math.max(0,C-(R(s,"padding-left",!0)||0)-(R(s,"padding-right",!0)||0))}if(u==="height")return Math.max(0,Math.min(s.offsetHeight,s.scrollHeight)-(R(s,"padding-top",!0)||0)-(R(s,"padding-bottom",!0)||0));let b=Dt.getComputedStyle(s,void 0);return b&&(g=b.getPropertyValue(u),di(p,u!=="opacity")&&(g=Yt(g))),g},insertItem:function(R,s){let u,p=R.options.index,g=s.length;for(u=R.options.isInternal?g:0;u<g+1;u++)if(!s[u]||ki(p)&&p<di(s[u].options.index,s[u]._i)||s[u].options.isInternal){s.splice(u,0,R);break}return u},isArray:wi,isClass:ti,isDOMElement:It,isFunction:function(R){return typeof R=="function"},isNumber:ki,isObject:gt,isString:yi,merge:function(R,...s){let u,p=[R,...s],g={},b=function(C,E){return typeof C!="object"&&(C={}),Cr(E,function(D,N){N!=="__proto__"&&N!=="constructor"&&(!gt(D,!0)||ti(D)||It(D)?C[N]=E[N]:C[N]=b(C[N]||{},D))}),C};R===!0&&(g=p[1],p=Array.prototype.slice.call(p,2));let T=p.length;for(u=0;u<T;u++)g=b(g,p[u]);return g},normalizeTickInterval:function(R,s,u,p,g){let b,T=R;u=di(u,Ri(R));let C=R/u;for(!s&&(s=g?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],p===!1&&(u===1?s=s.filter(function(E){return E%1==0}):u<=.1&&(s=[1/u]))),b=0;b<s.length&&(T=s[b],(!g||!(T*u>=R))&&(g||!(C<=(s[b]+(s[b+1]||s[b]))/2)));b++);return _n(T*u,-Math.round(Math.log(.001)/Math.LN10))},objectEach:Cr,offset:function(R){let s=_t.documentElement,u=R.parentElement||R.parentNode?R.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:u.top+(Dt.pageYOffset||s.scrollTop)-(s.clientTop||0),left:u.left+(Dt.pageXOffset||s.scrollLeft)-(s.clientLeft||0),width:u.width,height:u.height}},pad:function(R,s,u){return Array((s||2)+1-String(R).replace("-","").length).join(u||"0")+R},pick:di,pInt:Yt,pushUnique:function(R,s){return 0>R.indexOf(s)&&!!R.push(s)},relativeLength:function(R,s,u){return/%$/.test(R)?s*parseFloat(R)/100+(u||0):parseFloat(R)},removeEvent:Pl,replaceNested:function(R,...s){let u,p;do for(p of(u=R,s))R=R.replace(p[0],p[1]);while(R!==u);return R},splat:Ht,stableSort:function(R,s){let u,p,g=R.length;for(p=0;p<g;p++)R[p].safeI=p;for(R.sort(function(b,T){return(u=s(b,T))===0?b.safeI-T.safeI:u}),p=0;p<g;p++)delete R[p].safeI},syncTimeout:function(R,s,u){return s>0?setTimeout(R,s,u):(R.call(0,u),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},ucfirst:function(R){return yi(R)?R.substring(0,1).toUpperCase()+R.substring(1):String(R)},uniqueKey:hc,useSerialIds:function(R){return Z=di(R,Z)},wrap:function(R,s,u){let p=R[s];R[s]=function(){let g=arguments,b=this;return u.apply(this,[function(){return p.apply(b,arguments.length?arguments:g)}].concat([].slice.call(arguments)))}}},{pageLang:Ms,win:Va}=Ue,{defined:dc,error:qr,extend:Ga,isNumber:va,isObject:Ao,isString:$a,merge:Ru,objectEach:zl,pad:ba,splat:pc,timeUnits:Ha,ucfirst:en}=li,sa=Ue.isSafari&&Va.Intl&&!Va.Intl.DateTimeFormat.prototype.formatRange,oa=R=>R.main===void 0,Mh=class{constructor(R,s){this.options={timezone:"UTC"},this.variableTimezone=!1,this.Date=Va.Date,this.update(R),this.lang=s}update(R={}){this.dTLCache={},this.options=R=Ru(!0,this.options,R);let{timezoneOffset:s,useUTC:u}=R;this.Date=R.Date||Va.Date||Date;let p=R.timezone;dc(u)&&(p=u?"UTC":void 0),s&&s%60==0&&(p="Etc/GMT"+(s>0?"+":"")+s/60),this.variableTimezone=p!=="UTC"&&(p==null?void 0:p.indexOf("Etc/GMT"))!==0,this.timezone=p,["months","shortMonths","weekdays","shortWeekdays"].forEach(g=>{let b=/months/i.test(g),T=/short/.test(g),C={timeZone:"UTC"};C[b?"month":"weekday"]=T?"short":"long",this[g]=(b?[0,1,2,3,4,5,6,7,8,9,10,11]:[3,4,5,6,7,8,9]).map(E=>this.dateFormat(C,(b?31:1)*24*36e5*E))})}toParts(R){let[s,u,p,g,b,T,C]=this.dateTimeFormat({weekday:"narrow",day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},R,"es").split(/(?:, | |\/|:)/g);return[g,+p-1,u,b,T,C,Math.floor(Number(R)||0)%1e3,"DLMXJVS".indexOf(s)].map(Number)}dateTimeFormat(R,s,u=this.options.locale||Ms){let p=JSON.stringify(R)+u;$a(R)&&(R=this.str2dtf(R));let g=this.dTLCache[p];if(!g){R.timeZone??(R.timeZone=this.timezone);try{g=new Intl.DateTimeFormat(u,R)}catch(b){/Invalid time zone/i.test(b.message)?(qr(34),R.timeZone="UTC",g=new Intl.DateTimeFormat(u,R)):qr(b.message,!1)}}return this.dTLCache[p]=g,(g==null?void 0:g.format(s))||""}str2dtf(R,s={}){let u={L:{fractionalSecondDigits:3},S:{second:"2-digit"},M:{minute:"numeric"},H:{hour:"2-digit"},k:{hour:"numeric"},E:{weekday:"narrow"},a:{weekday:"short"},A:{weekday:"long"},d:{day:"2-digit"},e:{day:"numeric"},b:{month:"short"},B:{month:"long"},m:{month:"2-digit"},o:{month:"numeric"},y:{year:"2-digit"},Y:{year:"numeric"}};return Object.keys(u).forEach(p=>{R.indexOf(p)!==-1&&Ga(s,u[p])}),s}makeTime(R,s,u=1,p=0,g,b,T){let C=this.Date.UTC(R,s,u,p,g||0,b||0,T||0);if(this.timezone!=="UTC"){let E=this.getTimezoneOffset(C);if(C+=E,[2,3,8,9,10,11].indexOf(s)!==-1&&(p<5||p>20)){let D=this.getTimezoneOffset(C);E!==D?C+=D-E:E-36e5!==this.getTimezoneOffset(C-36e5)||sa||(C-=36e5)}}return C}parse(R){if(!$a(R))return R??void 0;let s=(R=R.replace(/\//g,"-").replace(/(GMT|UTC)/,"")).indexOf("Z")>-1||/([+-][0-9]{2}):?[0-9]{2}$/.test(R),u=/^[0-9]{4}-[0-9]{2}(-[0-9]{2}|)$/.test(R);s||u||(R+="Z");let p=Date.parse(R);if(va(p))return p+(!s||u?this.getTimezoneOffset(p):0)}getTimezoneOffset(R){if(this.timezone!=="UTC"){let[s,u,p,g,b=0]=this.dateTimeFormat({timeZoneName:"shortOffset"},R,"en").split(/(GMT|:)/).map(Number),T=-(36e5*(p+b/60));if(va(T))return T}return 0}dateFormat(R,s,u){let p=this.lang;if(!dc(s)||isNaN(s))return(p==null?void 0:p.invalidDate)||"";if($a(R=R??"%Y-%m-%d %H:%M:%S")){let g,b=/%\[([a-zA-Z]+)\]/g;for(;g=b.exec(R);)R=R.replace(g[0],this.dateTimeFormat(g[1],s,p==null?void 0:p.locale))}if($a(R)&&R.indexOf("%")!==-1){let g=this,[b,T,C,E,D,N,I,U]=this.toParts(s),X=(p==null?void 0:p.weekdays)||this.weekdays,Q=(p==null?void 0:p.shortWeekdays)||this.shortWeekdays,le=(p==null?void 0:p.months)||this.months,ne=(p==null?void 0:p.shortMonths)||this.shortMonths;zl(Ga({a:Q?Q[U]:X[U].substr(0,3),A:X[U],d:ba(C),e:ba(C,2," "),w:U,v:(p==null?void 0:p.weekFrom)??"",b:ne[T],B:le[T],m:ba(T+1),o:T+1,y:b.toString().substr(2,2),Y:b,H:ba(E),k:E,I:ba(E%12||12),l:E%12||12,M:ba(D),p:E<12?"AM":"PM",P:E<12?"am":"pm",S:ba(N),L:ba(I,3)},Ue.dateFormats),function(ie,me){if($a(R))for(;R.indexOf("%"+me)!==-1;)R=R.replace("%"+me,typeof ie=="function"?ie.call(g,s):ie)})}else if(Ao(R)){let g=(this.getTimezoneOffset(s)||0)/36e5,b=this.timezone||"Etc/GMT"+(g>=0?"+":"")+g,{prefix:T="",suffix:C=""}=R;R=T+this.dateTimeFormat(Ga({timeZone:b},R),s)+C}return u?en(R):R}resolveDTLFormat(R){return Ao(R,!0)?Ao(R,!0)&&oa(R)?{main:R}:R:{main:(R=pc(R))[0],from:R[1],to:R[2]}}getDateFormat(R,s,u,p){let g=this.dateFormat("%m-%d %H:%M:%S.%L",s),b="01-01 00:00:00.000",T={millisecond:15,second:12,minute:9,hour:6,day:3},C="millisecond",E=C;for(C in Ha){if(R&&R===Ha.week&&+this.dateFormat("%w",s)===u&&g.substr(6)===b.substr(6)){C="week";break}if(R&&Ha[C]>R){C=E;break}if(T[C]&&g.substr(T[C])!==b.substr(T[C]))break;C!=="week"&&(E=C)}return this.resolveDTLFormat(p[C]).main}},{defined:Eo,extend:lt,timeUnits:de}=li,ye=class extends Mh{getTimeTicks(R,s,u,p){let g=this,b=[],T={},{count:C=1,unitRange:E}=R,[D,N,I,U,X,Q]=g.toParts(s),le=(s||0)%1e3,ne;if(p??(p=1),Eo(s)){if(le=E>=de.second?0:C*Math.floor(le/C),E>=de.second&&(Q=E>=de.minute?0:C*Math.floor(Q/C)),E>=de.minute&&(X=E>=de.hour?0:C*Math.floor(X/C)),E>=de.hour&&(U=E>=de.day?0:C*Math.floor(U/C)),E>=de.day&&(I=E>=de.month?1:Math.max(1,C*Math.floor(I/C))),E>=de.month&&(N=E>=de.year?0:C*Math.floor(N/C)),E>=de.year&&(D-=D%C),E===de.week){C&&(s=g.makeTime(D,N,I,U,X,Q,le));let _e=this.dateTimeFormat({timeZone:this.timezone,weekday:"narrow"},s,"es"),Je="DLMXJVS".indexOf(_e);I+=-Je+p+(Je<p?-7:0)}s=g.makeTime(D,N,I,U,X,Q,le),g.variableTimezone&&Eo(u)&&(ne=u-s>4*de.month||g.getTimezoneOffset(s)!==g.getTimezoneOffset(u));let ie=s,me=1;for(;ie<u;)b.push(ie),E===de.year?ie=g.makeTime(D+me*C,0):E===de.month?ie=g.makeTime(D,N+me*C):ne&&(E===de.day||E===de.week)?ie=g.makeTime(D,N,I+me*C*(E===de.day?1:7)):ne&&E===de.hour&&C>1?ie=g.makeTime(D,N,I,U+me*C):ie+=E*C,me++;b.push(ie),E<=de.hour&&b.length<1e4&&b.forEach(_e=>{_e%18e5==0&&g.dateFormat("%H%M%S%L",_e)==="000000000"&&(T[_e]="day")})}return b.info=lt(R,{higherRanks:T,totalRange:E*C}),b}},{isTouchDevice:Me}=Ue,{fireEvent:je,merge:Qe}=li,nt={colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{weekFrom:"week from",chartTitle:"Chart title",locale:void 0,loading:"Loading...",months:void 0,seriesName:"Series {add index 1}",shortMonths:void 0,weekdays:void 0,numericSymbols:["k","M","G","T","P","E"],pieSliceName:"Slice",resetZoom:"Reset zoom",yAxisTitle:"Values",resetZoomTitle:"Reset zoom level 1:1"},global:{buttonTheme:{fill:"#f7f7f7",padding:8,r:2,stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},states:{hover:{fill:"#e6e6e6"},select:{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},disabled:{style:{color:"#cccccc"}}}}},time:{Date:void 0,timezone:"UTC",timezoneOffset:0,useUTC:void 0},chart:{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",margin:15,minScale:.67},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:""},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",events:{},layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:{duration:300,easing:R=>Math.sqrt(1-Math.pow(R-1,2))},borderRadius:3,dateTimeLabelFormats:{millisecond:"%[AebHMSL]",second:"%[AebHMS]",minute:"%[AebHM]",hour:"%[AebHM]",day:"%[AebY]",week:"%v %[AebY]",month:"%[BY]",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,position:{x:0,y:3},shared:!1,snap:Me?25:10,headerFormat:'<span style="font-size: 0.8em">{ucfirst point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}},yt=new ye(nt.time,nt.lang),tt={defaultOptions:nt,defaultTime:yt,getOptions:function(){return nt},setOptions:function(R){var s;return je(Ue,"setOptions",{options:R}),Qe(!0,nt,R),R.time&&yt.update(nt.time),R.lang&&"locale"in R.lang&&yt.update({locale:R.lang.locale}),(s=R.lang)!=null&&s.chartTitle&&(nt.title={...nt.title,text:R.lang.chartTitle}),nt}},{win:Et}=Ue,{isNumber:St,isString:ut,merge:jt,pInt:He,defined:ni}=li,Pi=(R,s,u)=>`color-mix(in srgb,${R},${s} ${100*u}%)`,ci=R=>ut(R)&&!!R&&R!=="none";class ai{static parse(s){return s?new ai(s):ai.None}constructor(s){let u,p,g,b;this.rgba=[NaN,NaN,NaN,NaN],this.input=s;let T=Ue.Color;if(T&&T!==ai)return new T(s);if(typeof s=="object"&&s.stops!==void 0)this.stops=s.stops.map(C=>new ai(C[1]));else if(typeof s=="string")for(this.input=s=ai.names[s.toLowerCase()]||s,g=ai.parsers.length;g--&&!p;)(u=(b=ai.parsers[g]).regex.exec(s))&&(p=b.parse(u));p&&(this.rgba=p)}get(s){let u=this.input,p=this.rgba;if(this.output)return this.output;if(typeof u=="object"&&this.stops!==void 0){let g=jt(u);return g.stops=[].slice.call(g.stops),this.stops.forEach((b,T)=>{g.stops[T]=[g.stops[T][0],b.get(s)]}),g}return p&&St(p[0])?s!=="rgb"&&(s||p[3]!==1)?s==="a"?`${p[3]}`:"rgba("+p.join(",")+")":"rgb("+p[0]+","+p[1]+","+p[2]+")":u}brighten(s){let u=this.rgba;if(this.stops)this.stops.forEach(function(p){p.brighten(s)});else if(St(s)&&s!==0)if(St(u[0]))for(let p=0;p<3;p++)u[p]+=He(255*s),u[p]<0&&(u[p]=0),u[p]>255&&(u[p]=255);else ai.useColorMix&&ci(this.input)&&(this.output=Pi(this.input,s>0?"white":"black",Math.abs(s)));return this}setOpacity(s){return this.rgba[3]=s,this}tweenTo(s,u){let p=this.rgba,g=s.rgba;if(!St(p[0])||!St(g[0]))return ai.useColorMix&&ci(this.input)&&ci(s.input)&&u<.99?Pi(this.input,s.input,u):s.input||"none";let b=g[3]!==1||p[3]!==1,T=(E,D)=>E+(p[D]-E)*(1-u),C=g.slice(0,3).map(T).map(Math.round);return b&&C.push(T(g[3],3)),(b?"rgba(":"rgb(")+C.join(",")+")"}}ai.names={white:"#ffffff",black:"#000000"},ai.parsers=[{regex:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?(?:\.\d+)?)\s*\)/,parse:function(R){return[He(R[1]),He(R[2]),He(R[3]),parseFloat(R[4],10)]}},{regex:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,parse:function(R){return[He(R[1]),He(R[2]),He(R[3]),1]}},{regex:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?$/i,parse:function(R){return[He(R[1]+R[1],16),He(R[2]+R[2],16),He(R[3]+R[3],16),ni(R[4])?He(R[4]+R[4],16)/255:1]}},{regex:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?$/i,parse:function(R){return[He(R[1],16),He(R[2],16),He(R[3],16),ni(R[4])?He(R[4],16)/255:1]}}],ai.useColorMix=(ap=Et.CSS)==null?void 0:ap.supports("color","color-mix(in srgb,red,blue 9%)"),ai.None=new ai("");let{parse:Ai}=ai,{win:tr}=Ue,{isNumber:Wi,objectEach:ur}=li;class bi{constructor(s,u,p){this.pos=NaN,this.options=u,this.elem=s,this.prop=p}dSetter(){let s=this.paths,u=s==null?void 0:s[0],p=s==null?void 0:s[1],g=this.now||0,b=[];if(g!==1&&u&&p)if(u.length===p.length&&g<1)for(let T=0;T<p.length;T++){let C=u[T],E=p[T],D=[];for(let N=0;N<E.length;N++){let I=C[N],U=E[N];Wi(I)&&Wi(U)&&(E[0]!=="A"||N!==4&&N!==5)?D[N]=I+g*(U-I):D[N]=U}b.push(D)}else b=p;else b=this.toD||[];this.elem.attr("d",b,void 0,!0)}update(){let s=this.elem,u=this.prop,p=this.now,g=this.options.step;this[u+"Setter"]?this[u+"Setter"]():s.attr?s.element&&s.attr(u,p,null,!0):s.style[u]=p+this.unit,g&&g.call(s,p,this)}run(s,u,p){let g=this,b=g.options,T=function(D){return!T.stopped&&g.step(D)},C=tr.requestAnimationFrame||function(D){setTimeout(D,13)},E=function(){for(let D=0;D<bi.timers.length;D++)bi.timers[D]()||bi.timers.splice(D--,1);bi.timers.length&&C(E)};s!==u||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=s,this.end=u,this.unit=p,this.now=this.start,this.pos=0,T.elem=this.elem,T.prop=this.prop,T()&&bi.timers.push(T)===1&&C(E)):(delete b.curAnim[this.prop],b.complete&&Object.keys(b.curAnim).length===0&&b.complete.call(this.elem))}step(s){let u,p,g=+new Date,b=this.options,T=this.elem,C=b.complete,E=b.duration,D=b.curAnim;return T.attr&&!T.element?u=!1:s||g>=E+this.startTime?(this.now=this.end,this.pos=1,this.update(),D[this.prop]=!0,p=!0,ur(D,function(N){N!==!0&&(p=!1)}),p&&C&&C.call(T),u=!1):(this.pos=b.easing((g-this.startTime)/E),this.now=this.start+(this.end-this.start)*this.pos,this.update(),u=!0),u}initPath(s,u,p){let g=s.startX,b=s.endX,T=p.slice(),C=s.isArea,E=C?2:1,D=u&&p.length>u.length&&p.hasStackedCliffs,N,I,U,X,Q=u==null?void 0:u.slice();if(!Q||D)return[T,T];function le(ie,me){for(;ie.length<I;){let _e=ie[0],Je=me[I-ie.length];if(Je&&_e[0]==="M"&&(Je[0]==="C"?ie[0]=["C",_e[1],_e[2],_e[1],_e[2],_e[1],_e[2]]:ie[0]=["L",_e[1],_e[2]]),ie.unshift(_e),C){let $e=ie.pop();ie.push(ie[ie.length-1],$e)}}}function ne(ie){for(;ie.length<I;){let me=ie[Math.floor(ie.length/E)-1].slice();if(me[0]==="C"&&(me[1]=me[5],me[2]=me[6]),C){let _e=ie[Math.floor(ie.length/E)].slice();ie.splice(ie.length/2,0,me,_e)}else ie.push(me)}}if(g&&b&&b.length){for(U=0;U<g.length;U++){if(g[U]===b[0]){N=U;break}if(g[0]===b[b.length-g.length+U]){N=U,X=!0;break}if(g[g.length-1]===b[b.length-g.length+U]){N=g.length-U;break}}N===void 0&&(Q=[])}return Q.length&&Wi(N)&&(I=T.length+N*E,X?(le(Q,T),ne(T)):(le(T,Q),ne(Q))),[Q,T]}fillSetter(){bi.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,Ai(this.start).tweenTo(Ai(this.end),this.pos),void 0,!0)}}bi.timers=[];let{defined:fr,getStyle:Kn,isArray:Wt,isNumber:Cn,isObject:Ur,merge:es,objectEach:Cs,pick:Jt}=li;function Fi(R){return Ur(R)?es({duration:500,defer:0},R):{duration:500*!!R,defer:0}}function Mi(R,s){let u=bi.timers.length;for(;u--;)bi.timers[u].elem!==R||s&&s!==bi.timers[u].prop||(bi.timers[u].stopped=!0)}let Dr={animate:function(R,s,u){let p,g="",b,T,C;Ur(u)||(C=arguments,u={duration:C[2],easing:C[3],complete:C[4]}),Cn(u.duration)||(u.duration=400),u.easing=typeof u.easing=="function"?u.easing:Math[u.easing]||Math.easeInOutSine,u.curAnim=es(s),Cs(s,function(E,D){Mi(R,D),T=new bi(R,u,D),b=void 0,D==="d"&&Wt(s.d)?(T.paths=T.initPath(R,R.pathArray,s.d),T.toD=s.d,p=0,b=1):R.attr?p=R.attr(D):(p=parseFloat(Kn(R,D))||0,D!=="opacity"&&(g="px")),b||(b=E),typeof b=="string"&&b.match("px")&&(b=b.replace(/px/g,"")),T.run(p,b,g)})},animObject:Fi,getDeferredAnimation:function(R,s,u){let p=Fi(s),g=u?[u]:R.series,b=0,T=0;return g.forEach(C=>{let E=Fi(C.options.animation);b=Ur(s)&&fr(s.defer)?p.defer:Math.max(b,E.duration+E.defer),T=Math.min(p.duration,E.duration)}),R.renderer.forExport&&(b=0),{defer:Math.max(0,b-T),duration:Math.min(b,T)}},setAnimation:function(R,s){s.renderer.globalAnimation=Jt(R,s.options.chart.animation,!0)},stop:Mi},{SVG_NS:Qc,win:wa}=Ue,{attr:Zi,createElement:Qo,css:Ll,error:fn,isFunction:Iu,isString:Jo,objectEach:hs,splat:ds}=li,{trustedTypes:la}=wa,Vr=la&&Iu(la.createPolicy)&&la.createPolicy("highcharts",{createHTML:R=>R}),fc=Vr?Vr.createHTML(""):"";class Er{static filterUserAttributes(s){return hs(s,(u,p)=>{let g=!0;Er.allowedAttributes.indexOf(p)===-1&&(g=!1),["background","dynsrc","href","lowsrc","src"].indexOf(p)!==-1&&(g=Jo(u)&&Er.allowedReferences.some(b=>u.indexOf(b)===0)),g||(fn(33,!1,void 0,{"Invalid attribute in config":`${p}`}),delete s[p]),Jo(u)&&s[p]&&(s[p]=u.replace(/</g,"&lt;"))}),s}static parseStyle(s){return s.split(";").reduce((u,p)=>{let g=p.split(":").map(T=>T.trim()),b=g.shift();return b&&g.length&&(u[b.replace(/-([a-z])/g,T=>T[1].toUpperCase())]=g.join(":")),u},{})}static setElementHTML(s,u){s.innerHTML=Er.emptyHTML,u&&new Er(u).addToDOM(s)}constructor(s){this.nodes=typeof s=="string"?this.parseMarkup(s):s}addToDOM(s){return function u(p,g){let b;return ds(p).forEach(function(T){let C,E=T.tagName,D=T.textContent?Ue.doc.createTextNode(T.textContent):void 0,N=Er.bypassHTMLFiltering;if(E)if(E==="#text")C=D;else if(Er.allowedTags.indexOf(E)!==-1||N){let I=E==="svg"?Qc:g.namespaceURI||Qc,U=Ue.doc.createElementNS(I,E),X=T.attributes||{};hs(T,function(Q,le){le!=="tagName"&&le!=="attributes"&&le!=="children"&&le!=="style"&&le!=="textContent"&&(X[le]=Q)}),Zi(U,N?X:Er.filterUserAttributes(X)),T.style&&Ll(U,T.style),D&&U.appendChild(D),u(T.children||[],U),C=U}else fn(33,!1,void 0,{"Invalid tagName in config":E});C&&g.appendChild(C),b=C}),b}(this.nodes,s)}parseMarkup(s){let u,p=[];s=s.trim().replace(/ style=(["'])/g," data-style=$1");try{u=new DOMParser().parseFromString(Vr?Vr.createHTML(s):s,"text/html")}catch{}if(!u){let b=Qo("div");b.innerHTML=s,u={body:b}}let g=(b,T)=>{let C=b.nodeName.toLowerCase(),E={tagName:C};C==="#text"&&(E.textContent=b.textContent||"");let D=b.attributes;if(D){let N={};[].forEach.call(D,I=>{I.name==="data-style"?E.style=Er.parseStyle(I.value):N[I.name]=I.value}),E.attributes=N}if(b.childNodes.length){let N=[];[].forEach.call(b.childNodes,I=>{g(I,N)}),N.length&&(E.children=N)}T.push(E)};return[].forEach.call(u.body.childNodes,b=>g(b,p)),p}}Er.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","in2","markerHeight","markerWidth","offset","opacity","operator","orient","padding","paddingLeft","paddingRight","patternUnits","r","radius","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],Er.allowedReferences=["https://","http://","mailto:","/","../","./","#"],Er.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feComposite","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMorphology","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],Er.emptyHTML=fc,Er.bypassHTMLFiltering=!1;let{defaultOptions:mc,defaultTime:Dl}=tt,{pageLang:el}=Ue,{extend:ps,getNestedProperty:_d,isArray:yp,isNumber:ko,isObject:xd,isString:Ou,pick:ju,ucfirst:As}=li,gc={add:(R,s)=>R+s,divide:(R,s)=>s!==0?R/s:"",eq:(R,s)=>R==s,each:function(R){let s=arguments[arguments.length-1];return!!yp(R)&&R.map((u,p)=>Ws(s.body,ps(xd(u)?u:{"@this":u},{"@index":p,"@first":p===0,"@last":p===R.length-1}))).join("")},ge:(R,s)=>R>=s,gt:(R,s)=>R>s,if:R=>!!R,le:(R,s)=>R<=s,lt:(R,s)=>R<s,multiply:(R,s)=>R*s,ne:(R,s)=>R!=s,subtract:(R,s)=>R-s,ucfirst:As,unless:R=>!R},Rl={},Jc=R=>/^["'].+["']$/.test(R);function Ws(R="",s,u){var ne;let p=/\{([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'’= #\(\)]+)\}/g,g=/\(([a-zA-Z\u00C0-\u017F\d:\.,;\-\/<>\[\]%_@+"'= ]+)\)/g,b=[],T=/f$/,C=/\.(\d)/,E=((ne=u==null?void 0:u.options)==null?void 0:ne.lang)||mc.lang,D=(u==null?void 0:u.time)||Dl,N=(u==null?void 0:u.numberFormatter)||Ch,I=(ie="")=>{let me;return ie==="true"||ie!=="false"&&((me=Number(ie)).toString()===ie?me:Jc(ie)?ie.slice(1,-1):_d(ie,s))},U,X,Q=0,le;for(;(U=p.exec(R))!==null;){let ie=U,me=g.exec(U[1]);me&&(U=me,le=!0),X!=null&&X.isBlock||(X={ctx:s,expression:U[1],find:U[0],isBlock:U[1].charAt(0)==="#",start:U.index,startInner:U.index+U[0].length,length:U[0].length});let _e=(X.isBlock?ie:U)[1].split(" ")[0].replace("#","");gc[_e]&&(X.isBlock&&_e===X.fn&&Q++,X.fn||(X.fn=_e));let Je=U[1]==="else";if(X.isBlock&&X.fn&&(U[1]===`/${X.fn}`||Je))if(Q)!Je&&Q--;else{let $e=X.startInner,Ze=R.substr($e,U.index-$e);X.body===void 0?(X.body=Ze,X.startInner=U.index+U[0].length):X.elseBody=Ze,X.find+=Ze+U[0],Je||(b.push(X),X=void 0)}else X.isBlock||b.push(X);if(me&&!(X!=null&&X.isBlock))break}return b.forEach(ie=>{let me,_e,{body:Je,elseBody:$e,expression:Ze,fn:ht}=ie;if(ht){let at=[ie],mt=[],Bt=Ze.length,Zt=0,Qt;for(_e=0;_e<=Bt;_e++){let Gt=Ze.charAt(_e);Qt||Gt!=='"'&&Gt!=="'"?Qt===Gt&&(Qt=""):Qt=Gt,Qt||Gt!==" "&&_e!==Bt||(mt.push(Ze.substr(Zt,_e-Zt)),Zt=_e+1)}for(_e=gc[ht].length;_e--;)at.unshift(I(mt[_e+1]));me=gc[ht].apply(s,at),ie.isBlock&&typeof me=="boolean"&&(me=Ws(me?Je:$e,s,u))}else{let at=Jc(Ze)?[Ze]:Ze.split(":");if(me=I(at.shift()||""),at.length&&typeof me=="number"){let mt=at.join(":");if(T.test(mt)){let Bt=parseInt((mt.match(C)||["","-1"])[1],10);me!==null&&(me=N(me,Bt,E.decimalPoint,mt.indexOf(",")>-1?E.thousandsSep:""))}else me=D.dateFormat(mt,me)}g.lastIndex=0,g.test(ie.find)&&Ou(me)&&(me=`"${me}"`)}R=R.replace(ie.find,ju(me,""))}),le?Ws(R,s,u):R}function Ch(R,s,u,p){var le;s*=1;let g,b,[T,C]=(R=+R||0).toString().split("e").map(Number),E=((le=this==null?void 0:this.options)==null?void 0:le.lang)||mc.lang,D=(R.toString().split(".")[1]||"").split("e")[0].length,N=s,I={};u??(u=E.decimalPoint),p??(p=E.thousandsSep),s===-1?s=Math.min(D,20):ko(s)?s&&C<0&&((b=s+C)>=0?(T=+T.toExponential(b).split("e")[0],s=b):(T=Math.floor(T),R=s<20?+(T*Math.pow(10,C)).toFixed(s):0,C=0)):s=2,C&&(s??(s=2),R=T),ko(s)&&s>=0&&(I.minimumFractionDigits=s,I.maximumFractionDigits=s),p===""&&(I.useGrouping=!1);let U=p||u,X=U?"en":(this==null?void 0:this.locale)||E.locale||el,Q=JSON.stringify(I)+X;return g=(Rl[Q]??(Rl[Q]=new Intl.NumberFormat(X,I))).format(R),U&&(g=g.replace(/([,\.])/g,"_$1").replace(/_\,/g,p??",").replace("_.",u??".")),(s||+g!=0)&&(!(C<0)||N)||(g="0"),C&&+g!=0&&(g+="e"+(C<0?"":"+")+C),g}let Sa={dateFormat:function(R,s,u){return Dl.dateFormat(R,s,u)},format:Ws,helpers:gc,numberFormat:Ch};(function(R){let s;R.rendererTypes={},R.getRendererType=function(u=s){return R.rendererTypes[u]||R.rendererTypes[s]},R.registerRendererType=function(u,p,g){R.rendererTypes[u]=p,(!s||g)&&(s=u,Ue.Renderer=p)}})(ce||(ce={}));let fs=ce,{clamp:Po,pick:ar,pushUnique:zo,stableSort:ms}=li;(B||(B={})).distribute=function R(s,u,p){let g=s,b=g.reducedLen||u,T=(_e,Je)=>_e.target-Je.target,C=[],E=s.length,D=[],N=C.push,I,U,X,Q=!0,le,ne,ie=0,me;for(I=E;I--;)ie+=s[I].size;if(ie>b){for(ms(s,(_e,Je)=>(Je.rank||0)-(_e.rank||0)),X=(me=s[0].rank===s[s.length-1].rank)?E/2:-1,U=me?X:E-1;X&&ie>b;)le=s[I=Math.floor(U)],zo(D,I)&&(ie-=le.size),U+=X,me&&U>=s.length&&(X/=2,U=X);D.sort((_e,Je)=>Je-_e).forEach(_e=>N.apply(C,s.splice(_e,1)))}for(ms(s,T),s=s.map(_e=>({size:_e.size,targets:[_e.target],align:ar(_e.align,.5)}));Q;){for(I=s.length;I--;)le=s[I],ne=(Math.min.apply(0,le.targets)+Math.max.apply(0,le.targets))/2,le.pos=Po(ne-le.size*le.align,0,u-le.size);for(I=s.length,Q=!1;I--;)I>0&&s[I-1].pos+s[I-1].size>s[I].pos&&(s[I-1].size+=s[I].size,s[I-1].targets=s[I-1].targets.concat(s[I].targets),s[I-1].align=.5,s[I-1].pos+s[I-1].size>u&&(s[I-1].pos=u-s[I-1].size),s.splice(I,1),Q=!0)}return N.apply(g,C),I=0,s.some(_e=>{let Je=0;return(_e.targets||[]).some(()=>(g[I].pos=_e.pos+Je,p!==void 0&&Math.abs(g[I].pos-g[I].target)>p?(g.slice(0,I+1).forEach($e=>delete $e.pos),g.reducedLen=(g.reducedLen||u)-.1*u,g.reducedLen>.1*u&&R(g,u,p),!0):(Je+=g[I].size,I++,!1)))}),ms(g,T),g};let Lo=B,{animate:vd,animObject:eu,stop:Za}=Dr,{deg2rad:Es,doc:Ui,svg:Do,SVG_NS:Il,win:Bu,isFirefox:ca}=Ue,{addEvent:an,attr:Jr,createElement:Bn,crisp:kr,css:ks,defined:Vi,erase:ua,extend:Oi,fireEvent:Gi,getAlignFactor:Ps,isArray:Li,isFunction:An,isNumber:En,isObject:tl,isString:ha,merge:Nu,objectEach:da,pick:zs,pInt:il,pushUnique:Ol,replaceNested:tu,syncTimeout:Ks,uniqueKey:Vn}=li;class sn{_defaultGetter(s){let u=zs(this[s+"Value"],this[s],this.element?this.element.getAttribute(s):null,0);return/^-?[\d\.]+$/.test(u)&&(u=parseFloat(u)),u}_defaultSetter(s,u,p){p.setAttribute(u,s)}add(s){let u,p=this.renderer,g=this.element;return s&&(this.parentGroup=s),this.textStr!==void 0&&this.element.nodeName==="text"&&p.buildText(this),this.added=!0,(!s||s.handleZ||this.zIndex)&&(u=this.zIndexSetter()),u||(s?s.element:p.box).appendChild(g),this.onAdd&&this.onAdd(),this}addClass(s,u){let p=u?"":this.attr("class")||"";return(s=(s||"").split(/ /g).reduce(function(g,b){return p.indexOf(b)===-1&&g.push(b),g},p?[p]:[]).join(" "))!==p&&this.attr("class",s),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(s,u,p,g=!0){let b=this.renderer,T=b.alignedObjects,C=!!s;s?(this.alignOptions=s,this.alignByTranslate=u,this.alignTo=p):(s=this.alignOptions||{},u=this.alignByTranslate,p=this.alignTo);let E=!p||ha(p)?p||"renderer":void 0;E&&(C&&Ol(T,this),p=void 0);let D=zs(p,b[E],b),N=(D.x||0)+(s.x||0)+((D.width||0)-(s.width||0))*Ps(s.align),I=(D.y||0)+(s.y||0)+((D.height||0)-(s.height||0))*Ps(s.verticalAlign),U={"text-align":s==null?void 0:s.align};return U[u?"translateX":"x"]=Math.round(N),U[u?"translateY":"y"]=Math.round(I),g&&(this[this.placed?"animate":"attr"](U),this.placed=!0),this.alignAttr=U,this}alignSetter(s){let u={left:"start",center:"middle",right:"end"};u[s]&&(this.alignValue=s,this.element.setAttribute("text-anchor",u[s]))}animate(s,u,p){let g=eu(zs(u,this.renderer.globalAnimation,!0)),b=g.defer;return Ui.hidden&&(g.duration=0),g.duration!==0?(p&&(g.complete=p),Ks(()=>{this.element&&vd(this,s,g)},b)):(this.attr(s,void 0,p||g.complete),da(s,function(T,C){g.step&&g.step.call(this,T,{prop:C,pos:1,elem:this})},this)),this}applyTextOutline(s){let u=this.element;s.indexOf("contrast")!==-1&&(s=s.replace(/contrast/g,this.renderer.getContrast(u.style.fill)));let p=s.indexOf(" "),g=s.substring(p+1),b=s.substring(0,p);if(b&&b!=="none"&&Ue.svg){this.fakeTS=!0,b=b.replace(/(^[\d\.]+)(.*?)$/g,function(N,I,U){return 2*Number(I)+U}),this.removeTextOutline();let T=Ui.createElementNS(Il,"tspan");Jr(T,{class:"highcharts-text-outline",fill:g,stroke:g,"stroke-width":b,"stroke-linejoin":"round"});let C=u.querySelector("textPath")||u;[].forEach.call(C.childNodes,N=>{let I=N.cloneNode(!0);I.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(U=>I.removeAttribute(U)),T.appendChild(I)});let E=0;[].forEach.call(C.querySelectorAll("text tspan"),N=>{E+=Number(N.getAttribute("dy"))});let D=Ui.createElementNS(Il,"tspan");D.textContent="​",Jr(D,{x:Number(u.getAttribute("x")),dy:-E}),T.appendChild(D),C.insertBefore(T,C.firstChild)}}attr(s,u,p,g){let{element:b}=this,T=sn.symbolCustomAttribs,C,E,D=this,N;return typeof s=="string"&&u!==void 0&&(C=s,(s={})[C]=u),typeof s=="string"?D=(this[s+"Getter"]||this._defaultGetter).call(this,s,b):(da(s,function(I,U){N=!1,g||Za(this,U),this.symbolName&&T.indexOf(U)!==-1&&(E||(this.symbolAttr(s),E=!0),N=!0),this.rotation&&(U==="x"||U==="y")&&(this.doTransform=!0),N||(this[U+"Setter"]||this._defaultSetter).call(this,I,U,b)},this),this.afterSetters()),p&&p.call(this),D}clip(s){if(s&&!s.clipPath){let u=Vn()+"-",p=this.renderer.createElement("clipPath").attr({id:u}).add(this.renderer.defs);Oi(s,{clipPath:p,id:u,count:0}),s.add(p)}return this.attr("clip-path",s?`url(${this.renderer.url}#${s.id})`:"none")}crisp(s,u){u=Math.round(u||s.strokeWidth||0);let p=s.x||this.x||0,g=s.y||this.y||0,b=(s.width||this.width||0)+p,T=(s.height||this.height||0)+g,C=kr(p,u),E=kr(g,u);return Oi(s,{x:C,y:E,width:kr(b,u)-C,height:kr(T,u)-E}),Vi(s.strokeWidth)&&(s.strokeWidth=u),s}complexColor(s,u,p){let g=this.renderer,b,T,C,E,D,N,I,U,X,Q,le=[],ne;Gi(this.renderer,"complexColor",{args:arguments},function(){if(s.radialGradient?T="radialGradient":s.linearGradient&&(T="linearGradient"),T){if(C=s[T],D=g.gradients,N=s.stops,X=p.radialReference,Li(C)&&(s[T]=C={x1:C[0],y1:C[1],x2:C[2],y2:C[3],gradientUnits:"userSpaceOnUse"}),T==="radialGradient"&&X&&!Vi(C.gradientUnits)&&(E=C,C=Nu(C,g.getRadialAttr(X,E),{gradientUnits:"userSpaceOnUse"})),da(C,function(ie,me){me!=="id"&&le.push(me,ie)}),da(N,function(ie){le.push(ie)}),D[le=le.join(",")])Q=D[le].attr("id");else{C.id=Q=Vn();let ie=D[le]=g.createElement(T).attr(C).add(g.defs);ie.radAttr=E,ie.stops=[],N.forEach(function(me){me[1].indexOf("rgba")===0?(I=(b=ai.parse(me[1])).get("rgb"),U=b.get("a")):(I=me[1],U=1);let _e=g.createElement("stop").attr({offset:me[0],"stop-color":I,"stop-opacity":U}).add(ie);ie.stops.push(_e)})}ne="url("+g.url+"#"+Q+")",p.setAttribute(u,ne),p.gradient=le,s.toString=function(){return ne}}})}css(s){let u=this.styles,p={},g=this.element,b,T=!u;if(u&&da(s,function(C,E){u&&u[E]!==C&&(p[E]=C,T=!0)}),T){u&&(s=Oi(u,p)),s.width===null||s.width==="auto"?delete this.textWidth:g.nodeName.toLowerCase()==="text"&&s.width&&(b=this.textWidth=il(s.width)),Oi(this.styles,s),b&&!Do&&this.renderer.forExport&&delete s.width;let C=ca&&s.fontSize||null;C&&(En(C)||/^\d+$/.test(C))&&(s.fontSize+="px");let E=Nu(s);g.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","whiteSpace","width"].forEach(D=>E&&delete E[D]),E.color&&(E.fill=E.color,delete E.color)),ks(g,E)}return this.added&&(this.element.nodeName==="text"&&this.renderer.buildText(this),s.textOutline&&this.applyTextOutline(s.textOutline)),this}dashstyleSetter(s){let u,p=this["stroke-width"];if(p==="inherit"&&(p=1),s){let g=(s=s.toLowerCase()).replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(u=g.length;u--;)g[u]=""+il(g[u])*zs(p,NaN);s=g.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",s)}}destroy(){let s=this,u=s.element||{},p=s.renderer,g=u.ownerSVGElement,b=u.nodeName==="SPAN"&&s.parentGroup||void 0,T,C;if(u.onclick=u.onmouseout=u.onmouseover=u.onmousemove=u.point=null,Za(s),s.clipPath&&g){let E=s.clipPath;[].forEach.call(g.querySelectorAll("[clip-path],[CLIP-PATH]"),function(D){D.getAttribute("clip-path").indexOf(E.element.id)>-1&&D.removeAttribute("clip-path")}),s.clipPath=E.destroy()}if(s.stops){for(C=0;C<s.stops.length;C++)s.stops[C].destroy();s.stops.length=0,s.stops=void 0}for(s.safeRemoveChild(u);b!=null&&b.div&&b.div.childNodes.length===0;)T=b.parentGroup,s.safeRemoveChild(b.div),delete b.div,b=T;s.alignOptions&&ua(p.alignedObjects,s),da(s,(E,D)=>{var N,I,U;(((N=s[D])==null?void 0:N.parentGroup)===s||["connector","foreignObject"].indexOf(D)!==-1)&&((U=(I=s[D])==null?void 0:I.destroy)==null||U.call(I)),delete s[D]})}dSetter(s,u,p){Li(s)&&(typeof s[0]=="string"&&(s=this.renderer.pathToSegments(s)),this.pathArray=s,s=s.reduce((g,b,T)=>b!=null&&b.join?(T?g+" ":"")+b.join(" "):(b||"").toString(),"")),/(NaN| {2}|^$)/.test(s)&&(s="M 0 0"),this[u]!==s&&(p.setAttribute(u,s),this[u]=s)}fillSetter(s,u,p){typeof s=="string"?p.setAttribute(u,s):s&&this.complexColor(s,u,p)}hrefSetter(s,u,p){p.setAttributeNS("http://www.w3.org/1999/xlink",u,s)}getBBox(s,u){let p,g,b,T,{alignValue:C,element:E,renderer:D,styles:N,textStr:I}=this,{cache:U,cacheKeys:X}=D,Q=E.namespaceURI===this.SVG_NS,le=zs(u,this.rotation,0),ne=D.styledMode?E&&sn.prototype.getStyle.call(E,"font-size"):N.fontSize;if(Vi(I)&&((T=I.toString()).indexOf("<")===-1&&(T=T.replace(/\d/g,"0")),T+=["",D.rootFontSize,ne,le,this.textWidth,C,N.lineClamp,N.textOverflow,N.fontWeight].join(",")),T&&!s&&(p=U[T]),!p||p.polygon){if(Q||D.forExport){try{b=this.fakeTS&&function(me){let _e=E.querySelector(".highcharts-text-outline");_e&&ks(_e,{display:me})},An(b)&&b("none"),p=E.getBBox?Oi({},E.getBBox()):{width:E.offsetWidth,height:E.offsetHeight,x:0,y:0},An(b)&&b("")}catch{}(!p||p.width<0)&&(p={x:0,y:0,width:0,height:0})}else p=this.htmlGetBBox();g=p.height,Q&&(p.height=g={"11px,17":14,"13px,20":16}[`${ne||""},${Math.round(g)}`]||g),le&&(p=this.getRotatedBox(p,le));let ie={bBox:p};Gi(this,"afterGetBBox",ie),p=ie.bBox}if(T&&(I===""||p.height>0)){for(;X.length>250;)delete U[X.shift()];U[T]||X.push(T),U[T]=p}return p}getRotatedBox(s,u){let{x:p,y:g,width:b,height:T}=s,{alignValue:C,translateY:E,rotationOriginX:D=0,rotationOriginY:N=0}=this,I=Ps(C),U=Number(this.element.getAttribute("y")||0)-(E?0:g),X=u*Es,Q=(u-90)*Es,le=Math.cos(X),ne=Math.sin(X),ie=b*le,me=b*ne,_e=Math.cos(Q),Je=Math.sin(Q),[[$e,Ze],[ht,at]]=[D,N].map(yr=>[yr-yr*le,yr*ne]),mt=p+I*(b-ie)+$e+at+U*_e,Bt=mt+ie,Zt=Bt-T*_e,Qt=Zt-ie,Gt=g+U-I*me-Ze+ht+U*Je,hi=Gt+me,oi=hi-T*Je,ji=oi-me,_i=Math.min(mt,Bt,Zt,Qt),Di=Math.min(Gt,hi,oi,ji),lr=Math.max(mt,Bt,Zt,Qt)-_i,Bi=Math.max(Gt,hi,oi,ji)-Di;return{x:_i,y:Di,width:lr,height:Bi,polygon:[[mt,Gt],[Bt,hi],[Zt,oi],[Qt,ji]]}}getStyle(s){return Bu.getComputedStyle(this.element||this,"").getPropertyValue(s)}hasClass(s){return(""+this.attr("class")).split(" ").indexOf(s)!==-1}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(s,u){this.onEvents={},this.opacity=1,this.SVG_NS=Il,this.element=u==="span"||u==="body"?Bn(u):Ui.createElementNS(this.SVG_NS,u),this.renderer=s,this.styles={},Gi(this,"afterInit")}on(s,u){let{onEvents:p}=this;return p[s]&&p[s](),p[s]=an(this.element,s,u),this}opacitySetter(s,u,p){let g=Number(Number(s).toFixed(3));this.opacity=g,p.setAttribute(u,g)}reAlign(){var s;(s=this.alignOptions)!=null&&s.width&&this.alignOptions.align!=="left"&&(this.alignOptions.width=this.getBBox().width,this.placed=!1,this.align())}removeClass(s){return this.attr("class",(""+this.attr("class")).replace(ha(s)?RegExp(`(^| )${s}( |$)`):s," ").replace(/ +/g," ").trim())}removeTextOutline(){let s=this.element.querySelector("tspan.highcharts-text-outline");s&&this.safeRemoveChild(s)}safeRemoveChild(s){let u=s.parentNode;u&&u.removeChild(s)}setRadialReference(s){let u=this.element.gradient&&this.renderer.gradients[this.element.gradient]||void 0;return this.element.radialReference=s,u!=null&&u.radAttr&&u.animate(this.renderer.getRadialAttr(s,u.radAttr)),this}shadow(s){var b;let{renderer:u}=this,p=Nu(((b=this.parentGroup)==null?void 0:b.rotation)===90?{offsetX:-1,offsetY:-1}:{},tl(s)?s:{}),g=u.shadowDefinition(p);return this.attr({filter:s?`url(${u.url}#${g})`:"none"})}show(s=!0){return this.attr({visibility:s?"inherit":"visible"})}"stroke-widthSetter"(s,u,p){this[u]=s,p.setAttribute(u,s)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let s=this.getStyle("stroke-width"),u=0,p;return/px$/.test(s)?u=il(s):s!==""&&(Jr(p=Ui.createElementNS(Il,"rect"),{width:s,"stroke-width":0}),this.element.parentNode.appendChild(p),u=p.getBBox().width,p.parentNode.removeChild(p)),u}symbolAttr(s){let u=this;sn.symbolCustomAttribs.forEach(function(p){u[p]=zs(s[p],u[p])}),u.attr({d:u.renderer.symbols[u.symbolName](u.x,u.y,u.width,u.height,u)})}textSetter(s){s!==this.textStr&&(delete this.textPxLength,this.textStr=s,this.added&&this.renderer.buildText(this),this.reAlign())}titleSetter(s){let u=this.element,p=u.getElementsByTagName("title")[0]||Ui.createElementNS(this.SVG_NS,"title");u.insertBefore?u.insertBefore(p,u.firstChild):u.appendChild(p),p.textContent=tu(zs(s,""),[/<[^>]*>/g,""]).replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let s=this.element;return s.parentNode.appendChild(s),this}translate(s,u){return this.attr({translateX:s,translateY:u})}updateTransform(s="transform"){let{element:u,foreignObject:p,matrix:g,padding:b,rotation:T=0,rotationOriginX:C,rotationOriginY:E,scaleX:D,scaleY:N,text:I,translateX:U=0,translateY:X=0}=this,Q=["translate("+U+","+X+")"];Vi(g)&&Q.push("matrix("+g.join(",")+")"),T&&(Q.push("rotate("+T+" "+(C??u.getAttribute("x")??this.x??0)+" "+(E??u.getAttribute("y")??this.y??0)+")"),(I==null?void 0:I.element.tagName)!=="SPAN"||I!=null&&I.foreignObject||I.attr({rotation:T,rotationOriginX:(C||0)-b,rotationOriginY:(E||0)-b})),(Vi(D)||Vi(N))&&Q.push("scale("+zs(D,1)+" "+zs(N,1)+")"),Q.length&&!(I||this).textPath&&((p==null?void 0:p.element)||u).setAttribute(s,Q.join(" "))}visibilitySetter(s,u,p){s==="inherit"?p.removeAttribute(u):this[u]!==s&&p.setAttribute(u,s),this[u]=s}xGetter(s){return this.element.nodeName==="circle"&&(s==="x"?s="cx":s==="y"&&(s="cy")),this._defaultGetter(s)}zIndexSetter(s,u){let p=this.renderer,g=this.parentGroup,b=(g||p).element||p.box,T=this.element,C=b===p.box,E,D,N,I=!1,U,X=this.added,Q;if(Vi(s)?(T.setAttribute("data-z-index",s),s*=1,this[u]===s&&(X=!1)):Vi(this[u])&&T.removeAttribute("data-z-index"),this[u]=s,X){for((s=this.zIndex)&&g&&(g.handleZ=!0),Q=(E=b.childNodes).length-1;Q>=0&&!I;Q--)U=!Vi(N=(D=E[Q]).getAttribute("data-z-index")),D!==T&&(s<0&&U&&!C&&!Q?(b.insertBefore(T,E[Q]),I=!0):(il(N)<=s||U&&(!Vi(s)||s>=0))&&(b.insertBefore(T,E[Q+1]),I=!0));I||(b.insertBefore(T,E[3*!!C]),I=!0)}return I}}sn.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],sn.prototype.strokeSetter=sn.prototype.fillSetter,sn.prototype.yGetter=sn.prototype.xGetter,sn.prototype.matrixSetter=sn.prototype.rotationOriginXSetter=sn.prototype.rotationOriginYSetter=sn.prototype.rotationSetter=sn.prototype.scaleXSetter=sn.prototype.scaleYSetter=sn.prototype.translateXSetter=sn.prototype.translateYSetter=sn.prototype.verticalAlignSetter=function(R,s){this[s]=R,this.doTransform=!0};let Ta=sn,{defined:yc,extend:Nn,getAlignFactor:iu,isNumber:Ro,merge:ru,pick:Fu,removeEvent:rl}=li;class Qs extends Ta{constructor(s,u,p,g,b,T,C,E,D,N){let I;super(s,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.doUpdate=!1,this.textStr=u,this.x=p,this.y=g,this.anchorX=T,this.anchorY=C,this.baseline=D,this.className=N,this.addClass(N==="button"?"highcharts-no-tooltip":"highcharts-label"),N&&this.addClass("highcharts-"+N),this.text=s.text(void 0,0,0,E).attr({zIndex:1}),typeof b=="string"&&((I=/^url\((.*?)\)$/.test(b))||this.renderer.symbols[b])&&(this.symbolKey=b),this.bBox=Qs.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=s.styledMode||I,this.deferredAttr={},this.alignFactor=0}alignSetter(s){let u=iu(s);this.textAlign=s,u!==this.alignFactor&&(this.alignFactor=u,this.bBox&&Ro(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(s,u){this.anchorX=s,this.boxAttr(u,Math.round(s)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(s,u){this.anchorY=s,this.boxAttr(u,s-this.ySetting)}boxAttr(s,u){this.box?this.box.attr(s,u):this.deferredAttr[s]=u}css(s){if(s){let u={};s=ru(s),Qs.textProps.forEach(p=>{s[p]!==void 0&&(u[p]=s[p],delete s[p])}),this.text.css(u),"fontSize"in u||"fontWeight"in u?this.updateTextPadding():("width"in u||"textOverflow"in u)&&this.updateBoxSize()}return Ta.prototype.css.call(this,s)}destroy(){rl(this.element,"mouseenter"),rl(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),Ta.prototype.destroy.call(this)}fillSetter(s,u){s&&(this.needsBox=!0),this.fill=s,this.boxAttr(u,s)}getBBox(s,u){this.textStr&&this.bBox.width===0&&this.bBox.height===0&&this.updateBoxSize();let{padding:p,height:g=0,translateX:b=0,translateY:T=0,width:C=0}=this,E=Fu(this.paddingLeft,p),D=u??(this.rotation||0),N={width:C,height:g,x:b+this.bBox.x-E,y:T+this.bBox.y-p+this.baselineOffset};return D&&(N=this.getRotatedBox(N,D)),N}getCrispAdjust(){return(this.renderer.styledMode&&this.box?this.box.strokeWidth():this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(s){this.heightSetting=s,this.doUpdate=!0}afterSetters(){super.afterSetters(),this.doUpdate&&(this.updateBoxSize(),this.doUpdate=!1)}onAdd(){this.text.add(this),this.attr({text:Fu(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&yc(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(s,u){Ro(s)?s!==this[u]&&(this[u]=s,this.updateTextPadding()):this[u]=void 0}rSetter(s,u){this.boxAttr(u,s)}strokeSetter(s,u){this.stroke=s,this.boxAttr(u,s)}"stroke-widthSetter"(s,u){s&&(this.needsBox=!0),this["stroke-width"]=s,this.boxAttr(u,s)}"text-alignSetter"(s){this.textAlign=this["text-align"]=s,this.updateTextPadding()}textSetter(s){s!==void 0&&this.text.attr({text:s}),this.updateTextPadding(),this.reAlign()}updateBoxSize(){let s,u=this.text,p={},g=this.padding,b=this.bBox=(!Ro(this.widthSetting)||!Ro(this.heightSetting)||this.textAlign)&&yc(u.textStr)?u.getBBox(void 0,0):Qs.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||b.height||0)+2*g;let T=this.renderer.fontMetrics(u);if(this.baselineOffset=g+Math.min((this.text.firstLineMetrics||T).b,b.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-T.h)/2),this.needsBox&&!u.textPath){if(!this.box){let C=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();C.addClass((this.className==="button"?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),C.add(this)}p.x=s=this.getCrispAdjust(),p.y=(this.baseline?-this.baselineOffset:0)+s,p.width=Math.round(this.width),p.height=Math.round(this.height),this.box.attr(Nn(p,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let s=this.text,u=s.styles.textAlign||this.textAlign;if(!s.textPath){this.updateBoxSize();let p=this.baseline?0:this.baselineOffset,g=(this.paddingLeft??this.padding)+iu(u)*(this.widthSetting??this.bBox.width);(g!==s.x||p!==s.y)&&(s.attr({align:u,x:g}),p!==void 0&&s.attr("y",p)),s.x=g,s.y=p}}widthSetter(s){this.widthSetting=Ro(s)?s:void 0,this.doUpdate=!0}getPaddedWidth(){let s=this.padding,u=Fu(this.paddingLeft,s),p=Fu(this.paddingRight,s);return(this.widthSetting||this.bBox.width||0)+u+p}xSetter(s){this.x=s,this.alignFactor&&(s-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(s),this.attr("translateX",this.xSetting)}ySetter(s){this.ySetting=this.y=Math.round(s),this.attr("translateY",this.ySetting)}}Qs.emptyBBox={width:0,height:0,x:0,y:0},Qs.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineClamp","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"];let{defined:Ah,isNumber:ef,pick:kn}=li;function _c(R,s,u,p,g){let b=[];if(g){let T=g.start||0,C=g.end||0,E=kn(g.r,u),D=kn(g.r,p||u),N=2e-4/(g.borderRadius?1:Math.max(E,1)),I=Math.abs(C-T-2*Math.PI)<N;I&&(T=Math.PI/2,C=2.5*Math.PI-N);let U=g.innerR,X=kn(g.open,I),Q=Math.cos(T),le=Math.sin(T),ne=Math.cos(C),ie=Math.sin(C),me=kn(g.longArc,C-T-Math.PI<N?0:1),_e=["A",E,D,0,me,kn(g.clockwise,1),R+E*ne,s+D*ie];_e.params={start:T,end:C,cx:R,cy:s},b.push(["M",R+E*Q,s+D*le],_e),Ah(U)&&((_e=["A",U,U,0,me,Ah(g.clockwise)?1-g.clockwise:0,R+U*Q,s+U*le]).params={start:C,end:T,cx:R,cy:s},b.push(X?["M",R+U*ne,s+U*ie]:["L",R+U*ne,s+U*ie],_e)),X||b.push(["Z"])}return b}function ts(R,s,u,p,g){return g!=null&&g.r?Ma(R,s,u,p,g):[["M",R,s],["L",R+u,s],["L",R+u,s+p],["L",R,s+p],["Z"]]}function Ma(R,s,u,p,g){let b=(g==null?void 0:g.r)||0;return[["M",R+b,s],["L",R+u-b,s],["A",b,b,0,0,1,R+u,s+b],["L",R+u,s+p-b],["A",b,b,0,0,1,R+u-b,s+p],["L",R+b,s+p],["A",b,b,0,0,1,R,s+p-b],["L",R,s+b],["A",b,b,0,0,1,R+b,s],["Z"]]}let Uu={arc:_c,callout:function(R,s,u,p,g){let b=Math.min((g==null?void 0:g.r)||0,u,p),T=b+6,C=g==null?void 0:g.anchorX,E=(g==null?void 0:g.anchorY)||0,D=Ma(R,s,u,p,{r:b});if(!ef(C)||C<u&&C>0&&E<p&&E>0)return D;if(R+C>u-T)if(E>s+T&&E<s+p-T)D.splice(3,1,["L",R+u,E-6],["L",R+u+6,E],["L",R+u,E+6],["L",R+u,s+p-b]);else if(C<u){let N=E<s+T,I=N?s:s+p;D.splice(N?2:5,0,["L",C,E],["L",R+u-b,I])}else D.splice(3,1,["L",R+u,p/2],["L",C,E],["L",R+u,p/2],["L",R+u,s+p-b]);else if(R+C<T)if(E>s+T&&E<s+p-T)D.splice(7,1,["L",R,E+6],["L",R-6,E],["L",R,E-6],["L",R,s+b]);else if(C>0){let N=E<s+T,I=N?s:s+p;D.splice(N?1:6,0,["L",C,E],["L",R+b,I])}else D.splice(7,1,["L",R,p/2],["L",C,E],["L",R,p/2],["L",R,s+b]);else E>p&&C<u-T?D.splice(5,1,["L",C+6,s+p],["L",C,s+p+6],["L",C-6,s+p],["L",R+b,s+p]):E<0&&C>T&&D.splice(1,1,["L",C-6,s],["L",C,s-6],["L",C+6,s],["L",u-b,s]);return D},circle:function(R,s,u,p){return _c(R+u/2,s+p/2,u/2,p/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(R,s,u,p){return[["M",R+u/2,s],["L",R+u,s+p/2],["L",R+u/2,s+p],["L",R,s+p/2],["Z"]]},rect:ts,roundedRect:Ma,square:ts,triangle:function(R,s,u,p){return[["M",R+u/2,s],["L",R+u,s+p],["L",R,s+p],["Z"]]},"triangle-down":function(R,s,u,p){return[["M",R,s],["L",R+u,s],["L",R+u/2,s+p],["Z"]]}},{doc:xc,SVG_NS:nu,win:Eh}=Ue,{attr:bd,extend:tf,fireEvent:rf,isString:nf,objectEach:kh,pick:Ph}=li,jl=(R,s)=>R.substring(0,s)+"…",nl=class{constructor(R){let s=R.styles;this.renderer=R.renderer,this.svgElement=R,this.width=R.textWidth,this.textLineHeight=s==null?void 0:s.lineHeight,this.textOutline=s==null?void 0:s.textOutline,this.ellipsis=(s==null?void 0:s.textOverflow)==="ellipsis",this.lineClamp=s==null?void 0:s.lineClamp,this.noWrap=(s==null?void 0:s.whiteSpace)==="nowrap"}buildSVG(){let R=this.svgElement,s=R.element,u=R.renderer,p=Ph(R.textStr,"").toString(),g=p.indexOf("<")!==-1,b=s.childNodes,T=!R.added&&u.box,C=[p,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,R.getStyle("font-size"),R.styles.lineClamp,this.width].join(",");if(C!==R.textCache){R.textCache=C,delete R.actualWidth;for(let E=b.length;E--;)s.removeChild(b[E]);if(g||this.ellipsis||this.width||R.textPath||p.indexOf(" ")!==-1&&(!this.noWrap||/<br.*?>/g.test(p))){if(p!==""){T&&T.appendChild(s);let E=new Er(p);this.modifyTree(E.nodes),E.addToDOM(s),this.modifyDOM(),this.ellipsis&&(s.textContent||"").indexOf("…")!==-1&&R.attr("title",this.unescapeEntities(R.textStr||"",["&lt;","&gt;"])),T&&T.removeChild(s)}}else s.appendChild(xc.createTextNode(this.unescapeEntities(p)));nf(this.textOutline)&&R.applyTextOutline&&R.applyTextOutline(this.textOutline)}}modifyDOM(){let R,s=this.svgElement,u=bd(s.element,"x");for(s.firstLineMetrics=void 0;(R=s.element.firstChild)&&/^[\s\u200B]*$/.test(R.textContent||" ");)s.element.removeChild(R);[].forEach.call(s.element.querySelectorAll("tspan.highcharts-br"),(T,C)=>{T.nextSibling&&T.previousSibling&&(C===0&&T.previousSibling.nodeType===1&&(s.firstLineMetrics=s.renderer.fontMetrics(T.previousSibling)),bd(T,{dy:this.getLineHeight(T.nextSibling),x:u}))});let p=this.width||0;if(!p)return;let g=(T,C)=>{var le;let E=T.textContent||"",D=E.replace(/([^\^])-/g,"$1- ").split(" "),N=!this.noWrap&&(D.length>1||s.element.childNodes.length>1),I=this.getLineHeight(C),U=Math.max(0,p-.8*I),X=0,Q=s.actualWidth;if(N){let ne=[],ie=[];for(;C.firstChild&&C.firstChild!==T;)ie.push(C.firstChild),C.removeChild(C.firstChild);for(;D.length;)if(D.length&&!this.noWrap&&X>0&&(ne.push(T.textContent||""),T.textContent=D.join(" ").replace(/- /g,"-")),this.truncate(T,void 0,D,X===0&&Q||0,p,U,(me,_e)=>D.slice(0,_e).join(" ").replace(/- /g,"-")),Q=s.actualWidth,X++,this.lineClamp&&X>=this.lineClamp){D.length&&(this.truncate(T,T.textContent||"",void 0,0,p,U,jl),T.textContent=((le=T.textContent)==null?void 0:le.replace("…",""))+"…");break}ie.forEach(me=>{C.insertBefore(me,T)}),ne.forEach(me=>{C.insertBefore(xc.createTextNode(me),T);let _e=xc.createElementNS(nu,"tspan");_e.textContent="​",bd(_e,{dy:I,x:u}),C.insertBefore(_e,T)})}else this.ellipsis&&E&&this.truncate(T,E,void 0,0,p,U,jl)},b=T=>{[].slice.call(T.childNodes).forEach(C=>{C.nodeType===Eh.Node.TEXT_NODE?g(C,T):(C.className.baseVal.indexOf("highcharts-br")!==-1&&(s.actualWidth=0),b(C))})};b(s.element)}getLineHeight(R){let s=R.nodeType===Eh.Node.TEXT_NODE?R.parentElement:R;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(s||this.svgElement.element).h}modifyTree(R){let s=(u,p)=>{let{attributes:g={},children:b,style:T={},tagName:C}=u,E=this.renderer.styledMode;if(C==="b"||C==="strong"?E?g.class="highcharts-strong":T.fontWeight="bold":(C==="i"||C==="em")&&(E?g.class="highcharts-emphasized":T.fontStyle="italic"),T!=null&&T.color&&(T.fill=T.color),C==="br"){g.class="highcharts-br",u.textContent="​";let D=R[p+1];D!=null&&D.textContent&&(D.textContent=D.textContent.replace(/^ +/gm,""))}else C==="a"&&b&&b.some(D=>D.tagName==="#text")&&(u.children=[{children:b,tagName:"tspan"}]);C!=="#text"&&C!=="a"&&(u.tagName="tspan"),tf(u,{attributes:g,style:T}),b&&b.filter(D=>D.tagName!=="#text").forEach(s)};R.forEach(s),rf(this.svgElement,"afterModifyTree",{nodes:R})}truncate(R,s,u,p,g,b,T){let C,E,D=this.svgElement,{rotation:N}=D,I=[],U=u&&!p?1:0,X=(s||u||"").length,Q=X;u||(g=b);let le=function(ne,ie){let me=ie||ne,_e=R.parentNode;if(_e&&I[me]===void 0&&_e.getSubStringLength)try{I[me]=p+_e.getSubStringLength(0,u?me+1:me)}catch{}return I[me]};if(D.rotation=0,p+(E=le(R.textContent.length))>g){for(;U<=X;)Q=Math.ceil((U+X)/2),u&&(C=T(u,Q)),E=le(Q,C&&C.length-1),U===X?U=X+1:E>g?X=Q-1:U=Q;X===0?R.textContent="":s&&X===s.length-1||(R.textContent=C||T(s||u,Q)),this.ellipsis&&E>g&&this.truncate(R,R.textContent||"",void 0,0,g,b,jl)}u&&u.splice(0,Q),D.actualWidth=E,D.rotation=N}unescapeEntities(R,s){return kh(this.renderer.escapes,function(u,p){s&&s.indexOf(u)!==-1||(R=R.toString().replace(RegExp(u,"g"),p))}),R}},{defaultOptions:wd}=tt,{charts:Vu,deg2rad:Ls,doc:vc,isFirefox:Gu,isMS:bc,isWebKit:Io,noop:_p,SVG_NS:$u,symbolSizes:zh,win:al}=Ue,{addEvent:Hu,attr:sl,createElement:Zu,crisp:qu,css:ol,defined:ll,destroyObjectProperties:Sd,extend:Js,isArray:Xu,isNumber:gs,isObject:wc,isString:Lh,merge:Bl,pick:Td,pInt:Dh,replaceNested:af,uniqueKey:xp}=li;class pa{constructor(s,u,p,g,b,T,C){let E,D;this.x=0,this.y=0;let N=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),I=N.element;C||N.css(this.getStyle(g||{})),s.appendChild(I),sl(s,"dir","ltr"),s.innerHTML.indexOf("xmlns")===-1&&sl(I,"xmlns",this.SVG_NS),this.box=I,this.boxWrapper=N,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(vc.createTextNode("Created with Highcharts 12.2.0")),this.defs=this.createElement("defs").add(),this.allowHTML=T,this.forExport=b,this.styledMode=C,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=N.getStyle("font-size"),this.setSize(u,p,!1),Gu&&s.getBoundingClientRect&&((E=function(){ol(s,{left:0,top:0}),D=s.getBoundingClientRect(),ol(s,{left:Math.ceil(D.left)-D.left+"px",top:Math.ceil(D.top)-D.top+"px"})})(),this.unSubPixelFix=Hu(al,"resize",E))}definition(s){return new Er([s]).addToDOM(this.defs.element)}getReferenceURL(){if((Gu||Io)&&vc.getElementsByTagName("base").length){if(!ll($)){let s=xp(),u=new Er([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:s},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${s})`,fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(vc.body);ol(u,{position:"fixed",top:0,left:0,zIndex:9e5});let p=vc.elementFromPoint(6,6);$=(p==null?void 0:p.id)==="hitme",vc.body.removeChild(u)}if($)return af(al.location.href.split("#")[0],[/<[^>]*>/g,""],[/([\('\)])/g,"\\$1"],[/ /g,"%20"])}return""}getStyle(s){return this.style=Js({fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif',fontSize:"1rem"},s),this.style}setStyle(s){this.boxWrapper.css(this.getStyle(s))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let s=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),Sd(this.gradients||{}),this.gradients=null,this.defs=s.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(s){return new this.Element(this,s)}getRadialAttr(s,u){return{cx:s[0]-s[2]/2+(u.cx||0)*s[2],cy:s[1]-s[2]/2+(u.cy||0)*s[2],r:(u.r||0)*s[2]}}shadowDefinition(s){let u=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(s).map(g=>`${g}-${s[g]}`)].join("-").toLowerCase().replace(/[^a-z\d\-]/g,""),p=Bl({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},s);return this.defs.element.querySelector(`#${u}`)||this.definition({tagName:"filter",attributes:{id:u,filterUnits:p.filterUnits},children:this.getShadowFilterContent(p)}),u}getShadowFilterContent(s){return[{tagName:"feDropShadow",attributes:{dx:s.offsetX,dy:s.offsetY,"flood-color":s.color,"flood-opacity":Math.min(5*s.opacity,1),stdDeviation:s.width/2}}]}buildText(s){new nl(s).buildSVG()}getContrast(s){let u=ai.parse(s).rgba,p=" clamp(0,calc(9e9*(0.5 - (0.2126*r + 0.7152*g + 0.0722*b))),1)";if(gs(u[0])||!ai.useColorMix){let g=u.map(T=>{let C=T/255;return C<=.04?C/12.92:Math.pow((C+.055)/1.055,2.4)}),b=.2126*g[0]+.7152*g[1]+.0722*g[2];return 1.05/(b+.05)>(b+.05)/.05?"#FFFFFF":"#000000"}return"color(from "+s+" srgb"+p+p+p+")"}button(s,u,p,g,b={},T,C,E,D,N){let I=this.label(s,u,p,D,void 0,void 0,N,void 0,"button"),U=this.styledMode,X=arguments,Q=0;b=Bl(wd.global.buttonTheme,b),U&&(delete b.fill,delete b.stroke,delete b["stroke-width"]);let le=b.states||{},ne=b.style||{};delete b.states,delete b.style;let ie=[Er.filterUserAttributes(b)],me=[ne];return U||["hover","select","disabled"].forEach((_e,Je)=>{ie.push(Bl(ie[0],Er.filterUserAttributes(X[Je+5]||le[_e]||{}))),me.push(ie[Je+1].style),delete ie[Je+1].style}),Hu(I.element,bc?"mouseover":"mouseenter",function(){Q!==3&&I.setState(1)}),Hu(I.element,bc?"mouseout":"mouseleave",function(){Q!==3&&I.setState(Q)}),I.setState=(_e=0)=>{if(_e!==1&&(I.state=Q=_e),I.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][_e]),!U){I.attr(ie[_e]);let Je=me[_e];wc(Je)&&I.css(Je)}},I.attr(ie[0]),!U&&(I.css(Js({cursor:"default"},ne)),N&&I.text.css({pointerEvents:"none"})),I.on("touchstart",_e=>_e.stopPropagation()).on("click",function(_e){Q!==3&&(g==null||g.call(I,_e))})}crispLine(s,u){let[p,g]=s;return ll(p[1])&&p[1]===g[1]&&(p[1]=g[1]=qu(p[1],u)),ll(p[2])&&p[2]===g[2]&&(p[2]=g[2]=qu(p[2],u)),s}path(s){let u=this.styledMode?{}:{fill:"none"};return Xu(s)?u.d=s:wc(s)&&Js(u,s),this.createElement("path").attr(u)}circle(s,u,p){let g=wc(s)?s:s===void 0?{}:{x:s,y:u,r:p},b=this.createElement("circle");return b.xSetter=b.ySetter=function(T,C,E){E.setAttribute("c"+C,T)},b.attr(g)}arc(s,u,p,g,b,T){let C;wc(s)?(u=(C=s).y,p=C.r,g=C.innerR,b=C.start,T=C.end,s=C.x):C={innerR:g,start:b,end:T};let E=this.symbol("arc",s,u,p,p,C);return E.r=p,E}rect(s,u,p,g,b,T){let C=wc(s)?s:s===void 0?{}:{x:s,y:u,r:b,width:Math.max(p||0,0),height:Math.max(g||0,0)},E=this.createElement("rect");return this.styledMode||(T!==void 0&&(C["stroke-width"]=T,Js(C,E.crisp(C))),C.fill="none"),E.rSetter=function(D,N,I){E.r=D,sl(I,{rx:D,ry:D})},E.rGetter=function(){return E.r||0},E.attr(C)}roundedRect(s){return this.symbol("roundedRect").attr(s)}setSize(s,u,p){this.width=s,this.height=u,this.boxWrapper.animate({width:s,height:u},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:Td(p,!0)?void 0:0}),this.alignElements()}g(s){let u=this.createElement("g");return s?u.attr({class:"highcharts-"+s}):u}image(s,u,p,g,b,T){let C={preserveAspectRatio:"none"};gs(u)&&(C.x=u),gs(p)&&(C.y=p),gs(g)&&(C.width=g),gs(b)&&(C.height=b);let E=this.createElement("image").attr(C),D=function(N){E.attr({href:s}),T.call(E,N)};if(T){E.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let N=new al.Image;Hu(N,"load",D),N.src=s,N.complete&&D({})}else E.attr({href:s});return E}symbol(s,u,p,g,b,T){var ne,ie;let C,E,D,N,I=this,U=/^url\((.*?)\)$/,X=U.test(s),Q=!X&&(this.symbols[s]?s:"circle"),le=Q&&this.symbols[Q];if(le)typeof u=="number"&&(E=le.call(this.symbols,u||0,p||0,g||0,b||0,T)),C=this.path(E),I.styledMode||C.attr("fill","none"),Js(C,{symbolName:Q||void 0,x:u,y:p,width:g,height:b}),T&&Js(C,T);else if(X){D=s.match(U)[1];let me=C=this.image(D);me.imgwidth=Td(T==null?void 0:T.width,(ne=zh[D])==null?void 0:ne.width),me.imgheight=Td(T==null?void 0:T.height,(ie=zh[D])==null?void 0:ie.height),N=_e=>_e.attr({width:_e.width,height:_e.height}),["width","height"].forEach(_e=>{me[`${_e}Setter`]=function(Je,$e){this[$e]=Je;let{alignByTranslate:Ze,element:ht,width:at,height:mt,imgwidth:Bt,imgheight:Zt}=this,Qt=$e==="width"?Bt:Zt,Gt=1;T&&T.backgroundSize==="within"&&at&&mt&&Bt&&Zt?(Gt=Math.min(at/Bt,mt/Zt),sl(ht,{width:Math.round(Bt*Gt),height:Math.round(Zt*Gt)})):ht&&Qt&&ht.setAttribute($e,Qt),!Ze&&Bt&&Zt&&this.translate(((at||0)-Bt*Gt)/2,((mt||0)-Zt*Gt)/2)}}),ll(u)&&me.attr({x:u,y:p}),me.isImg=!0,me.symbolUrl=s,ll(me.imgwidth)&&ll(me.imgheight)?N(me):(me.attr({width:0,height:0}),Zu("img",{onload:function(){let _e=Vu[I.chartIndex];this.width===0&&(ol(this,{position:"absolute",top:"-999em"}),vc.body.appendChild(this)),zh[D]={width:this.width,height:this.height},me.imgwidth=this.width,me.imgheight=this.height,me.element&&N(me),this.parentNode&&this.parentNode.removeChild(this),I.imgCount--,I.imgCount||!_e||_e.hasLoaded||_e.onload()},src:D}),this.imgCount++)}return C}clipRect(s,u,p,g){return this.rect(s,u,p,g,0)}text(s,u,p,g){let b={};if(g&&(this.allowHTML||!this.forExport))return this.html(s,u,p);b.x=Math.round(u||0),p&&(b.y=Math.round(p)),ll(s)&&(b.text=s);let T=this.createElement("text").attr(b);return g&&(!this.forExport||this.allowHTML)||(T.xSetter=function(C,E,D){let N=D.getElementsByTagName("tspan"),I=D.getAttribute(E);for(let U=0,X;U<N.length;U++)(X=N[U]).getAttribute(E)===I&&X.setAttribute(E,C);D.setAttribute(E,C)}),T}fontMetrics(s){let u=Dh(Ta.prototype.getStyle.call(s,"font-size")||0),p=u<24?u+3:Math.round(1.2*u),g=Math.round(.8*p);return{h:p,b:g,f:u}}rotCorr(s,u,p){let g=s;return u&&p&&(g=Math.max(g*Math.cos(u*Ls),4)),{x:-s/3*Math.sin(u*Ls),y:g}}pathToSegments(s){let u=[],p=[],g={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let b=0;b<s.length;b++)Lh(p[0])&&gs(s[b])&&p.length===g[p[0].toUpperCase()]&&s.splice(b,0,p[0].replace("M","L").replace("m","l")),typeof s[b]=="string"&&(p.length&&u.push(p.slice(0)),p.length=0),p.push(s[b]);return u.push(p.slice(0)),u}label(s,u,p,g,b,T,C,E,D){return new Qs(this,s,u,p,g,b,T,C,E,D)}alignElements(){this.alignedObjects.forEach(s=>s.align())}}Js(pa.prototype,{Element:Ta,SVG_NS:$u,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:Uu,draw:_p}),fs.registerRendererType("svg",pa,!0);let{composed:au,isFirefox:Md}=Ue,{attr:Rh,css:sr,createElement:Yu,defined:Ds,extend:Cd,getAlignFactor:Nl,isNumber:Fl,pInt:su,pushUnique:Wu}=li;function cl(R,s,u){var g;let p=((g=this.div)==null?void 0:g.style)||u.style;Ta.prototype[`${s}Setter`].call(this,R,s,u),p&&(p[s]=R)}let ul=(R,s)=>{var u;if(!R.div){let p=Rh(R.element,"class"),g=R.css,b=Yu("div",p?{className:p}:void 0,{position:"absolute",left:`${R.translateX||0}px`,top:`${R.translateY||0}px`,...R.styles,display:R.display,opacity:R.opacity,visibility:R.visibility},((u=R.parentGroup)==null?void 0:u.div)||s);R.classSetter=(T,C,E)=>{E.setAttribute("class",T),b.className=T},R.translateXSetter=R.translateYSetter=(T,C)=>{R[C]=T,b.style[C==="translateX"?"left":"top"]=`${T}px`,R.doTransform=!0},R.opacitySetter=R.visibilitySetter=cl,R.css=T=>(g.call(R,T),T.cursor&&(b.style.cursor=T.cursor),T.pointerEvents&&(b.style.pointerEvents=T.pointerEvents),R),R.on=function(){return Ta.prototype.on.apply({element:b,onEvents:R.onEvents},arguments),R},R.div=b}return R.div};class eo extends Ta{static compose(s){Wu(au,this.compose)&&(s.prototype.html=function(u,p,g){return new eo(this,"span").attr({text:u,x:Math.round(p),y:Math.round(g)})})}constructor(s,u){super(s,u),eo.useForeignObject?this.foreignObject=s.createElement("foreignObject").attr({zIndex:2}):this.css({position:"absolute",...s.styledMode?{}:{fontFamily:s.style.fontFamily,fontSize:s.style.fontSize}}),this.element.style.whiteSpace="nowrap"}getSpanCorrection(s,u,p){this.xCorr=-s*p,this.yCorr=-u}css(s){let u,{element:p}=this,g=p.tagName==="SPAN"&&s&&"width"in s,b=g&&s.width;return g&&(delete s.width,this.textWidth=su(b)||void 0,u=!0),(s==null?void 0:s.textOverflow)==="ellipsis"&&(s.overflow="hidden",s.whiteSpace="nowrap"),s!=null&&s.lineClamp&&(s.display="-webkit-box",s.WebkitLineClamp=s.lineClamp,s.WebkitBoxOrient="vertical",s.overflow="hidden"),Fl(Number(s==null?void 0:s.fontSize))&&(s.fontSize+="px"),Cd(this.styles,s),sr(p,s),u&&this.updateTransform(),this}htmlGetBBox(){let{element:s}=this;return{x:s.offsetLeft,y:s.offsetTop,width:s.offsetWidth,height:s.offsetHeight}}updateTransform(){var me;if(!this.added){this.alignOnAdd=!0;return}let{element:s,foreignObject:u,oldTextWidth:p,renderer:g,rotation:b,rotationOriginX:T,rotationOriginY:C,scaleX:E,scaleY:D,styles:{display:N="inline-block",whiteSpace:I},textAlign:U="left",textWidth:X,translateX:Q=0,translateY:le=0,x:ne=0,y:ie=0}=this;if(u||sr(s,{marginLeft:`${Q}px`,marginTop:`${le}px`}),s.tagName==="SPAN"){let _e,Je=[b,U,s.innerHTML,X,this.textAlign].join(","),$e=-(((me=this.parentGroup)==null?void 0:me.padding)*1)||0;if(X!==p){let mt=this.textPxLength?this.textPxLength:(sr(s,{width:"",whiteSpace:I||"nowrap"}),s.offsetWidth),Bt=X||0,Zt=s.style.textOverflow===""&&s.style.webkitLineClamp;(Bt>p||mt>Bt||Zt)&&(/[\-\s\u00AD]/.test(s.textContent||s.innerText)||s.style.textOverflow==="ellipsis")&&(sr(s,{width:(b||E||mt>Bt||Zt)&&Fl(X)?X+"px":"auto",display:N,whiteSpace:I||"normal"}),this.oldTextWidth=X)}u&&(sr(s,{display:"inline-block",verticalAlign:"top"}),u.attr({width:g.width,height:g.height})),Je!==this.cTT&&(_e=g.fontMetrics(s).b,Ds(b)&&!u&&(b!==(this.oldRotation||0)||U!==this.oldAlign)&&sr(s,{transform:`rotate(${b}deg)`,transformOrigin:`${$e}% ${$e}px`}),this.getSpanCorrection(!Ds(b)&&!this.textWidth&&this.textPxLength||s.offsetWidth,_e,Nl(U)));let{xCorr:Ze=0,yCorr:ht=0}=this,at={left:`${ne+Ze}px`,top:`${ie+ht}px`,textAlign:U,transformOrigin:`${(T??ne)-Ze-ne-$e}px ${(C??ie)-ht-ie-$e}px`};(E||D)&&(at.transform=`scale(${E??1},${D??1})`),u?(super.updateTransform(),Fl(ne)&&Fl(ie)?(u.attr({x:ne+Ze,y:ie+ht,width:s.offsetWidth+3,height:s.offsetHeight,"transform-origin":s.getAttribute("transform-origin")||"0 0"}),sr(s,{display:N,textAlign:U})):Md&&u.attr({width:0,height:0})):sr(s,at),this.cTT=Je,this.oldRotation=b,this.oldAlign=U}}add(s){let{foreignObject:u,renderer:p}=this,g=p.box.parentNode,b=[];if(u)u.add(s),super.add(p.createElement("body").attr({xmlns:"http://www.w3.org/1999/xhtml"}).css({background:"transparent",margin:"0 3px 0 0"}).add(u));else{let T;if(this.parentGroup=s,s&&!(T=s.div)){let C=s;for(;C;)b.push(C),C=C.parentGroup;for(let E of b.reverse())T=ul(E,g)}(T||g).appendChild(this.element)}return this.added=!0,this.alignOnAdd&&this.updateTransform(),this}textSetter(s){s!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,Er.setElementHTML(this.element,s??""),this.textStr=s,this.doTransform=!0)}alignSetter(s){this.alignValue=this.textAlign=s,this.doTransform=!0}xSetter(s,u){this[u]=s,this.doTransform=!0}}let hl=eo.prototype;hl.visibilitySetter=hl.opacitySetter=cl,hl.ySetter=hl.rotationSetter=hl.rotationOriginXSetter=hl.rotationOriginYSetter=hl.xSetter,function(R){R.xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%[HMSL]",range:!1},second:{main:"%[HMS]",range:!1},minute:{main:"%[HM]",range:!1},hour:{main:"%[HM]",range:!1},day:{main:"%[eb]"},week:{main:"%[eb]"},month:{main:"%[bY]"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em",textOverflow:"ellipsis"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},R.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:s}=this.axis.chart;return s(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0}}(h||(h={}));let vp=h,{addEvent:Sc,isFunction:Ad,objectEach:bp,removeEvent:Ed}=li;(oe||(oe={})).registerEventOptions=function(R,s){R.eventOptions=R.eventOptions||{},bp(s.events,function(u,p){R.eventOptions[p]!==u&&(R.eventOptions[p]&&(Ed(R,p,R.eventOptions[p]),delete R.eventOptions[p]),Ad(u)&&(R.eventOptions[p]=u,Sc(R,p,u,{order:0})))})};let Tc=oe,{deg2rad:ou}=Ue,{clamp:Ih,correctFloat:Mc,defined:Oo,destroyObjectProperties:Cc,extend:fa,fireEvent:ma,getAlignFactor:ys,isNumber:Ca,merge:Ul,objectEach:dl,pick:Aa}=li,Rs=class{constructor(R,s,u,p,g){this.isNew=!0,this.isNewLabel=!0,this.axis=R,this.pos=s,this.type=u||"",this.parameters=g||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,ma(this,"init"),u||p||this.addLabel()}addLabel(){var ht;let R=this,s=R.axis,u=s.options,p=s.chart,g=s.categories,b=s.logarithmic,T=s.names,C=R.pos,E=Aa((ht=R.options)==null?void 0:ht.labels,u.labels),D=s.tickPositions,N=C===D[0],I=C===D[D.length-1],U=(!E.step||E.step===1)&&s.tickInterval===1,X=D.info,Q=R.label,le,ne,ie,me=this.parameters.category||(g?Aa(g[C],T[C],C):C);b&&Ca(me)&&(me=Mc(b.lin2log(me))),s.dateTime&&(X?le=(ne=p.time.resolveDTLFormat(u.dateTimeLabelFormats[!u.grid&&X.higherRanks[C]||X.unitName])).main:Ca(me)&&(le=s.dateTime.getXDateFormat(me,u.dateTimeLabelFormats||{}))),R.isFirst=N,R.isLast=I;let _e={axis:s,chart:p,dateTimeLabelFormat:le,isFirst:N,isLast:I,pos:C,tick:R,tickPositionInfo:X,value:me};ma(this,"labelFormat",_e);let Je=at=>E.formatter?E.formatter.call(at,at):E.format?(at.text=s.defaultLabelFormatter.call(at),Sa.format(E.format,at,p)):s.defaultLabelFormatter.call(at),$e=Je.call(_e,_e),Ze=ne==null?void 0:ne.list;Ze?R.shortenLabel=function(){for(ie=0;ie<Ze.length;ie++)if(fa(_e,{dateTimeLabelFormat:Ze[ie]}),Q.attr({text:Je.call(_e,_e)}),Q.getBBox().width<s.getSlotWidth(R)-2*(E.padding||0))return;Q.attr({text:""})}:R.shortenLabel=void 0,U&&s._addedPlotLB&&R.moveLabel($e,E),Oo(Q)||R.movedLabel?Q&&Q.textStr!==$e&&!U&&(!Q.textWidth||E.style.width||Q.styles.width||Q.css({width:null}),Q.attr({text:$e}),Q.textPxLength=Q.getBBox().width):(R.label=Q=R.createLabel($e,E),R.rotation=0)}createLabel(R,s,u){let p=this.axis,{renderer:g,styledMode:b}=p.chart,T=s.style.whiteSpace,C=Oo(R)&&s.enabled?g.text(R,u==null?void 0:u.x,u==null?void 0:u.y,s.useHTML).add(p.labelGroup):void 0;return C&&(b||C.css(Ul(s.style)),C.textPxLength=C.getBBox().width,!b&&T&&C.css({whiteSpace:T})),C}destroy(){Cc(this,this.axis)}getPosition(R,s,u,p){let g=this.axis,b=g.chart,T=p&&b.oldChartHeight||b.chartHeight,C={x:R?Mc(g.translate(s+u,void 0,void 0,p)+g.transB):g.left+g.offset+(g.opposite?(p&&b.oldChartWidth||b.chartWidth)-g.right-g.left:0),y:R?T-g.bottom+g.offset-(g.opposite?g.height:0):Mc(T-g.translate(s+u,void 0,void 0,p)-g.transB)};return C.y=Ih(C.y,-1e9,1e9),ma(this,"afterGetPosition",{pos:C}),C}getLabelPosition(R,s,u,p,g,b,T,C){let E,D,N=this.axis,I=N.transA,U=N.isLinked&&N.linkedParent?N.linkedParent.reversed:N.reversed,X=N.staggerLines,Q=N.tickRotCorr||{x:0,y:0},le=p||N.reserveSpaceDefault?0:-N.labelOffset*(N.labelAlign==="center"?.5:1),ne=g.distance,ie={};return E=N.side===0?u.rotation?-ne:-u.getBBox().height:N.side===2?Q.y+ne:Math.cos(u.rotation*ou)*(Q.y-u.getBBox(!1,0).height/2),Oo(g.y)&&(E=N.side===0&&N.horiz?g.y+E:g.y),R=R+Aa(g.x,[0,1,0,-1][N.side]*ne)+le+Q.x-(b&&p?b*I*(U?-1:1):0),s=s+E-(b&&!p?b*I*(U?1:-1):0),X&&(D=T/(C||1)%X,N.opposite&&(D=X-D-1),s+=D*(N.labelOffset/X)),ie.x=R,ie.y=Math.round(s),ma(this,"afterGetLabelPosition",{pos:ie,tickmarkOffset:b,index:T}),ie}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(R,s,u,p,g=!1,b){return b.crispLine([["M",R,s],["L",R+(g?0:-u),s+(g?u:0)]],p)}handleOverflow(R){var ne;let s=this.axis,u=s.options.labels,p=R.x,g=s.chart.chartWidth,b=s.chart.spacing,T=Aa(s.labelLeft,Math.min(s.pos,b[3])),C=Aa(s.labelRight,Math.max(s.isRadial?0:s.pos+s.len,g-b[1])),E=this.label,D=this.rotation,N=ys(s.labelAlign||E.attr("align")),I=E.getBBox().width,U=s.getSlotWidth(this),X=U,Q=1,le;D||u.overflow!=="justify"?D<0&&p-N*I<T?le=Math.round(p/Math.cos(D*ou)-T):D>0&&p+N*I>C&&(le=Math.round((g-p)/Math.cos(D*ou))):(p-N*I<T?X=R.x+X*(1-N)-T:p+(1-N)*I>C&&(X=C-R.x+X*N,Q=-1),(X=Math.min(U,X))<U&&s.labelAlign==="center"&&(R.x+=Q*(U-X-N*(U-Math.min(I,X)))),(I>X||s.autoRotation&&((ne=E==null?void 0:E.styles)!=null&&ne.width))&&(le=X)),le&&E&&(this.shortenLabel?this.shortenLabel():E.css(fa({},{width:Math.floor(le)+"px",lineClamp:+!s.isRadial})))}moveLabel(R,s){let u=this,p=u.label,g=u.axis,b=!1,T;p&&p.textStr===R?(u.movedLabel=p,b=!0,delete u.label):dl(g.ticks,function(C){b||C.isNew||C===u||!C.label||C.label.textStr!==R||(u.movedLabel=C.label,b=!0,C.labelPos=u.movedLabel.xy,delete C.label)}),!b&&(u.labelPos||p)&&(T=u.labelPos||p.xy,u.movedLabel=u.createLabel(R,s,T),u.movedLabel&&u.movedLabel.attr({opacity:0}))}render(R,s,u){var Q;let p=this.axis,g=p.horiz,b=this.pos,T=Aa(this.tickmarkOffset,p.tickmarkOffset),C=this.getPosition(g,b,T,s),E=C.x,D=C.y,N=p.pos,I=N+p.len,U=g?E:D,X=Aa(u,(Q=this.label)==null?void 0:Q.newOpacity,1);!p.chart.polar&&(Mc(U)<N||U>I)&&(u=0),u??(u=1),this.isActive=!0,this.renderGridLine(s,u),this.renderMark(C,u),this.renderLabel(C,s,X,R),this.isNew=!1,ma(this,"afterRender")}renderGridLine(R,s){let u=this.axis,p=u.options,g={},b=this.pos,T=this.type,C=Aa(this.tickmarkOffset,u.tickmarkOffset),E=u.chart.renderer,D=this.gridLine,N,I=p.gridLineWidth,U=p.gridLineColor,X=p.gridLineDashStyle;this.type==="minor"&&(I=p.minorGridLineWidth,U=p.minorGridLineColor,X=p.minorGridLineDashStyle),D||(u.chart.styledMode||(g.stroke=U,g["stroke-width"]=I||0,g.dashstyle=X),T||(g.zIndex=1),R&&(s=0),this.gridLine=D=E.path().attr(g).addClass("highcharts-"+(T?T+"-":"")+"grid-line").add(u.gridGroup)),D&&(N=u.getPlotLinePath({value:b+C,lineWidth:D.strokeWidth(),force:"pass",old:R,acrossPanes:!1}))&&D[R||this.isNew?"attr":"animate"]({d:N,opacity:s})}renderMark(R,s){let u=this.axis,p=u.options,g=u.chart.renderer,b=this.type,T=u.tickSize(b?b+"Tick":"tick"),C=R.x,E=R.y,D=Aa(p[b!=="minor"?"tickWidth":"minorTickWidth"],!b&&u.isXAxis?1:0),N=p[b!=="minor"?"tickColor":"minorTickColor"],I=this.mark,U=!I;T&&(u.opposite&&(T[0]=-T[0]),I||(this.mark=I=g.path().addClass("highcharts-"+(b?b+"-":"")+"tick").add(u.axisGroup),u.chart.styledMode||I.attr({stroke:N,"stroke-width":D})),I[U?"attr":"animate"]({d:this.getMarkPath(C,E,T[0],I.strokeWidth(),u.horiz,g),opacity:s}))}renderLabel(R,s,u,p){let g=this.axis,b=g.horiz,T=g.options,C=this.label,E=T.labels,D=E.step,N=Aa(this.tickmarkOffset,g.tickmarkOffset),I=R.x,U=R.y,X=!0;C&&Ca(I)&&(C.xy=R=this.getLabelPosition(I,U,C,b,E,N,p,D),(!this.isFirst||this.isLast||T.showFirstLabel)&&(!this.isLast||this.isFirst||T.showLastLabel)?!b||E.step||E.rotation||s||u===0||this.handleOverflow(R):X=!1,D&&p%D&&(X=!1),X&&Ca(R.y)?(R.opacity=u,C[this.isNewLabel?"attr":"animate"](R).show(!0),this.isNewLabel=!1):(C.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let R=this.label,s=this.axis;R&&!this.isNew&&(R.animate({opacity:0},void 0,R.destroy),delete this.label),s.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}},{animObject:Ac}=Dr,{xAxis:Is,yAxis:kd}=vp,{defaultOptions:to}=tt,{registerEventOptions:io}=Tc,{deg2rad:Pd}=Ue,{arrayMax:Ea,arrayMin:ir,clamp:ga,correctFloat:qa,defined:Ar,destroyObjectProperties:ro,erase:Oh,error:Ku,extend:jo,fireEvent:Rr,getClosestDistance:Vl,insertItem:Ec,isArray:ka,isNumber:xi,isString:no,merge:is,normalizeTickInterval:_s,objectEach:Xa,pick:qi,relativeLength:Bo,removeEvent:Qu,splat:xn,syncTimeout:vn}=li,Mr=(R,s)=>_s(s,void 0,void 0,qi(R.options.allowDecimals,s<.5||R.tickAmount!==void 0),!!R.tickAmount);jo(to,{xAxis:Is,yAxis:is(Is,kd)});class Ya{constructor(s,u,p){this.init(s,u,p)}init(s,u,p=this.coll){let g=p==="xAxis",b=this.isZAxis||(s.inverted?!g:g);this.chart=s,this.horiz=b,this.isXAxis=g,this.coll=p,Rr(this,"init",{userOptions:u}),this.opposite=qi(u.opposite,this.opposite),this.side=qi(u.side,this.side,b?2*!this.opposite:this.opposite?1:3),this.setOptions(u);let T=this.options,C=T.labels;this.type??(this.type=T.type||"linear"),this.uniqueNames??(this.uniqueNames=T.uniqueNames??!0),Rr(this,"afterSetType"),this.userOptions=u,this.minPixelPadding=0,this.reversed=qi(T.reversed,this.reversed),this.visible=T.visible,this.zoomEnabled=T.zoomEnabled,this.hasNames=this.type==="category"||T.categories===!0,this.categories=ka(T.categories)&&T.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=Ar(T.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len??(this.len=0),this.minRange=this.userMinRange=T.minRange||T.maxZoom,this.range=T.range,this.offset=T.offset||0,this.max=void 0,this.min=void 0;let E=qi(T.crosshair,xn(s.options.tooltip.crosshairs)[+!g]);this.crosshair=E===!0?{}:E,s.axes.indexOf(this)===-1&&(g?s.axes.splice(s.xAxis.length,0,this):s.axes.push(this),Ec(this,s[this.coll])),s.orderItems(this.coll),this.series=this.series||[],s.inverted&&!this.isZAxis&&g&&!Ar(this.reversed)&&(this.reversed=!0),this.labelRotation=xi(C.rotation)?C.rotation:void 0,io(this,T),Rr(this,"afterInit")}setOptions(s){let u=this.horiz?{labels:{autoRotation:[-45],padding:3},margin:15}:{labels:{padding:1},title:{rotation:90*this.side}};this.options=is(u,this.coll==="yAxis"?{title:{text:this.chart.options.lang.yAxisTitle}}:{},to[this.coll],s),Rr(this,"afterSetOptions",{userOptions:s})}defaultLabelFormatter(){let s=this.axis,{numberFormatter:u}=this.chart,p=xi(this.value)?this.value:NaN,g=s.chart.time,b=s.categories,T=this.dateTimeLabelFormat,C=to.lang,E=C.numericSymbols,D=C.numericSymbolMagnitude||1e3,N=s.logarithmic?Math.abs(p):s.tickInterval,I=E==null?void 0:E.length,U,X;if(b)X=`${this.value}`;else if(T)X=g.dateFormat(T,p,!0);else if(I&&E&&N>=1e3)for(;I--&&X===void 0;)N>=(U=Math.pow(D,I+1))&&10*p%U==0&&E[I]!==null&&p!==0&&(X=u(p/U,-1)+E[I]);return X===void 0&&(X=Math.abs(p)>=1e4?u(p,-1):u(p,-1,void 0,"")),X}getSeriesExtremes(){let s,u=this;Rr(this,"getSeriesExtremes",null,function(){u.hasVisibleSeries=!1,u.dataMin=u.dataMax=u.threshold=void 0,u.softThreshold=!u.isXAxis,u.series.forEach(p=>{if(p.reserveSpace()){let g=p.options,b,T=g.threshold,C,E;if(u.hasVisibleSeries=!0,u.positiveValuesOnly&&0>=(T||0)&&(T=void 0),u.isXAxis)(b=p.getColumn("x")).length&&(b=u.logarithmic?b.filter(D=>D>0):b,C=(s=p.getXExtremes(b)).min,E=s.max,xi(C)||C instanceof Date||(b=b.filter(xi),C=(s=p.getXExtremes(b)).min,E=s.max),b.length&&(u.dataMin=Math.min(qi(u.dataMin,C),C),u.dataMax=Math.max(qi(u.dataMax,E),E)));else{let D=p.applyExtremes();xi(D.dataMin)&&(C=D.dataMin,u.dataMin=Math.min(qi(u.dataMin,C),C)),xi(D.dataMax)&&(E=D.dataMax,u.dataMax=Math.max(qi(u.dataMax,E),E)),Ar(T)&&(u.threshold=T),(!g.softThreshold||u.positiveValuesOnly)&&(u.softThreshold=!1)}}})}),Rr(this,"afterGetSeriesExtremes")}translate(s,u,p,g,b,T){var le;let C=this.linkedParent||this,E=g&&C.old?C.old.min:C.min;if(!xi(E))return NaN;let D=C.minPixelPadding,N=(C.isOrdinal||((le=C.brokenAxis)==null?void 0:le.hasBreaks)||C.logarithmic&&b)&&C.lin2val,I=1,U=0,X=g&&C.old?C.old.transA:C.transA,Q=0;return X||(X=C.transA),p&&(I*=-1,U=C.len),C.reversed&&(I*=-1,U-=I*(C.sector||C.len)),u?(Q=(s=s*I+U-D)/X+E,N&&(Q=C.lin2val(Q))):(N&&(s=C.val2lin(s)),Q=I*(s-E)*X+U+I*D+(xi(T)?X*T:0),C.isRadial||(Q=qa(Q))),Q}toPixels(s,u){var p;return this.translate(((p=this.chart)==null?void 0:p.time.parse(s))??NaN,!1,!this.horiz,void 0,!0)+(u?0:this.pos)}toValue(s,u){return this.translate(s-(u?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(s){let u=this,p=u.chart,g=u.left,b=u.top,T=s.old,C=s.value,E=s.lineWidth,D=T&&p.oldChartHeight||p.chartHeight,N=T&&p.oldChartWidth||p.chartWidth,I=u.transB,U=s.translatedValue,X=s.force,Q,le,ne,ie,me;function _e($e,Ze,ht){return X!=="pass"&&($e<Ze||$e>ht)&&(X?$e=ga($e,Ze,ht):me=!0),$e}let Je={value:C,lineWidth:E,old:T,force:X,acrossPanes:s.acrossPanes,translatedValue:U};return Rr(this,"getPlotLinePath",Je,function($e){Q=ne=(U=ga(U=qi(U,u.translate(C,void 0,void 0,T)),-1e9,1e9))+I,le=ie=D-U-I,xi(U)?u.horiz?(le=b,ie=D-u.bottom+(u.options.isInternal?0:p.scrollablePixelsY||0),Q=ne=_e(Q,g,g+u.width)):(Q=g,ne=N-u.right+(p.scrollablePixelsX||0),le=ie=_e(le,b,b+u.height)):(me=!0,X=!1),$e.path=me&&!X?void 0:p.renderer.crispLine([["M",Q,le],["L",ne,ie]],E||1)}),Je.path}getLinearTickPositions(s,u,p){let g,b,T,C=qa(Math.floor(u/s)*s),E=qa(Math.ceil(p/s)*s),D=[];if(qa(C+s)===C&&(T=20),this.single)return[u];for(g=C;g<=E&&(D.push(g),(g=qa(g+s,T))!==b);)b=g;return D}getMinorTickInterval(){let{minorTicks:s,minorTickInterval:u}=this.options;return s===!0?qi(u,"auto"):s!==!1?u:void 0}getMinorTickPositions(){var N;let s=this.options,u=this.tickPositions,p=this.minorTickInterval,g=this.pointRangePadding||0,b=(this.min||0)-g,T=(this.max||0)+g,C=(N=this.brokenAxis)!=null&&N.hasBreaks?this.brokenAxis.unitLength:T-b,E=[],D;if(C&&C/p<this.len/3){let I=this.logarithmic;if(I)this.paddedTicks.forEach(function(U,X,Q){X&&E.push.apply(E,I.getLogTickPositions(p,Q[X-1],Q[X],!0))});else if(this.dateTime&&this.getMinorTickInterval()==="auto")E=E.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(p),b,T,s.startOfWeek));else for(D=b+(u[0]-b)%p;D<=T&&D!==E[0];D+=p)E.push(D)}return E.length!==0&&this.trimTicks(E),E}adjustForMinRange(){let s=this.options,u=this.logarithmic,p=this.chart.time,{max:g,min:b,minRange:T}=this,C,E,D,N;this.isXAxis&&T===void 0&&!u&&(T=Ar(s.min)||Ar(s.max)||Ar(s.floor)||Ar(s.ceiling)?null:Math.min(5*(Vl(this.series.map(I=>{let U=I.getColumn("x");return I.xIncrement?U.slice(0,2):U}))||0),this.dataMax-this.dataMin)),xi(g)&&xi(b)&&xi(T)&&g-b<T&&(E=this.dataMax-this.dataMin>=T,C=(T-g+b)/2,D=[b-C,p.parse(s.min)??b-C],E&&(D[2]=u?u.log2lin(this.dataMin):this.dataMin),N=[(b=Ea(D))+T,p.parse(s.max)??b+T],E&&(N[2]=u?u.log2lin(this.dataMax):this.dataMax),(g=ir(N))-b<T&&(D[0]=g-T,D[1]=p.parse(s.min)??g-T,b=Ea(D))),this.minRange=T,this.min=b,this.max=g}getClosest(){let s,u;if(this.categories)u=1;else{let p=[];this.series.forEach(function(g){let b=g.closestPointRange,T=g.getColumn("x");T.length===1?p.push(T[0]):g.sorted&&Ar(b)&&g.reserveSpace()&&(u=Ar(u)?Math.min(u,b):b)}),p.length&&(p.sort((g,b)=>g-b),s=Vl([p]))}return s&&u?Math.min(s,u):s||u}nameToX(s){let u=ka(this.options.categories),p=u?this.categories:this.names,g=s.options.x,b;return s.series.requireSorting=!1,Ar(g)||(g=this.uniqueNames&&p?u?p.indexOf(s.name):qi(p.keys[s.name],-1):s.series.autoIncrement()),g===-1?!u&&p&&(b=p.length):xi(g)&&(b=g),b!==void 0?(this.names[b]=s.name,this.names.keys[s.name]=b):s.x&&(b=s.x),b}updateNames(){let s=this,u=this.names;u.length>0&&(Object.keys(u.keys).forEach(function(p){delete u.keys[p]}),u.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(p=>{p.xIncrement=null,(!p.points||p.isDirtyData)&&(s.max=Math.max(s.max||0,p.dataTable.rowCount-1),p.processData(),p.generatePoints());let g=p.getColumn("x").slice();p.data.forEach((b,T)=>{let C=g[T];b!=null&&b.options&&b.name!==void 0&&(C=s.nameToX(b))!==void 0&&C!==b.x&&(g[T]=b.x=C)}),p.dataTable.setColumn("x",g)}))}setAxisTranslation(){var U;let s=this,u=s.max-s.min,p=s.linkedParent,g=!!s.categories,b=s.isXAxis,T=s.axisPointRange||0,C,E=0,D=0,N,I=s.transA;(b||g||T)&&(C=s.getClosest(),p?(E=p.minPointOffset,D=p.pointRangePadding):s.series.forEach(function(X){let Q=g?1:b?qi(X.options.pointRange,C,0):s.axisPointRange||0,le=X.options.pointPlacement;if(T=Math.max(T,Q),!s.single||g){let ne=X.is("xrange")?!b:b;E=Math.max(E,ne&&no(le)?0:Q/2),D=Math.max(D,ne&&le==="on"?0:Q)}}),N=(U=s.ordinal)!=null&&U.slope&&C?s.ordinal.slope/C:1,s.minPointOffset=E*=N,s.pointRangePadding=D*=N,s.pointRange=Math.min(T,s.single&&g?1:u),b&&(s.closestPointRange=C)),s.translationSlope=s.transA=I=s.staticScale||s.len/(u+D||1),s.transB=s.horiz?s.left:s.bottom,s.minPixelPadding=I*E,Rr(this,"afterSetAxisTranslation")}minFromRange(){let{max:s,min:u}=this;return xi(s)&&xi(u)&&s-u||void 0}setTickInterval(s){var oi,ji,_i,Di;let{categories:u,chart:p,dataMax:g,dataMin:b,dateTime:T,isXAxis:C,logarithmic:E,options:D,softThreshold:N}=this,I=p.time,U=xi(this.threshold)?this.threshold:void 0,X=this.minRange||0,{ceiling:Q,floor:le,linkedTo:ne,softMax:ie,softMin:me}=D,_e=xi(ne)&&((oi=p[this.coll])==null?void 0:oi[ne]),Je=D.tickPixelInterval,$e=D.maxPadding,Ze=D.minPadding,ht=0,at,mt=xi(D.tickInterval)&&D.tickInterval>=0?D.tickInterval:void 0,Bt,Zt,Qt,Gt;if(T||u||_e||this.getTickAmount(),Qt=qi(this.userMin,I.parse(D.min)),Gt=qi(this.userMax,I.parse(D.max)),_e?(this.linkedParent=_e,at=_e.getExtremes(),this.min=qi(at.min,at.dataMin),this.max=qi(at.max,at.dataMax),this.type!==_e.type&&Ku(11,!0,p)):(N&&Ar(U)&&xi(g)&&xi(b)&&(b>=U?(Bt=U,Ze=0):g<=U&&(Zt=U,$e=0)),this.min=qi(Qt,Bt,b),this.max=qi(Gt,Zt,g)),xi(this.max)&&xi(this.min)&&(E&&(this.positiveValuesOnly&&!s&&0>=Math.min(this.min,qi(b,this.min))&&Ku(10,!0,p),this.min=qa(E.log2lin(this.min),16),this.max=qa(E.log2lin(this.max),16)),this.range&&xi(b)&&(this.userMin=this.min=Qt=Math.max(b,this.minFromRange()||0),this.userMax=Gt=this.max,this.range=void 0)),Rr(this,"foundExtremes"),this.adjustForMinRange(),xi(this.min)&&xi(this.max)){if(!xi(this.userMin)&&xi(me)&&me<this.min&&(this.min=Qt=me),!xi(this.userMax)&&xi(ie)&&ie>this.max&&(this.max=Gt=ie),u||this.axisPointRange||(ji=this.stacking)!=null&&ji.usePercentage||_e||!(ht=this.max-this.min)||(!Ar(Qt)&&Ze&&(this.min-=ht*Ze),Ar(Gt)||!$e||(this.max+=ht*$e)),!xi(this.userMin)&&xi(le)&&(this.min=Math.max(this.min,le)),!xi(this.userMax)&&xi(Q)&&(this.max=Math.min(this.max,Q)),N&&xi(b)&&xi(g)){let lr=U||0;!Ar(Qt)&&this.min<lr&&b>=lr?this.min=D.minRange?Math.min(lr,this.max-X):lr:!Ar(Gt)&&this.max>lr&&g<=lr&&(this.max=D.minRange?Math.max(lr,this.min+X):lr)}!p.polar&&this.min>this.max&&(Ar(D.min)?this.max=this.min:Ar(D.max)&&(this.min=this.max)),ht=this.max-this.min}if(this.min!==this.max&&xi(this.min)&&xi(this.max)?_e&&!mt&&Je===_e.options.tickPixelInterval?this.tickInterval=mt=_e.tickInterval:this.tickInterval=qi(mt,this.tickAmount?ht/Math.max(this.tickAmount-1,1):void 0,u?1:ht*Je/Math.max(this.len,Je)):this.tickInterval=1,C&&!s){let lr=this.min!==((_i=this.old)==null?void 0:_i.min)||this.max!==((Di=this.old)==null?void 0:Di.max);this.series.forEach(function(Bi){var yr;Bi.forceCrop=(yr=Bi.forceCropping)==null?void 0:yr.call(Bi),Bi.processData(lr)}),Rr(this,"postProcessData",{hasExtremesChanged:lr})}this.setAxisTranslation(),Rr(this,"initialAxisTranslation"),this.pointRange&&!mt&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let hi=qi(D.minTickInterval,T&&!this.series.some(lr=>!lr.sorted)?this.closestPointRange:0);!mt&&hi&&this.tickInterval<hi&&(this.tickInterval=hi),T||E||mt||(this.tickInterval=Mr(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){var N,I;let s=this.options,u=s.tickPositions,p=s.tickPositioner,g=this.getMinorTickInterval(),b=!this.isPanning,T=b&&s.startOnTick,C=b&&s.endOnTick,E=[],D;if(this.tickmarkOffset=this.categories&&s.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0,this.single=this.min===this.max&&Ar(this.min)&&!this.tickAmount&&(this.min%1==0||s.allowDecimals!==!1),u)E=u.slice();else if(xi(this.min)&&xi(this.max)){if(!((N=this.ordinal)!=null&&N.positions)&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))E=[this.min,this.max],Ku(19,!1,this.chart);else if(this.dateTime)E=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,s.units),this.min,this.max,s.startOfWeek,(I=this.ordinal)==null?void 0:I.positions,this.closestPointRange,!0);else if(this.logarithmic)E=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let U=this.tickInterval,X=U;for(;X<=2*U&&(E=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&E.length>this.tickAmount);)this.tickInterval=Mr(this,X*=1.1)}E.length>this.len&&(E=[E[0],E[E.length-1]])[0]===E[1]&&(E.length=1),p&&(this.tickPositions=E,(D=p.apply(this,[this.min,this.max]))&&(E=D))}this.tickPositions=E,this.minorTickInterval=g==="auto"&&this.tickInterval?this.tickInterval/s.minorTicksPerMajor:g,this.paddedTicks=E.slice(0),this.trimTicks(E,T,C),!this.isLinked&&xi(this.min)&&xi(this.max)&&(this.single&&E.length<2&&!this.categories&&!this.series.some(U=>U.is("heatmap")&&U.options.pointPlacement==="between")&&(this.min-=.5,this.max+=.5),u||D||this.adjustTickAmount()),Rr(this,"afterSetTickPositions")}trimTicks(s,u,p){let g=s[0],b=s[s.length-1],T=!this.isOrdinal&&this.minPointOffset||0;if(Rr(this,"trimTicks"),!this.isLinked||!this.grid){if(u&&g!==-1/0)this.min=g;else for(;this.min-T>s[0];)s.shift();if(p)this.max=b;else for(;this.max+T<s[s.length-1];)s.pop();s.length===0&&Ar(g)&&!this.options.tickPositions&&s.push((b+g)/2)}}alignToOthers(){let s,u=this,p=u.chart,g=[this],b=u.options,T=p.options.chart,C=this.coll==="yAxis"&&T.alignThresholds,E=[];if(u.thresholdAlignment=void 0,(T.alignTicks!==!1&&b.alignTicks||C)&&b.startOnTick!==!1&&b.endOnTick!==!1&&!u.logarithmic){let D=I=>{let{horiz:U,options:X}=I;return[U?X.left:X.top,X.width,X.height,X.pane].join(",")},N=D(this);p[this.coll].forEach(function(I){let{series:U}=I;U.length&&U.some(X=>X.visible)&&I!==u&&D(I)===N&&(s=!0,g.push(I))})}if(s&&C){g.forEach(N=>{let I=N.getThresholdAlignment(u);xi(I)&&E.push(I)});let D=E.length>1?E.reduce((N,I)=>N+=I,0)/E.length:void 0;g.forEach(N=>{N.thresholdAlignment=D})}return s}getThresholdAlignment(s){if((!xi(this.dataMin)||this!==s&&this.series.some(u=>u.isDirty||u.isDirtyData))&&this.getSeriesExtremes(),xi(this.threshold)){let u=ga((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(u=1-u),u}}getTickAmount(){let s=this.options,u=s.tickPixelInterval,p=s.tickAmount;Ar(s.tickInterval)||p||!(this.len<u)||this.isRadial||this.logarithmic||!s.startOnTick||!s.endOnTick||(p=2),!p&&this.alignToOthers()&&(p=Math.ceil(this.len/u)+1),p<4&&(this.finalTickAmt=p,p=5),this.tickAmount=p}adjustTickAmount(){let s=this,{finalTickAmt:u,max:p,min:g,options:b,tickPositions:T,tickAmount:C,thresholdAlignment:E}=s,D=T==null?void 0:T.length,N=qi(s.threshold,s.softThreshold?0:null),I,U,X=s.tickInterval,Q,le=()=>T.push(qa(T[T.length-1]+X)),ne=()=>T.unshift(qa(T[0]-X));if(xi(E)&&(Q=E<.5?Math.ceil(E*(C-1)):Math.floor(E*(C-1)),b.reversed&&(Q=C-1-Q)),s.hasData()&&xi(g)&&xi(p)){let ie=()=>{s.transA*=(D-1)/(C-1),s.min=b.startOnTick?T[0]:Math.min(g,T[0]),s.max=b.endOnTick?T[T.length-1]:Math.max(p,T[T.length-1])};if(xi(Q)&&xi(s.threshold)){for(;T[Q]!==N||T.length!==C||T[0]>g||T[T.length-1]<p;){for(T.length=0,T.push(s.threshold);T.length<C;)T[Q]===void 0||T[Q]>s.threshold?ne():le();if(X>8*s.tickInterval)break;X*=2}ie()}else if(D<C){for(;T.length<C;)T.length%2||g===N?le():ne();ie()}if(Ar(u)){for(U=I=T.length;U--;)(u===3&&U%2==1||u<=2&&U>0&&U<I-1)&&T.splice(U,1);s.finalTickAmt=void 0}}}setScale(){var T,C,E,D,N;let{coll:s,stacking:u}=this,p=!1,g=!1;this.series.forEach(I=>{var U;p=p||I.isDirtyData||I.isDirty,g=g||((U=I.xAxis)==null?void 0:U.isDirty)||!1}),this.setAxisSize();let b=this.len!==((T=this.old)==null?void 0:T.len);b||p||g||this.isLinked||this.forceRedraw||this.userMin!==((C=this.old)==null?void 0:C.userMin)||this.userMax!==((E=this.old)==null?void 0:E.userMax)||this.alignToOthers()?(u&&s==="yAxis"&&u.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),u&&s==="xAxis"&&u.buildStacks(),this.isDirty||(this.isDirty=b||this.min!==((D=this.old)==null?void 0:D.min)||this.max!==((N=this.old)==null?void 0:N.max))):u&&u.cleanStacks(),p&&delete this.allExtremes,Rr(this,"afterSetScale")}setExtremes(s,u,p=!0,g,b){let T=this.chart;this.series.forEach(C=>{delete C.kdTree}),s=T.time.parse(s),u=T.time.parse(u),Rr(this,"setExtremes",b=jo(b,{min:s,max:u}),C=>{this.userMin=C.min,this.userMax=C.max,this.eventArgs=C,p&&T.redraw(g)})}setAxisSize(){let s=this.chart,u=this.options,p=u.offsets||[0,0,0,0],g=this.horiz,b=this.width=Math.round(Bo(qi(u.width,s.plotWidth-p[3]+p[1]),s.plotWidth)),T=this.height=Math.round(Bo(qi(u.height,s.plotHeight-p[0]+p[2]),s.plotHeight)),C=this.top=Math.round(Bo(qi(u.top,s.plotTop+p[0]),s.plotHeight,s.plotTop)),E=this.left=Math.round(Bo(qi(u.left,s.plotLeft+p[3]),s.plotWidth,s.plotLeft));this.bottom=s.chartHeight-T-C,this.right=s.chartWidth-b-E,this.len=Math.max(g?b:T,0),this.pos=g?E:C}getExtremes(){let s=this.logarithmic;return{min:s?qa(s.lin2log(this.min)):this.min,max:s?qa(s.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(s){let u=this.logarithmic,p=u?u.lin2log(this.min):this.min,g=u?u.lin2log(this.max):this.max;return s===null||s===-1/0?s=p:s===1/0?s=g:p>s?s=p:g<s&&(s=g),this.translate(s,0,1,0,1)}autoLabelAlign(s){let u=(qi(s,0)-90*this.side+720)%360,p={align:"center"};return Rr(this,"autoLabelAlign",p,function(g){u>15&&u<165?g.align="right":u>195&&u<345&&(g.align="left")}),p.align}tickSize(s){let u=this.options,p=qi(u[s==="tick"?"tickWidth":"minorTickWidth"],s==="tick"&&this.isXAxis&&!this.categories?1:0),g=u[s==="tick"?"tickLength":"minorTickLength"],b;p&&g&&(u[s+"Position"]==="inside"&&(g=-g),b=[g,p]);let T={tickSize:b};return Rr(this,"afterTickSize",T),T.tickSize}labelMetrics(){let s=this.chart.renderer,u=this.ticks,p=u[Object.keys(u)[0]]||{};return this.chart.renderer.fontMetrics(p.label||p.movedLabel||s.box)}unsquish(){let s=this.options.labels,u=s.padding||0,p=this.horiz,g=this.tickInterval,b=this.len/((+!!this.categories+this.max-this.min)/g),T=s.rotation,C=qa(.8*this.labelMetrics().h),E=Math.max(this.max-this.min,0),D=function(Q){let le=(Q+2*u)/(b||1);return(le=le>1?Math.ceil(le):1)*g>E&&Q!==1/0&&b!==1/0&&E&&(le=Math.ceil(E/g)),qa(le*g)},N=g,I,U=Number.MAX_VALUE,X;if(p){if(!s.staggerLines&&(xi(T)?X=[T]:b<s.autoRotationLimit&&(X=s.autoRotation)),X){let Q,le;for(let ne of X)(ne===T||ne&&ne>=-90&&ne<=90)&&(le=(Q=D(Math.abs(C/Math.sin(Pd*ne))))+Math.abs(ne/360))<U&&(U=le,I=ne,N=Q)}}else N=D(.75*C);return this.autoRotation=X,this.labelRotation=qi(I,xi(T)?T:0),s.step?g:N}getSlotWidth(s){let u=this.chart,p=this.horiz,g=this.options.labels,b=Math.max(this.tickPositions.length-+!this.categories,1),T=u.margin[3];if(s&&xi(s.slotWidth))return s.slotWidth;if(p&&g.step<2&&!this.isRadial)return g.rotation?0:(this.staggerLines||1)*this.len/b;if(!p){let C=g.style.width;if(C!==void 0)return parseInt(String(C),10);if(T)return T-u.spacing[3]}return .33*u.chartWidth}renderUnsquish(){let s=this.chart,u=s.renderer,p=this.tickPositions,g=this.ticks,b=this.options.labels,T=b.style,C=this.horiz,E=this.getSlotWidth(),D=Math.max(1,Math.round(E-(C?2*(b.padding||0):b.distance||0))),N={},I=this.labelMetrics(),U=T.lineClamp,X,Q=U??(Math.floor(this.len/(p.length*I.h))||1),le=0;no(b.rotation)||(N.rotation=b.rotation||0),p.forEach(function(ne){var _e;let ie=g[ne];ie.movedLabel&&ie.replaceMovedLabel();let me=((_e=ie.label)==null?void 0:_e.textPxLength)||0;me>le&&(le=me)}),this.maxLabelLength=le,this.autoRotation?le>D&&le>I.h?N.rotation=this.labelRotation:this.labelRotation=0:E&&(X=D),N.rotation&&(X=le>.5*s.chartHeight?.33*s.chartHeight:le,U||(Q=1)),this.labelAlign=b.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(N.align=this.labelAlign),p.forEach(function(ne){let ie=g[ne],me=ie==null?void 0:ie.label,_e=T.width,Je={};me&&(me.attr(N),ie.shortenLabel?ie.shortenLabel():X&&!_e&&T.whiteSpace!=="nowrap"&&(X<(me.textPxLength||0)||me.element.tagName==="SPAN")?me.css(jo(Je,{width:`${X}px`,lineClamp:Q})):!me.styles.width||Je.width||_e||me.css({width:"auto"}),ie.rotation=N.rotation)},this),this.tickRotCorr=u.rotCorr(I.b,this.labelRotation||0,this.side!==0)}hasData(){return this.series.some(function(s){return s.hasData()})||this.options.showEmpty&&Ar(this.min)&&Ar(this.max)}addTitle(s){let u,p=this.chart.renderer,g=this.horiz,b=this.opposite,T=this.options.title,C=this.chart.styledMode;this.axisTitle||((u=T.textAlign)||(u=(g?{low:"left",middle:"center",high:"right"}:{low:b?"right":"left",middle:"center",high:b?"left":"right"})[T.align]),this.axisTitle=p.text(T.text||"",0,0,T.useHTML).attr({zIndex:7,rotation:T.rotation||0,align:u}).addClass("highcharts-axis-title"),C||this.axisTitle.css(is(T.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),C||T.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[s?"show":"hide"](s)}generateTick(s){let u=this.ticks;u[s]?u[s].addLabel():u[s]=new Rs(this,s)}createGroups(){let{axisParent:s,chart:u,coll:p,options:g}=this,b=u.renderer,T=(C,E,D)=>b.g(C).attr({zIndex:D}).addClass(`highcharts-${p.toLowerCase()}${E} `+(this.isRadial?`highcharts-radial-axis${E} `:"")+(g.className||"")).add(s);this.axisGroup||(this.gridGroup=T("grid","-grid",g.gridZIndex),this.axisGroup=T("axis","",g.zIndex),this.labelGroup=T("axis-labels","-labels",g.labels.zIndex))}getOffset(){let s=this,{chart:u,horiz:p,options:g,side:b,ticks:T,tickPositions:C,coll:E}=s,D=u.inverted&&!s.isZAxis?[1,0,3,2][b]:b,N=s.hasData(),I=g.title,U=g.labels,X=xi(g.crossing),Q=u.axisOffset,le=u.clipOffset,ne=[-1,1,1,-1][b],ie,me=0,_e,Je=0,$e=0,Ze,ht;if(s.showAxis=ie=N||g.showEmpty,s.staggerLines=s.horiz&&U.staggerLines||void 0,s.createGroups(),N||s.isLinked?(C.forEach(function(at){s.generateTick(at)}),s.renderUnsquish(),s.reserveSpaceDefault=b===0||b===2||{1:"left",3:"right"}[b]===s.labelAlign,qi(U.reserveSpace,!X&&null,s.labelAlign==="center"||null,s.reserveSpaceDefault)&&C.forEach(function(at){$e=Math.max(T[at].getLabelSize(),$e)}),s.staggerLines&&($e*=s.staggerLines),s.labelOffset=$e*(s.opposite?-1:1)):Xa(T,function(at,mt){at.destroy(),delete T[mt]}),I!=null&&I.text&&I.enabled!==!1&&(s.addTitle(ie),ie&&!X&&I.reserveSpace!==!1&&(s.titleOffset=me=s.axisTitle.getBBox()[p?"height":"width"],Je=Ar(_e=I.offset)?0:qi(I.margin,p?5:10))),s.renderLine(),s.offset=ne*qi(g.offset,Q[b]?Q[b]+(g.margin||0):0),s.tickRotCorr=s.tickRotCorr||{x:0,y:0},ht=b===0?-s.labelMetrics().h:b===2?s.tickRotCorr.y:0,Ze=Math.abs($e)+Je,$e&&(Ze-=ht,Ze+=ne*(p?qi(U.y,s.tickRotCorr.y+ne*U.distance):qi(U.x,ne*U.distance))),s.axisTitleMargin=qi(_e,Ze),s.getMaxLabelDimensions&&(s.maxLabelDimensions=s.getMaxLabelDimensions(T,C)),E!=="colorAxis"&&le){let at=this.tickSize("tick");Q[b]=Math.max(Q[b],(s.axisTitleMargin||0)+me+ne*s.offset,Ze,C!=null&&C.length&&at?at[0]+ne*s.offset:0);let mt=!s.axisLine||g.offset?0:s.axisLine.strokeWidth()/2;le[D]=Math.max(le[D],mt)}Rr(this,"afterGetOffset")}getLinePath(s){let u=this.chart,p=this.opposite,g=this.offset,b=this.horiz,T=this.left+(p?this.width:0)+g,C=u.chartHeight-this.bottom-(p?this.height:0)+g;return p&&(s*=-1),u.renderer.crispLine([["M",b?this.left:T,b?C:this.top],["L",b?u.chartWidth-this.right:T,b?C:u.chartHeight-this.bottom]],s)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(s){let u=this.horiz,p=this.left,g=this.top,b=this.len,T=this.options.title,C=u?p:g,E=this.opposite,D=this.offset,N=T.x,I=T.y,U=this.chart.renderer.fontMetrics(s),X=s?Math.max(s.getBBox(!1,0).height-U.h-1,0):0,Q={low:C+(u?0:b),middle:C+b/2,high:C+(u?b:0)}[T.align],le=(u?g+this.height:p)+(u?1:-1)*(E?-1:1)*(this.axisTitleMargin||0)+[-X,X,U.f,-X][this.side],ne={x:u?Q+N:le+(E?this.width:0)+D+N,y:u?le+I-(E?this.height:0)+D:Q+I};return Rr(this,"afterGetTitlePosition",{titlePosition:ne}),ne}renderMinorTick(s,u){let p=this.minorTicks;p[s]||(p[s]=new Rs(this,s,"minor")),u&&p[s].isNew&&p[s].render(null,!0),p[s].render(null,!1,1)}renderTick(s,u,p){var T;let g=this.isLinked,b=this.ticks;(!g||s>=this.min&&s<=this.max||(T=this.grid)!=null&&T.isColumn)&&(b[s]||(b[s]=new Rs(this,s)),p&&b[s].isNew&&b[s].render(u,!0,-1),b[s].render(u))}render(){let s,u,p=this,g=p.chart,b=p.logarithmic,T=g.renderer,C=p.options,E=p.isLinked,D=p.tickPositions,N=p.axisTitle,I=p.ticks,U=p.minorTicks,X=p.alternateBands,Q=C.stackLabels,le=C.alternateGridColor,ne=C.crossing,ie=p.tickmarkOffset,me=p.axisLine,_e=p.showAxis,Je=Ac(T.globalAnimation);if(p.labelEdge.length=0,p.overlap=!1,[I,U,X].forEach(function($e){Xa($e,function(Ze){Ze.isActive=!1})}),xi(ne)){let $e=this.isXAxis?g.yAxis[0]:g.xAxis[0],Ze=[1,-1,-1,1][this.side];if($e){let ht=$e.toPixels(ne,!0);p.horiz&&(ht=$e.len-ht),p.offset=Ze*ht}}if(p.hasData()||E){let $e=p.chart.hasRendered&&p.old&&xi(p.old.min);p.minorTickInterval&&!p.categories&&p.getMinorTickPositions().forEach(function(Ze){p.renderMinorTick(Ze,$e)}),D.length&&(D.forEach(function(Ze,ht){p.renderTick(Ze,ht,$e)}),ie&&(p.min===0||p.single)&&(I[-1]||(I[-1]=new Rs(p,-1,null,!0)),I[-1].render(-1))),le&&D.forEach(function(Ze,ht){u=D[ht+1]!==void 0?D[ht+1]+ie:p.max-ie,ht%2==0&&Ze<p.max&&u<=p.max+(g.polar?-ie:ie)&&(X[Ze]||(X[Ze]=new Ue.PlotLineOrBand(p,{})),s=Ze+ie,X[Ze].options={from:b?b.lin2log(s):s,to:b?b.lin2log(u):u,color:le,className:"highcharts-alternate-grid"},X[Ze].render(),X[Ze].isActive=!0)}),p._addedPlotLB||(p._addedPlotLB=!0,(C.plotLines||[]).concat(C.plotBands||[]).forEach(function(Ze){p.addPlotBandOrLine(Ze)}))}[I,U,X].forEach(function($e){let Ze=[],ht=Je.duration;Xa($e,function(at,mt){at.isActive||(at.render(mt,!1,0),at.isActive=!1,Ze.push(mt))}),vn(function(){let at=Ze.length;for(;at--;)$e[Ze[at]]&&!$e[Ze[at]].isActive&&($e[Ze[at]].destroy(),delete $e[Ze[at]])},$e!==X&&g.hasRendered&&ht?ht:0)}),me&&(me[me.isPlaced?"animate":"attr"]({d:this.getLinePath(me.strokeWidth())}),me.isPlaced=!0,me[_e?"show":"hide"](_e)),N&&_e&&(N[N.isNew?"attr":"animate"](p.getTitlePosition(N)),N.isNew=!1),Q!=null&&Q.enabled&&p.stacking&&p.stacking.renderStackTotals(),p.old={len:p.len,max:p.max,min:p.min,transA:p.transA,userMax:p.userMax,userMin:p.userMin},p.isDirty=!1,Rr(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(s){s.render()})),this.series.forEach(function(s){s.isDirty=!0})}getKeepProps(){return this.keepProps||Ya.keepProps}destroy(s){let u=this,p=u.plotLinesAndBands,g=this.eventOptions;if(Rr(this,"destroy",{keepEvents:s}),s||Qu(u),[u.ticks,u.minorTicks,u.alternateBands].forEach(function(b){ro(b)}),p){let b=p.length;for(;b--;)p[b].destroy()}for(let b in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(T){u[T]&&(u[T]=u[T].destroy())}),u.plotLinesAndBandsGroups)u.plotLinesAndBandsGroups[b]=u.plotLinesAndBandsGroups[b].destroy();Xa(u,function(b,T){u.getKeepProps().indexOf(T)===-1&&delete u[T]}),this.eventOptions=g}drawCrosshair(s,u){var I;let p=this.crosshair,g=(p==null?void 0:p.snap)??!0,b=this.chart,T,C,E,D=this.cross,N;if(Rr(this,"drawCrosshair",{e:s,point:u}),s||(s=(I=this.cross)==null?void 0:I.e),p&&(Ar(u)||!g)!==!1){if(g?Ar(u)&&(C=qi(this.coll!=="colorAxis"?u.crosshairPos:null,this.isXAxis?u.plotX:this.len-u.plotY)):C=s&&(this.horiz?s.chartX-this.pos:this.len-s.chartY+this.pos),Ar(C)&&(N={value:u&&(this.isXAxis?u.x:qi(u.stackY,u.y)),translatedValue:C},b.polar&&jo(N,{isCrosshair:!0,chartX:s==null?void 0:s.chartX,chartY:s==null?void 0:s.chartY,point:u}),T=this.getPlotLinePath(N)||null),!Ar(T)){this.hideCrosshair();return}E=this.categories&&!this.isRadial,D||(this.cross=D=b.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(E?"category ":"thin ")+(p.className||"")).attr({zIndex:qi(p.zIndex,2)}).add(),!b.styledMode&&(D.attr({stroke:p.color||(E?ai.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":qi(p.width,1)}).css({"pointer-events":"none"}),p.dashStyle&&D.attr({dashstyle:p.dashStyle}))),D.show().attr({d:T}),E&&!p.width&&D.attr({"stroke-width":this.transA}),this.cross.e=s}else this.hideCrosshair();Rr(this,"afterDrawCrosshair",{e:s,point:u})}hideCrosshair(){this.cross&&this.cross.hide(),Rr(this,"afterHideCrosshair")}update(s,u){let p=this.chart;s=is(this.userOptions,s),this.destroy(!0),this.init(p,s),p.isDirtyBox=!0,qi(u,!0)&&p.redraw()}remove(s){let u=this.chart,p=this.coll,g=this.series,b=g.length;for(;b--;)g[b]&&g[b].remove(!1);Oh(u.axes,this),Oh(u[p]||[],this),u.orderItems(p),this.destroy(),u.isDirtyBox=!0,qi(s,!0)&&u.redraw()}setTitle(s,u){this.update({title:s},u)}setCategories(s,u){this.update({categories:s},u)}}Ya.keepProps=["coll","extKey","hcEvents","len","names","series","userMax","userMin"];let{addEvent:Os,getMagnitude:jh,normalizeTickInterval:Gl,timeUnits:pl}=li;(function(R){function s(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function u(){if(this.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new p(this))}R.compose=function(g){return g.keepProps.includes("dateTime")||(g.keepProps.push("dateTime"),g.prototype.getTimeTicks=s,Os(g,"afterSetType",u)),g};class p{constructor(b){this.axis=b}normalizeTimeTickInterval(b,T){let C=T||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],E=C[C.length-1],D=pl[E[0]],N=E[1],I;for(I=0;I<C.length&&(D=pl[(E=C[I])[0]],N=E[1],!C[I+1]||!(b<=(D*N[N.length-1]+pl[C[I+1][0]])/2));I++);D===pl.year&&b<5*D&&(N=[1,2,5]);let U=Gl(b/D,N,E[0]==="year"?Math.max(jh(b/D),1):1);return{unitRange:D,count:U,unitName:E[0]}}getXDateFormat(b,T){let{axis:C}=this,E=C.chart.time;return C.closestPointRange?E.getDateFormat(C.closestPointRange,b,C.options.startOfWeek,T)||E.resolveDTLFormat(T.year).main:E.resolveDTLFormat(T.day).main}}R.Additions=p})(ge||(ge={}));let Ju=ge,{addEvent:fl,normalizeTickInterval:lu,pick:on}=li;(function(R){function s(){this.type!=="logarithmic"?this.logarithmic=void 0:this.logarithmic??(this.logarithmic=new p(this))}function u(){let g=this.logarithmic;g&&(this.lin2val=function(b){return g.lin2log(b)},this.val2lin=function(b){return g.log2lin(b)})}R.compose=function(g){return g.keepProps.includes("logarithmic")||(g.keepProps.push("logarithmic"),fl(g,"afterSetType",s),fl(g,"afterInit",u)),g};class p{constructor(b){this.axis=b}getLogTickPositions(b,T,C,E){let D=this.axis,N=D.len,I=D.options,U=[];if(E||(this.minorAutoInterval=void 0),b>=.5)b=Math.round(b),U=D.getLinearTickPositions(b,T,C);else if(b>=.08){let X,Q,le,ne,ie,me,_e,Je=Math.floor(T);for(X=b>.3?[1,2,4]:b>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],Q=Je;Q<C+1&&!_e;Q++)for(le=0,ne=X.length;le<ne&&!_e;le++)(ie=this.log2lin(this.lin2log(Q)*X[le]))>T&&(!E||me<=C)&&me!==void 0&&U.push(me),me>C&&(_e=!0),me=ie}else{let X=this.lin2log(T),Q=this.lin2log(C),le=E?D.getMinorTickInterval():I.tickInterval,ne=I.tickPixelInterval/(E?5:1),ie=E?N/D.tickPositions.length:N;b=lu(b=on(le==="auto"?null:le,this.minorAutoInterval,(Q-X)*ne/(ie||1))),U=D.getLinearTickPositions(b,X,Q).map(this.log2lin),E||(this.minorAutoInterval=b/5)}return E||(D.tickInterval=b),U}lin2log(b){return Math.pow(10,b)}log2lin(b){return Math.log(b)/Math.LN10}}R.Additions=p})(Te||(Te={}));let js=Te,{erase:rs,extend:No,isNumber:ns}=li;(function(R){let s;function u(D){return this.addPlotBandOrLine(D,"plotBands")}function p(D,N){let I=this.userOptions,U=new s(this,D);if(this.visible&&(U=U.render()),U){if(this._addedPlotLB||(this._addedPlotLB=!0,(I.plotLines||[]).concat(I.plotBands||[]).forEach(X=>{this.addPlotBandOrLine(X)})),N){let X=I[N]||[];X.push(D),I[N]=X}this.plotLinesAndBands.push(U)}return U}function g(D){return this.addPlotBandOrLine(D,"plotLines")}function b(D,N,I){I=I||this.options;let U=this.getPlotLinePath({value:N,force:!0,acrossPanes:I.acrossPanes}),X=[],Q=this.horiz,le=!ns(this.min)||!ns(this.max)||D<this.min&&N<this.min||D>this.max&&N>this.max,ne=this.getPlotLinePath({value:D,force:!0,acrossPanes:I.acrossPanes}),ie,me=1,_e;if(ne&&U)for(le&&(_e=ne.toString()===U.toString(),me=0),ie=0;ie<ne.length;ie+=2){let Je=ne[ie],$e=ne[ie+1],Ze=U[ie],ht=U[ie+1];(Je[0]==="M"||Je[0]==="L")&&($e[0]==="M"||$e[0]==="L")&&(Ze[0]==="M"||Ze[0]==="L")&&(ht[0]==="M"||ht[0]==="L")&&(Q&&Ze[1]===Je[1]?(Ze[1]+=me,ht[1]+=me):Q||Ze[2]!==Je[2]||(Ze[2]+=me,ht[2]+=me),X.push(["M",Je[1],Je[2]],["L",$e[1],$e[2]],["L",ht[1],ht[2]],["L",Ze[1],Ze[2]],["Z"])),X.isFlat=_e}return X}function T(D){this.removePlotBandOrLine(D)}function C(D){let N=this.plotLinesAndBands,I=this.options,U=this.userOptions;if(N){let X=N.length;for(;X--;)N[X].id===D&&N[X].destroy();[I.plotLines||[],U.plotLines||[],I.plotBands||[],U.plotBands||[]].forEach(function(Q){var le;for(X=Q.length;X--;)((le=Q[X])==null?void 0:le.id)===D&&rs(Q,Q[X])})}}function E(D){this.removePlotBandOrLine(D)}R.compose=function(D,N){let I=N.prototype;return I.addPlotBand||(s=D,No(I,{addPlotBand:u,addPlotLine:g,addPlotBandOrLine:p,getPlotBandPath:b,removePlotBand:T,removePlotLine:E,removePlotBandOrLine:C})),N}})(Ve||(Ve={}));let xs=Ve,{addEvent:as,arrayMax:cu,arrayMin:$l,defined:Pa,destroyObjectProperties:eh,erase:Hl,fireEvent:Pn,merge:Fo,objectEach:Wa,pick:ao}=li;class uu{static compose(s,u){return as(s,"afterInit",function(){this.labelCollectors.push(()=>{var g;let p=[];for(let b of this.axes)for(let{label:T,options:C}of b.plotLinesAndBands)T&&!((g=C==null?void 0:C.label)!=null&&g.allowOverlap)&&p.push(T);return p})}),xs.compose(uu,u)}constructor(s,u){this.axis=s,this.options=u,this.id=u.id}render(){Pn(this,"render");let{axis:s,options:u}=this,{horiz:p,logarithmic:g}=s,{color:b,events:T,zIndex:C=0}=u,{renderer:E,time:D}=s.chart,N={},I=D.parse(u.to),U=D.parse(u.from),X=D.parse(u.value),Q=u.borderWidth,le=u.label,{label:ne,svgElem:ie}=this,me=[],_e,Je=Pa(U)&&Pa(I),$e=Pa(X),Ze=!ie,ht={class:"highcharts-plot-"+(Je?"band ":"line ")+(u.className||"")},at=Je?"bands":"lines";if(!s.chart.styledMode&&($e?(ht.stroke=b||"#999999",ht["stroke-width"]=ao(u.width,1),u.dashStyle&&(ht.dashstyle=u.dashStyle)):Je&&(ht.fill=b||"#e6e9ff",Q&&(ht.stroke=u.borderColor,ht["stroke-width"]=Q))),N.zIndex=C,at+="-"+C,(_e=s.plotLinesAndBandsGroups[at])||(s.plotLinesAndBandsGroups[at]=_e=E.g("plot-"+at).attr(N).add()),ie||(this.svgElem=ie=E.path().attr(ht).add(_e)),Pa(X))me=s.getPlotLinePath({value:(g==null?void 0:g.log2lin(X))??X,lineWidth:ie.strokeWidth(),acrossPanes:u.acrossPanes});else{if(!(Pa(U)&&Pa(I)))return;me=s.getPlotBandPath((g==null?void 0:g.log2lin(U))??U,(g==null?void 0:g.log2lin(I))??I,u)}return!this.eventsAdded&&T&&(Wa(T,(mt,Bt)=>{ie==null||ie.on(Bt,Zt=>{T[Bt].apply(this,[Zt])})}),this.eventsAdded=!0),(Ze||!ie.d)&&(me!=null&&me.length)?ie.attr({d:me}):ie&&(me?(ie.show(),ie.animate({d:me})):ie.d&&(ie.hide(),ne&&(this.label=ne=ne.destroy()))),le&&(Pa(le.text)||Pa(le.formatter))&&(me!=null&&me.length)&&s.width>0&&s.height>0&&!me.isFlat?(le=Fo({align:p&&Je?"center":void 0,x:p?!Je&&4:10,verticalAlign:!p&&Je?"middle":void 0,y:p?Je?16:10:Je?6:-4,rotation:p&&!Je?90:0,...Je?{inside:!0}:{}},le),this.renderLabel(le,me,Je,C)):ne&&ne.hide(),this}renderLabel(s,u,p,g){var Q;let b=this.axis,T=b.chart.renderer,C=s.inside,E=this.label;E||(this.label=E=T.text(this.getLabelText(s),0,0,s.useHTML).attr({align:s.textAlign||s.align,rotation:s.rotation,class:"highcharts-plot-"+(p?"band":"line")+"-label "+(s.className||""),zIndex:g}),b.chart.styledMode||E.css(Fo({fontSize:"0.8em",textOverflow:p&&!C?"":"ellipsis"},s.style)),E.add());let D=u.xBounds||[u[0][1],u[1][1],p?u[2][1]:u[0][1]],N=u.yBounds||[u[0][2],u[1][2],p?u[2][2]:u[0][2]],I=$l(D),U=$l(N),X=cu(D)-I;E.align(s,!1,{x:I,y:U,width:X,height:cu(N)-U}),E.alignAttr.y-=T.fontMetrics(E).b,(!E.alignValue||E.alignValue==="left"||Pa(C))&&E.css({width:(((Q=s.style)==null?void 0:Q.width)||(p&&C?X:E.rotation===90?b.height-(E.alignAttr.y-b.top):(s.clip?b.width:b.chart.chartWidth)-(E.alignAttr.x-b.left)))+"px"}),E.show(!0)}getLabelText(s){return Pa(s.formatter)?s.formatter.call(this):s.text}destroy(){Hl(this.axis.plotLinesAndBands,this),delete this.axis,eh(this)}}let{animObject:wp}=Dr,{format:zn}=Sa,{composed:Zl,dateFormats:kc,doc:ml,isSafari:Bh}=Ue,{distribute:gl}=Lo,{addEvent:yl,clamp:so,css:ss,discardElement:oo,extend:zd,fireEvent:bn,getAlignFactor:_l,isArray:Nh,isNumber:th,isObject:ih,isString:hu,merge:ql,pick:vs,pushUnique:lo,splat:si,syncTimeout:Fh}=li;class co{constructor(s,u,p){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.options={},this.outside=!1,this.chart=s,this.init(s,u),this.pointer=p}bodyFormatter(s){return s.map(u=>{let p=u.series.tooltipOptions,g=u.formatPrefix||"point";return(p[g+"Formatter"]||u.tooltipFormatter).call(u,p[g+"Format"]||"")})}cleanSplit(s){this.chart.series.forEach(function(u){let p=u==null?void 0:u.tt;p&&(!p.isActive||s?u.tt=p.destroy():p.isActive=!1)})}defaultFormatter(s){let u,p=this.points||si(this);return(u=(u=[s.headerFooterFormatter(p[0])]).concat(s.bodyFormatter(p))).push(s.headerFooterFormatter(p[0],!0)),u}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),oo(this.container)),li.clearTimeout(this.hideTimer)}getAnchor(s,u){var D;let p,{chart:g,pointer:b}=this,T=g.inverted,C=g.plotTop,E=g.plotLeft;if(s=si(s),(D=s[0].series)!=null&&D.yAxis&&!s[0].series.yAxis.options.reversedStacks&&(s=s.slice().reverse()),this.followPointer&&u)u.chartX===void 0&&(u=b.normalize(u)),p=[u.chartX-E,u.chartY-C];else if(s[0].tooltipPos)p=s[0].tooltipPos;else{let N=0,I=0;s.forEach(function(U){let X=U.pos(!0);X&&(N+=X[0],I+=X[1])}),N/=s.length,I/=s.length,this.shared&&s.length>1&&u&&(T?N=u.chartX:I=u.chartY),p=[N-E,I-C]}return p.map(Math.round)}getClassName(s,u,p){let g=this.options,b=s.series,T=b.options;return[g.className,"highcharts-label",p&&"highcharts-tooltip-header",u?"highcharts-tooltip-box":"highcharts-tooltip",!p&&"highcharts-color-"+vs(s.colorIndex,b.colorIndex),T==null?void 0:T.className].filter(hu).join(" ")}getLabel({anchorX:s,anchorY:u}={anchorX:0,anchorY:0}){let p=this,g=this.chart.styledMode,b=this.options,T=this.split&&this.allowShared,C=this.container,E=this.chart.renderer;if(this.label){let D=!this.label.hasClass("highcharts-label");(!T&&D||T&&!D)&&this.destroy()}if(!this.label){if(this.outside){let D=this.chart,N=D.options.chart.style,I=fs.getRendererType();this.container=C=Ue.doc.createElement("div"),C.className="highcharts-tooltip-container "+(D.renderTo.className.match(/(highcharts[a-zA-Z0-9-]+)\s?/gm)||""),ss(C,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,((N==null?void 0:N.zIndex)||0)+3)}),this.renderer=E=new I(C,0,0,N,void 0,void 0,E.styledMode)}if(T?this.label=E.g("tooltip"):(this.label=E.label("",s,u,b.shape||"callout",void 0,void 0,b.useHTML,void 0,"tooltip").attr({padding:b.padding,r:b.borderRadius}),g||this.label.attr({fill:b.backgroundColor,"stroke-width":b.borderWidth||0}).css(b.style).css({pointerEvents:b.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),p.outside){let D=this.label;[D.xSetter,D.ySetter].forEach((N,I)=>{D[I?"ySetter":"xSetter"]=U=>{N.call(D,p.distance),D[I?"y":"x"]=U,C&&(C.style[I?"top":"left"]=`${U}px`)}})}this.label.attr({zIndex:8}).shadow(b.shadow??!b.fixed).add()}return C&&!C.parentElement&&Ue.doc.body.appendChild(C),this.label}getPlayingField(){let{body:s,documentElement:u}=ml,{chart:p,distance:g,outside:b}=this;return{width:b?Math.max(s.scrollWidth,u.scrollWidth,s.offsetWidth,u.offsetWidth,u.clientWidth)-2*g-2:p.chartWidth,height:b?Math.max(s.scrollHeight,u.scrollHeight,s.offsetHeight,u.offsetHeight,u.clientHeight):p.chartHeight}}getPosition(s,u,p){var oi,ji;let{distance:g,chart:b,outside:T,pointer:C}=this,{inverted:E,plotLeft:D,plotTop:N,polar:I}=b,{plotX:U=0,plotY:X=0}=p,Q={},le=E&&p.h||0,{height:ne,width:ie}=this.getPlayingField(),me=C.getChartPosition(),_e=_i=>_i*me.scaleX,Je=_i=>_i*me.scaleY,$e=_i=>{let Di=_i==="x";return[_i,Di?ie:ne,Di?s:u].concat(T?[Di?_e(s):Je(u),Di?me.left-g+_e(U+D):me.top-g+Je(X+N),0,Di?ie:ne]:[Di?s:u,Di?U+D:X+N,Di?D:N,Di?D+b.plotWidth:N+b.plotHeight])},Ze=$e("y"),ht=$e("x"),at,mt=!!p.negative;!I&&((ji=(oi=b.hoverSeries)==null?void 0:oi.yAxis)!=null&&ji.reversed)&&(mt=!mt);let Bt=!this.followPointer&&vs(p.ttBelow,!I&&!E===mt),Zt=function(_i,Di,lr,Bi,yr,Na,_r){let dr=T?_i==="y"?Je(g):_e(g):g,fi=(lr-Bi)/2,zi=Bi<yr-g,hn=yr+g+Bi<Di,pr=yr-dr-lr+fi,Hr=yr+dr-fi;if(Bt&&hn)Q[_i]=Hr;else if(!Bt&&zi)Q[_i]=pr;else if(zi)Q[_i]=Math.min(_r-Bi,pr-le<0?pr:pr-le);else{if(!hn)return Q[_i]=0,!1;Q[_i]=Math.max(Na,Hr+le+lr>Di?Hr:Hr+le)}},Qt=function(_i,Di,lr,Bi,yr){if(yr<g||yr>Di-g)return!1;yr<lr/2?Q[_i]=1:yr>Di-Bi/2?Q[_i]=Di-Bi-2:Q[_i]=yr-lr/2},Gt=function(_i){[Ze,ht]=[ht,Ze],at=_i},hi=()=>{Zt.apply(0,Ze)!==!1?Qt.apply(0,ht)!==!1||at||(Gt(!0),hi()):at?Q.x=Q.y=0:(Gt(!0),hi())};return(E&&!I||this.len>1)&&Gt(),hi(),Q}getFixedPosition(s,u,p){var U;let g=p.series,{chart:b,options:T,split:C}=this,E=T.position,D=E.relativeTo,N=T.shared||(U=g==null?void 0:g.yAxis)!=null&&U.isRadial&&(D==="pane"||!D)?"plotBox":D,I=N==="chart"?b.renderer:b[N]||b.getClipBox(g,!0);return{x:I.x+(I.width-s)*_l(E.align)+E.x,y:I.y+(I.height-u)*_l(E.verticalAlign)+(!C&&E.y||0)}}hide(s){let u=this;li.clearTimeout(this.hideTimer),s=vs(s,this.options.hideDelay),this.isHidden||(this.hideTimer=Fh(function(){let p=u.getLabel();u.getLabel().animate({opacity:0},{duration:s&&150,complete:()=>{p.hide(),u.container&&u.container.remove()}}),u.isHidden=!0},s))}init(s,u){this.chart=s,this.options=u,this.crosshairs=[],this.isHidden=!0,this.split=u.split&&!s.inverted&&!s.polar,this.shared=u.shared||this.split,this.outside=vs(u.outside,!!(s.scrollablePixelsX||s.scrollablePixelsY))}shouldStickOnContact(s){return!!(!this.followPointer&&this.options.stickOnContact&&(!s||this.pointer.inClass(s.target,"highcharts-tooltip")))}move(s,u,p,g){let{followPointer:b,options:T}=this,C=wp(!b&&!this.isHidden&&!T.fixed&&T.animation),E=b||(this.len||0)>1,D={x:s,y:u};E?D.anchorX=D.anchorY=NaN:(D.anchorX=p,D.anchorY=g),C.step=()=>this.drawTracker(),this.getLabel().animate(D,C)}refresh(s,u){let{chart:p,options:g,pointer:b,shared:T}=this,C=si(s),E=C[0],D=g.format,N=g.formatter||this.defaultFormatter,I=p.styledMode,U=this.allowShared;if(!g.enabled||!E.series)return;li.clearTimeout(this.hideTimer),this.allowShared=!(!Nh(s)&&s.series&&s.series.noSharedTooltip),U=U&&!this.allowShared,this.followPointer=!this.split&&E.series.tooltipOptions.followPointer;let X=this.getAnchor(s,u),Q=X[0],le=X[1];T&&this.allowShared&&(b.applyInactiveState(C),C.forEach(me=>me.setState("hover")),E.points=C),this.len=C.length;let ne=hu(D)?zn(D,E,p):N.call(E,this);E.points=void 0;let ie=E.series;if(this.distance=vs(ie.tooltipOptions.distance,16),ne===!1)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(ne,C);else{let me=Q,_e=le;if(u&&b.isDirectTouch&&(me=u.chartX-p.plotLeft,_e=u.chartY-p.plotTop),p.polar||ie.options.clip===!1||C.some(Je=>b.isDirectTouch||Je.series.shouldShowTooltip(me,_e))){let Je=this.getLabel(U&&this.tt||{});(!g.style.width||I)&&Je.css({width:(this.outside?this.getPlayingField():p.spacingBox).width+"px"}),Je.attr({class:this.getClassName(E),text:ne&&ne.join?ne.join(""):ne}),this.outside&&Je.attr({x:so(Je.x||0,0,this.getPlayingField().width-(Je.width||0)-1)}),I||Je.attr({stroke:g.borderColor||E.color||ie.color||"#666666"}),this.updatePosition({plotX:Q,plotY:le,negative:E.negative,ttBelow:E.ttBelow,series:ie,h:X[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}bn(this,"refresh")}renderSplit(s,u){var yr,Na;let p=this,{chart:g,chart:{chartWidth:b,chartHeight:T,plotHeight:C,plotLeft:E,plotTop:D,scrollablePixelsY:N=0,scrollablePixelsX:I,styledMode:U},distance:X,options:Q,options:{fixed:le,position:ne,positioner:ie},pointer:me}=p,{scrollLeft:_e=0,scrollTop:Je=0}=((yr=g.scrollablePlotArea)==null?void 0:yr.scrollingContainer)||{},$e=p.outside&&typeof I!="number"?ml.documentElement.getBoundingClientRect():{left:_e,right:_e+b},Ze=p.getLabel(),ht=this.renderer||g.renderer,at=!!((Na=g.xAxis[0])!=null&&Na.opposite),{left:mt,top:Bt}=me.getChartPosition(),Zt=ie||le,Qt=D+Je,Gt=0,hi=C-N,oi=function(_r,dr,fi,zi=[0,0],hn=!0){let pr,Hr;if(fi.isHeader)Hr=at?0:hi,pr=so(zi[0]-_r/2,$e.left,$e.right-_r-(p.outside?mt:0));else if(le&&fi){let ta=p.getFixedPosition(_r,dr,fi);pr=ta.x,Hr=ta.y-Qt}else Hr=zi[1]-Qt,pr=so(pr=hn?zi[0]-_r-X:zi[0]+X,hn?pr:$e.left,$e.right);return{x:pr,y:Hr}};hu(s)&&(s=[!1,s]);let ji=s.slice(0,u.length+1).reduce(function(_r,dr,fi){if(dr!==!1&&dr!==""){let zi=u[fi-1]||{isHeader:!0,plotX:u[0].plotX,plotY:C,series:{}},hn=zi.isHeader,pr=hn?p:zi.series,Hr=pr.tt=function(us,Rn,xh){let $c=us,{isHeader:El,series:vh}=Rn,So=vh.tooltipOptions||Q;if(!$c){let To={padding:So.padding,r:So.borderRadius};U||(To.fill=So.backgroundColor,To["stroke-width"]=So.borderWidth??(le&&!El?0:1)),$c=ht.label("",0,0,So[El?"headerShape":"shape"]||(le&&!El?"rect":"callout"),void 0,void 0,So.useHTML).addClass(p.getClassName(Rn,!0,El)).attr(To).add(Ze)}return $c.isActive=!0,$c.attr({text:xh}),U||$c.css(So.style).attr({stroke:So.borderColor||Rn.color||vh.color||"#333333"}),$c}(pr.tt,zi,dr.toString()),ta=Hr.getBBox(),Ts=ta.width+Hr.strokeWidth();hn&&(Gt=ta.height,hi+=Gt,at&&(Qt-=Gt));let{anchorX:$s,anchorY:Yo}=function(us){let Rn,xh,{isHeader:$c,plotX:El=0,plotY:vh=0,series:So}=us;if($c)Rn=Math.max(E+El,E),xh=D+C/2;else{let{xAxis:To,yAxis:Hc}=So;Rn=To.pos+so(El,-X,To.len+X),So.shouldShowTooltip(0,Hc.pos-D+vh,{ignoreX:!0})&&(xh=Hc.pos+vh)}return{anchorX:Rn=so(Rn,$e.left-X,$e.right+X),anchorY:xh}}(zi);if(typeof Yo=="number"){let us=ta.height+1,Rn=(ie||oi).call(p,Ts,us,zi,[$s,Yo]);_r.push({align:Zt?0:void 0,anchorX:$s,anchorY:Yo,boxWidth:Ts,point:zi,rank:vs(Rn.rank,+!!hn),size:us,target:Rn.y,tt:Hr,x:Rn.x})}else Hr.isActive=!1}return _r},[]);!Zt&&ji.some(_r=>{let{outside:dr}=p,fi=(dr?mt:0)+_r.anchorX;return fi<$e.left&&fi+_r.boxWidth<$e.right||fi<mt-$e.left+_r.boxWidth&&$e.right-fi>fi})&&(ji=ji.map(_r=>{let{x:dr,y:fi}=oi.call(this,_r.boxWidth,_r.size,_r.point,[_r.anchorX,_r.anchorY],!1);return zd(_r,{target:fi,x:dr})})),p.cleanSplit(),gl(ji,hi);let _i={left:mt,right:mt};ji.forEach(function(_r){let{x:dr,boxWidth:fi,isHeader:zi}=_r;!zi&&(p.outside&&mt+dr<_i.left&&(_i.left=mt+dr),!zi&&p.outside&&_i.left+fi>_i.right&&(_i.right=mt+dr))}),ji.forEach(function(_r){let{x:dr,anchorX:fi,anchorY:zi,pos:hn,point:{isHeader:pr}}=_r,Hr={visibility:hn===void 0?"hidden":"inherit",x:dr,y:(hn||0)+Qt+(le&&ne.y||0),anchorX:fi,anchorY:zi};if(p.outside&&dr<fi){let ta=mt-_i.left;ta>0&&(pr||(Hr.x=dr+ta,Hr.anchorX=fi+ta),pr&&(Hr.x=(_i.right-_i.left)/2,Hr.anchorX=fi+ta))}_r.tt.attr(Hr)});let{container:Di,outside:lr,renderer:Bi}=p;if(lr&&Di&&Bi){let{width:_r,height:dr,x:fi,y:zi}=Ze.getBBox();Bi.setSize(_r+fi,dr+zi,!1),Di.style.left=_i.left+"px",Di.style.top=Bt+"px"}Bh&&Ze.attr({opacity:Ze.opacity===1?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let s=this.chart,u=this.label,p=this.shared?s.hoverPoints:s.hoverPoint;if(!u||!p)return;let g={x:0,y:0,width:0,height:0},b=this.getAnchor(p),T=u.getBBox();b[0]+=s.plotLeft-(u.translateX||0),b[1]+=s.plotTop-(u.translateY||0),g.x=Math.min(0,b[0]),g.y=Math.min(0,b[1]),g.width=b[0]<0?Math.max(Math.abs(b[0]),T.width-b[0]):Math.max(Math.abs(b[0]),T.width),g.height=b[1]<0?Math.max(Math.abs(b[1]),T.height-Math.abs(b[1])):Math.max(Math.abs(b[1]),T.height),this.tracker?this.tracker.attr(g):(this.tracker=u.renderer.rect(g).addClass("highcharts-tracker").add(u),s.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(s){return s.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}headerFooterFormatter(s,u){let p=s.series,g=p.tooltipOptions,b=p.xAxis,T=b==null?void 0:b.dateTime,C={isFooter:u,point:s},E=g.xDateFormat||"",D=g[u?"footerFormat":"headerFormat"];return bn(this,"headerFormatter",C,function(N){if(T&&!E&&th(s.key)&&(E=T.getXDateFormat(s.key,g.dateTimeLabelFormats)),T&&E){if(ih(E)){let I=E;kc[0]=U=>p.chart.time.dateFormat(I,U),E="%0"}(s.tooltipDateKeys||["key"]).forEach(I=>{D=D.replace(RegExp("point\\."+I+"([ \\)}])"),`(point.${I}:${E})$1`)})}p.chart.styledMode&&(D=this.styledModeFormat(D)),N.text=zn(D,s,this.chart)}),C.text||""}update(s){this.destroy(),this.init(this.chart,ql(!0,this.options,s))}updatePosition(s){var $e;let{chart:u,container:p,distance:g,options:b,pointer:T,renderer:C}=this,{height:E=0,width:D=0}=this.getLabel(),{fixed:N,positioner:I}=b,{left:U,top:X,scaleX:Q,scaleY:le}=T.getChartPosition(),ne=(I||N&&this.getFixedPosition||this.getPosition).call(this,D,E,s),ie=Ue.doc,me=(s.plotX||0)+u.plotLeft,_e=(s.plotY||0)+u.plotTop,Je;if(C&&p){if(I||N){let{scrollLeft:Ze=0,scrollTop:ht=0}=(($e=u.scrollablePlotArea)==null?void 0:$e.scrollingContainer)||{};ne.x+=Ze+U-g,ne.y+=ht+X-g}Je=(b.borderWidth||0)+2*g+2,C.setSize(so(D+Je,0,ie.documentElement.clientWidth)-1,E+Je,!1),(Q!==1||le!==1)&&(ss(p,{transform:`scale(${Q}, ${le})`}),me*=Q,_e*=le),me+=U-ne.x,_e+=X-ne.y}this.move(Math.round(ne.x),Math.round(ne.y||0),me,_e)}}(function(R){R.compose=function(s){lo(Zl,"Core.Tooltip")&&yl(s,"afterInit",function(){let u=this.chart;u.options.tooltip&&(u.tooltip=new R(u,u.options.tooltip,this))})}})(co||(co={}));let rh=co,{animObject:du}=Dr,{defaultOptions:bs}=tt,{format:nh}=Sa,{addEvent:rr,crisp:Uo,erase:xl,extend:uo,fireEvent:ah,getNestedProperty:Ld,isArray:Pc,isFunction:Xl,isNumber:ho,isObject:pu,merge:po,pick:fo,syncTimeout:Uh,removeEvent:mo,uniqueKey:Xr}=li;class za{animateBeforeDestroy(){let s=this,u={x:s.startXPos,opacity:0},p=s.getGraphicalProps();p.singular.forEach(function(g){s[g]=s[g].animate(g==="dataLabel"?{x:s[g].startXPos,y:s[g].startYPos,opacity:0}:u)}),p.plural.forEach(function(g){s[g].forEach(function(b){b.element&&b.animate(uo({x:s.startXPos},b.startYPos?{x:b.startXPos,y:b.startYPos}:{}))})})}applyOptions(s,u){let p=this.series,g=p.options.pointValKey||p.pointValKey;return uo(this,s=za.prototype.optionsToObject.call(this,s)),this.options=this.options?uo(this.options,s):s,s.group&&delete this.group,s.dataLabels&&delete this.dataLabels,g&&(this.y=za.prototype.getNestedProperty.call(this,g)),this.selected&&(this.state="select"),"name"in this&&u===void 0&&p.xAxis&&p.xAxis.hasNames&&(this.x=p.xAxis.nameToX(this)),this.x===void 0&&p?this.x=u??p.autoIncrement():ho(s.x)&&p.options.relativeXValue?this.x=p.autoIncrement(s.x):typeof this.x=="string"&&(u??(u=p.chart.time.parse(this.x)),ho(u)&&(this.x=u)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let s=this,u=s.series,p=u.chart,g=u.options.dataSorting,b=p.hoverPoints,T=du(s.series.chart.renderer.globalAnimation),C=()=>{for(let E in(s.graphic||s.graphics||s.dataLabel||s.dataLabels)&&(mo(s),s.destroyElements()),s)delete s[E]};s.legendItem&&p.legend.destroyItem(s),b&&(s.setState(),xl(b,s),b.length||(p.hoverPoints=null)),s===p.hoverPoint&&s.onMouseOut(),g!=null&&g.enabled?(this.animateBeforeDestroy(),Uh(C,T.duration)):C(),p.pointCount--}this.destroyed=!0}destroyElements(s){let u=this,p=u.getGraphicalProps(s);p.singular.forEach(function(g){u[g]=u[g].destroy()}),p.plural.forEach(function(g){u[g].forEach(function(b){b!=null&&b.element&&b.destroy()}),delete u[g]})}firePointEvent(s,u,p){let g=this,b=this.series.options;g.manageEvent(s),s==="click"&&b.allowPointSelect&&(p=function(T){!g.destroyed&&g.select&&g.select(null,T.ctrlKey||T.metaKey||T.shiftKey)}),ah(g,s,u,p)}getClassName(){var s;return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(this.colorIndex!==void 0?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+((s=this.zone)!=null&&s.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(s){let u,p,g=this,b=[],T={singular:[],plural:[]};for((s=s||{graphic:1,dataLabel:1}).graphic&&b.push("graphic","connector"),s.dataLabel&&b.push("dataLabel","dataLabelPath","dataLabelUpper"),p=b.length;p--;)g[u=b[p]]&&T.singular.push(u);return["graphic","dataLabel"].forEach(function(C){let E=C+"s";s[C]&&g[E]&&T.plural.push(E)}),T}getNestedProperty(s){return s?s.indexOf("custom.")===0?Ld(s,this.options):this[s]:void 0}getZone(){let s=this.series,u=s.zones,p=s.zoneAxis||"y",g,b=0;for(g=u[0];this[p]>=g.value;)g=u[++b];return this.nonZonedColor||(this.nonZonedColor=this.color),g!=null&&g.color&&!this.options.color?this.color=g.color:this.color=this.nonZonedColor,g}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(s,u,p){this.formatPrefix="point",this.visible=!0,this.point=this,this.series=s,this.applyOptions(u,p),this.id??(this.id=Xr()),this.resolveColor(),this.dataLabelOnNull??(this.dataLabelOnNull=s.options.nullInteraction),s.chart.pointCount++,ah(this,"afterInit")}isValid(){return(ho(this.x)||this.x instanceof Date)&&ho(this.y)}optionsToObject(s){var N;let u=this.series,p=u.options.keys,g=p||u.pointArrayMap||["y"],b=g.length,T={},C,E=0,D=0;if(ho(s)||s===null)T[g[0]]=s;else if(Pc(s))for(!p&&s.length>b&&((C=typeof s[0])=="string"?(N=u.xAxis)!=null&&N.dateTime?T.x=u.chart.time.parse(s[0]):T.name=s[0]:C==="number"&&(T.x=s[0]),E++);D<b;)p&&s[E]===void 0||(g[D].indexOf(".")>0?za.prototype.setNestedProperty(T,s[E],g[D]):T[g[D]]=s[E]),E++,D++;else typeof s=="object"&&(T=s,s.dataLabels&&(u.hasDataLabels=()=>!0),s.marker&&(u._hasPointMarkers=!0));return T}pos(s,u=this.plotY){if(!this.destroyed){let{plotX:p,series:g}=this,{chart:b,xAxis:T,yAxis:C}=g,E=0,D=0;if(ho(p)&&ho(u))return s&&(E=T?T.pos:b.plotLeft,D=C?C.pos:b.plotTop),b.inverted&&T&&C?[C.len-u+D,T.len-p+E]:[p+E,u+D]}}resolveColor(){let s=this.series,u=s.chart.options.chart,p=s.chart.styledMode,g,b,T=u.colorCount,C;delete this.nonZonedColor,s.options.colorByPoint?(p||(g=(b=s.options.colors||s.chart.options.colors)[s.colorCounter],T=b.length),C=s.colorCounter,s.colorCounter++,s.colorCounter===T&&(s.colorCounter=0)):(p||(g=s.color),C=s.colorIndex),this.colorIndex=fo(this.options.colorIndex,C),this.color=fo(this.options.color,g)}setNestedProperty(s,u,p){return p.split(".").reduce(function(g,b,T,C){let E=C.length-1===T;return g[b]=E?u:pu(g[b],!0)?g[b]:{},g[b]},s),s}shouldDraw(){return!this.isNull}tooltipFormatter(s){var E;let{chart:u,pointArrayMap:p=["y"],tooltipOptions:g}=this.series,{valueDecimals:b="",valuePrefix:T="",valueSuffix:C=""}=g;return u.styledMode&&(s=((E=u.tooltip)==null?void 0:E.styledModeFormat(s))||s),p.forEach(D=>{D="{point."+D,(T||C)&&(s=s.replace(RegExp(D+"}","g"),T+D+"}"+C)),s=s.replace(RegExp(D+"}","g"),D+":,."+b+"f}")}),nh(s,this,u)}update(s,u,p,g){let b,T=this,C=T.series,E=T.graphic,D=C.chart,N=C.options;function I(){T.applyOptions(s);let U=E&&T.hasMockGraphic,X=T.y===null?!U:U;E&&X&&(T.graphic=E.destroy(),delete T.hasMockGraphic),pu(s,!0)&&(E!=null&&E.element&&s&&s.marker&&s.marker.symbol!==void 0&&(T.graphic=E.destroy()),s!=null&&s.dataLabels&&T.dataLabel&&(T.dataLabel=T.dataLabel.destroy())),b=T.index;let Q={};for(let le of C.dataColumnKeys())Q[le]=T[le];C.dataTable.setRow(Q,b),N.data[b]=pu(N.data[b],!0)||pu(s,!0)?T.options:fo(s,N.data[b]),C.isDirty=C.isDirtyData=!0,!C.fixedBox&&C.hasCartesianSeries&&(D.isDirtyBox=!0),N.legendType==="point"&&(D.isDirtyLegend=!0),u&&D.redraw(p)}u=fo(u,!0),g===!1?I():T.firePointEvent("update",{options:s},I)}remove(s,u){this.series.removePoint(this.series.data.indexOf(this),s,u)}select(s,u){let p=this,g=p.series,b=g.chart;s=fo(s,!p.selected),this.selectedStaging=s,p.firePointEvent(s?"select":"unselect",{accumulate:u},function(){p.selected=p.options.selected=s,g.options.data[g.data.indexOf(p)]=p.options,p.setState(s&&"select"),u||b.getSelectedPoints().forEach(function(T){let C=T.series;T.selected&&T!==p&&(T.selected=T.options.selected=!1,C.options.data[C.data.indexOf(T)]=T.options,T.setState(b.hoverPoints&&C.options.inactiveOtherPoints?"inactive":""),T.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver(s){let{inverted:u,pointer:p}=this.series.chart;p&&(s=s?p.normalize(s):p.getChartCoordinatesFromPoint(this,u),p.runPointActions(s,this))}onMouseOut(){let s=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(s.hoverPoints||[]).forEach(function(u){u.setState()}),s.hoverPoints=s.hoverPoint=null}manageEvent(s){var g,b,T,C,E,D,N;let u=po(this.series.options.point,this.options),p=(g=u.events)==null?void 0:g[s];Xl(p)&&(!((b=this.hcEvents)!=null&&b[s])||((C=(T=this.hcEvents)==null?void 0:T[s])==null?void 0:C.map(I=>I.fn).indexOf(p))===-1)?((E=this.importedUserEvent)==null||E.call(this),this.importedUserEvent=rr(this,s,p),this.hcEvents&&(this.hcEvents[s].userEvent=!0)):this.importedUserEvent&&!p&&((D=this.hcEvents)!=null&&D[s])&&((N=this.hcEvents)!=null&&N[s].userEvent)&&(mo(this,s),delete this.hcEvents[s],Object.keys(this.hcEvents)||delete this.importedUserEvent)}setState(s,u){var Ze,ht;let p=this.series,g=this.state,b=p.options.states[s||"normal"]||{},T=bs.plotOptions[p.type].marker&&p.options.marker,C=T&&T.enabled===!1,E=((Ze=T==null?void 0:T.states)==null?void 0:Ze[s||"normal"])||{},D=E.enabled===!1,N=this.marker||{},I=p.chart,U=T&&p.markerAttribs,X=p.halo,Q,le,ne,ie=p.stateMarkerGraphic,me;if((s=s||"")===this.state&&!u||this.selected&&s!=="select"||b.enabled===!1||s&&(D||C&&E.enabled===!1)||s&&N.states&&N.states[s]&&N.states[s].enabled===!1)return;if(this.state=s,U&&(Q=p.markerAttribs(this,s)),this.graphic&&!this.hasMockGraphic){if(g&&this.graphic.removeClass("highcharts-point-"+g),s&&this.graphic.addClass("highcharts-point-"+s),!I.styledMode){le=p.pointAttribs(this,s),ne=fo(I.options.chart.animation,b.animation);let at=le.opacity;p.options.inactiveOtherPoints&&ho(at)&&(this.dataLabels||[]).forEach(function(mt){mt&&!mt.hasClass("highcharts-data-label-hidden")&&(mt.animate({opacity:at},ne),mt.connector&&mt.connector.animate({opacity:at},ne))}),this.graphic.animate(le,ne)}Q&&this.graphic.animate(Q,fo(I.options.chart.animation,E.animation,T.animation)),ie&&ie.hide()}else s&&E&&(me=N.symbol||p.symbol,ie&&ie.currentSymbol!==me&&(ie=ie.destroy()),Q&&(ie?ie[u?"animate":"attr"]({x:Q.x,y:Q.y}):me&&(p.stateMarkerGraphic=ie=I.renderer.symbol(me,Q.x,Q.y,Q.width,Q.height,po(T,E)).add(p.markerGroup),ie.currentSymbol=me)),!I.styledMode&&ie&&this.state!=="inactive"&&ie.attr(p.pointAttribs(this,s))),ie&&(ie[s&&this.isInside?"show":"hide"](),ie.element.point=this,ie.addClass(this.getClassName(),!0));let _e=b.halo,Je=this.graphic||ie,$e=(Je==null?void 0:Je.visibility)||"inherit";_e!=null&&_e.size&&Je&&$e!=="hidden"&&!this.isCluster?(X||(p.halo=X=I.renderer.path().add(Je.parentGroup)),X.show()[u?"animate":"attr"]({d:this.haloPath(_e.size)}),X.attr({class:"highcharts-halo highcharts-color-"+fo(this.colorIndex,p.colorIndex)+(this.className?" "+this.className:""),visibility:$e,zIndex:-1}),X.point=this,I.styledMode||X.attr(uo({fill:this.color||p.color,"fill-opacity":_e.opacity},Er.filterUserAttributes(_e.attributes||{})))):(ht=X==null?void 0:X.point)!=null&&ht.haloPath&&!X.point.destroyed&&X.animate({d:X.point.haloPath(0)},null,X.hide),ah(this,"afterSetState",{state:s})}haloPath(s){let u=this.pos();return u?this.series.chart.renderer.symbols.circle(Uo(u[0],1)-s,u[1]-s,2*s,2*s):[]}}let $i=za,{parse:Ir}=ai,{charts:mn,composed:sh,isTouchDevice:fu}=Ue,{addEvent:Yr,attr:zc,css:ui,extend:Ti,find:oh,fireEvent:Or,isNumber:Vo,isObject:Fn,objectEach:Dd,offset:Qn,pick:go,pushUnique:vl,splat:Wr}=li;class er{applyInactiveState(s=[]){let u=[];s.forEach(p=>{let g=p.series;u.push(g),g.linkedParent&&u.push(g.linkedParent),g.linkedSeries&&u.push.apply(u,g.linkedSeries),g.navigatorSeries&&u.push(g.navigatorSeries),g.boosted&&g.markerGroup&&u.push.apply(u,this.chart.series.filter(b=>b.markerGroup===g.markerGroup))}),this.chart.series.forEach(p=>{u.indexOf(p)===-1?p.setState("inactive",!0):p.options.inactiveOtherPoints&&p.setAllPointsToState("inactive")})}destroy(){let s=this;this.eventsToUnbind.forEach(u=>u()),this.eventsToUnbind=[],!Ue.chartCount&&(er.unbindDocumentMouseUp.forEach(u=>u.unbind()),er.unbindDocumentMouseUp.length=0,er.unbindDocumentTouchEnd&&(er.unbindDocumentTouchEnd=er.unbindDocumentTouchEnd())),clearInterval(s.tooltipTimeout),Dd(s,function(u,p){s[p]=void 0})}getSelectionMarkerAttrs(s,u){let p={args:{chartX:s,chartY:u},attrs:{},shapeType:"rect"};return Or(this,"getSelectionMarkerAttrs",p,g=>{let b,{chart:T,zoomHor:C,zoomVert:E}=this,{mouseDownX:D=0,mouseDownY:N=0}=T,I=g.attrs;I.x=T.plotLeft,I.y=T.plotTop,I.width=C?1:T.plotWidth,I.height=E?1:T.plotHeight,C&&(I.width=Math.max(1,Math.abs(b=s-D)),I.x=(b>0?0:b)+D),E&&(I.height=Math.max(1,Math.abs(b=u-N)),I.y=(b>0?0:b)+N)}),p}drag(s){let{chart:u}=this,{mouseDownX:p=0,mouseDownY:g=0}=u,{panning:b,panKey:T,selectionMarkerFill:C}=u.options.chart,E=u.plotLeft,D=u.plotTop,N=u.plotWidth,I=u.plotHeight,U=Fn(b)?b.enabled:b,X=T&&s[`${T}Key`],Q=s.chartX,le=s.chartY,ne,ie=this.selectionMarker;if((!ie||!ie.touch)&&(Q<E?Q=E:Q>E+N&&(Q=E+N),le<D?le=D:le>D+I&&(le=D+I),this.hasDragged=Math.sqrt(Math.pow(p-Q,2)+Math.pow(g-le,2)),this.hasDragged>10)){ne=u.isInsidePlot(p-E,g-D,{visiblePlotOnly:!0});let{shapeType:me,attrs:_e}=this.getSelectionMarkerAttrs(Q,le);(u.hasCartesianSeries||u.mapView)&&this.hasZoom&&ne&&!X&&!ie&&(this.selectionMarker=ie=u.renderer[me](),ie.attr({class:"highcharts-selection-marker",zIndex:7}).add(),u.styledMode||ie.attr({fill:C||Ir("#334eff").setOpacity(.25).get()})),ie&&ie.attr(_e),ne&&!ie&&U&&u.pan(s,b)}}dragStart(s){let u=this.chart;u.mouseIsDown=s.type,u.cancelClick=!1,u.mouseDownX=s.chartX,u.mouseDownY=s.chartY}getSelectionBox(s){let u={args:{marker:s},result:s.getBBox()};return Or(this,"getSelectionBox",u),u.result}drop(s){let u,{chart:p,selectionMarker:g}=this;for(let b of p.axes)b.isPanning&&(b.isPanning=!1,(b.options.startOnTick||b.options.endOnTick||b.series.some(T=>T.boosted))&&(b.forceRedraw=!0,b.setExtremes(b.userMin,b.userMax,!1),u=!0));if(u&&p.redraw(),g&&s){if(this.hasDragged){let b=this.getSelectionBox(g);p.transform({axes:p.axes.filter(T=>T.zoomEnabled&&(T.coll==="xAxis"&&this.zoomX||T.coll==="yAxis"&&this.zoomY)),selection:{originalEvent:s,xAxis:[],yAxis:[],...b},from:b})}Vo(p.index)&&(this.selectionMarker=g.destroy())}p&&Vo(p.index)&&(ui(p.container,{cursor:p._cursor}),p.cancelClick=this.hasDragged>10,p.mouseIsDown=!1,this.hasDragged=0,this.pinchDown=[])}findNearestKDPoint(s,u,p){let g;return s.forEach(function(b){let T=!(b.noSharedTooltip&&u)&&0>b.options.findNearestPointBy.indexOf("y"),C=b.searchPoint(p,T);Fn(C,!0)&&C.series&&(!Fn(g,!0)||function(E,D){var X,Q;let N=E.distX-D.distX,I=E.dist-D.dist,U=((X=D.series.group)==null?void 0:X.zIndex)-((Q=E.series.group)==null?void 0:Q.zIndex);return N!==0&&u?N:I!==0?I:U!==0?U:E.series.index>D.series.index?-1:1}(g,C)>0)&&(g=C)}),g}getChartCoordinatesFromPoint(s,u){let{xAxis:p,yAxis:g}=s.series,b=s.shapeArgs;if(p&&g){let T=s.clientX??s.plotX??0,C=s.plotY||0;return s.isNode&&b&&Vo(b.x)&&Vo(b.y)&&(T=b.x,C=b.y),u?{chartX:g.len+g.pos-C,chartY:p.len+p.pos-T}:{chartX:T+p.pos,chartY:C+g.pos}}if(b!=null&&b.x&&b.y)return{chartX:b.x,chartY:b.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:s}=this.chart,u=Qn(s);this.chartPosition={left:u.left,top:u.top,scaleX:1,scaleY:1};let{offsetHeight:p,offsetWidth:g}=s;return g>2&&p>2&&(this.chartPosition.scaleX=u.width/g,this.chartPosition.scaleY=u.height/p),this.chartPosition}getCoordinates(s){let u={xAxis:[],yAxis:[]};for(let p of this.chart.axes)u[p.isXAxis?"xAxis":"yAxis"].push({axis:p,value:p.toValue(s[p.horiz?"chartX":"chartY"])});return u}getHoverData(s,u,p,g,b,T){let C=[],E=function(X){return X.visible&&!(!b&&X.directTouch)&&go(X.options.enableMouseTracking,!0)},D=u,N,I={chartX:T?T.chartX:void 0,chartY:T?T.chartY:void 0,shared:b};Or(this,"beforeGetHoverData",I),N=D&&!D.stickyTracking?[D]:p.filter(X=>X.stickyTracking&&(I.filter||E)(X));let U=g&&s||!T?s:this.findNearestKDPoint(N,b,T);return D=U==null?void 0:U.series,U&&(b&&!D.noSharedTooltip?(N=p.filter(function(X){return I.filter?I.filter(X):E(X)&&!X.noSharedTooltip})).forEach(function(X){var ne;let Q=(ne=X.options)==null?void 0:ne.nullInteraction,le=oh(X.points,function(ie){return ie.x===U.x&&(!ie.isNull||!!Q)});Fn(le)&&(X.boosted&&X.boost&&(le=X.boost.getPoint(le)),C.push(le))}):C.push(U)),Or(this,"afterGetHoverData",I={hoverPoint:U}),{hoverPoint:I.hoverPoint,hoverSeries:D,hoverPoints:C}}getPointFromEvent(s){let u=s.target,p;for(;u&&!p;)p=u.point,u=u.parentNode;return p}onTrackerMouseOut(s){let u=this.chart,p=s.relatedTarget,g=u.hoverSeries;this.isDirectTouch=!1,!g||!p||g.stickyTracking||this.inClass(p,"highcharts-tooltip")||this.inClass(p,"highcharts-series-"+g.index)&&this.inClass(p,"highcharts-tracker")||g.onMouseOut()}inClass(s,u){let p=s,g;for(;p;){if(g=zc(p,"class")){if(g.indexOf(u)!==-1)return!0;if(g.indexOf("highcharts-container")!==-1)return!1}p=p.parentElement}}constructor(s,u){var p;this.hasDragged=0,this.pointerCaptureEventsToUnbind=[],this.eventsToUnbind=[],this.options=u,this.chart=s,this.runChartClick=!!((p=u.chart.events)!=null&&p.click),this.pinchDown=[],this.setDOMEvents(),Or(this,"afterInit")}normalize(s,u){let p=s.touches,g=p?p.length?p.item(0):go(p.changedTouches,s.changedTouches)[0]:s;u||(u=this.getChartPosition());let b=g.pageX-u.left,T=g.pageY-u.top;return Ti(s,{chartX:Math.round(b/=u.scaleX),chartY:Math.round(T/=u.scaleY)})}onContainerClick(s){let u=this.chart,p=u.hoverPoint,g=this.normalize(s),b=u.plotLeft,T=u.plotTop;!u.cancelClick&&(p&&this.inClass(g.target,"highcharts-tracker")?(Or(p.series,"click",Ti(g,{point:p})),u.hoverPoint&&p.firePointEvent("click",g)):(Ti(g,this.getCoordinates(g)),u.isInsidePlot(g.chartX-b,g.chartY-T,{visiblePlotOnly:!0})&&Or(u,"click",g)))}onContainerMouseDown(s){var p;let u=(1&(s.buttons||s.button))==1;s=this.normalize(s),Ue.isFirefox&&s.button!==0&&this.onContainerMouseMove(s),(s.button===void 0||u)&&(this.zoomOption(s),u&&((p=s.preventDefault)==null||p.call(s)),this.dragStart(s))}onContainerMouseLeave(s){let{pointer:u}=mn[go(er.hoverChartIndex,-1)]||{};s=this.normalize(s),this.onContainerMouseMove(s),u&&!this.inClass(s.relatedTarget,"highcharts-tooltip")&&(u.reset(),u.chartPosition=void 0)}onContainerMouseEnter(){delete this.chartPosition}onContainerMouseMove(s){let u=this.chart,p=u.tooltip,g=this.normalize(s);this.setHoverChartIndex(s),(u.mouseIsDown==="mousedown"||this.touchSelect(g))&&this.drag(g),!u.openMenu&&(this.inClass(g.target,"highcharts-tracker")||u.isInsidePlot(g.chartX-u.plotLeft,g.chartY-u.plotTop,{visiblePlotOnly:!0}))&&!(p!=null&&p.shouldStickOnContact(g))&&(this.inClass(g.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(g))}onDocumentTouchEnd(s){this.onDocumentMouseUp(s)}onContainerTouchMove(s){this.touchSelect(s)?this.onContainerMouseMove(s):this.touch(s)}onContainerTouchStart(s){this.touchSelect(s)?this.onContainerMouseDown(s):(this.zoomOption(s),this.touch(s,!0))}onDocumentMouseMove(s){let u=this.chart,p=u.tooltip,g=this.chartPosition,b=this.normalize(s,g);!g||u.isInsidePlot(b.chartX-u.plotLeft,b.chartY-u.plotTop,{visiblePlotOnly:!0})||p!=null&&p.shouldStickOnContact(b)||b.target!==u.container.ownerDocument&&this.inClass(b.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(s){var u,p;(p=(u=mn[go(er.hoverChartIndex,-1)])==null?void 0:u.pointer)==null||p.drop(s)}pinch(s){let u=this,{chart:p,hasZoom:g,lastTouches:b}=u,T=[].map.call(s.touches||[],I=>u.normalize(I)),C=T.length,E=C===1&&(u.inClass(s.target,"highcharts-tracker")&&p.runTrackerClick||u.runChartClick),D=p.tooltip,N=C===1&&go(D==null?void 0:D.options.followTouchMove,!0);C>1?u.initiated=!0:N&&(u.initiated=!1),g&&u.initiated&&!E&&s.cancelable!==!1&&s.preventDefault(),s.type==="touchstart"?(u.pinchDown=T,u.res=!0,p.mouseDownX=s.chartX):N?this.runPointActions(u.normalize(s)):b&&(Or(p,"touchpan",{originalEvent:s,touches:T},()=>{let I=U=>{let X=U[0],Q=U[1]||X;return{x:X.chartX,y:X.chartY,width:Q.chartX-X.chartX,height:Q.chartY-X.chartY}};p.transform({axes:p.axes.filter(U=>U.zoomEnabled&&(this.zoomHor&&U.horiz||this.zoomVert&&!U.horiz)),to:I(T),from:I(b),trigger:s.type})}),u.res&&(u.res=!1,this.reset(!1,0))),u.lastTouches=T}reset(s,u){let p=this.chart,g=p.hoverSeries,b=p.hoverPoint,T=p.hoverPoints,C=p.tooltip,E=C!=null&&C.shared?T:b;s&&E&&Wr(E).forEach(function(D){D.series.isCartesian&&D.plotX===void 0&&(s=!1)}),s?C&&E&&Wr(E).length&&(C.refresh(E),C.shared&&T?T.forEach(function(D){D.setState(D.state,!0),D.series.isCartesian&&(D.series.xAxis.crosshair&&D.series.xAxis.drawCrosshair(null,D),D.series.yAxis.crosshair&&D.series.yAxis.drawCrosshair(null,D))}):b&&(b.setState(b.state,!0),p.axes.forEach(function(D){D.crosshair&&b.series[D.coll]===D&&D.drawCrosshair(null,b)}))):(b&&b.onMouseOut(),T&&T.forEach(function(D){D.setState()}),g&&g.onMouseOut(),C&&C.hide(u),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),p.axes.forEach(function(D){D.hideCrosshair()}),p.hoverPoints=p.hoverPoint=void 0)}runPointActions(s,u,p){var le;let g=this.chart,b=g.series,T=(le=g.tooltip)!=null&&le.options.enabled?g.tooltip:void 0,C=!!T&&T.shared,E=u||g.hoverPoint,D=(E==null?void 0:E.series)||g.hoverSeries,N=(!s||s.type!=="touchmove")&&(!!u||(D==null?void 0:D.directTouch)&&this.isDirectTouch),I=this.getHoverData(E,D,b,N,C,s);E=I.hoverPoint,D=I.hoverSeries;let U=I.hoverPoints,X=(D==null?void 0:D.tooltipOptions.followPointer)&&!D.tooltipOptions.split,Q=C&&D&&!D.noSharedTooltip;if(E&&(p||E!==g.hoverPoint||T!=null&&T.isHidden)){if((g.hoverPoints||[]).forEach(function(ne){U.indexOf(ne)===-1&&ne.setState()}),g.hoverSeries!==D&&D.onMouseOver(),this.applyInactiveState(U),(U||[]).forEach(function(ne){ne.setState("hover")}),g.hoverPoint&&g.hoverPoint.firePointEvent("mouseOut"),!E.series)return;g.hoverPoints=U,g.hoverPoint=E,E.firePointEvent("mouseOver",void 0,()=>{T&&E&&T.refresh(Q?U:E,s)})}else if(X&&T&&!T.isHidden){let ne=T.getAnchor([{}],s);g.isInsidePlot(ne[0],ne[1],{visiblePlotOnly:!0})&&T.updatePosition({plotX:ne[0],plotY:ne[1]})}this.unDocMouseMove||(this.unDocMouseMove=Yr(g.container.ownerDocument,"mousemove",ne=>{var ie,me;return(me=(ie=mn[er.hoverChartIndex??-1])==null?void 0:ie.pointer)==null?void 0:me.onDocumentMouseMove(ne)}),this.eventsToUnbind.push(this.unDocMouseMove)),g.axes.forEach(function(ne){var _e;let ie,me=((_e=ne.crosshair)==null?void 0:_e.snap)??!0;!me||(ie=g.hoverPoint)&&ie.series[ne.coll]===ne||(ie=oh(U,Je=>{var $e;return(($e=Je.series)==null?void 0:$e[ne.coll])===ne})),ie||!me?ne.drawCrosshair(s,ie):ne.hideCrosshair()})}setDOMEvents(){let s=this.chart.container,u=s.ownerDocument;s.onmousedown=this.onContainerMouseDown.bind(this),s.onmousemove=this.onContainerMouseMove.bind(this),s.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(Yr(s,"mouseenter",this.onContainerMouseEnter.bind(this)),Yr(s,"mouseleave",this.onContainerMouseLeave.bind(this))),er.unbindDocumentMouseUp.some(g=>g.doc===u)||er.unbindDocumentMouseUp.push({doc:u,unbind:Yr(u,"mouseup",this.onDocumentMouseUp.bind(this))});let p=this.chart.renderTo.parentElement;for(;p&&p.tagName!=="BODY";)this.eventsToUnbind.push(Yr(p,"scroll",()=>{delete this.chartPosition})),p=p.parentElement;this.eventsToUnbind.push(Yr(s,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1}),Yr(s,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),er.unbindDocumentTouchEnd||(er.unbindDocumentTouchEnd=Yr(u,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})),this.setPointerCapture(),Yr(this.chart,"redraw",this.setPointerCapture.bind(this))}setPointerCapture(){var b,T;if(!fu)return;let s=this.pointerCaptureEventsToUnbind,u=this.chart,p=u.container,g=go((b=u.options.tooltip)==null?void 0:b.followTouchMove,!0)&&u.series.some(C=>C.options.findNearestPointBy.indexOf("y")>-1);!this.hasPointerCapture&&g?(s.push(Yr(p,"pointerdown",C=>{var E,D;(E=C.target)!=null&&E.hasPointerCapture(C.pointerId)&&((D=C.target)==null||D.releasePointerCapture(C.pointerId))}),Yr(p,"pointermove",C=>{var E,D;(D=(E=u.pointer)==null?void 0:E.getPointFromEvent(C))==null||D.onMouseOver(C)})),u.styledMode||ui(p,{"touch-action":"none"}),p.className+=" highcharts-no-touch-action",this.hasPointerCapture=!0):this.hasPointerCapture&&!g&&(s.forEach(C=>C()),s.length=0,u.styledMode||ui(p,{"touch-action":go((T=u.options.chart.style)==null?void 0:T["touch-action"],"manipulation")}),p.className=p.className.replace(" highcharts-no-touch-action",""),this.hasPointerCapture=!1)}setHoverChartIndex(s){var g;let u=this.chart,p=Ue.charts[go(er.hoverChartIndex,-1)];if(p&&p!==u){let b={relatedTarget:u.container};s&&!(s!=null&&s.relatedTarget)&&Object.assign({},s,b),(g=p.pointer)==null||g.onContainerMouseLeave(s||b)}p!=null&&p.mouseIsDown||(er.hoverChartIndex=u.index)}touch(s,u){let p,{chart:g,pinchDown:b=[]}=this;this.setHoverChartIndex(),(s=this.normalize(s)).touches.length===1?g.isInsidePlot(s.chartX-g.plotLeft,s.chartY-g.plotTop,{visiblePlotOnly:!0})&&!g.openMenu?(u&&this.runPointActions(s),s.type==="touchmove"&&(p=!!b[0]&&Math.pow(b[0].chartX-s.chartX,2)+Math.pow(b[0].chartY-s.chartY,2)>=16),go(p,!0)&&this.pinch(s)):u&&this.reset():s.touches.length===2&&this.pinch(s)}touchSelect(s){return!!(this.chart.zooming.singleTouch&&s.touches&&s.touches.length===1)}zoomOption(s){let u=this.chart,p=u.inverted,g=u.zooming.type||"",b,T;/touch/.test(s.type)&&(g=go(u.zooming.pinchType,g)),this.zoomX=b=/x/.test(g),this.zoomY=T=/y/.test(g),this.zoomHor=b&&!p||T&&p,this.zoomVert=T&&!p||b&&p,this.hasZoom=b||T}}er.unbindDocumentMouseUp=[],function(R){R.compose=function(s){vl(sh,"Core.Pointer")&&Yr(s,"beforeRender",function(){this.pointer=new R(this,this.options)})}}(er||(er={}));let La=er;(function(R){R.setLength=function(s,u,p){return Array.isArray(s)?(s.length=u,s):s[p?"subarray":"slice"](0,u)},R.splice=function(s,u,p,g,b=[]){if(Array.isArray(s))return Array.isArray(b)||(b=Array.from(b)),{removed:s.splice(u,p,...b),array:s};let T=Object.getPrototypeOf(s).constructor,C=s[g?"subarray":"slice"](u,u+p),E=new T(s.length-p+b.length);return E.set(s.subarray(0,u),0),E.set(b,u),E.set(s.subarray(u+p),u+b.length),{removed:C,array:E}}})(Ee||(Ee={}));let{setLength:Kr,splice:yo}=Ee,{fireEvent:bl,objectEach:_o,uniqueKey:ws}=li,Da=class{constructor(R={}){this.autoId=!R.id,this.columns={},this.id=R.id||ws(),this.modified=this,this.rowCount=0,this.versionTag=ws();let s=0;_o(R.columns||{},(u,p)=>{this.columns[p]=u.slice(),s=Math.max(s,u.length)}),this.applyRowCount(s)}applyRowCount(R){this.rowCount=R,_o(this.columns,(s,u)=>{s.length!==R&&(this.columns[u]=Kr(s,R))})}deleteRows(R,s=1){if(s>0&&R<this.rowCount){let u=0;_o(this.columns,(p,g)=>{this.columns[g]=yo(p,R,s).array,u=p.length}),this.rowCount=u}bl(this,"afterDeleteRows",{rowIndex:R,rowCount:s}),this.versionTag=ws()}getColumn(R,s){return this.columns[R]}getColumns(R,s){return(R||Object.keys(this.columns)).reduce((u,p)=>(u[p]=this.columns[p],u),{})}getRow(R,s){return(s||Object.keys(this.columns)).map(u=>{var p;return(p=this.columns[u])==null?void 0:p[R]})}setColumn(R,s=[],u=0,p){this.setColumns({[R]:s},u,p)}setColumns(R,s,u){let p=this.rowCount;_o(R,(g,b)=>{this.columns[b]=g.slice(),p=g.length}),this.applyRowCount(p),u!=null&&u.silent||(bl(this,"afterSetColumns"),this.versionTag=ws())}setRow(R,s=this.rowCount,u,p){let{columns:g}=this,b=u?this.rowCount+1:s+1;_o(R,(T,C)=>{let E=g[C]||(p==null?void 0:p.addColumns)!==!1&&Array(b);E&&(u?E=yo(E,s,0,!0,[T]).array:E[s]=T,g[C]=E)}),b>this.rowCount&&this.applyRowCount(b),p!=null&&p.silent||(bl(this,"afterSetRows"),this.versionTag=ws())}},{extend:mu,merge:gu,pick:yu}=li;(function(R){function s(u,p,g){var Je,$e;let b=this.legendItem=this.legendItem||{},{chart:T,options:C}=this,{baseline:E=0,symbolWidth:D,symbolHeight:N}=u,I=this.symbol||"circle",U=N/2,X=T.renderer,Q=b.group,le=E-Math.round((((Je=u.fontMetrics)==null?void 0:Je.b)||N)*(g?.4:.3)),ne={},ie,me=C.marker,_e=0;if(T.styledMode||(ne["stroke-width"]=Math.min(C.lineWidth||0,24),C.dashStyle?ne.dashstyle=C.dashStyle:C.linecap==="square"||(ne["stroke-linecap"]="round")),b.line=X.path().addClass("highcharts-graph").attr(ne).add(Q),g&&(b.area=X.path().addClass("highcharts-area").add(Q)),ne["stroke-linecap"]&&(_e=Math.min(b.line.strokeWidth(),D)/2),D){let Ze=[["M",_e,le],["L",D-_e,le]];b.line.attr({d:Ze}),($e=b.area)==null||$e.attr({d:[...Ze,["L",D-_e,E],["L",_e,E]]})}if(me&&me.enabled!==!1&&D){let Ze=Math.min(yu(me.radius,U),U);I.indexOf("url")===0&&(me=gu(me,{width:N,height:N}),Ze=0),b.symbol=ie=X.symbol(I,D/2-Ze,le-Ze,2*Ze,2*Ze,mu({context:"legend"},me)).addClass("highcharts-point").add(Q),ie.isMarker=!0}}R.areaMarker=function(u,p){s.call(this,u,p,!0)},R.lineMarker=s,R.rectangle=function(u,p){let g=p.legendItem||{},b=u.options,T=u.symbolHeight,C=b.squareSymbol,E=C?T:u.symbolWidth;g.symbol=this.chart.renderer.rect(C?(u.symbolWidth-T)/2:0,u.baseline-T+1,E,T,yu(u.options.symbolRadius,T/2)).addClass("highcharts-point").attr({zIndex:3}).add(g.group)}})(pe||(pe={}));let y=pe,{defaultOptions:e}=tt,{extend:r,extendClass:c,merge:f}=li;(function(R){function s(u,p){let g=e.plotOptions||{},b=p.defaultOptions,T=p.prototype;return T.type=u,T.pointClass||(T.pointClass=$i),!R.seriesTypes[u]&&(b&&(g[u]=b),R.seriesTypes[u]=p,!0)}R.seriesTypes=Ue.seriesTypes,R.registerSeriesType=s,R.seriesType=function(u,p,g,b,T){let C=e.plotOptions||{};if(p=p||"",C[u]=f(C[p],g),delete R.seriesTypes[u],s(u,c(R.seriesTypes[p]||function(){},b)),R.seriesTypes[u].prototype.type=u,T){class E extends $i{}r(E.prototype,T),R.seriesTypes[u].prototype.pointClass=E}return R.seriesTypes[u]}})(Se||(Se={}));let _=Se,{animObject:M,setAnimation:P}=Dr,{defaultOptions:L}=tt,{registerEventOptions:V}=Tc,{svg:q,win:K}=Ue,{seriesTypes:W}=_,{format:te}=Sa,{arrayMax:he,arrayMin:Ae,clamp:Ce,correctFloat:ke,crisp:ze,defined:Le,destroyObjectProperties:De,diffObjects:Ge,erase:Ye,error:Re,extend:it,find:vt,fireEvent:ot,getClosestDistance:ft,getNestedProperty:wt,insertItem:ei,isArray:Kt,isNumber:Lt,isString:pi,merge:Hi,objectEach:xr,pick:Xi,removeEvent:jr,syncTimeout:tn}=li;class cr{constructor(){this.zoneAxis="y"}init(s,u){var E,D,N;let p;ot(this,"init",{options:u}),this.dataTable??(this.dataTable=new Da);let g=s.series;this.eventsToUnbind=[],this.chart=s,this.options=this.setOptions(u);let b=this.options,T=b.visible!==!1;this.linkedSeries=[],this.bindAxes(),it(this,{name:b.name,state:"",visible:T,selected:b.selected===!0}),V(this,b);let C=b.events;(C!=null&&C.click||(D=(E=b.point)==null?void 0:E.events)!=null&&D.click||b.allowPointSelect)&&(s.runTrackerClick=!0),this.getColor(),this.getSymbol(),this.isCartesian&&(s.hasCartesianSeries=!0),g.length&&(p=g[g.length-1]),this._i=Xi(p==null?void 0:p._i,-1)+1,this.opacity=this.options.opacity,s.orderItems("series",ei(this,g)),(N=b.dataSorting)!=null&&N.enabled?this.setDataSortingOptions():this.points||this.data||this.setData(b.data,!1),ot(this,"afterInit")}is(s){return W[s]&&this instanceof W[s]}bindAxes(){let s,u=this,p=u.options,g=u.chart;ot(this,"bindAxes",null,function(){(u.axisTypes||[]).forEach(function(b){(g[b]||[]).forEach(function(T){s=T.options,(Xi(p[b],0)===T.index||p[b]!==void 0&&p[b]===s.id)&&(ei(u,T.series),u[b]=T,T.isDirty=!0)}),u[b]||u.optionalAxis===b||Re(18,!0,g)})}),ot(this,"afterBindAxes")}hasData(){return this.visible&&this.dataMax!==void 0&&this.dataMin!==void 0||this.visible&&this.dataTable.rowCount>0}hasMarkerChanged(s,u){let p=s.marker,g=u.marker||{};return p&&(g.enabled&&!p.enabled||g.symbol!==p.symbol||g.height!==p.height||g.width!==p.width)}autoIncrement(s){let u,p=this.options,{pointIntervalUnit:g,relativeXValue:b}=this.options,T=this.chart.time,C=this.xIncrement??T.parse(p.pointStart)??0;if(this.pointInterval=u=Xi(this.pointInterval,p.pointInterval,1),b&&Lt(s)&&(u*=s),g){let E=T.toParts(C);g==="day"?E[2]+=u:g==="month"?E[1]+=u:g==="year"&&(E[0]+=u),u=T.makeTime.apply(T,E)-C}return b&&Lt(s)?C+u:(this.xIncrement=C+u,C)}setDataSortingOptions(){let s=this.options;it(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),Le(s.pointRange)||(s.pointRange=1)}setOptions(s){var ne,ie;let u,p=this.chart,g=p.options.plotOptions,b=p.userOptions||{},T=Hi(s),C=p.styledMode,E={plotOptions:g,userOptions:T};ot(this,"setOptions",E);let D=E.plotOptions[this.type],N=b.plotOptions||{},I=N.series||{},U=L.plotOptions[this.type]||{},X=N[this.type]||{};D.dataLabels=this.mergeArrays(U.dataLabels,D.dataLabels),this.userOptions=E.userOptions;let Q=Hi(D,g.series,X,T);this.tooltipOptions=Hi(L.tooltip,(ne=L.plotOptions.series)==null?void 0:ne.tooltip,U==null?void 0:U.tooltip,p.userOptions.tooltip,(ie=N.series)==null?void 0:ie.tooltip,X.tooltip,T.tooltip),this.stickyTracking=Xi(T.stickyTracking,X.stickyTracking,I.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||Q.stickyTracking),D.marker===null&&delete Q.marker,this.zoneAxis=Q.zoneAxis||"y";let le=this.zones=(Q.zones||[]).map(me=>({...me}));return(Q.negativeColor||Q.negativeFillColor)&&!Q.zones&&(u={value:Q[this.zoneAxis+"Threshold"]||Q.threshold||0,className:"highcharts-negative"},C||(u.color=Q.negativeColor,u.fillColor=Q.negativeFillColor),le.push(u)),le.length&&Le(le[le.length-1].value)&&le.push(C?{}:{color:this.color,fillColor:this.fillColor}),ot(this,"afterSetOptions",{options:Q}),Q}getName(){return this.options.name??te(this.chart.options.lang.seriesName,this,this.chart)}getCyclic(s,u,p){let g,b,T=this.chart,C=`${s}Index`,E=`${s}Counter`,D=(p==null?void 0:p.length)||T.options.chart.colorCount;!u&&(Le(b=Xi(s==="color"?this.options.colorIndex:void 0,this[C]))?g=b:(T.series.length||(T[E]=0),g=T[E]%D,T[E]+=1),p&&(u=p[g])),g!==void 0&&(this[C]=g),this[s]=u}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||L.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let s=this.options.marker;this.getCyclic("symbol",s.symbol,this.chart.options.symbols)}getColumn(s,u){return(u?this.dataTable.modified:this.dataTable).getColumn(s,!0)||[]}findPointIndex(s,u){var I;let p,g,b,{id:T,x:C}=s,E=this.points,D=this.options.dataSorting,N=this.cropStart||0;if(T){let U=this.chart.get(T);U instanceof $i&&(p=U)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let U=X=>!X.touched&&X.index===s.index;if(D!=null&&D.matchByName?U=X=>!X.touched&&X.name===s.name:this.options.relativeXValue&&(U=X=>!X.touched&&X.options.x===s.x),!(p=vt(E,U)))return}return p&&(b=p==null?void 0:p.index)!==void 0&&(g=!0),b===void 0&&Lt(C)&&(b=this.getColumn("x").indexOf(C,u)),b!==-1&&b!==void 0&&this.cropped&&(b=b>=N?b-N:b),!g&&Lt(b)&&((I=E[b])!=null&&I.touched)&&(b=void 0),b}updateData(s,u){var le;let{options:p,requireSorting:g}=this,b=p.dataSorting,T=this.points,C=[],E=s.length===T.length,D,N,I,U,X=!0;if(this.xIncrement=null,s.forEach((ne,ie)=>{var Ze;let me,_e=Le(ne)&&this.pointClass.prototype.optionsToObject.call({series:this},ne)||{},{id:Je,x:$e}=_e;Je||Lt($e)?((me=this.findPointIndex(_e,U))===-1||me===void 0?C.push(ne):T[me]&&ne!==((Ze=p.data)==null?void 0:Ze[me])?(T[me].update(ne,!1,void 0,!1),T[me].touched=!0,g&&(U=me+1)):T[me]&&(T[me].touched=!0),(!E||ie!==me||b!=null&&b.enabled||this.hasDerivedData)&&(D=!0)):C.push(ne)},this),D)for(N=T.length;N--;)(I=T[N])&&!I.touched&&((le=I.remove)==null||le.call(I,!1,u));else E&&!(b!=null&&b.enabled)?(s.forEach((ne,ie)=>{ne===T[ie].y||T[ie].destroyed||T[ie].update(ne,!1,void 0,!1)}),C.length=0):X=!1;if(T.forEach(ne=>{ne&&(ne.touched=!1)}),!X)return!1;C.forEach(ne=>{this.addPoint(ne,!1,void 0,void 0,!1)},this);let Q=this.getColumn("x");return this.xIncrement===null&&Q.length&&(this.xIncrement=he(Q),this.autoIncrement()),!0}dataColumnKeys(){return["x",...this.pointArrayMap||["y"]]}setData(s,u=!0,p,g){var ht,at;let b=this.points,T=(b==null?void 0:b.length)||0,C=this.options,E=this.chart,D=C.dataSorting,N=this.xAxis,I=C.turboThreshold,U=this.dataTable,X=this.dataColumnKeys(),Q=this.pointValKey||"y",le=(this.pointArrayMap||[]).length,ne=C.keys,ie,me,_e=0,Je=1,$e;E.options.chart.allowMutatingData||(C.data&&delete this.options.data,this.userOptions.data&&delete this.userOptions.data,$e=Hi(!0,s));let Ze=(s=$e||s||[]).length;if(D!=null&&D.enabled&&(s=this.sortData(s)),E.options.chart.allowMutatingData&&g!==!1&&Ze&&T&&!this.cropped&&!this.hasGroupedData&&this.visible&&!this.boosted&&(me=this.updateData(s,p)),!me){this.xIncrement=null,this.colorCounter=0;let mt=I&&Ze>I;if(mt){let Bt=this.getFirstValidPoint(s),Zt=this.getFirstValidPoint(s,Ze-1,-1),Qt=Gt=>!!(Kt(Gt)&&(ne||Lt(Gt[0])));if(Lt(Bt)&&Lt(Zt)){let Gt=[],hi=[];for(let oi of s)Gt.push(this.autoIncrement()),hi.push(oi);U.setColumns({x:Gt,[Q]:hi})}else if(Qt(Bt)&&Qt(Zt))if(le){let Gt=+(Bt.length===le),hi=Array(X.length).fill(0).map(()=>[]);for(let oi of s){Gt&&hi[0].push(this.autoIncrement());for(let ji=Gt;ji<=le;ji++)(ht=hi[ji])==null||ht.push(oi[ji-Gt])}U.setColumns(X.reduce((oi,ji,_i)=>(oi[ji]=hi[_i],oi),{}))}else{ne&&(_e=ne.indexOf("x"),Je=ne.indexOf("y"),_e=_e>=0?_e:0,Je=Je>=0?Je:1),Bt.length===1&&(Je=0);let Gt=[],hi=[];if(_e===Je)for(let oi of s)Gt.push(this.autoIncrement()),hi.push(oi[Je]);else for(let oi of s)Gt.push(oi[_e]),hi.push(oi[Je]);U.setColumns({x:Gt,[Q]:hi})}else mt=!1}if(!mt){let Bt=X.reduce((Zt,Qt)=>(Zt[Qt]=[],Zt),{});for(ie=0;ie<Ze;ie++){let Zt=this.pointClass.prototype.applyOptions.apply({series:this},[s[ie]]);for(let Qt of X)Bt[Qt][ie]=Zt[Qt]}U.setColumns(Bt)}for(pi(this.getColumn("y")[0])&&Re(14,!0,E),this.data=[],this.options.data=this.userOptions.data=s,ie=T;ie--;)(at=b[ie])==null||at.destroy();N&&(N.minRange=N.userMinRange),this.isDirty=E.isDirtyBox=!0,this.isDirtyData=!!b,p=!1}C.legendType==="point"&&(this.processData(),this.generatePoints()),u&&E.redraw(p)}sortData(s){let u=this,p=u.options.dataSorting.sortKey||"y",g=function(b,T){return Le(T)&&b.pointClass.prototype.optionsToObject.call({series:b},T)||{}};return s.forEach(function(b,T){s[T]=g(u,b),s[T].index=T},this),s.concat().sort((b,T)=>{let C=wt(p,b),E=wt(p,T);return E<C?-1:+(E>C)}).forEach(function(b,T){b.x=T},this),u.linkedSeries&&u.linkedSeries.forEach(function(b){var E;let T=b.options,C=T.data;!((E=T.dataSorting)!=null&&E.enabled)&&C&&(C.forEach(function(D,N){C[N]=g(b,D),s[N]&&(C[N].x=s[N].x,C[N].index=N)}),b.setData(C,!1))}),s}getProcessedData(s){let u=this,{dataTable:p,isCartesian:g,options:b,xAxis:T}=u,C=b.cropThreshold,E=s||u.getExtremesFromAll,D=T==null?void 0:T.logarithmic,N=p.rowCount,I,U,X=0,Q,le,ne,ie=u.getColumn("x"),me=p,_e=!1;return T&&(le=(Q=T.getExtremes()).min,ne=Q.max,_e=!!(T.categories&&!T.names.length),g&&u.sorted&&!E&&(!C||N>C||u.forceCrop)&&(ie[N-1]<le||ie[0]>ne?me=new Da:u.getColumn(u.pointValKey||"y").length&&(ie[0]<le||ie[N-1]>ne)&&(me=(I=this.cropData(p,le,ne)).modified,X=I.start,U=!0))),ie=me.getColumn("x")||[],{modified:me,cropped:U,cropStart:X,closestPointRange:ft([D?ie.map(D.log2lin):ie],()=>u.requireSorting&&!_e&&Re(15,!1,u.chart))}}processData(s){let u=this.xAxis,p=this.dataTable;if(this.isCartesian&&!this.isDirty&&!u.isDirty&&!this.yAxis.isDirty&&!s)return!1;let g=this.getProcessedData();p.modified=g.modified,this.cropped=g.cropped,this.cropStart=g.cropStart,this.closestPointRange=this.basePointRange=g.closestPointRange,ot(this,"afterProcessData")}cropData(s,u,p){let g=s.getColumn("x",!0)||[],b=g.length,T={},C,E,D=0,N=b;for(C=0;C<b;C++)if(g[C]>=u){D=Math.max(0,C-1);break}for(E=C;E<b;E++)if(g[E]>p){N=E+1;break}for(let I of this.dataColumnKeys()){let U=s.getColumn(I,!0);U&&(T[I]=U.slice(D,N))}return{modified:new Da({columns:T}),start:D,end:N}}generatePoints(){var $e,Ze,ht;let s=this.options,u=this.processedData||s.data,p=this.dataTable.modified,g=this.getColumn("x",!0),b=this.pointClass,T=p.rowCount,C=this.cropStart||0,E=this.hasGroupedData,D=s.keys,N=[],I=($e=s.dataGrouping)!=null&&$e.groupAll?C:0,U=(Ze=this.xAxis)==null?void 0:Ze.categories,X=this.pointArrayMap||["y"],Q=this.dataColumnKeys(),le,ne,ie,me,_e=this.data,Je;if(!_e&&!E){let at=[];at.length=(u==null?void 0:u.length)||0,_e=this.data=at}for(D&&E&&(this.options.keys=!1),me=0;me<T;me++)ne=C+me,E?((ie=new b(this,p.getRow(me,Q)||[])).dataGroup=this.groupMap[I+me],(ht=ie.dataGroup)!=null&&ht.options&&(ie.options=ie.dataGroup.options,it(ie,ie.dataGroup.options),delete ie.dataLabels)):(ie=_e[ne],Je=u?u[ne]:p.getRow(me,X),ie||Je===void 0||(_e[ne]=ie=new b(this,Je,g[me]))),ie&&(ie.index=E?I+me:ne,N[me]=ie,ie.category=(U==null?void 0:U[ie.x])??ie.x,ie.key=ie.name??ie.category);if(this.options.keys=D,_e&&(T!==(le=_e.length)||E))for(me=0;me<le;me++)me!==C||E||(me+=T),_e[me]&&(_e[me].destroyElements(),_e[me].plotX=void 0);this.data=_e,this.points=N,ot(this,"afterGeneratePoints")}getXExtremes(s){return{min:Ae(s),max:he(s)}}getExtremes(s,u){var $e;let{xAxis:p,yAxis:g}=this,b=u||this.getExtremesFromAll||this.options.getExtremesFromAll,T=b&&this.cropped?this.dataTable:this.dataTable.modified,C=T.rowCount,E=s||this.stackedYData,D=E?[E]:(($e=this.keysAffectYAxis||this.pointArrayMap||["y"])==null?void 0:$e.map(Ze=>T.getColumn(Ze,!0)||[]))||[],N=this.getColumn("x",!0),I=[],U=this.requireSorting&&!this.is("column")?1:0,X=!!g&&g.positiveValuesOnly,Q=b||this.cropped||!p,le,ne,ie,me=0,_e=0;for(p&&(me=(le=p.getExtremes()).min,_e=le.max),ie=0;ie<C;ie++)if(ne=N[ie],Q||(N[ie+U]||ne)>=me&&(N[ie-U]||ne)<=_e)for(let Ze of D){let ht=Ze[ie];Lt(ht)&&(ht>0||!X)&&I.push(ht)}let Je={activeYData:I,dataMin:Ae(I),dataMax:he(I)};return ot(this,"afterGetExtremes",{dataExtremes:Je}),Je}applyExtremes(){let s=this.getExtremes();return this.dataMin=s.dataMin,this.dataMax=s.dataMax,s}getFirstValidPoint(s,u=0,p=1){let g=s.length,b=u;for(;b>=0&&b<g;){if(Le(s[b]))return s[b];b+=p}}translate(){var _e;this.generatePoints();let s=this.options,u=s.stacking,p=this.xAxis,g=this.enabledDataSorting,b=this.yAxis,T=this.points,C=T.length,E=this.pointPlacementToXValue(),D=!!E,N=s.threshold,I=s.startFromThreshold?N:0,U=(s==null?void 0:s.nullInteraction)&&b.len,X,Q,le,ne,ie=Number.MAX_VALUE;function me(Je){return Ce(Je,-1e9,1e9)}for(X=0;X<C;X++){let Je,$e=T[X],Ze=$e.x,ht,at,mt=$e.y,Bt=$e.low,Zt=u&&((_e=b.stacking)==null?void 0:_e.stacks[(this.negStacks&&mt<(I?0:N)?"-":"")+this.stackKey]);$e.plotX=Lt(Q=p.translate(Ze,!1,!1,!1,!0,E))?ke(me(Q)):void 0,u&&this.visible&&Zt&&Zt[Ze]&&(ne=this.getStackIndicator(ne,Ze,this.index),!$e.isNull&&ne.key&&(at=(ht=Zt[Ze]).points[ne.key]),ht&&Kt(at)&&(Bt=at[0],mt=at[1],Bt===I&&ne.key===Zt[Ze].base&&(Bt=Xi(Lt(N)?N:b.min)),b.positiveValuesOnly&&Le(Bt)&&Bt<=0&&(Bt=void 0),$e.total=$e.stackTotal=Xi(ht.total),$e.percentage=Le($e.y)&&ht.total?$e.y/ht.total*100:void 0,$e.stackY=mt,this.irregularWidths||ht.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),$e.yBottom=Le(Bt)?me(b.translate(Bt,!1,!0,!1,!0)):void 0,this.dataModify&&(mt=this.dataModify.modifyValue(mt,X)),Lt(mt)&&$e.plotX!==void 0?Je=Lt(Je=b.translate(mt,!1,!0,!1,!0))?me(Je):void 0:!Lt(mt)&&U&&(Je=U),$e.plotY=Je,$e.isInside=this.isPointInside($e),$e.clientX=D?ke(p.translate(Ze,!1,!1,!1,!0,E)):Q,$e.negative=($e.y||0)<(N||0),$e.isNull||$e.visible===!1||(le!==void 0&&(ie=Math.min(ie,Math.abs(Q-le))),le=Q),$e.zone=this.zones.length?$e.getZone():void 0,!$e.graphic&&this.group&&g&&($e.isNew=!0)}this.closestPointRangePx=ie,ot(this,"afterTranslate")}getValidPoints(s,u,p){let g=this.chart;return(s||this.points||[]).filter(function(b){let{plotX:T,plotY:C}=b;return!!((p||!b.isNull&&Lt(C))&&(!u||g.isInsidePlot(T,C,{inverted:g.inverted})))&&b.visible!==!1})}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:s,group:u,markerGroup:p}=this,g=s.sharedClips,b=s.renderer,T=s.getClipBox(this),C=this.getSharedClipKey(),E=g[C];E?E.animate(T):g[C]=E=b.clipRect(T),u&&u.clip(this.options.clip===!1?void 0:E),p&&p.clip()}animate(s){let{chart:u,group:p,markerGroup:g}=this,b=u.inverted,T=M(this.options.animation),C=[this.getSharedClipKey(),T.duration,T.easing,T.defer].join(","),E=u.sharedClips[C],D=u.sharedClips[C+"m"];if(s&&p){let N=u.getClipBox(this);if(E)E.attr("height",N.height);else{N.width=0,b&&(N.x=u.plotHeight),E=u.renderer.clipRect(N),u.sharedClips[C]=E;let I={x:-99,y:-99,width:b?u.plotWidth+199:99,height:b?99:u.plotHeight+199};D=u.renderer.clipRect(I),u.sharedClips[C+"m"]=D}p.clip(E),g==null||g.clip(D)}else if(E&&!E.hasClass("highcharts-animating")){let N=u.getClipBox(this),I=T.step;(g!=null&&g.element.childNodes.length||u.series.length>1)&&(T.step=function(U,X){I&&I.apply(X,arguments),X.prop==="width"&&(D!=null&&D.element)&&D.attr(b?"height":"width",U+99)}),E.addClass("highcharts-animating").animate(N,T)}}afterAnimate(){this.setClip(),xr(this.chart.sharedClips,(s,u,p)=>{s&&!this.chart.container.querySelector(`[clip-path="url(#${s.id})"]`)&&(s.destroy(),delete p[u])}),this.finishedAnimating=!0,ot(this,"afterAnimate")}drawPoints(s=this.points){let u,p,g,b,T,C,E,D=this.chart,N=D.styledMode,{colorAxis:I,options:U}=this,X=U.marker,Q=U.nullInteraction,le=this[this.specialGroup||"markerGroup"],ne=this.xAxis,ie=Xi(X.enabled,!ne||!!ne.isRadial||null,this.closestPointRangePx>=X.enabledThreshold*X.radius);if(X.enabled!==!1||this._hasPointMarkers)for(u=0;u<s.length;u++){b=(g=(p=s[u]).graphic)?"animate":"attr",T=p.marker||{},C=!!p.marker;let me=p.isNull;if((ie&&!Le(T.enabled)||T.enabled)&&(!me||Q)&&p.visible!==!1){let _e=Xi(T.symbol,this.symbol,"rect");E=this.markerAttribs(p,p.selected&&"select"),this.enabledDataSorting&&(p.startXPos=ne.reversed?-(E.width||0):ne.width);let Je=p.isInside!==!1;if(!g&&Je&&((E.width||0)>0||p.hasImage)&&(p.graphic=g=D.renderer.symbol(_e,E.x,E.y,E.width,E.height,C?T:X).add(le),this.enabledDataSorting&&D.hasRendered&&(g.attr({x:p.startXPos}),b="animate")),g&&b==="animate"&&g[Je?"show":"hide"](Je).animate(E),g){let $e=this.pointAttribs(p,N||!p.selected?void 0:"select");N?I&&g.css({fill:$e.fill}):g[b]($e)}g&&g.addClass(p.getClassName(),!0)}else g&&(p.graphic=g.destroy())}}markerAttribs(s,u){let p=this.options,g=p.marker,b=s.marker||{},T=b.symbol||g.symbol,C={},E,D,N=Xi(b.radius,g==null?void 0:g.radius);u&&(E=g.states[u],D=b.states&&b.states[u],N=Xi(D==null?void 0:D.radius,E==null?void 0:E.radius,N&&N+((E==null?void 0:E.radiusPlus)||0))),s.hasImage=T&&T.indexOf("url")===0,s.hasImage&&(N=0);let I=s.pos();return Lt(N)&&I&&(p.crisp&&(I[0]=ze(I[0],s.hasImage?0:T==="rect"?(g==null?void 0:g.lineWidth)||0:1)),C.x=I[0]-N,C.y=I[1]-N),N&&(C.width=C.height=2*N),C}pointAttribs(s,u){var ie;let p=this.options,g=p.marker,b=s==null?void 0:s.options,T=(b==null?void 0:b.marker)||{},C=b==null?void 0:b.color,E=s==null?void 0:s.color,D=(ie=s==null?void 0:s.zone)==null?void 0:ie.color,N,I,U=this.color,X,Q,le=Xi(T.lineWidth,g.lineWidth),ne=s!=null&&s.isNull&&p.nullInteraction?0:1;return U=C||D||E||U,X=T.fillColor||g.fillColor||U,Q=T.lineColor||g.lineColor||U,u=u||"normal",N=g.states[u]||{},le=Xi((I=T.states&&T.states[u]||{}).lineWidth,N.lineWidth,le+Xi(I.lineWidthPlus,N.lineWidthPlus,0)),X=I.fillColor||N.fillColor||X,Q=I.lineColor||N.lineColor||Q,{stroke:Q,"stroke-width":le,fill:X,opacity:ne=Xi(I.opacity,N.opacity,ne)}}destroy(s){var E,D;let u,p,g=this,b=g.chart,T=/AppleWebKit\/533/.test(K.navigator.userAgent),C=g.data||[];for(ot(g,"destroy",{keepEventsForUpdate:s}),this.removeEvents(s),(g.axisTypes||[]).forEach(function(N){p=g[N],p!=null&&p.series&&(Ye(p.series,g),p.isDirty=p.forceRedraw=!0)}),g.legendItem&&g.chart.legend.destroyItem(g),u=C.length;u--;)(D=(E=C[u])==null?void 0:E.destroy)==null||D.call(E);for(let N of g.zones)De(N,void 0,!0);li.clearTimeout(g.animationTimeout),xr(g,function(N,I){N instanceof Ta&&!N.survive&&N[T&&I==="group"?"hide":"destroy"]()}),b.hoverSeries===g&&(b.hoverSeries=void 0),Ye(b.series,g),b.orderItems("series"),xr(g,function(N,I){s&&I==="hcEvents"||delete g[I]})}applyZones(){let{area:s,chart:u,graph:p,zones:g,points:b,xAxis:T,yAxis:C,zoneAxis:E}=this,{inverted:D,renderer:N}=u,I=this[`${E}Axis`],{isXAxis:U,len:X=0,minPointOffset:Q=0}=I||{},le=((p==null?void 0:p.strokeWidth())||0)/2+1,ne=(ie,me=0,_e=0)=>{D&&(_e=X-_e);let{translated:Je=0,lineClip:$e}=ie,Ze=_e-Je;$e==null||$e.push(["L",me,Math.abs(Ze)<le?_e-le*(Ze<=0?-1:1):Je])};if(g.length&&(p||s)&&I&&Lt(I.min)){let ie=I.getExtremes().max+Q,me=$e=>{$e.forEach((Ze,ht)=>{(Ze[0]==="M"||Ze[0]==="L")&&($e[ht]=[Ze[0],U?X-Ze[1]:Ze[1],U?Ze[2]:X-Ze[2]])})};if(g.forEach($e=>{$e.lineClip=[],$e.translated=Ce(I.toPixels(Xi($e.value,ie),!0)||0,0,X)}),p&&!this.showLine&&p.hide(),s&&s.hide(),E==="y"&&b.length<T.len)for(let $e of b){let{plotX:Ze,plotY:ht,zone:at}=$e,mt=at&&g[g.indexOf(at)-1];at&&ne(at,Ze,ht),mt&&ne(mt,Ze,ht)}let _e=[],Je=I.toPixels(I.getExtremes().min-Q,!0);g.forEach($e=>{var ji,_i;let Ze=$e.lineClip||[],ht=Math.round($e.translated||0);T.reversed&&Ze.reverse();let{clip:at,simpleClip:mt}=$e,Bt=0,Zt=0,Qt=T.len,Gt=C.len;U?(Bt=ht,Qt=Je):(Zt=ht,Gt=Je);let hi=[["M",Bt,Zt],["L",Qt,Zt],["L",Qt,Gt],["L",Bt,Gt],["Z"]],oi=[hi[0],...Ze,hi[1],hi[2],..._e,hi[3],hi[4]];_e=Ze.reverse(),Je=ht,D&&(me(oi),s&&me(hi)),at?(at.animate({d:oi}),mt==null||mt.animate({d:hi})):(at=$e.clip=N.path(oi),s&&(mt=$e.simpleClip=N.path(hi))),p&&((ji=$e.graph)==null||ji.clip(at)),s&&((_i=$e.area)==null||_i.clip(mt))})}else this.visible&&(p&&p.show(),s&&s.show())}plotGroup(s,u,p,g,b){let T=this[s],C=!T,E={visibility:p,zIndex:g||.1};return Le(this.opacity)&&!this.chart.styledMode&&this.state!=="inactive"&&(E.opacity=this.opacity),T||(this[s]=T=this.chart.renderer.g().add(b)),T.addClass("highcharts-"+u+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(Le(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(T.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),T.attr(E)[C?"attr":"animate"](this.getPlotBox(u)),T}getPlotBox(s){let u=this.xAxis,p=this.yAxis,g=this.chart,b=g.inverted&&!g.polar&&u&&this.invertible&&s==="series";return g.inverted&&(u=p,p=this.xAxis),{translateX:u?u.left:g.plotLeft,translateY:p?p.top:g.plotTop,rotation:90*!!b,rotationOriginX:b?(u.len-p.len)/2:0,rotationOriginY:b?(u.len+p.len)/2:0,scaleX:b?-1:1,scaleY:1}}removeEvents(s){let{eventsToUnbind:u}=this;s||jr(this),u.length&&(u.forEach(p=>{p()}),u.length=0)}render(){var N,I,U,X,Q;let s=this,{chart:u,options:p,hasRendered:g}=s,b=M(p.animation),T=s.visible?"inherit":"hidden",C=p.zIndex,E=u.seriesGroup,D=s.finishedAnimating?0:b.duration;ot(this,"render"),s.plotGroup("group","series",T,C,E),s.markerGroup=s.plotGroup("markerGroup","markers",T,C,E),p.clip!==!1&&s.setClip(),D&&((N=s.animate)==null||N.call(s,!0)),s.drawGraph&&(s.drawGraph(),s.applyZones()),s.visible&&s.drawPoints(),(I=s.drawDataLabels)==null||I.call(s),(U=s.redrawPoints)==null||U.call(s),p.enableMouseTracking&&((X=s.drawTracker)==null||X.call(s)),D&&((Q=s.animate)==null||Q.call(s)),g||(D&&b.defer&&(D+=b.defer),s.animationTimeout=tn(()=>{s.afterAnimate()},D||0)),s.isDirty=!1,s.hasRendered=!0,ot(s,"afterRender")}redraw(){let s=this.isDirty||this.isDirtyData;this.translate(),this.render(),s&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(s,u){let{xAxis:p,yAxis:g}=this,b=this.chart.inverted;return this.searchKDTree({clientX:b?p.len-s.chartY+p.pos:s.chartX-p.pos,plotY:b?g.len-s.chartX+g.pos:s.chartY-g.pos},u,s)}buildKDTree(s){this.buildingKdTree=!0;let u=this,p=u.options,g=p.findNearestPointBy.indexOf("y")>-1?2:1;delete u.kdTree,tn(function(){u.kdTree=function b(T,C,E){let D,N,I=T==null?void 0:T.length;if(I)return D=u.kdAxisArray[C%E],T.sort((U,X)=>(U[D]||0)-(X[D]||0)),{point:T[N=Math.floor(I/2)],left:b(T.slice(0,N),C+1,E),right:b(T.slice(N+1),C+1,E)}}(u.getValidPoints(void 0,!u.directTouch,p==null?void 0:p.nullInteraction),g,g),u.buildingKdTree=!1},p.kdNow||(s==null?void 0:s.type)==="touchstart"?0:1)}searchKDTree(s,u,p,g,b){let T=this,[C,E]=this.kdAxisArray,D=u?"distX":"dist",N=(T.options.findNearestPointBy||"").indexOf("y")>-1?2:1,I=!!T.isBubble,U=g||((Q,le,ne)=>{let ie=Q[ne]||0,me=le[ne]||0;return[ie===me&&Q.index>le.index||ie<me?Q:le,!1]}),X=b||((Q,le)=>Q<le);if(this.kdTree||this.buildingKdTree||this.buildKDTree(p),this.kdTree)return function Q(le,ne,ie,me){var Bt;let _e=ne.point,Je=T.kdAxisArray[ie%me],$e=_e,Ze=!1;(function(Zt,Qt){var Bi;let Gt=Zt[C],hi=Qt[C],oi=Le(Gt)&&Le(hi)?Gt-hi:null,ji=Zt[E],_i=Qt[E],Di=Le(ji)&&Le(_i)?ji-_i:0,lr=I&&((Bi=Qt.marker)==null?void 0:Bi.radius)||0;Qt.dist=Math.sqrt((oi&&oi*oi||0)+Di*Di)-lr,Qt.distX=Le(oi)?Math.abs(oi)-lr:Number.MAX_VALUE})(le,_e);let ht=(le[Je]||0)-(_e[Je]||0)+(I&&((Bt=_e.marker)==null?void 0:Bt.radius)||0),at=ht<0?"left":"right",mt=ht<0?"right":"left";return ne[at]&&([$e,Ze]=U(_e,Q(le,ne[at],ie+1,me),D)),ne[mt]&&X(Math.sqrt(ht*ht),$e[D],Ze)&&($e=U($e,Q(le,ne[mt],ie+1,me),D)[0]),$e}(s,this.kdTree,N,N)}pointPlacementToXValue(){let{options:s,xAxis:u}=this,p=s.pointPlacement;return p==="between"&&(p=u.reversed?-.5:.5),Lt(p)?p*(s.pointRange||u.pointRange):0}isPointInside(s){let{chart:u,xAxis:p,yAxis:g}=this,{plotX:b=-1,plotY:T=-1}=s;return T>=0&&T<=(g?g.len:u.plotHeight)&&b>=0&&b<=(p?p.len:u.plotWidth)}drawTracker(){var U;let s=this,u=s.options,p=u.trackByArea,g=[].concat((p?s.areaPath:s.graphPath)||[]),b=s.chart,T=b.pointer,C=b.renderer,E=((U=b.options.tooltip)==null?void 0:U.snap)||0,D=()=>{u.enableMouseTracking&&b.hoverSeries!==s&&s.onMouseOver()},N="rgba(192,192,192,"+(q?1e-4:.002)+")",I=s.tracker;I?I.attr({d:g}):s.graph&&(s.tracker=I=C.path(g).attr({visibility:s.visible?"inherit":"hidden",zIndex:2}).addClass(p?"highcharts-tracker-area":"highcharts-tracker-line").add(s.group),b.styledMode||I.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:N,fill:p?N:"none","stroke-width":s.graph.strokeWidth()+(p?0:2*E)}),[s.tracker,s.markerGroup,s.dataLabelsGroup].forEach(X=>{X&&(X.addClass("highcharts-tracker").on("mouseover",D).on("mouseout",Q=>{T==null||T.onTrackerMouseOut(Q)}),u.cursor&&!b.styledMode&&X.css({cursor:u.cursor}),X.on("touchstart",D))})),ot(this,"afterDrawTracker")}addPoint(s,u,p,g,b){let T,C,E=this.options,{chart:D,data:N,dataTable:I,xAxis:U}=this,X=(U==null?void 0:U.hasNames)&&U.names,Q=E.data,le=this.getColumn("x");u=Xi(u,!0);let ne={series:this};this.pointClass.prototype.applyOptions.apply(ne,[s]);let ie=ne.x;if(C=le.length,this.requireSorting&&ie<le[C-1])for(T=!0;C&&le[C-1]>ie;)C--;I.setRow(ne,C,!0,{addColumns:!1}),X&&ne.name&&(X[ie]=ne.name),Q==null||Q.splice(C,0,s),(T||this.processedData)&&(this.data.splice(C,0,null),this.processData()),E.legendType==="point"&&this.generatePoints(),p&&(N[0]&&N[0].remove?N[0].remove(!1):([N,Q].filter(Le).forEach(me=>{me.shift()}),I.deleteRows(0))),b!==!1&&ot(this,"addPoint",{point:ne}),this.isDirty=!0,this.isDirtyData=!0,u&&D.redraw(g)}removePoint(s,u,p){let g=this,{chart:b,data:T,points:C,dataTable:E}=g,D=T[s],N=function(){[(C==null?void 0:C.length)===T.length?C:void 0,T,g.options.data].filter(Le).forEach(I=>{I.splice(s,1)}),E.deleteRows(s),D==null||D.destroy(),g.isDirty=!0,g.isDirtyData=!0,u&&b.redraw()};P(p,b),u=Xi(u,!0),D?D.firePointEvent("remove",null,N):N()}remove(s,u,p,g){let b=this,T=b.chart;function C(){b.destroy(g),T.isDirtyLegend=T.isDirtyBox=!0,T.linkSeries(g),Xi(s,!0)&&T.redraw(u)}p!==!1?ot(b,"remove",null,C):C()}update(s,u){var ie,me;ot(this,"update",{options:s=Ge(s,this.userOptions)});let p=this,g=p.chart,b=p.userOptions,T=p.initialType||p.type,C=g.options.plotOptions,E=W[T].prototype,D=p.finishedAnimating&&{animation:!1},N={},I,U,X=cr.keepProps.slice(),Q=s.type||b.type||g.options.chart.type,le=!(this.hasDerivedData||Q&&Q!==this.type||s.keys!==void 0||s.pointStart!==void 0||s.pointInterval!==void 0||s.relativeXValue!==void 0||s.joinBy||s.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(_e=>p.hasOptionChanged(_e)));Q=Q||T,le?(X.push.apply(X,cr.keepPropsForPoints),s.visible!==!1&&X.push("area","graph"),p.parallelArrays.forEach(function(_e){X.push(_e+"Data")}),s.data&&(s.dataSorting&&it(p.options.dataSorting,s.dataSorting),this.setData(s.data,!1))):this.dataTable.modified=this.dataTable,s=Hi(b,{index:b.index===void 0?p.index:b.index,pointStart:((ie=C==null?void 0:C.series)==null?void 0:ie.pointStart)??b.pointStart??p.getColumn("x")[0]},!le&&{data:p.options.data},s,D),le&&s.data&&(s.data=p.options.data),(X=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(X)).forEach(function(_e){X[_e]=p[_e],delete p[_e]});let ne=!1;if(W[Q]){if(ne=Q!==p.type,p.remove(!1,!1,!1,!0),ne)if(g.propFromSeries(),Object.setPrototypeOf)Object.setPrototypeOf(p,W[Q].prototype);else{let _e=Object.hasOwnProperty.call(p,"hcEvents")&&p.hcEvents;for(U in E)p[U]=void 0;it(p,W[Q].prototype),_e?p.hcEvents=_e:delete p.hcEvents}}else Re(17,!0,g,{missingModuleFor:Q});if(X.forEach(function(_e){p[_e]=X[_e]}),p.init(g,s),le&&this.points)for(let _e of((I=p.options).visible===!1?(N.graphic=1,N.dataLabel=1):(this.hasMarkerChanged(I,b)&&(N.graphic=1),(me=p.hasDataLabels)!=null&&me.call(p)||(N.dataLabel=1)),this.points))_e!=null&&_e.series&&(_e.resolveColor(),Object.keys(N).length&&_e.destroyElements(N),I.showInLegend===!1&&_e.legendItem&&g.legend.destroyItem(_e));p.initialType=T,g.linkSeries(),g.setSortedData(),ne&&p.linkedSeries.length&&(p.isDirtyData=!0),ot(this,"afterUpdate"),Xi(u,!0)&&g.redraw(!!le&&void 0)}setName(s){this.name=this.options.name=this.userOptions.name=s,this.chart.isDirtyLegend=!0}hasOptionChanged(s){var C,E;let u=this.chart,p=this.options[s],g=u.options.plotOptions,b=this.userOptions[s],T=Xi((C=g==null?void 0:g[this.type])==null?void 0:C[s],(E=g==null?void 0:g.series)==null?void 0:E[s]);return b&&!Le(T)?p!==b:p!==Xi(T,p)}onMouseOver(){let s=this.chart,u=s.hoverSeries,p=s.pointer;p==null||p.setHoverChartIndex(),u&&u!==this&&u.onMouseOut(),this.options.events.mouseOver&&ot(this,"mouseOver"),this.setState("hover"),s.hoverSeries=this}onMouseOut(){let s=this.options,u=this.chart,p=u.tooltip,g=u.hoverPoint;u.hoverSeries=null,g&&g.onMouseOut(),this&&s.events.mouseOut&&ot(this,"mouseOut"),p&&!this.stickyTracking&&(!p.shared||this.noSharedTooltip)&&p.hide(),u.series.forEach(function(b){b.setState("",!0)})}setState(s,u){let p=this,g=p.options,b=p.graph,T=g.inactiveOtherPoints,C=g.states,E=Xi(C[s||"normal"]&&C[s||"normal"].animation,p.chart.options.chart.animation),D=g.lineWidth,N=g.opacity;if(s=s||"",p.state!==s&&([p.group,p.markerGroup,p.dataLabelsGroup].forEach(function(I){I&&(p.state&&I.removeClass("highcharts-series-"+p.state),s&&I.addClass("highcharts-series-"+s))}),p.state=s,!p.chart.styledMode)){if(C[s]&&C[s].enabled===!1)return;if(s&&(D=C[s].lineWidth||D+(C[s].lineWidthPlus||0),N=Xi(C[s].opacity,N)),b&&!b.dashstyle&&Lt(D))for(let I of[b,...this.zones.map(U=>U.graph)])I==null||I.animate({"stroke-width":D},E);T||[p.group,p.markerGroup,p.dataLabelsGroup,p.labelBySeries].forEach(function(I){I&&I.animate({opacity:N},E)})}u&&T&&p.points&&p.setAllPointsToState(s||void 0)}setAllPointsToState(s){this.points.forEach(function(u){u.setState&&u.setState(s)})}setVisible(s,u){var E;let p=this,g=p.chart,b=g.options.chart.ignoreHiddenSeries,T=p.visible;p.visible=s=p.options.visible=p.userOptions.visible=s===void 0?!T:s;let C=s?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(D=>{var N;(N=p[D])==null||N[C]()}),(g.hoverSeries===p||((E=g.hoverPoint)==null?void 0:E.series)===p)&&p.onMouseOut(),p.legendItem&&g.legend.colorizeItem(p,s),p.isDirty=!0,p.options.stacking&&g.series.forEach(D=>{D.options.stacking&&D.visible&&(D.isDirty=!0)}),p.linkedSeries.forEach(D=>{D.setVisible(s,!1)}),b&&(g.isDirtyBox=!0),ot(p,C),u!==!1&&g.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(s){this.selected=s=this.options.selected=s===void 0?!this.selected:s,this.checkbox&&(this.checkbox.checked=s),ot(this,s?"select":"unselect")}shouldShowTooltip(s,u,p={}){return p.series=this,p.visiblePlotOnly=!0,this.chart.isInsidePlot(s,u,p)}drawLegendSymbol(s,u){var p;(p=y[this.options.legendSymbol||"rectangle"])==null||p.call(this,s,u)}}cr.defaultOptions={lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:R}=this.series.chart;return typeof this.y!="number"?"":R(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},cr.types=_.seriesTypes,cr.registerType=_.registerSeriesType,cr.keepProps=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],cr.keepPropsForPoints=["data","isDirtyData","isDirtyCanvas","points","dataTable","processedData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX","transformGroups"],it(cr.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,invertible:!0,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:$i,requireSorting:!0,sorted:!0}),_.series=cr;let nr=cr,{animObject:Fr,setAnimation:Gn}=Dr,{registerEventOptions:hr}=Tc,{composed:$n,marginNames:Jn}=Ue,{distribute:Yl}=Lo,{format:wl}=Sa,{addEvent:Ka,createElement:Bs,css:Wl,defined:Kl,discardElement:Lc,find:ya,fireEvent:Un,isNumber:Go,merge:Ss,pick:mr,pushUnique:Br,relativeLength:ea,stableSort:gn,syncTimeout:lh}=li;class Vh{constructor(s,u){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=s,this.setOptions(u),u.enabled&&(this.render(),hr(this,u),Ka(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),Ka(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(s){let u=mr(s.padding,8);this.options=s,this.chart.styledMode||(this.itemStyle=s.itemStyle,this.itemHiddenStyle=Ss(this.itemStyle,s.itemHiddenStyle)),this.itemMarginTop=s.itemMarginTop,this.itemMarginBottom=s.itemMarginBottom,this.padding=u,this.initialItemY=u-5,this.symbolWidth=mr(s.symbolWidth,16),this.pages=[],this.proximate=s.layout==="proximate"&&!this.chart.inverted,this.baseline=void 0}update(s,u){let p=this.chart;this.setOptions(Ss(!0,this.options,s)),"events"in this.options&&hr(this,this.options),this.destroy(),p.isDirtyLegend=p.isDirtyBox=!0,mr(u,!0)&&p.redraw(),Un(this,"afterUpdate",{redraw:u})}colorizeItem(s,u){var D;let p=s.color,{area:g,group:b,label:T,line:C,symbol:E}=s.legendItem||{};if((s instanceof nr||s instanceof $i)&&(s.color=((D=s.options)==null?void 0:D.legendSymbolColor)||p),b==null||b[u?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:N={}}=this,I=N.color,{fillColor:U,fillOpacity:X,lineColor:Q,marker:le}=s.options,ne=ie=>(!u&&(ie.fill&&(ie.fill=I),ie.stroke&&(ie.stroke=I)),ie);T==null||T.css(Ss(u?this.itemStyle:N)),C==null||C.attr(ne({stroke:Q||s.color})),E&&E.attr(ne(le&&E.isMarker?s.pointAttribs():{fill:s.color})),g==null||g.attr(ne({fill:U||s.color,"fill-opacity":U?1:X??.75}))}s.color=p,Un(this,"afterColorizeItem",{item:s,visible:u})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(s){let{group:u,x:p=0,y:g=0}=s.legendItem||{},b=this.options,T=b.symbolPadding,C=!b.rtl,E=s.checkbox;if(u!=null&&u.element){let D={translateX:C?p:this.legendWidth-p-2*T-4,translateY:g};u[Kl(u.translateY)?"animate":"attr"](D,void 0,()=>{Un(this,"afterPositionItem",{item:s})})}E&&(E.x=p,E.y=g)}destroyItem(s){let u=s.checkbox,p=s.legendItem||{};for(let g of["group","label","line","symbol"])p[g]&&(p[g]=p[g].destroy());u&&Lc(u),s.legendItem=void 0}destroy(){for(let s of this.getAllItems())this.destroyItem(s);for(let s of["clipRect","up","down","pager","nav","box","title","group"])this[s]&&(this[s]=this[s].destroy());this.display=null}positionCheckboxes(){var b;let s,u=(b=this.group)==null?void 0:b.alignAttr,p=this.clipHeight||this.legendHeight,g=this.titleHeight;u&&(s=u.translateY,this.allItems.forEach(function(T){let C,E=T.checkbox;E&&(C=s+g+E.y+(this.scrollOffset||0)+3,Wl(E,{left:u.translateX+T.checkboxOffset+E.x-20+"px",top:C+"px",display:this.proximate||C>s-6&&C<s+p-6?"":"none"}))},this))}renderTitle(){let s=this.options,u=this.padding,p=s.title,g,b=0;p.text&&(this.title||(this.title=this.chart.renderer.label(p.text,u-3,u-4,void 0,void 0,void 0,s.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(p.style),this.title.add(this.group)),p.width||this.title.css({width:this.maxLegendWidth+"px"}),b=(g=this.title.getBBox()).height,this.offsetWidth=g.width,this.contentGroup.attr({translateY:b})),this.titleHeight=b}setText(s){let u=this.options;s.legendItem.label.attr({text:u.labelFormat?wl(u.labelFormat,s,this.chart):u.labelFormatter.call(s)})}renderItem(s){var ht;let u=s.legendItem=s.legendItem||{},p=this.chart,g=p.renderer,b=this.options,T=b.layout==="horizontal",C=this.symbolWidth,E=b.symbolPadding||0,D=this.itemStyle,N=this.itemHiddenStyle,I=T?mr(b.itemDistance,20):0,U=!b.rtl,X=!s.series,Q=!X&&s.series.drawLegendSymbol?s.series:s,le=Q.options,ne=!!this.createCheckboxForItem&&le&&le.showCheckbox,ie=b.useHTML,me=s.options.className,_e=u.label,Je=C+E+I+20*!!ne;!_e&&(u.group=g.g("legend-item").addClass("highcharts-"+Q.type+"-series highcharts-color-"+s.colorIndex+(me?" "+me:"")+(X?" highcharts-series-"+s.index:"")).attr({zIndex:1}).add(this.scrollGroup),u.label=_e=g.text("",U?C+E:-E,this.baseline||0,ie),p.styledMode||_e.css(Ss(s.visible?D:N)),_e.attr({align:U?"left":"right",zIndex:2}).add(u.group),!this.baseline&&(this.fontMetrics=g.fontMetrics(_e),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,_e.attr("y",this.baseline),this.symbolHeight=mr(b.symbolHeight,this.fontMetrics.f),b.squareSymbol&&(this.symbolWidth=mr(b.symbolWidth,Math.max(this.symbolHeight,16)),Je=this.symbolWidth+E+I+20*!!ne,U&&_e.attr("x",this.symbolWidth+E))),Q.drawLegendSymbol(this,s),this.setItemEvents&&this.setItemEvents(s,_e,ie)),ne&&!s.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(s),this.colorizeItem(s,s.visible),(p.styledMode||!D.width)&&_e.css({width:(b.itemWidth||this.widthOption||p.spacingBox.width)-Je+"px"}),this.setText(s);let $e=_e.getBBox(),Ze=((ht=this.fontMetrics)==null?void 0:ht.h)||0;s.itemWidth=s.checkboxOffset=b.itemWidth||u.labelWidth||$e.width+Je,this.maxItemWidth=Math.max(this.maxItemWidth,s.itemWidth),this.totalItemWidth+=s.itemWidth,this.itemHeight=s.itemHeight=Math.round(u.labelHeight||($e.height>1.5*Ze?$e.height:Ze))}layoutItem(s){let u=this.options,p=this.padding,g=u.layout==="horizontal",b=s.itemHeight,T=this.itemMarginBottom,C=this.itemMarginTop,E=g?mr(u.itemDistance,20):0,D=this.maxLegendWidth,N=u.alignColumns&&this.totalItemWidth>D?this.maxItemWidth:s.itemWidth,I=s.legendItem||{};g&&this.itemX-p+N>D&&(this.itemX=p,this.lastLineHeight&&(this.itemY+=C+this.lastLineHeight+T),this.lastLineHeight=0),this.lastItemY=C+this.itemY+T,this.lastLineHeight=Math.max(b,this.lastLineHeight),I.x=this.itemX,I.y=this.itemY,g?this.itemX+=N:(this.itemY+=C+b+T,this.lastLineHeight=b),this.offsetWidth=this.widthOption||Math.max((g?this.itemX-p-(s.checkbox?0:E):N)+p,this.offsetWidth)}getAllItems(){let s=[];return this.chart.series.forEach(function(u){var g;let p=u==null?void 0:u.options;u&&mr(p.showInLegend,!Kl(p.linkedTo)&&void 0,!0)&&(s=s.concat(((g=u.legendItem)==null?void 0:g.labels)||(p.legendType==="point"?u.data:u)))}),Un(this,"afterGetAllItems",{allItems:s}),s}getAlignment(){let s=this.options;return this.proximate?s.align.charAt(0)+"tv":s.floating?"":s.align.charAt(0)+s.verticalAlign.charAt(0)+s.layout.charAt(0)}adjustMargins(s,u){let p=this.chart,g=this.options,b=this.getAlignment();b&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(T,C){T.test(b)&&!Kl(s[C])&&(p[Jn[C]]=Math.max(p[Jn[C]],p.legend[(C+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][C]*g[C%2?"x":"y"]+mr(g.margin,12)+u[C]+(p.titleOffset[C]||0)))})}proximatePositions(){let s,u=this.chart,p=[],g=this.options.align==="left";for(let b of(this.allItems.forEach(function(T){let C,E,D=g,N,I;T.yAxis&&(T.xAxis.options.reversed&&(D=!D),T.points&&(C=ya(D?T.points:T.points.slice(0).reverse(),function(U){return Go(U.plotY)})),E=this.itemMarginTop+T.legendItem.label.getBBox().height+this.itemMarginBottom,I=T.yAxis.top-u.plotTop,N=T.visible?(C?C.plotY:T.yAxis.height)+(I-.3*E):I+T.yAxis.height,p.push({target:N,size:E,item:T}))},this),Yl(p,u.plotHeight)))s=b.item.legendItem||{},Go(b.pos)&&(s.y=u.plotTop-u.spacing[0]+b.pos)}render(){let s=this.chart,u=s.renderer,p=this.options,g=this.padding,b=this.getAllItems(),T,C,E,D=this.group,N,I=this.box;this.itemX=g,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=ea(p.width,s.spacingBox.width-g),N=s.spacingBox.width-2*g-p.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(N/=2),this.maxLegendWidth=this.widthOption||N,D||(this.group=D=u.g("legend").addClass(p.className||"").attr({zIndex:7}).add(),this.contentGroup=u.g().attr({zIndex:1}).add(D),this.scrollGroup=u.g().add(this.contentGroup)),this.renderTitle(),gn(b,(U,X)=>{var Q,le;return(((Q=U.options)==null?void 0:Q.legendIndex)||0)-(((le=X.options)==null?void 0:le.legendIndex)||0)}),p.reversed&&b.reverse(),this.allItems=b,this.display=T=!!b.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,b.forEach(this.renderItem,this),b.forEach(this.layoutItem,this),C=(this.widthOption||this.offsetWidth)+g,E=this.lastItemY+this.lastLineHeight+this.titleHeight,E=this.handleOverflow(E)+g,I||(this.box=I=u.rect().addClass("highcharts-legend-box").attr({r:p.borderRadius}).add(D)),s.styledMode||I.attr({stroke:p.borderColor,"stroke-width":p.borderWidth||0,fill:p.backgroundColor||"none"}).shadow(p.shadow),C>0&&E>0&&I[I.placed?"animate":"attr"](I.crisp.call({},{x:0,y:0,width:C,height:E},I.strokeWidth())),D[T?"show":"hide"](),s.styledMode&&D.getStyle("display")==="none"&&(C=E=0),this.legendWidth=C,this.legendHeight=E,T&&this.align(),this.proximate||this.positionItems(),Un(this,"afterRender")}align(s=this.chart.spacingBox){let u=this.chart,p=this.options,g=s.y;/(lth|ct|rth)/.test(this.getAlignment())&&u.titleOffset[0]>0?g+=u.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&u.titleOffset[2]>0&&(g-=u.titleOffset[2]),g!==s.y&&(s=Ss(s,{y:g})),u.hasRendered||(this.group.placed=!1),this.group.align(Ss(p,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":p.verticalAlign}),!0,s)}handleOverflow(s){let u=this,p=this.chart,g=p.renderer,b=this.options,T=b.y,C=b.verticalAlign==="top",E=this.padding,D=b.maxHeight,N=b.navigation,I=mr(N.animation,!0),U=N.arrowSize||12,X=this.pages,Q=this.allItems,le=function(at){typeof at=="number"?ht.attr({height:at}):ht&&(u.clipRect=ht.destroy(),u.contentGroup.clip()),u.contentGroup.div&&(u.contentGroup.div.style.clip=at?"rect("+E+"px,9999px,"+(E+at)+"px,0)":"auto")},ne=function(at){return u[at]=g.circle(0,0,1.3*U).translate(U/2,U/2).add(Ze),p.styledMode||u[at].attr("fill","rgba(0,0,0,0.0001)"),u[at]},ie,me,_e,Je,$e=p.spacingBox.height+(C?-T:T)-E,Ze=this.nav,ht=this.clipRect;return b.layout!=="horizontal"||b.verticalAlign==="middle"||b.floating||($e/=2),D&&($e=Math.min($e,D)),X.length=0,s&&$e>0&&s>$e&&N.enabled!==!1?(this.clipHeight=ie=Math.max($e-20-this.titleHeight-E,0),this.currentPage=mr(this.currentPage,1),this.fullHeight=s,Q.forEach((at,mt)=>{let Bt=(_e=at.legendItem||{}).y||0,Zt=Math.round(_e.label.getBBox().height),Qt=X.length;(!Qt||Bt-X[Qt-1]>ie&&(me||Bt)!==X[Qt-1])&&(X.push(me||Bt),Qt++),_e.pageIx=Qt-1,me&&Je&&(Je.pageIx=Qt-1),mt===Q.length-1&&Bt+Zt-X[Qt-1]>ie&&Bt>X[Qt-1]&&(X.push(Bt),_e.pageIx=Qt),Bt!==me&&(me=Bt),Je=_e}),ht||(ht=u.clipRect=g.clipRect(0,E-2,9999,0),u.contentGroup.clip(ht)),le(ie),Ze||(this.nav=Ze=g.g().attr({zIndex:1}).add(this.group),this.up=g.symbol("triangle",0,0,U,U).add(Ze),ne("upTracker").on("click",function(){u.scroll(-1,I)}),this.pager=g.text("",15,10).addClass("highcharts-legend-navigation"),!p.styledMode&&N.style&&this.pager.css(N.style),this.pager.add(Ze),this.down=g.symbol("triangle-down",0,0,U,U).add(Ze),ne("downTracker").on("click",function(){u.scroll(1,I)})),u.scroll(0),s=$e):Ze&&(le(),this.nav=Ze.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),s}scroll(s,u){let p=this.chart,g=this.pages,b=g.length,T=this.clipHeight,C=this.options.navigation,E=this.pager,D=this.padding,N=this.currentPage+s;N>b&&(N=b),N>0&&(u!==void 0&&Gn(u,p),this.nav.attr({translateX:D,translateY:T+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(I){I.attr({class:N===1?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),E.attr({text:N+"/"+b}),[this.down,this.downTracker].forEach(function(I){I.attr({x:18+this.pager.getBBox().width,class:N===b?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),p.styledMode||(this.up.attr({fill:N===1?C.inactiveColor:C.activeColor}),this.upTracker.css({cursor:N===1?"default":"pointer"}),this.down.attr({fill:N===b?C.inactiveColor:C.activeColor}),this.downTracker.css({cursor:N===b?"default":"pointer"})),this.scrollOffset=-g[N-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=N,this.positionCheckboxes(),lh(()=>{Un(this,"afterScroll",{currentPage:N})},Fr(mr(u,p.renderer.globalAnimation,!0)).duration))}setItemEvents(s,u,p){let g=this,b=s.legendItem||{},T=g.chart.renderer.boxWrapper,C=s instanceof $i,E=s instanceof nr,D="highcharts-legend-"+(C?"point":"series")+"-active",N=g.chart.styledMode,I=p?[u,b.symbol]:[b.group],U=X=>{g.allItems.forEach(Q=>{s!==Q&&[Q].concat(Q.linkedSeries||[]).forEach(le=>{le.setState(X,!C)})})};for(let X of I)X&&X.on("mouseover",function(){s.visible&&U("inactive"),s.setState("hover"),s.visible&&T.addClass(D),N||u.css(g.options.itemHoverStyle)}).on("mouseout",function(){g.chart.styledMode||u.css(Ss(s.visible?g.itemStyle:g.itemHiddenStyle)),U(""),T.removeClass(D),s.setState()}).on("click",function(Q){let le=function(){s.setVisible&&s.setVisible(),U(s.visible?"inactive":"")};T.removeClass(D),Un(g,"itemClick",{browserEvent:Q,legendItem:s},le),C?s.firePointEvent("legendItemClick",{browserEvent:Q}):E&&Un(s,"legendItemClick",{browserEvent:Q})})}createCheckboxForItem(s){s.checkbox=Bs("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:s.selected,defaultChecked:s.selected},this.options.itemCheckboxStyle,this.chart.container),Ka(s.checkbox,"click",function(u){let p=u.target;Un(s.series||s,"checkboxClick",{checked:p.checked,item:s},function(){s.select()})})}}(function(R){R.compose=function(s){Br($n,"Core.Legend")&&Ka(s,"beforeMargins",function(){this.legend=new R(this,this.options.legend)})}})(Vh||(Vh={}));let ch=Vh,{animate:Ns,animObject:Dc,setAnimation:wn}=Dr,{defaultOptions:Gr}=tt,{numberFormat:Ra}=Sa,{registerEventOptions:uh}=Tc,{charts:Ln,doc:Qa,marginNames:Sn,svg:Ql,win:Rd}=Ue,{seriesTypes:Sl}=_,{addEvent:Jl,attr:Sp,createElement:Rc,css:os,defined:ec,diffObjects:sf,discardElement:of,erase:Tp,error:Gh,extend:tc,find:$h,fireEvent:vr,getAlignFactor:Nf,getStyle:Ic,isArray:Ia,isNumber:ln,isObject:Id,isString:_u,merge:$o,objectEach:Od,pick:Oa,pInt:Mp,relativeLength:jd,removeEvent:Cp,splat:Hh,syncTimeout:Ff,uniqueKey:Bd}=li;class Tl{static chart(s,u,p){return new Tl(s,u,p)}constructor(s,u,p){this.sharedClips={};let g=[...arguments];(_u(s)||s.nodeName)&&(this.renderTo=g.shift()),this.init(g[0],g[1])}setZoomOptions(){let s=this.options.chart,u=s.zooming;this.zooming={...u,type:Oa(s.zoomType,u.type),key:Oa(s.zoomKey,u.key),pinchType:Oa(s.pinchType,u.pinchType),singleTouch:Oa(s.zoomBySingleTouch,u.singleTouch,!1),resetButton:$o(u.resetButton,s.resetZoomButton)}}init(s,u){vr(this,"init",{args:arguments},function(){var T;let p=$o(Gr,s),g=p.chart,b=this.renderTo||g.renderTo;this.userOptions=tc({},s),(this.renderTo=_u(b)?Qa.getElementById(b):b)||Gh(13,!0,this),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=u,this.isResizing=0,this.options=p,this.axes=[],this.series=[],this.locale=p.lang.locale??((T=this.renderTo.closest("[lang]"))==null?void 0:T.lang),this.time=new ye(tc(p.time||{},{locale:this.locale}),p.lang),p.time=this.time.options,this.numberFormatter=(g.numberFormatter||Ra).bind(this),this.styledMode=g.styledMode,this.hasCartesianSeries=g.showAxes,this.index=Ln.length,Ln.push(this),Ue.chartCount++,uh(this,g),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),vr(this,"afterInit"),this.firstRender()})}initSeries(s){let u=this.options.chart,p=s.type||u.type,g=Sl[p];g||Gh(17,!0,this,{missingModuleFor:p});let b=new g;return typeof b.init=="function"&&b.init(this,s),b}setSortedData(){this.getSeriesOrderByLinks().forEach(function(s){s.points||s.data||!s.enabledDataSorting||s.setData(s.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(s,u){return s.linkedSeries.length||u.linkedSeries.length?u.linkedSeries.length-s.linkedSeries.length:0})}orderItems(s,u=0){let p=this[s],g=this.options[s]=Hh(this.options[s]).slice(),b=this.userOptions[s]=this.userOptions[s]?Hh(this.userOptions[s]).slice():[];if(this.hasRendered&&(g.splice(u),b.splice(u)),p)for(let T=u,C=p.length;T<C;++T){let E=p[T];E&&(E.index=T,E instanceof nr&&(E.name=E.getName()),E.options.isInternal||(g[T]=E.options,b[T]=E.userOptions))}}getClipBox(s,u){var N,I;let p=this.inverted,{xAxis:g,yAxis:b}=s||{},{x:T,y:C,width:E,height:D}=$o(this.clipBox);return s&&(g&&g.len!==this.plotSizeX&&(E=g.len),b&&b.len!==this.plotSizeY&&(D=b.len),p&&!s.invertible&&([E,D]=[D,E])),u&&(T+=((N=p?b:g)==null?void 0:N.pos)??this.plotLeft,C+=((I=p?g:b)==null?void 0:I.pos)??this.plotTop),{x:T,y:C,width:E,height:D}}isInsidePlot(s,u,p={}){var ne;let{inverted:g,plotBox:b,plotLeft:T,plotTop:C,scrollablePlotBox:E}=this,{scrollLeft:D=0,scrollTop:N=0}=p.visiblePlotOnly&&((ne=this.scrollablePlotArea)==null?void 0:ne.scrollingContainer)||{},I=p.series,U=p.visiblePlotOnly&&E||b,X=p.inverted?u:s,Q=p.inverted?s:u,le={x:X,y:Q,isInsidePlot:!0,options:p};if(!p.ignoreX){let ie=I&&(g&&!this.polar?I.yAxis:I.xAxis)||{pos:T,len:1/0},me=p.paneCoordinates?ie.pos+X:T+X;me>=Math.max(D+T,ie.pos)&&me<=Math.min(D+T+U.width,ie.pos+ie.len)||(le.isInsidePlot=!1)}if(!p.ignoreY&&le.isInsidePlot){let ie=!g&&p.axis&&!p.axis.isXAxis&&p.axis||I&&(g?I.xAxis:I.yAxis)||{pos:C,len:1/0},me=p.paneCoordinates?ie.pos+Q:C+Q;me>=Math.max(N+C,ie.pos)&&me<=Math.min(N+C+U.height,ie.pos+ie.len)||(le.isInsidePlot=!1)}return vr(this,"afterIsInsidePlot",le),le.isInsidePlot}redraw(s){vr(this,"beforeRedraw");let u=this.hasCartesianSeries?this.axes:this.colorAxis||[],p=this.series,g=this.pointer,b=this.legend,T=this.userOptions.legend,C=this.renderer,E=C.isHidden(),D=[],N,I,U,X=this.isDirtyBox,Q=this.isDirtyLegend,le;for(C.rootFontSize=C.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),wn(!!this.hasRendered&&s,this),E&&this.temporaryDisplay(),this.layOutTitles(!1),U=p.length;U--;)if(((le=p[U]).options.stacking||le.options.centerInCategory)&&(I=!0,le.isDirty)){N=!0;break}if(N)for(U=p.length;U--;)(le=p[U]).options.stacking&&(le.isDirty=!0);p.forEach(function(ne){ne.isDirty&&(ne.options.legendType==="point"?(typeof ne.updateTotals=="function"&&ne.updateTotals(),Q=!0):T&&(T.labelFormatter||T.labelFormat)&&(Q=!0)),ne.isDirtyData&&vr(ne,"updatedData")}),Q&&b&&b.options.enabled&&(b.render(),this.isDirtyLegend=!1),I&&this.getStacks(),u.forEach(function(ne){ne.updateNames(),ne.setScale()}),this.getMargins(),u.forEach(function(ne){ne.isDirty&&(X=!0)}),u.forEach(function(ne){let ie=ne.min+","+ne.max;ne.extKey!==ie&&(ne.extKey=ie,D.push(function(){vr(ne,"afterSetExtremes",tc(ne.eventArgs,ne.getExtremes())),delete ne.eventArgs})),(X||I)&&ne.redraw()}),X&&this.drawChartBox(),vr(this,"predraw"),p.forEach(function(ne){(X||ne.isDirty)&&ne.visible&&ne.redraw(),ne.isDirtyData=!1}),g&&g.reset(!0),C.draw(),vr(this,"redraw"),vr(this,"render"),E&&this.temporaryDisplay(!0),D.forEach(function(ne){ne.call()})}get(s){let u=this.series;function p(b){return b.id===s||b.options&&b.options.id===s}let g=$h(this.axes,p)||$h(this.series,p);for(let b=0;!g&&b<u.length;b++)g=$h(u[b].points||[],p);return g}createAxes(){let s=this.userOptions;for(let u of(vr(this,"createAxes"),["xAxis","yAxis"]))for(let p of s[u]=Hh(s[u]||{}))new Ya(this,p,u);vr(this,"afterCreateAxes")}getSelectedPoints(){return this.series.reduce((s,u)=>(u.getPointsCollection().forEach(p=>{Oa(p.selectedStaging,p.selected)&&s.push(p)}),s),[])}getSelectedSeries(){return this.series.filter(s=>s.selected)}setTitle(s,u,p){this.applyDescription("title",s),this.applyDescription("subtitle",u),this.applyDescription("caption",void 0),this.layOutTitles(p)}applyDescription(s,u){var T;let p=this,g=this.options[s]=$o(this.options[s],u),b=this[s];b&&u&&(this[s]=b=b.destroy()),g&&!b&&((b=this.renderer.text(g.text,0,0,g.useHTML).attr({align:g.align,class:"highcharts-"+s,zIndex:g.zIndex||4}).css({textOverflow:"ellipsis",whiteSpace:"nowrap"}).add()).update=function(C,E){p.applyDescription(s,C),p.layOutTitles(E)},this.styledMode||b.css(tc(s==="title"?{fontSize:this.options.isStock?"1em":"1.2em"}:{},g.style)),b.textPxLength=b.getBBox().width,b.css({whiteSpace:(T=g.style)==null?void 0:T.whiteSpace}),this[s]=b)}layOutTitles(s=!0){var C,E,D,N;let u=[0,0,0],{options:p,renderer:g,spacingBox:b}=this;["title","subtitle","caption"].forEach(I=>{var ne;let U=this[I],X=this.options[I],Q=$o(b),le=(U==null?void 0:U.textPxLength)||0;if(U&&X){vr(this,"layOutTitle",{alignTo:Q,key:I,textPxLength:le});let ie=g.fontMetrics(U),me=ie.b,_e=ie.h,Je=X.verticalAlign||"top",$e=Je==="top",Ze=$e&&X.minScale||1,ht=I==="title"?$e?-3:0:$e?u[0]+2:0,at=Math.min(Q.width/le,1),mt=Math.max(Ze,at),Bt=$o({y:Je==="bottom"?me:ht+me},{align:I==="title"?at<Ze?"left":"center":(ne=this.title)==null?void 0:ne.alignValue},X),Zt=(X.width||(at>Ze?this.chartWidth:Q.width)/mt)+"px";U.alignValue!==Bt.align&&(U.placed=!1);let Qt=Math.round(U.css({width:Zt}).getBBox(X.useHTML).height);if(Bt.height=Qt,U.align(Bt,!1,Q).attr({align:Bt.align,scaleX:mt,scaleY:mt,"transform-origin":`${Q.x+le*mt*Nf(Bt.align)} ${_e}`}),!X.floating){let Gt=Qt*(Qt<1.2*_e?1:mt);Je==="top"?u[0]=Math.ceil(u[0]+Gt):Je==="bottom"&&(u[2]=Math.ceil(u[2]+Gt))}}},this),u[0]&&(((C=p.title)==null?void 0:C.verticalAlign)||"top")==="top"&&(u[0]+=((E=p.title)==null?void 0:E.margin)||0),u[2]&&((D=p.caption)==null?void 0:D.verticalAlign)==="bottom"&&(u[2]+=((N=p.caption)==null?void 0:N.margin)||0);let T=!this.titleOffset||this.titleOffset.join(",")!==u.join(",");this.titleOffset=u,vr(this,"afterLayOutTitles"),!this.isDirtyBox&&T&&(this.isDirtyBox=this.isDirtyLegend=T,this.hasRendered&&s&&this.isDirtyBox&&this.redraw())}getContainerBox(){let s=[].map.call(this.renderTo.children,p=>{if(p!==this.container){let g=p.style.display;return p.style.display="none",[p,g]}}),u={width:Ic(this.renderTo,"width",!0)||0,height:Ic(this.renderTo,"height",!0)||0};return s.filter(Boolean).forEach(([p,g])=>{p.style.display=g}),u}getChartSize(){var T;let s=this.options.chart,u=s.width,p=s.height,g=this.getContainerBox(),b=g.height<=1||!((T=this.renderTo.parentElement)!=null&&T.style.height)&&this.renderTo.style.height==="100%";this.chartWidth=Math.max(0,u||g.width||600),this.chartHeight=Math.max(0,jd(p,this.chartWidth)||(b?400:g.height)),this.containerBox=g}temporaryDisplay(s){let u=this.renderTo,p;if(s)for(;u!=null&&u.style;)u.hcOrigStyle&&(os(u,u.hcOrigStyle),delete u.hcOrigStyle),u.hcOrigDetached&&(Qa.body.removeChild(u),u.hcOrigDetached=!1),u=u.parentNode;else for(;u!=null&&u.style&&(Qa.body.contains(u)||u.parentNode||(u.hcOrigDetached=!0,Qa.body.appendChild(u)),(Ic(u,"display",!1)==="none"||u.hcOricDetached)&&(u.hcOrigStyle={display:u.style.display,height:u.style.height,overflow:u.style.overflow},p={display:"block",overflow:"hidden"},u!==this.renderTo&&(p.height=0),os(u,p),u.offsetWidth||u.style.setProperty("display","block","important")),(u=u.parentNode)!==Qa.body););}setClassName(s){this.container.className="highcharts-container "+(s||"")}getContainer(){var U,X;let s,u=this.options,p=u.chart,g="data-highcharts-chart",b=Bd(),T=this.renderTo,C=Mp(Sp(T,g));ln(C)&&Ln[C]&&Ln[C].hasRendered&&Ln[C].destroy(),Sp(T,g,this.index),T.innerHTML=Er.emptyHTML,p.skipClone||T.offsetWidth||this.temporaryDisplay(),this.getChartSize();let E=this.chartHeight,D=this.chartWidth;os(T,{overflow:"hidden"}),this.styledMode||(s=tc({position:"relative",overflow:"hidden",width:D+"px",height:E+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none",padding:"0px"},p.style||{}));let N=Rc("div",{id:b},s,T);this.container=N,this.getChartSize(),D===this.chartWidth||(D=this.chartWidth,this.styledMode||os(N,{width:Oa((U=p.style)==null?void 0:U.width,D+"px")})),this.containerBox=this.getContainerBox(),this._cursor=N.style.cursor;let I=p.renderer||!Ql?fs.getRendererType(p.renderer):pa;if(this.renderer=new I(N,D,E,void 0,p.forExport,(X=u.exporting)==null?void 0:X.allowHTML,this.styledMode),wn(void 0,this),this.setClassName(p.className),this.styledMode)for(let Q in u.defs)this.renderer.definition(u.defs[Q]);else this.renderer.setStyle(p.style);this.renderer.chartIndex=this.index,vr(this,"afterGetContainer")}getMargins(s){var b;let{spacing:u,margin:p,titleOffset:g}=this;this.resetMargins(),g[0]&&!ec(p[0])&&(this.plotTop=Math.max(this.plotTop,g[0]+u[0])),g[2]&&!ec(p[2])&&(this.marginBottom=Math.max(this.marginBottom,g[2]+u[2])),(b=this.legend)!=null&&b.display&&this.legend.adjustMargins(p,u),vr(this,"getMargins"),s||this.getAxisMargins()}getAxisMargins(){let s=this,u=s.axisOffset=[0,0,0,0],p=s.colorAxis,g=s.margin,b=function(T){T.forEach(function(C){C.visible&&C.getOffset()})};s.hasCartesianSeries?b(s.axes):p!=null&&p.length&&b(p),Sn.forEach(function(T,C){ec(g[C])||(s[T]+=u[C])}),s.setChartSize()}getOptions(){return sf(this.userOptions,Gr)}reflow(s){var b;let u=this,p=u.containerBox,g=u.getContainerBox();(b=u.pointer)==null||delete b.chartPosition,!u.isPrinting&&!u.isResizing&&p&&g.width&&((g.width!==p.width||g.height!==p.height)&&(li.clearTimeout(u.reflowTimeout),u.reflowTimeout=Ff(function(){u.container&&u.setSize(void 0,void 0,!1)},100*!!s)),u.containerBox=g)}setReflow(){let s=this,u=p=>{var g;(g=s.options)!=null&&g.chart.reflow&&s.hasLoaded&&s.reflow(p)};if(typeof ResizeObserver=="function")new ResizeObserver(u).observe(s.renderTo);else{let p=Jl(Rd,"resize",u);Jl(this,"destroy",p)}}setSize(s,u,p){let g=this,b=g.renderer;g.isResizing+=1,wn(p,g);let T=b.globalAnimation;g.oldChartHeight=g.chartHeight,g.oldChartWidth=g.chartWidth,s!==void 0&&(g.options.chart.width=s),u!==void 0&&(g.options.chart.height=u),g.getChartSize();let{chartWidth:C,chartHeight:E,scrollablePixelsX:D=0,scrollablePixelsY:N=0}=g;(g.isDirtyBox||C!==g.oldChartWidth||E!==g.oldChartHeight)&&(g.styledMode||(T?Ns:os)(g.container,{width:`${C+D}px`,height:`${E+N}px`},T),g.setChartSize(!0),b.setSize(C,E,T),g.axes.forEach(function(I){I.isDirty=!0,I.setScale()}),g.isDirtyLegend=!0,g.isDirtyBox=!0,g.layOutTitles(),g.getMargins(),g.redraw(T),g.oldChartHeight=void 0,vr(g,"resize"),setTimeout(()=>{g&&vr(g,"endResize")},Dc(T).duration)),g.isResizing-=1}setChartSize(s){let u,p,g,b,{chartHeight:T,chartWidth:C,inverted:E,spacing:D,renderer:N}=this,I=this.clipOffset,U=Math[E?"floor":"round"];this.plotLeft=u=Math.round(this.plotLeft),this.plotTop=p=Math.round(this.plotTop),this.plotWidth=g=Math.max(0,Math.round(C-u-(this.marginRight??0))),this.plotHeight=b=Math.max(0,Math.round(T-p-(this.marginBottom??0))),this.plotSizeX=E?b:g,this.plotSizeY=E?g:b,this.spacingBox=N.spacingBox={x:D[3],y:D[0],width:C-D[3]-D[1],height:T-D[0]-D[2]},this.plotBox=N.plotBox={x:u,y:p,width:g,height:b},I&&(this.clipBox={x:U(I[3]),y:U(I[0]),width:U(this.plotSizeX-I[1]-I[3]),height:U(this.plotSizeY-I[0]-I[2])}),s||(this.axes.forEach(function(X){X.setAxisSize(),X.setAxisTranslation()}),N.alignElements()),vr(this,"afterSetChartSize",{skipAxes:s})}resetMargins(){vr(this,"resetMargins");let s=this,u=s.options.chart,p=u.plotBorderWidth||0,g=Math.round(p)/2;["margin","spacing"].forEach(function(b){let T=u[b],C=Id(T)?T:[T,T,T,T];["Top","Right","Bottom","Left"].forEach(function(E,D){s[b][D]=Oa(u[b+E],C[D])})}),Sn.forEach(function(b,T){s[b]=Oa(s.margin[T],s.spacing[T])}),s.axisOffset=[0,0,0,0],s.clipOffset=[g,g,g,g],s.plotBorderWidth=p}drawChartBox(){let s=this.options.chart,u=this.renderer,p=this.chartWidth,g=this.chartHeight,b=this.styledMode,T=this.plotBGImage,C=s.backgroundColor,E=s.plotBackgroundColor,D=s.plotBackgroundImage,N=this.plotLeft,I=this.plotTop,U=this.plotWidth,X=this.plotHeight,Q=this.plotBox,le=this.clipRect,ne=this.clipBox,ie=this.chartBackground,me=this.plotBackground,_e=this.plotBorder,Je,$e,Ze,ht="animate";ie||(this.chartBackground=ie=u.rect().addClass("highcharts-background").add(),ht="attr"),b?Je=$e=ie.strokeWidth():($e=(Je=s.borderWidth||0)+8*!!s.shadow,Ze={fill:C||"none"},(Je||ie["stroke-width"])&&(Ze.stroke=s.borderColor,Ze["stroke-width"]=Je),ie.attr(Ze).shadow(s.shadow)),ie[ht]({x:$e/2,y:$e/2,width:p-$e-Je%2,height:g-$e-Je%2,r:s.borderRadius}),ht="animate",me||(ht="attr",this.plotBackground=me=u.rect().addClass("highcharts-plot-background").add()),me[ht](Q),!b&&(me.attr({fill:E||"none"}).shadow(s.plotShadow),D&&(T?(D!==T.attr("href")&&T.attr("href",D),T.animate(Q)):this.plotBGImage=u.image(D,N,I,U,X).add())),le?le.animate({width:ne.width,height:ne.height}):this.clipRect=u.clipRect(ne),ht="animate",_e||(ht="attr",this.plotBorder=_e=u.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),b||_e.attr({stroke:s.plotBorderColor,"stroke-width":s.plotBorderWidth||0,fill:"none"}),_e[ht](_e.crisp(Q,-_e.strokeWidth())),this.isDirtyBox=!1,vr(this,"afterDrawChartBox")}propFromSeries(){let s,u,p,g=this,b=g.options.chart,T=g.options.series;["inverted","angular","polar"].forEach(function(C){for(u=Sl[b.type],p=b[C]||u&&u.prototype[C],s=T==null?void 0:T.length;!p&&s--;)(u=Sl[T[s].type])&&u.prototype[C]&&(p=!0);g[C]=p})}linkSeries(s){let u=this,p=u.series;p.forEach(function(g){g.linkedSeries.length=0}),p.forEach(function(g){let{linkedTo:b}=g.options;if(_u(b)){let T;(T=b===":previous"?u.series[g.index-1]:u.get(b))&&T.linkedParent!==g&&(T.linkedSeries.push(g),g.linkedParent=T,T.enabledDataSorting&&g.setDataSortingOptions(),g.visible=Oa(g.options.visible,T.options.visible,g.visible))}}),vr(this,"afterLinkSeries",{isUpdating:s})}renderSeries(){this.series.forEach(function(s){s.translate(),s.render()})}render(){var N;let s=this.axes,u=this.colorAxis,p=this.renderer,g=this.options.chart.axisLayoutRuns||2,b=I=>{I.forEach(U=>{U.visible&&U.render()})},T=0,C=!0,E,D=0;for(let I of(this.setTitle(),vr(this,"beforeMargins"),(N=this.getStacks)==null||N.call(this),this.getMargins(!0),this.setChartSize(),s)){let{options:U}=I,{labels:X}=U;if(this.hasCartesianSeries&&I.horiz&&I.visible&&X.enabled&&I.series.length&&I.coll!=="colorAxis"&&!this.polar){T=U.tickLength,I.createGroups();let Q=new Rs(I,0,"",!0),le=Q.createLabel("x",X);if(Q.destroy(),le&&Oa(X.reserveSpace,!ln(U.crossing))&&(T=le.getBBox().height+X.distance+Math.max(U.offset||0,0)),T){le==null||le.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-T,0);(C||E||g>1)&&D<g;){let I=this.plotWidth,U=this.plotHeight;for(let X of s)D===0?X.setScale():(X.horiz&&C||!X.horiz&&E)&&X.setTickInterval(!0);D===0?this.getAxisMargins():this.getMargins(),C=I/this.plotWidth>(D?1:1.1),E=U/this.plotHeight>(D?1:1.05),D++}this.drawChartBox(),this.hasCartesianSeries?b(s):u!=null&&u.length&&b(u),this.seriesGroup||(this.seriesGroup=p.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(s){let u=this,p=$o(!0,this.options.credits,s);p.enabled&&!this.credits&&(this.credits=this.renderer.text(p.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){p.href&&(Rd.location.href=p.href)}).attr({align:p.position.align,zIndex:8}),u.styledMode||this.credits.css(p.style),this.credits.add().align(p.position),this.credits.update=function(g){u.credits=u.credits.destroy(),u.addCredits(g)})}destroy(){var C,E;let s,u=this,p=u.axes,g=u.series,b=u.container,T=b==null?void 0:b.parentNode;for(vr(u,"destroy"),u.renderer.forExport?Tp(Ln,u):Ln[u.index]=void 0,Ue.chartCount--,u.renderTo.removeAttribute("data-highcharts-chart"),Cp(u),s=p.length;s--;)p[s]=p[s].destroy();for((E=(C=this.scroller)==null?void 0:C.destroy)==null||E.call(C),s=g.length;s--;)g[s]=g[s].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(D=>{var N,I;u[D]=(I=(N=u[D])==null?void 0:N.destroy)==null?void 0:I.call(N)}),b&&(b.innerHTML=Er.emptyHTML,Cp(b),T&&of(b)),Od(u,function(D,N){delete u[N]})}firstRender(){var g;let s=this,u=s.options;s.getContainer(),s.resetMargins(),s.setChartSize(),s.propFromSeries(),s.createAxes();let p=Ia(u.series)?u.series:[];u.series=[],p.forEach(function(b){s.initSeries(b)}),s.linkSeries(),s.setSortedData(),vr(s,"beforeRender"),s.render(),(g=s.pointer)==null||g.getChartPosition(),s.renderer.imgCount||s.hasLoaded||s.onload(),s.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(s){s&&this.index!==void 0&&s.apply(this,[this])},this),vr(this,"load"),vr(this,"render"),ec(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:s,title:u}=this;!s||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":((u==null?void 0:u.element.textContent)||"").replace(/</g,"&lt;")}),s.accessibility&&s.accessibility.enabled===!1||Gh('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(s,u,p){let g,b=this;return s&&(u=Oa(u,!0),vr(b,"addSeries",{options:s},function(){g=b.initSeries(s),b.isDirtyLegend=!0,b.linkSeries(),g.enabledDataSorting&&g.setData(s.data,!1),vr(b,"afterAddSeries",{series:g}),u&&b.redraw(p)})),g}addAxis(s,u,p,g){return this.createAxis(u?"xAxis":"yAxis",{axis:s,redraw:p,animation:g})}addColorAxis(s,u,p){return this.createAxis("colorAxis",{axis:s,redraw:u,animation:p})}createAxis(s,u){let p=new Ya(this,u.axis,s);return Oa(u.redraw,!0)&&this.redraw(u.animation),p}showLoading(s){let u=this,p=u.options,g=p.loading,b=function(){T&&os(T,{left:u.plotLeft+"px",top:u.plotTop+"px",width:u.plotWidth+"px",height:u.plotHeight+"px"})},T=u.loadingDiv,C=u.loadingSpan;T||(u.loadingDiv=T=Rc("div",{className:"highcharts-loading highcharts-loading-hidden"},null,u.container)),C||(u.loadingSpan=C=Rc("span",{className:"highcharts-loading-inner"},null,T),Jl(u,"redraw",b)),T.className="highcharts-loading",Er.setElementHTML(C,Oa(s,p.lang.loading,"")),u.styledMode||(os(T,tc(g.style,{zIndex:10})),os(C,g.labelStyle),u.loadingShown||(os(T,{opacity:0,display:""}),Ns(T,{opacity:g.style.opacity||.5},{duration:g.showDuration||0}))),u.loadingShown=!0,b()}hideLoading(){let s=this.options,u=this.loadingDiv;u&&(u.className="highcharts-loading highcharts-loading-hidden",this.styledMode||Ns(u,{opacity:0},{duration:s.loading.hideDuration||100,complete:function(){os(u,{display:"none"})}})),this.loadingShown=!1}update(s,u,p,g){let b,T,C,E=this,D={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},N=s.isResponsiveOptions,I=[];vr(E,"update",{options:s}),N||E.setResponsive(!1,!0),s=sf(s,E.options),E.userOptions=$o(E.userOptions,s);let U=s.chart;U&&($o(!0,E.options.chart,U),this.setZoomOptions(),"className"in U&&E.setClassName(U.className),("inverted"in U||"polar"in U||"type"in U)&&(E.propFromSeries(),b=!0),"alignTicks"in U&&(b=!0),"events"in U&&uh(this,U),Od(U,function(le,ne){E.propsRequireUpdateSeries.indexOf("chart."+ne)!==-1&&(T=!0),E.propsRequireDirtyBox.indexOf(ne)!==-1&&(E.isDirtyBox=!0),E.propsRequireReflow.indexOf(ne)===-1||(E.isDirtyBox=!0,N||(C=!0))}),!E.styledMode&&U.style&&E.renderer.setStyle(E.options.chart.style||{})),!E.styledMode&&s.colors&&(this.options.colors=s.colors),Od(s,function(le,ne){E[ne]&&typeof E[ne].update=="function"?E[ne].update(le,!1):typeof E[D[ne]]=="function"?E[D[ne]](le):ne!=="colors"&&E.collectionsWithUpdate.indexOf(ne)===-1&&$o(!0,E.options[ne],s[ne]),ne!=="chart"&&E.propsRequireUpdateSeries.indexOf(ne)!==-1&&(T=!0)}),this.collectionsWithUpdate.forEach(function(le){s[le]&&(Hh(s[le]).forEach(function(ne,ie){let me,_e=ec(ne.id);_e&&(me=E.get(ne.id)),!me&&E[le]&&(me=E[le][Oa(ne.index,ie)])&&(_e&&ec(me.options.id)||me.options.isInternal)&&(me=void 0),me&&me.coll===le&&(me.update(ne,!1),p&&(me.touched=!0)),!me&&p&&E.collectionsWithInit[le]&&(E.collectionsWithInit[le][0].apply(E,[ne].concat(E.collectionsWithInit[le][1]||[]).concat([!1])).touched=!0)}),p&&E[le].forEach(function(ne){ne.touched||ne.options.isInternal?delete ne.touched:I.push(ne)}))}),I.forEach(function(le){le.chart&&le.remove&&le.remove(!1)}),b&&E.axes.forEach(function(le){le.update({},!1)}),T&&E.getSeriesOrderByLinks().forEach(function(le){le.chart&&le.update({},!1)},this);let X=U==null?void 0:U.width,Q=U&&(_u(U.height)?jd(U.height,X||E.chartWidth):U.height);C||ln(X)&&X!==E.chartWidth||ln(Q)&&Q!==E.chartHeight?E.setSize(X,Q,g):Oa(u,!0)&&E.redraw(g),vr(E,"afterUpdate",{options:s,redraw:u,animation:g})}setSubtitle(s,u){this.applyDescription("subtitle",s),this.layOutTitles(u)}setCaption(s,u){this.applyDescription("caption",s),this.layOutTitles(u)}showResetZoom(){let s=this,u=Gr.lang,p=s.zooming.resetButton,g=p.theme,b=p.relativeTo==="chart"||p.relativeTo==="spacingBox"?null:"plotBox";function T(){s.zoomOut()}vr(this,"beforeShowResetZoom",null,function(){s.resetZoomButton=s.renderer.button(u.resetZoom,null,null,T,g).attr({align:p.position.align,title:u.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(p.position,!1,b)}),vr(this,"afterShowResetZoom")}zoomOut(){vr(this,"selection",{resetSelection:!0},()=>this.transform({reset:!0,trigger:"zoom"}))}pan(s,u){let p=this,g=typeof u=="object"?u:{enabled:u,type:"x"},b=g.type,T=b&&p[{x:"xAxis",xy:"axes",y:"yAxis"}[b]].filter(E=>E.options.panningEnabled&&!E.options.isInternal),C=p.options.chart;C!=null&&C.panning&&(C.panning=g),vr(this,"pan",{originalEvent:s},()=>{p.transform({axes:T,event:s,to:{x:s.chartX-(p.mouseDownX||0),y:s.chartY-(p.mouseDownY||0)},trigger:"pan"}),os(p.container,{cursor:"move"})})}transform(s){var Q;let{axes:u=this.axes,event:p,from:g={},reset:b,selection:T,to:C={},trigger:E}=s,{inverted:D,time:N}=this,I=!1,U,X;for(let le of((Q=this.hoverPoints)==null||Q.forEach(ne=>ne.setState()),u)){let{horiz:ne,len:ie,minPointOffset:me=0,options:_e,reversed:Je}=le,$e=ne?"width":"height",Ze=ne?"x":"y",ht=Oa(C[$e],le.len),at=Oa(g[$e],le.len),mt=10>Math.abs(ht)?1:ht/at,Bt=(g[Ze]||0)+at/2-le.pos,Zt=Bt-((C[Ze]??le.pos)+ht/2-le.pos)/mt,Qt=Je&&!D||!Je&&D?-1:1;if(!b&&(Bt<0||Bt>le.len))continue;let Gt=le.toValue(Zt,!0)+(T||le.isOrdinal?0:me*Qt),hi=le.toValue(Zt+ie/mt,!0)-(T||le.isOrdinal?0:me*Qt||0),oi=le.allExtremes;if(Gt>hi&&([Gt,hi]=[hi,Gt]),mt===1&&!b&&le.coll==="yAxis"&&!oi){for(let Ts of le.series){let $s=Ts.getExtremes(Ts.getProcessedData(!0).modified.getColumn("y")||[],!0);oi??(oi={dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE}),ln($s.dataMin)&&ln($s.dataMax)&&(oi.dataMin=Math.min($s.dataMin,oi.dataMin),oi.dataMax=Math.max($s.dataMax,oi.dataMax))}le.allExtremes=oi}let{dataMin:ji,dataMax:_i,min:Di,max:lr}=tc(le.getExtremes(),oi||{}),Bi=N.parse(_e.min),yr=N.parse(_e.max),Na=ji??Bi,_r=_i??yr,dr=hi-Gt,fi=le.categories?0:Math.min(dr,_r-Na),zi=Na-fi*(ec(Bi)?0:_e.minPadding),hn=_r+fi*(ec(yr)?0:_e.maxPadding),pr=le.allowZoomOutside||mt===1||E!=="zoom"&&mt>1,Hr=Math.min(Bi??zi,zi,pr?Di:zi),ta=Math.max(yr??hn,hn,pr?lr:hn);(!le.isOrdinal||le.options.overscroll||mt!==1||b)&&(Gt<Hr&&(Gt=Hr,mt>=1&&(hi=Gt+dr)),hi>ta&&(hi=ta,mt>=1&&(Gt=hi-dr)),(b||le.series.length&&(Gt!==Di||hi!==lr)&&Gt>=Hr&&hi<=ta)&&(T?T[le.coll].push({axis:le,min:Gt,max:hi}):(le.isPanning=E!=="zoom",le.isPanning&&(X=!0),le.setExtremes(b?void 0:Gt,b?void 0:hi,!1,!1,{move:Zt,trigger:E,scale:mt}),!b&&(Gt>Hr||hi<ta)&&E!=="mousewheel"&&(U=!0)),I=!0),p&&(this[ne?"mouseDownX":"mouseDownY"]=p[ne?"chartX":"chartY"]))}return I&&(T?vr(this,"selection",T,()=>{delete s.selection,s.trigger="zoom",this.transform(s)}):(!U||X||this.resetZoomButton?!U&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()):this.showResetZoom(),this.redraw(E==="zoom"&&(this.options.chart.animation??this.pointCount<100)))),I}}tc(Tl.prototype,{callbacks:[],collectionsWithInit:{xAxis:[Tl.prototype.addAxis,[!0]],yAxis:[Tl.prototype.addAxis,[!1]],series:[Tl.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]});let{stop:Nd}=Dr,{composed:Zh}=Ue,{addEvent:Tn,createElement:xu,css:hh,defined:Ap,erase:Ep,merge:lf,pushUnique:ic}=li;function kp(){let R=this.scrollablePlotArea;(this.scrollablePixelsX||this.scrollablePixelsY)&&!R&&(this.scrollablePlotArea=R=new vu(this)),R==null||R.applyFixed()}function Uf(){this.chart.scrollablePlotArea&&(this.chart.scrollablePlotArea.isDirty=!0)}class vu{static compose(s,u,p){ic(Zh,this.compose)&&(Tn(s,"afterInit",Uf),Tn(u,"afterSetChartSize",g=>this.afterSetSize(g.target,g)),Tn(u,"render",kp),Tn(p,"show",Uf))}static afterSetSize(s,u){let p,g,b,{minWidth:T,minHeight:C}=s.options.chart.scrollablePlotArea||{},{clipBox:E,plotBox:D,inverted:N,renderer:I}=s;if(!I.forExport&&(T?(s.scrollablePixelsX=p=Math.max(0,T-s.chartWidth),p&&(s.scrollablePlotBox=lf(s.plotBox),D.width=s.plotWidth+=p,E[N?"height":"width"]+=p,b=!0)):C&&(s.scrollablePixelsY=g=Math.max(0,C-s.chartHeight),Ap(g)&&(s.scrollablePlotBox=lf(s.plotBox),D.height=s.plotHeight+=g,E[N?"width":"height"]+=g,b=!1)),Ap(b)&&!u.skipAxes))for(let U of s.axes)(U.horiz===b||s.hasParallelCoordinates&&U.coll==="yAxis")&&(U.setAxisSize(),U.setAxisTranslation())}constructor(s){var X;let u,p=s.options.chart,g=fs.getRendererType(),b=p.scrollablePlotArea||{},T=this.moveFixedElements.bind(this),C={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};s.scrollablePixelsX&&(C.overflowX="auto"),s.scrollablePixelsY&&(C.overflowY="auto"),this.chart=s;let E=this.parentDiv=xu("div",{className:"highcharts-scrolling-parent"},{position:"relative"},s.renderTo),D=this.scrollingContainer=xu("div",{className:"highcharts-scrolling"},C,E),N=this.innerContainer=xu("div",{className:"highcharts-inner-container"},void 0,D),I=this.fixedDiv=xu("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(((X=p.style)==null?void 0:X.zIndex)||0)+2,top:0},void 0,!0),U=this.fixedRenderer=new g(I,s.chartWidth,s.chartHeight,p.style);this.mask=U.path().attr({fill:p.backgroundColor||"#fff","fill-opacity":b.opacity??.85,zIndex:-1}).addClass("highcharts-scrollable-mask").add(),D.parentNode.insertBefore(I,D),hh(s.renderTo,{overflow:"visible"}),Tn(s,"afterShowResetZoom",T),Tn(s,"afterApplyDrilldown",T),Tn(s,"afterLayOutTitles",T),Tn(D,"scroll",()=>{let{pointer:Q,hoverPoint:le}=s;Q&&(delete Q.chartPosition,le&&(u=le),Q.runPointActions(void 0,u,!0))}),N.appendChild(s.container)}applyFixed(){var Bt;let{chart:s,fixedRenderer:u,isDirty:p,scrollingContainer:g}=this,{axisOffset:b,chartWidth:T,chartHeight:C,container:E,plotHeight:D,plotLeft:N,plotTop:I,plotWidth:U,scrollablePixelsX:X=0,scrollablePixelsY:Q=0}=s,{scrollPositionX:le=0,scrollPositionY:ne=0}=s.options.chart.scrollablePlotArea||{},ie=T+X,me=C+Q;u.setSize(T,C),(p??!0)&&(this.isDirty=!1,this.moveFixedElements()),Nd(s.container),hh(E,{width:`${ie}px`,height:`${me}px`}),s.renderer.boxWrapper.attr({width:ie,height:me,viewBox:[0,0,ie,me].join(" ")}),(Bt=s.chartBackground)==null||Bt.attr({width:ie,height:me}),hh(g,{width:`${T}px`,height:`${C}px`}),Ap(p)||(g.scrollLeft=X*le,g.scrollTop=Q*ne);let _e=I-b[0]-1,Je=N-b[3]-1,$e=I+D+b[2]+1,Ze=N+U+b[1]+1,ht=N+U-X,at=I+D-Q,mt=[["M",0,0]];X?mt=[["M",0,_e],["L",N-1,_e],["L",N-1,$e],["L",0,$e],["Z"],["M",ht,_e],["L",T,_e],["L",T,$e],["L",ht,$e],["Z"]]:Q&&(mt=[["M",Je,0],["L",Je,I-1],["L",Ze,I-1],["L",Ze,0],["Z"],["M",Je,at],["L",Je,C],["L",Ze,C],["L",Ze,at],["Z"]]),s.redrawTrigger!=="adjustHeight"&&this.mask.attr({d:mt})}moveFixedElements(){let s,{container:u,inverted:p,scrollablePixelsX:g,scrollablePixelsY:b}=this.chart,T=this.fixedRenderer,C=vu.fixedSelectors;if(g&&!p?s=".highcharts-yaxis":g&&p||b&&!p?s=".highcharts-xaxis":b&&p&&(s=".highcharts-yaxis"),s&&!(this.chart.hasParallelCoordinates&&s===".highcharts-yaxis"))for(let E of[`${s}:not(.highcharts-radial-axis)`,`${s}-labels:not(.highcharts-radial-axis-labels)`])ic(C,E);else for(let E of[".highcharts-xaxis",".highcharts-yaxis"])for(let D of[`${E}:not(.highcharts-radial-axis)`,`${E}-labels:not(.highcharts-radial-axis-labels)`])Ep(C,D);for(let E of C)[].forEach.call(u.querySelectorAll(E),D=>{(D.namespaceURI===T.SVG_NS?T.box:T.box.parentNode).appendChild(D),D.style.pointerEvents="auto"})}}vu.fixedSelectors=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-drillup-button",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-range-selector-group",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"];let{format:rc}=Sa,{series:cf}=_,{destroyObjectProperties:Pp,fireEvent:qh,getAlignFactor:yn,isNumber:Fd,pick:dh}=li,zp=class{constructor(R,s,u,p,g){let b=R.chart.inverted,T=R.reversed;this.axis=R;let C=this.isNegative=!!u!=!!T;this.options=s=s||{},this.x=p,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=g,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:s.align||(b?C?"left":"right":"center"),verticalAlign:s.verticalAlign||(b?"middle":C?"bottom":"top"),y:s.y,x:s.x},this.textAlign=s.textAlign||(b?C?"right":"left":"center")}destroy(){Pp(this,this.axis)}render(R){let s=this.axis.chart,u=this.options,p=u.format,g=p?rc(p,this,s):u.formatter.call(this);if(this.label)this.label.attr({text:g,visibility:"hidden"});else{this.label=s.renderer.label(g,null,void 0,u.shape,void 0,void 0,u.useHTML,!1,"stack-labels");let b={r:u.borderRadius||0,text:g,padding:dh(u.padding,5),visibility:"hidden"};s.styledMode||(b.fill=u.backgroundColor,b.stroke=u.borderColor,b["stroke-width"]=u.borderWidth,this.label.css(u.style||{})),this.label.attr(b),this.label.added||this.label.add(R)}this.label.labelrank=s.plotSizeY,qh(this,"afterRender")}setOffset(R,s,u,p,g,b){let{alignOptions:T,axis:C,label:E,options:D,textAlign:N}=this,I=C.chart,U=this.getStackBox({xOffset:R,width:s,boxBottom:u,boxTop:p,defaultX:g,xAxis:b}),{verticalAlign:X}=T;if(E&&U){let Q=E.getBBox(void 0,0),le=E.padding,ne=dh(D.overflow,"justify")==="justify",ie;T.x=D.x||0,T.y=D.y||0;let{x:me,y:_e}=this.adjustStackPosition({labelBox:Q,verticalAlign:X,textAlign:N});U.x-=me,U.y-=_e,E.align(T,!1,U),(ie=I.isInsidePlot(E.alignAttr.x+T.x+me,E.alignAttr.y+T.y+_e))||(ne=!1),ne&&cf.prototype.justifyDataLabel.call(C,E,T,E.alignAttr,Q,U),E.attr({x:E.alignAttr.x,y:E.alignAttr.y,rotation:D.rotation,rotationOriginX:Q.width*yn(D.textAlign||"center"),rotationOriginY:Q.height/2}),dh(!ne&&D.crop,!0)&&(ie=Fd(E.x)&&Fd(E.y)&&I.isInsidePlot(E.x-le+(E.width||0),E.y)&&I.isInsidePlot(E.x+le,E.y)),E[ie?"show":"hide"]()}qh(this,"afterSetOffset",{xOffset:R,width:s})}adjustStackPosition({labelBox:R,verticalAlign:s,textAlign:u}){return{x:R.width/2+R.width/2*(2*yn(u)-1),y:R.height/2*2*(1-yn(s))}}getStackBox(R){let s=this.axis,u=s.chart,{boxTop:p,defaultX:g,xOffset:b,width:T,boxBottom:C}=R,E=s.stacking.usePercentage?100:dh(p,this.total,0),D=s.toPixels(E),N=R.xAxis||u.xAxis[0],I=dh(g,N.translate(this.x))+b,U=Math.abs(D-s.toPixels(C||Fd(s.min)&&s.logarithmic&&s.logarithmic.lin2log(s.min)||0)),X=u.inverted,Q=this.isNegative;return X?{x:(Q?D:D-U)-u.plotLeft,y:N.height-I-T+N.top-u.plotTop,width:U,height:T}:{x:I+N.transB-u.plotLeft,y:(Q?D-U:D)-u.plotTop,width:T,height:U}}},{getDeferredAnimation:Ml}=Dr,{series:{prototype:Ho}}=_,{addEvent:uf,correctFloat:Xh,defined:Yh,destroyObjectProperties:nc,fireEvent:Vf,isNumber:Ud,objectEach:bu,pick:ph}=li;function hf(){let R=this.inverted;this.axes.forEach(s=>{var u;(u=s.stacking)!=null&&u.stacks&&s.hasVisibleSeries&&(s.stacking.oldStacks=s.stacking.stacks)}),this.series.forEach(s=>{var p;let u=((p=s.xAxis)==null?void 0:p.options)||{};s.options.stacking&&s.reserveSpace()&&(s.stackKey=[s.type,ph(s.options.stack,""),R?u.top:u.left,R?u.height:u.width].join(","))})}function Vd(){var s;let R=this.stacking;if(R){let u=R.stacks;bu(u,(p,g)=>{nc(p),delete u[g]}),(s=R.stackTotalGroup)==null||s.destroy()}}function Wh(){this.stacking||(this.stacking=new Lp(this))}function Oc(R,s,u,p){return!Yh(R)||R.x!==s||p&&R.stackKey!==p?R={x:s,index:0,key:p,stackKey:p}:R.index++,R.key=[u,s,R.index].join(","),R}function or(){let R,s=this,u=s.yAxis,p=s.stackKey||"",g=u.stacking.stacks,b=s.getColumn("x",!0),T=s.options.stacking,C=s[T+"Stacker"];C&&[p,"-"+p].forEach(E=>{var X;let D=b.length,N,I,U;for(;D--;)N=b[D],R=s.getStackIndicator(R,N,s.index,E),I=(X=g[E])==null?void 0:X[N],(U=I==null?void 0:I.points[R.key||""])&&C.call(s,U,I,D)})}function wu(R,s,u){let p=s.total?100/s.total:0;R[0]=Xh(R[0]*p),R[1]=Xh(R[1]*p),this.stackedYData[u]=R[1]}function df(R){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&this.chart.series.length>1?Ho.setStackedPoints.call(this,R,"group"):R.stacking.resetStacks())}function Hn(R,s){var at,mt;let u,p,g,b,T,C,E,D=s||this.options.stacking;if(!D||!this.reserveSpace()||({group:"xAxis"}[D]||"yAxis")!==R.coll)return;let N=this.getColumn("x",!0),I=this.getColumn(this.pointValKey||"y",!0),U=[],X=I.length,Q=this.options,le=Q.threshold||0,ne=Q.startFromThreshold?le:0,ie=Q.stack,me=s?`${this.type},${D}`:this.stackKey||"",_e="-"+me,Je=this.negStacks,$e=R.stacking,Ze=$e.stacks,ht=$e.oldStacks;for($e.stacksTouched+=1,E=0;E<X;E++){let Bt=N[E]||0,Zt=I[E],Qt=Ud(Zt)&&Zt||0;C=(u=this.getStackIndicator(u,Bt,this.index)).key||"",Ze[T=(p=Je&&Qt<(ne?0:le))?_e:me]||(Ze[T]={}),Ze[T][Bt]||((at=ht[T])!=null&&at[Bt]?(Ze[T][Bt]=ht[T][Bt],Ze[T][Bt].total=null):Ze[T][Bt]=new zp(R,R.options.stackLabels,!!p,Bt,ie)),g=Ze[T][Bt],Zt!==null?(g.points[C]=g.points[this.index]=[ph(g.cumulative,ne)],Yh(g.cumulative)||(g.base=C),g.touched=$e.stacksTouched,u.index>0&&this.singleStacks===!1&&(g.points[C][0]=g.points[this.index+","+Bt+",0"][0])):(delete g.points[C],delete g.points[this.index]);let Gt=g.total||0;D==="percent"?(b=p?me:_e,Gt=Je&&((mt=Ze[b])!=null&&mt[Bt])?(b=Ze[b][Bt]).total=Math.max(b.total||0,Gt)+Math.abs(Qt):Xh(Gt+Math.abs(Qt))):D==="group"?Ud(Zt)&&Gt++:Gt=Xh(Gt+Qt),D==="group"?g.cumulative=(Gt||1)-1:g.cumulative=Xh(ph(g.cumulative,ne)+Qt),g.total=Gt,Zt!==null&&(g.points[C].push(g.cumulative),U[E]=g.cumulative,g.hasValidPoints=!0)}D==="percent"&&($e.usePercentage=!0),D!=="group"&&(this.stackedYData=U),$e.oldStacks={}}class Lp{constructor(s){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=s}buildStacks(){let s,u,p=this.axis,g=p.series,b=p.coll==="xAxis",T=p.options.reversedStacks,C=g.length;for(this.resetStacks(),this.usePercentage=!1,u=C;u--;)s=g[T?u:C-u-1],b&&s.setGroupedPoints(p),s.setStackedPoints(p);if(!b)for(u=0;u<C;u++)g[u].modifyStacks();Vf(p,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,bu(this.stacks,s=>{bu(s,u=>{u.cumulative=u.total})}))}resetStacks(){bu(this.stacks,s=>{bu(s,(u,p)=>{Ud(u.touched)&&u.touched<this.stacksTouched?(u.destroy(),delete s[p]):(u.total=null,u.cumulative=null)})})}renderStackTotals(){var C;let s=this.axis,u=s.chart,p=u.renderer,g=this.stacks,b=Ml(u,((C=s.options.stackLabels)==null?void 0:C.animation)||!1),T=this.stackTotalGroup=this.stackTotalGroup||p.g("stack-labels").attr({zIndex:6,opacity:0}).add();T.translate(u.plotLeft,u.plotTop),bu(g,E=>{bu(E,D=>{D.render(T)})}),T.animate({opacity:1},b)}}(Ne||(Ne={})).compose=function(R,s,u){let p=s.prototype,g=u.prototype;p.getStacks||(uf(R,"init",Wh),uf(R,"destroy",Vd),p.getStacks=hf,g.getStackIndicator=Oc,g.modifyStacks=or,g.percentStacker=wu,g.setGroupedPoints=df,g.setStackedPoints=Hn)};let Kh=Ne,{defined:pf,merge:cn,isObject:ja}=li;class Zo extends nr{drawGraph(){let s=this.options,u=(this.gappedPath||this.getGraphPath).call(this),p=this.chart.styledMode;[this,...this.zones].forEach((g,b)=>{let T,C=g.graph,E=C?"animate":"attr",D=g.dashStyle||s.dashStyle;C?(C.endX=this.preventGraphAnimation?null:u.xMap,C.animate({d:u})):u.length&&(g.graph=C=this.chart.renderer.path(u).addClass("highcharts-graph"+(b?` highcharts-zone-graph-${b-1} `:" ")+(b&&g.className||"")).attr({zIndex:1}).add(this.group)),C&&!p&&(T={stroke:!b&&s.lineColor||g.color||this.color||"#cccccc","stroke-width":s.lineWidth||0,fill:this.fillGraph&&this.color||"none"},D?T.dashstyle=D:s.linecap!=="square"&&(T["stroke-linecap"]=T["stroke-linejoin"]="round"),C[E](T).shadow(s.shadow&&cn({filterUnits:"userSpaceOnUse"},ja(s.shadow)?s.shadow:{}))),C&&(C.startX=u.xMap,C.isArea=u.isArea)})}getGraphPath(s,u,p){let g=this,b=g.options,T=[],C=[],E,D=b.step,N=(s=s||g.points).reversed;return N&&s.reverse(),(D={right:1,center:2}[D]||D&&3)&&N&&(D=4-D),(s=this.getValidPoints(s,!1,b.nullInteraction||!(b.connectNulls&&!u&&!p))).forEach(function(I,U){let X,Q=I.plotX,le=I.plotY,ne=s[U-1],ie=I.isNull||typeof le!="number";(I.leftCliff||ne!=null&&ne.rightCliff)&&!p&&(E=!0),ie&&!pf(u)&&U>0?E=!b.connectNulls:ie&&!u?E=!0:(U===0||E?X=[["M",I.plotX,I.plotY]]:g.getPointSpline?X=[g.getPointSpline(s,I,U)]:D?(X=D===1?[["L",ne.plotX,le]]:D===2?[["L",(ne.plotX+Q)/2,ne.plotY],["L",(ne.plotX+Q)/2,le]]:[["L",Q,ne.plotY]]).push(["L",Q,le]):X=[["L",Q,le]],C.push(I.x),D&&(C.push(I.x),D===2&&C.push(I.x)),T.push.apply(T,X),E=!1)}),T.xMap=C,g.graphPath=T,T}}Zo.defaultOptions=cn(nr.defaultOptions,{legendSymbol:"lineMarker"}),_.registerSeriesType("line",Zo);let{seriesTypes:{line:jc}}=_,{extend:Gd,merge:Qh,objectEach:fh,pick:ls}=li;class Fs extends jc{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:s,options:u}=this;[this,...this.zones].forEach((p,g)=>{let b={},T=p.fillColor||u.fillColor,C=p.area,E=C?"animate":"attr";C?(C.endX=this.preventGraphAnimation?null:s.xMap,C.animate({d:s})):(b.zIndex=0,(C=p.area=this.chart.renderer.path(s).addClass("highcharts-area"+(g?` highcharts-zone-area-${g-1} `:" ")+(g&&p.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(b.fill=T||p.color||this.color,b["fill-opacity"]=T?1:u.fillOpacity??.75,C.css({pointerEvents:this.stickyTracking?"none":"auto"})),C[E](b),C.startX=s.xMap,C.shiftUnit=u.step?2:1})}getGraphPath(s){let u,p,g,b=jc.prototype.getGraphPath,T=this.options,C=T.stacking,E=this.yAxis,D=[],N=[],I=this.index,U=E.stacking.stacks[this.stackKey],X=T.threshold,Q=Math.round(E.getThreshold(T.threshold)),le=ls(T.connectNulls,C==="percent"),ne=function(Ze,ht,at){let mt=s[Ze],Bt=C&&U[mt.x].points[I],Zt=mt[at+"Null"]||0,Qt=mt[at+"Cliff"]||0,Gt,hi,oi=!0;Qt||Zt?(Gt=(Zt?Bt[0]:Bt[1])+Qt,hi=Bt[0]+Qt,oi=!!Zt):!C&&s[ht]&&s[ht].isNull&&(Gt=hi=X),Gt!==void 0&&(N.push({plotX:u,plotY:Gt===null?Q:E.getThreshold(Gt),isNull:oi,isCliff:!0}),D.push({plotX:u,plotY:hi===null?Q:E.getThreshold(hi),doCurve:!1}))};s=s||this.points,C&&(s=this.getStackPoints(s));for(let Ze=0,ht=s.length;Ze<ht;++Ze)C||(s[Ze].leftCliff=s[Ze].rightCliff=s[Ze].leftNull=s[Ze].rightNull=void 0),p=s[Ze].isNull,u=ls(s[Ze].rectPlotX,s[Ze].plotX),g=C?ls(s[Ze].yBottom,Q):Q,p&&!le||(le||ne(Ze,Ze-1,"left"),p&&!C&&le||(N.push(s[Ze]),D.push({x:Ze,plotX:u,plotY:g})),le||ne(Ze,Ze+1,"right"));let ie=b.call(this,N,!0,!0);D.reversed=!0;let me=b.call(this,D,!0,!0),_e=me[0];_e&&_e[0]==="M"&&(me[0]=["L",_e[1],_e[2]]);let Je=ie.concat(me);Je.length&&Je.push(["Z"]);let $e=b.call(this,N,!1,le);return this.chart.series.length>1&&C&&N.some(Ze=>Ze.isCliff)&&(Je.hasStackedCliffs=$e.hasStackedCliffs=!0),Je.xMap=ie.xMap,this.areaPath=Je,$e}getStackPoints(s){let u=this,p=[],g=[],b=this.xAxis,T=this.yAxis,C=T.stacking.stacks[this.stackKey],E={},D=T.series,N=D.length,I=T.options.reversedStacks?1:-1,U=D.indexOf(u);if(s=s||this.points,this.options.stacking){for(let Q=0;Q<s.length;Q++)s[Q].leftNull=s[Q].rightNull=void 0,E[s[Q].x]=s[Q];fh(C,function(Q,le){Q.total!==null&&g.push(le)}),g.sort(function(Q,le){return Q-le});let X=D.map(Q=>Q.visible);g.forEach(function(Q,le){let ne=0,ie,me;if(E[Q]&&!E[Q].isNull)p.push(E[Q]),[-1,1].forEach(function(_e){let Je=_e===1?"rightNull":"leftNull",$e=C[g[le+_e]],Ze=0;if($e){let ht=U;for(;ht>=0&&ht<N;){let at=D[ht].index;!(ie=$e.points[at])&&(at===u.index?E[Q][Je]=!0:X[ht]&&(me=C[Q].points[at])&&(Ze-=me[1]-me[0])),ht+=I}}E[Q][_e===1?"rightCliff":"leftCliff"]=Ze});else{let _e=U;for(;_e>=0&&_e<N;){let Je=D[_e].index;if(ie=C[Q].points[Je]){ne=ie[1];break}_e+=I}ne=ls(ne,0),ne=T.translate(ne,0,1,0,1),p.push({isNull:!0,plotX:b.translate(Q,0,0,0,1),x:Q,plotY:ne,yBottom:ne})}})}return p}}Fs.defaultOptions=Qh(jc.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),Gd(Fs.prototype,{singleStacks:!1}),_.registerSeriesType("area",Fs);let{line:Bc}=_.seriesTypes,{merge:xo,pick:Jh}=li;class Us extends Bc{getPointSpline(s,u,p){let g,b,T,C,E=u.plotX||0,D=u.plotY||0,N=s[p-1],I=s[p+1];function U(Q){return Q&&!Q.isNull&&Q.doCurve!==!1&&!u.isCliff}if(U(N)&&U(I)){let Q=N.plotX||0,le=N.plotY||0,ne=I.plotX||0,ie=I.plotY||0,me=0;g=(1.5*E+Q)/2.5,b=(1.5*D+le)/2.5,T=(1.5*E+ne)/2.5,C=(1.5*D+ie)/2.5,T!==g&&(me=(C-b)*(T-E)/(T-g)+D-C),b+=me,C+=me,b>le&&b>D?(b=Math.max(le,D),C=2*D-b):b<le&&b<D&&(b=Math.min(le,D),C=2*D-b),C>ie&&C>D?(C=Math.max(ie,D),b=2*D-C):C<ie&&C<D&&(C=Math.min(ie,D),b=2*D-C),u.rightContX=T,u.rightContY=C,u.controlPoints={low:[g,b],high:[T,C]}}let X=["C",Jh(N.rightContX,N.plotX,0),Jh(N.rightContY,N.plotY,0),Jh(g,E,0),Jh(b,D,0),E,D];return N.rightContX=N.rightContY=void 0,X}}Us.defaultOptions=xo(Bc.defaultOptions),_.registerSeriesType("spline",Us);let ac=Us,{area:Nc,area:{prototype:ed}}=_.seriesTypes,{extend:ff,merge:sc}=li;class Dp extends ac{}Dp.defaultOptions=sc(ac.defaultOptions,Nc.defaultOptions),ff(Dp.prototype,{getGraphPath:ed.getGraphPath,getStackPoints:ed.getStackPoints,drawGraph:ed.drawGraph}),_.registerSeriesType("areaspline",Dp);let{animObject:td}=Dr,{parse:$d}=ai,{noop:mh}=Ue,{clamp:oc,crisp:gh,defined:Rp,extend:Su,fireEvent:Ip,isArray:id,isNumber:Tu,merge:Op,pick:rd,objectEach:$r}=li;class Pr extends nr{animate(s){let u,p,g=this,b=this.yAxis,T=b.pos,C=b.reversed,E=g.options,{clipOffset:D,inverted:N}=this.chart,I={},U=N?"translateX":"translateY";s&&D?(I.scaleY=.001,p=oc(b.toPixels(E.threshold||0),T,T+b.len),N?I.translateX=(p+=C?-Math.floor(D[0]):Math.ceil(D[2]))-b.len:I.translateY=p+=C?Math.ceil(D[0]):-Math.floor(D[2]),g.clipBox&&g.setClip(),g.group.attr(I)):(u=Number(g.group.attr(U)),g.group.animate({scaleY:1},Su(td(g.options.animation),{step:function(X,Q){g.group&&(I[U]=u+Q.pos*(T-u),g.group.attr(I))}})))}init(s,u){super.init.apply(this,arguments);let p=this;(s=p.chart).hasRendered&&s.series.forEach(function(g){g.type===p.type&&(g.isDirty=!0)})}getColumnMetrics(){var le,ne;let s=this,u=s.options,p=s.xAxis,g=s.yAxis,b=p.options.reversedStacks,T=p.reversed&&!b||!p.reversed&&b,C={},E,D=0;u.grouping===!1?D=1:s.chart.series.forEach(function(ie){let me,_e=ie.yAxis,Je=ie.options;ie.type===s.type&&ie.reserveSpace()&&g.len===_e.len&&g.pos===_e.pos&&(Je.stacking&&Je.stacking!=="group"?(C[E=ie.stackKey]===void 0&&(C[E]=D++),me=C[E]):Je.grouping!==!1&&(me=D++),ie.columnIndex=me)});let N=Math.min(Math.abs(p.transA)*(!((le=p.brokenAxis)!=null&&le.hasBreaks)&&((ne=p.ordinal)==null?void 0:ne.slope)||u.pointRange||p.closestPointRange||p.tickInterval||1),p.len),I=N*u.groupPadding,U=(N-2*I)/(D||1),X=Math.min(u.maxPointWidth||p.len,rd(u.pointWidth,U*(1-2*u.pointPadding))),Q=(s.columnIndex||0)+ +!!T;return s.columnMetrics={width:X,offset:(U-X)/2+(I+Q*U-N/2)*(T?-1:1),paddedWidth:U,columnCount:D},s.columnMetrics}crispCol(s,u,p,g){let b=this.borderWidth,T=this.chart.inverted;return g=gh(u+g,b,T)-(u=gh(u,b,T)),this.options.crisp&&(p=gh(s+p,b)-(s=gh(s,b))),{x:s,y:u,width:p,height:g}}adjustForMissingColumns(s,u,p,g){var b;if(!p.isNull&&g.columnCount>1){let T=this.xAxis.series.filter(N=>N.visible).map(N=>N.index),C=0,E=0;$r((b=this.xAxis.stacking)==null?void 0:b.stacks,N=>{var Q;let I=typeof p.x=="number"?(Q=N[p.x.toString()])==null?void 0:Q.points:void 0,U=I==null?void 0:I[this.index],X={};if(I&&id(U)){let le=this.index,ne=Object.keys(I).filter(ie=>!ie.match(",")&&I[ie]&&I[ie].length>1).map(parseFloat).filter(ie=>T.indexOf(ie)!==-1).filter(ie=>{let me=this.chart.series[ie].options,_e=me.stacking&&me.stack;if(Rp(_e)){if(Tu(X[_e]))return le===ie&&(le=X[_e]),!1;X[_e]=ie}return!0}).sort((ie,me)=>me-ie);C=ne.indexOf(le),E=ne.length}}),C=this.xAxis.reversed?E-1-C:C;let D=(E-1)*g.paddedWidth+u;s=(p.plotX||0)+D/2-u-C*g.paddedWidth}return s}translate(){let s=this,u=s.chart,p=s.options,g=s.dense=s.closestPointRange*s.xAxis.transA<2,b=s.borderWidth=rd(p.borderWidth,+!g),T=s.xAxis,C=s.yAxis,E=p.threshold,D=rd(p.minPointLength,5),N=s.getColumnMetrics(),I=N.width,U=s.pointXOffset=N.offset,X=s.dataMin,Q=s.dataMax,le=s.translatedThreshold=C.getThreshold(E),ne=s.barW=Math.max(I,1+2*b);p.pointPadding&&p.crisp&&(ne=Math.ceil(ne)),nr.prototype.translate.apply(s),s.points.forEach(function(ie){let me=rd(ie.yBottom,le),_e=999+Math.abs(me),Je=ie.plotX||0,$e=oc(ie.plotY,-_e,C.len+_e),Ze,ht=Math.min($e,me),at=Math.max($e,me)-ht,mt=I,Bt=Je+U,Zt=ne;D&&Math.abs(at)<D&&(at=D,Ze=!C.reversed&&!ie.negative||C.reversed&&ie.negative,Tu(E)&&Tu(Q)&&ie.y===E&&Q<=E&&(C.min||0)<E&&(X!==Q||(C.max||0)<=E)&&(Ze=!Ze,ie.negative=!ie.negative),ht=Math.abs(ht-le)>D?me-D:le-(Ze?D:0)),Rp(ie.options.pointWidth)&&(Bt-=Math.round(((mt=Zt=Math.ceil(ie.options.pointWidth))-I)/2)),p.centerInCategory&&(Bt=s.adjustForMissingColumns(Bt,mt,ie,N)),ie.barX=Bt,ie.pointWidth=mt,ie.tooltipPos=u.inverted?[oc(C.len+C.pos-u.plotLeft-$e,C.pos-u.plotLeft,C.len+C.pos-u.plotLeft),T.len+T.pos-u.plotTop-Bt-Zt/2,at]:[T.left-u.plotLeft+Bt+Zt/2,oc($e+C.pos-u.plotTop,C.pos-u.plotTop,C.len+C.pos-u.plotTop),at],ie.shapeType=s.pointClass.prototype.shapeType||"roundedRect",ie.shapeArgs=s.crispCol(Bt,ht,Zt,ie.isNull?0:at)}),Ip(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(s,u){let p=this.options,g=this.pointAttrToOptions||{},b=g.stroke||"borderColor",T=g["stroke-width"]||"borderWidth",C,E,D,N=s&&s.color||this.color,I=s&&s[b]||p[b]||N,U=s&&s.options.dashStyle||p.dashStyle,X=s&&s[T]||p[T]||this[T]||0,Q=s!=null&&s.isNull&&p.nullInteraction?0:(s==null?void 0:s.opacity)??p.opacity??1;s&&this.zones.length&&(E=s.getZone(),N=s.options.color||E&&(E.color||s.nonZonedColor)||this.color,E&&(I=E.borderColor||I,U=E.dashStyle||U,X=E.borderWidth||X)),u&&s&&(D=(C=Op(p.states[u],s.options.states&&s.options.states[u]||{})).brightness,N=C.color||D!==void 0&&$d(N).brighten(C.brightness).get()||N,I=C[b]||I,X=C[T]||X,U=C.dashStyle||U,Q=rd(C.opacity,Q));let le={fill:N,stroke:I,"stroke-width":X,opacity:Q};return U&&(le.dashstyle=U),le}drawPoints(s=this.points){let u,p=this,g=this.chart,b=p.options,T=b.nullInteraction,C=g.renderer,E=b.animationLimit||250;s.forEach(function(D){let N=D.plotY,I=D.graphic,U=!!I,X=I&&g.pointCount<E?"animate":"attr";Tu(N)&&(D.y!==null||T)?(u=D.shapeArgs,I&&D.hasNewShapeType()&&(I=I.destroy()),p.enabledDataSorting&&(D.startXPos=p.xAxis.reversed?-(u&&u.width||0):p.xAxis.width),!I&&(D.graphic=I=C[D.shapeType](u).add(D.group||p.group),I&&p.enabledDataSorting&&g.hasRendered&&g.pointCount<E&&(I.attr({x:D.startXPos}),U=!0,X="animate")),I&&U&&I[X](Op(u)),g.styledMode||I[X](p.pointAttribs(D,D.selected&&"select")).shadow(D.allowShadow!==!1&&b.shadow),I&&(I.addClass(D.getClassName(),!0),I.attr({visibility:D.visible?"inherit":"hidden"}))):I&&(D.graphic=I.destroy())})}drawTracker(s=this.points){let u,p=this,g=p.chart,b=g.pointer,T=function(C){b==null||b.normalize(C);let E=b==null?void 0:b.getPointFromEvent(C);b&&E&&p.options.enableMouseTracking&&(g.isInsidePlot(C.chartX-g.plotLeft,C.chartY-g.plotTop,{visiblePlotOnly:!0})||b!=null&&b.inClass(C.target,"highcharts-data-label"))&&(b.isDirectTouch=!0,E.onMouseOver(C))};s.forEach(function(C){u=id(C.dataLabels)?C.dataLabels:C.dataLabel?[C.dataLabel]:[],C.graphic&&(C.graphic.element.point=C),u.forEach(function(E){(E.div||E.element).point=C})}),p._hasTracking||(p.trackerGroups.forEach(function(C){p[C]&&(p[C].addClass("highcharts-tracker").on("mouseover",T).on("mouseout",function(E){b==null||b.onTrackerMouseOut(E)}).on("touchstart",T),!g.styledMode&&p.options.cursor&&p[C].css({cursor:p.options.cursor}))}),p._hasTracking=!0),Ip(this,"afterDrawTracker")}remove(){let s=this,u=s.chart;u.hasRendered&&u.series.forEach(function(p){p.type===s.type&&(p.isDirty=!0)}),nr.prototype.remove.apply(s,arguments)}}Pr.defaultOptions=Op(nr.defaultOptions,{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}),Su(Pr.prototype,{directTouch:!0,getSymbol:mh,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),_.registerSeriesType("column",Pr);let gr=Pr,{getDeferredAnimation:Sr}=Dr,{format:zr}=Sa,{defined:Zn,extend:Fc,fireEvent:Mu,getAlignFactor:Hd,isArray:Ja,isString:un,merge:qo,objectEach:Cl,pick:Cu,pInt:Xo,splat:yh}=li;(function(R){function s(){return E(this).some(N=>N==null?void 0:N.enabled)}function u(N,I,U,X,Q){var Bt;let{chart:le,enabledDataSorting:ne}=this,ie=this.isCartesian&&le.inverted,me=N.plotX,_e=N.plotY,Je=U.rotation||0,$e=Zn(me)&&Zn(_e)&&le.isInsidePlot(me,Math.round(_e),{inverted:ie,paneCoordinates:!0,series:this}),Ze=Je===0&&Cu(U.overflow,ne?"none":"justify")==="justify",ht=this.visible&&N.visible!==!1&&Zn(me)&&(N.series.forceDL||ne&&!Ze||$e||Cu(U.inside,!!this.options.stacking)&&X&&le.isInsidePlot(me,ie?X.x+1:X.y+X.height-1,{inverted:ie,paneCoordinates:!0,series:this})),at=N.pos();if(ht&&at){var mt;let Zt=I.getBBox(),Qt=I.getBBox(void 0,0);if(X=Fc({x:at[0],y:Math.round(at[1]),width:0,height:0},X||{}),U.alignTo==="plotEdges"&&this.isCartesian&&(X[ie?"x":"y"]=0,X[ie?"width":"height"]=((Bt=this.yAxis)==null?void 0:Bt.len)||0),Fc(U,{width:Zt.width,height:Zt.height}),mt=X,ne&&this.xAxis&&!Ze&&this.setDataLabelStartPos(N,I,Q,$e,mt),I.align(qo(U,{width:Qt.width,height:Qt.height}),!1,X,!1),I.alignAttr.x+=Hd(U.align)*(Qt.width-Zt.width),I.alignAttr.y+=Hd(U.verticalAlign)*(Qt.height-Zt.height),I[I.placed?"animate":"attr"]({"text-align":I.alignAttr["text-align"]||"center",x:I.alignAttr.x+(Zt.width-Qt.width)/2,y:I.alignAttr.y+(Zt.height-Qt.height)/2,rotationOriginX:(I.width||0)/2,rotationOriginY:(I.height||0)/2}),Ze&&X.height>=0)this.justifyDataLabel(I,U,I.alignAttr,Zt,X,Q);else if(Cu(U.crop,!0)){let{x:Gt,y:hi}=I.alignAttr;ht=le.isInsidePlot(Gt,hi,{paneCoordinates:!0,series:this})&&le.isInsidePlot(Gt+Zt.width-1,hi+Zt.height-1,{paneCoordinates:!0,series:this})}U.shape&&!Je&&I[Q?"attr":"animate"]({anchorX:at[0],anchorY:at[1]})}Q&&ne&&(I.placed=!1),ht||ne&&!Ze?(I.show(),I.placed=!0):(I.hide(),I.placed=!1)}function p(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function g(N){let I=this.hasRendered||0,U=this.initDataLabelsGroup().attr({opacity:+I});return!I&&U&&(this.visible&&U.show(),this.options.animation?U.animate({opacity:1},N):U.attr({opacity:1})),U}function b(N){var ht;let I;N=N||this.points;let U=this,X=U.chart,Q=U.options,le=X.renderer,{backgroundColor:ne,plotBackgroundColor:ie}=X.options.chart,me=le.getContrast(un(ie)&&ie||un(ne)&&ne||"#000000"),_e=E(U),{animation:Je,defer:$e}=_e[0],Ze=$e?Sr(X,Je,U):{defer:0,duration:0};Mu(this,"drawDataLabels"),(ht=U.hasDataLabels)!=null&&ht.call(U)&&(I=this.initDataLabels(Ze),N.forEach(at=>{var Qt,Gt,hi;let mt=at.dataLabels||[],Bt=at.color||U.color;yh(C(_e,at.dlOptions||((Qt=at.options)==null?void 0:Qt.dataLabels))).forEach((oi,ji)=>{var Hr;let _i=oi.enabled&&(at.visible||at.dataLabelOnHidden)&&(!at.isNull||at.dataLabelOnNull)&&function(ta,Ts){let $s=Ts.filter;if($s){let Yo=$s.operator,us=ta[$s.property],Rn=$s.value;return Yo===">"&&us>Rn||Yo==="<"&&us<Rn||Yo===">="&&us>=Rn||Yo==="<="&&us<=Rn||Yo==="=="&&us==Rn||Yo==="==="&&us===Rn||Yo==="!="&&us!=Rn||Yo==="!=="&&us!==Rn||!1}return!0}(at,oi),{backgroundColor:Di,borderColor:lr,distance:Bi,style:yr={}}=oi,Na,_r,dr,fi={},zi=mt[ji],hn=!zi,pr;_i&&(_r=Zn(Na=Cu(oi[at.formatPrefix+"Format"],oi.format))?zr(Na,at,X):(oi[at.formatPrefix+"Formatter"]||oi.formatter).call(at,oi),dr=oi.rotation,!X.styledMode&&(yr.color=Cu(oi.color,yr.color,un(U.color)?U.color:void 0,"#000000"),yr.color==="contrast"?(Di!=="none"&&(pr=Di),at.contrastColor=le.getContrast(pr!=="auto"&&un(pr)&&pr||(un(Bt)?Bt:"")),yr.color=pr||!Zn(Bi)&&oi.inside||0>Xo(Bi||0)||Q.stacking?at.contrastColor:me):delete at.contrastColor,Q.cursor&&(yr.cursor=Q.cursor)),fi={r:oi.borderRadius||0,rotation:dr,padding:oi.padding,zIndex:1},X.styledMode||(fi.fill=Di==="auto"?at.color:Di,fi.stroke=lr==="auto"?at.color:lr,fi["stroke-width"]=oi.borderWidth),Cl(fi,(ta,Ts)=>{ta===void 0&&delete fi[Ts]})),!zi||_i&&Zn(_r)&&!!(zi.div||(Hr=zi.text)!=null&&Hr.foreignObject)==!!oi.useHTML&&(zi.rotation&&oi.rotation||zi.rotation===oi.rotation)||(zi=void 0,hn=!0),_i&&Zn(_r)&&(zi?fi.text=_r:(zi=le.label(_r,0,0,oi.shape,void 0,void 0,oi.useHTML,void 0,"data-label")).addClass(" highcharts-data-label-color-"+at.colorIndex+" "+(oi.className||"")+(oi.useHTML?" highcharts-tracker":"")),zi&&(zi.options=oi,zi.attr(fi),X.styledMode?yr.width&&zi.css({width:yr.width,textOverflow:yr.textOverflow,whiteSpace:yr.whiteSpace}):zi.css(yr).shadow(oi.shadow),Mu(zi,"beforeAddingDataLabel",{labelOptions:oi,point:at}),zi.added||zi.add(I),U.alignDataLabel(at,zi,oi,void 0,hn),zi.isActive=!0,mt[ji]&&mt[ji]!==zi&&mt[ji].destroy(),mt[ji]=zi))});let Zt=mt.length;for(;Zt--;)(Gt=mt[Zt])!=null&&Gt.isActive?mt[Zt].isActive=!1:((hi=mt[Zt])==null||hi.destroy(),mt.splice(Zt,1));at.dataLabel=mt[0],at.dataLabels=mt})),Mu(this,"afterDrawDataLabels")}function T(N,I,U,X,Q,le){let ne=this.chart,ie=I.align,me=I.verticalAlign,_e=N.box?0:N.padding||0,Je=ne.inverted?this.yAxis:this.xAxis,$e=Je?Je.left-ne.plotLeft:0,Ze=ne.inverted?this.xAxis:this.yAxis,ht=Ze?Ze.top-ne.plotTop:0,{x:at=0,y:mt=0}=I,Bt,Zt;return(Bt=(U.x||0)+_e+$e)<0&&(ie==="right"&&at>=0?(I.align="left",I.inside=!0):at-=Bt,Zt=!0),(Bt=(U.x||0)+X.width-_e+$e)>ne.plotWidth&&(ie==="left"&&at<=0?(I.align="right",I.inside=!0):at+=ne.plotWidth-Bt,Zt=!0),(Bt=U.y+_e+ht)<0&&(me==="bottom"&&mt>=0?(I.verticalAlign="top",I.inside=!0):mt-=Bt,Zt=!0),(Bt=(U.y||0)+X.height-_e+ht)>ne.plotHeight&&(me==="top"&&mt<=0?(I.verticalAlign="bottom",I.inside=!0):mt+=ne.plotHeight-Bt,Zt=!0),Zt&&(I.x=at,I.y=mt,N.placed=!le,N.align(I,void 0,Q)),Zt}function C(N,I){let U=[],X;if(Ja(N)&&!Ja(I))U=N.map(function(Q){return qo(Q,I)});else if(Ja(I)&&!Ja(N))U=I.map(function(Q){return qo(N,Q)});else if(Ja(N)||Ja(I)){if(Ja(N)&&Ja(I))for(X=Math.max(N.length,I.length);X--;)U[X]=qo(N[X],I[X])}else U=qo(N,I);return U}function E(N){var U,X;let I=N.chart.options.plotOptions;return yh(C(C((U=I==null?void 0:I.series)==null?void 0:U.dataLabels,(X=I==null?void 0:I[N.type])==null?void 0:X.dataLabels),N.options.dataLabels))}function D(N,I,U,X,Q){let le=this.chart,ne=le.inverted,ie=this.xAxis,me=ie.reversed,_e=((ne?I.height:I.width)||0)/2,Je=N.pointWidth,$e=Je?Je/2:0;I.startXPos=ne?Q.x:me?-_e-$e:ie.width-_e+$e,I.startYPos=ne?me?this.yAxis.height-_e+$e:-_e-$e:Q.y,X?I.visibility==="hidden"&&(I.show(),I.attr({opacity:0}).animate({opacity:1})):I.attr({opacity:1}).animate({opacity:0},void 0,I.hide),le.hasRendered&&(U&&I.attr({x:I.startXPos,y:I.startYPos}),I.placed=!0)}R.compose=function(N){let I=N.prototype;I.initDataLabels||(I.initDataLabels=g,I.initDataLabelsGroup=p,I.alignDataLabel=u,I.drawDataLabels=b,I.justifyDataLabel=T,I.mergeArrays=C,I.setDataLabelStartPos=D,I.hasDataLabels=s)}})(rt||(rt={}));let Au=rt,{composed:Vs}=Ue,{series:jp}=_,{merge:mf,pushUnique:Zd}=li;(function(R){function s(u,p,g,b,T){var le,ne;let{chart:C,options:E}=this,D=C.inverted,N=((le=this.xAxis)==null?void 0:le.len)||C.plotSizeX||0,I=((ne=this.yAxis)==null?void 0:ne.len)||C.plotSizeY||0,U=u.dlBox||u.shapeArgs,X=u.below??(u.plotY||0)>(this.translatedThreshold??I),Q=g.inside??!!E.stacking;if(U){if(b=mf(U),g.overflow!=="allow"||g.crop!==!1||E.clip!==!1){b.y<0&&(b.height+=b.y,b.y=0);let ie=b.y+b.height-I;ie>0&&ie<b.height-1&&(b.height-=ie)}D&&(b={x:I-b.y-b.height,y:N-b.x-b.width,width:b.height,height:b.width}),Q||(D?(b.x+=X?0:b.width,b.width=0):(b.y+=X?b.height:0,b.height=0))}g.align??(g.align=!D||Q?"center":X?"right":"left"),g.verticalAlign??(g.verticalAlign=D||Q?"middle":X?"top":"bottom"),jp.prototype.alignDataLabel.call(this,u,p,g,b,T),g.inside&&u.contrastColor&&p.css({color:u.contrastColor})}R.compose=function(u){Au.compose(jp),Zd(Vs,"ColumnDataLabel")&&(u.prototype.alignDataLabel=s)}})(Ie||(Ie={}));let nd=Ie,{extend:Uc,merge:Ba}=li;class Al extends gr{}Al.defaultOptions=Ba(gr.defaultOptions,{}),Uc(Al.prototype,{inverted:!0}),_.registerSeriesType("bar",Al);let{column:ad,line:lc}=_.seriesTypes,{addEvent:gf,extend:Bp,merge:Gf}=li;class Eu extends lc{applyJitter(){let s=this,u=this.options.jitter,p=this.points.length;u&&this.points.forEach(function(g,b){["x","y"].forEach(function(T,C){if(u[T]&&!g.isNull){let E=`plot${T.toUpperCase()}`,D=s[`${T}Axis`],N=u[T]*D.transA;if(D&&!D.logarithmic){let I=Math.max(0,(g[E]||0)-N),U=Math.min(D.len,(g[E]||0)+N);g[E]=I+(U-I)*function(X){let Q=1e4*Math.sin(X);return Q-Math.floor(Q)}(b+C*p),T==="x"&&(g.clientX=g.plotX)}}})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}Eu.defaultOptions=Gf(lc.defaultOptions,{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">●</span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}),Bp(Eu.prototype,{drawTracker:ad.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),gf(Eu,"afterTranslate",function(){this.applyJitter()}),_.registerSeriesType("scatter",Eu);let{deg2rad:Np}=Ue,{fireEvent:Gs,isNumber:Fp,pick:cs,relativeLength:sd}=li;(function(R){R.getCenter=function(){let s=this.options,u=this.chart,p=2*(s.slicedOffset||0),g=u.plotWidth-2*p,b=u.plotHeight-2*p,T=s.center,C=Math.min(g,b),E=s.thickness,D,N=s.size,I=s.innerSize||0,U,X;typeof N=="string"&&(N=parseFloat(N)),typeof I=="string"&&(I=parseFloat(I));let Q=[cs(T==null?void 0:T[0],"50%"),cs(T==null?void 0:T[1],"50%"),cs(N&&N<0?void 0:s.size,"100%"),cs(I&&I<0?void 0:s.innerSize||0,"0%")];for(!u.angular||this instanceof nr||(Q[3]=0),U=0;U<4;++U)X=Q[U],D=U<2||U===2&&/%$/.test(X),Q[U]=sd(X,[g,b,C,Q[2]][U])+(D?p:0);return Q[3]>Q[2]&&(Q[3]=Q[2]),Fp(E)&&2*E<Q[2]&&E>0&&(Q[3]=Q[2]-2*E),Gs(this,"afterGetCenter",{positions:Q}),Q},R.getStartAndEndRadians=function(s,u){let p=Fp(s)?s:0,g=Fp(u)&&u>p&&u-p<360?u:p+360;return{start:Np*(p+-90),end:Np*(g+-90)}}})(Oe||(Oe={}));let Up=Oe,{setAnimation:yf}=Dr,{addEvent:cc,defined:Dn,extend:qd,isNumber:od,pick:_f,relativeLength:Vc}=li;class Xd extends $i{getConnectorPath(s){let u=s.dataLabelPosition,p=s.options||{},g=p.connectorShape,b=this.connectorShapes[g]||g;return u&&b.call(this,{...u.computed,alignment:u.alignment},u.connectorPosition,p)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(s){let u=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(u.x,u.y,u.r+s,u.r+s,{innerR:u.r-1,start:u.start,end:u.end,borderRadius:u.borderRadius})}constructor(s,u,p){super(s,u,p),this.half=0,this.name??(this.name=s.chart.options.lang.pieSliceName);let g=b=>{this.slice(b.type==="select")};cc(this,"select",g),cc(this,"unselect",g)}isValid(){return od(this.y)&&this.y>=0}setVisible(s,u=!0){s!==this.visible&&this.update({visible:s??!this.visible},u,void 0,!1)}slice(s,u,p){let g=this.series;yf(p,g.chart),u=_f(u,!0),this.sliced=this.options.sliced=s=Dn(s)?s:!this.sliced,g.options.data[g.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}qd(Xd.prototype,{connectorShapes:{fixedOffset:function(R,s,u){let p=s.breakAt,g=s.touchingSliceAt,b=u.softConnector?["C",R.x+(R.alignment==="left"?-5:5),R.y,2*p.x-g.x,2*p.y-g.y,p.x,p.y]:["L",p.x,p.y];return[["M",R.x,R.y],b,["L",g.x,g.y]]},straight:function(R,s){let u=s.touchingSliceAt;return[["M",R.x,R.y],["L",u.x,u.y]]},crookedLine:function(R,s,u){let{angle:p=this.angle||0,breakAt:g,touchingSliceAt:b}=s,{series:T}=this,[C,E,D]=T.center,N=D/2,{plotLeft:I,plotWidth:U}=T.chart,X=R.alignment==="left",{x:Q,y:le}=R,ne=g.x;if(u.crookDistance){let me=Vc(u.crookDistance,1);ne=X?C+N+(U+I-C-N)*(1-me):I+(C-N)*me}else ne=C+(E-le)*Math.tan(p-Math.PI/2);let ie=[["M",Q,le]];return(X?ne<=Q&&ne>=g.x:ne>=Q&&ne<=g.x)&&ie.push(["L",ne,le]),ie.push(["L",g.x,g.y],["L",b.x,b.y]),ie}}});let{getStartAndEndRadians:xf}=Up,{noop:Vp}=Ue,{clamp:pm,extend:$f,fireEvent:Gp,merge:Yd,pick:ld}=li;class vo extends nr{animate(s){let u=this,p=u.points,g=u.startAngleRad;s||p.forEach(function(b){let T=b.graphic,C=b.shapeArgs;T&&C&&(T.attr({r:ld(b.startR,u.center&&u.center[3]/2),start:g,end:g}),T.animate({r:C.r,start:C.start,end:C.end},u.options.animation))})}drawEmpty(){let s,u,p=this.startAngleRad,g=this.endAngleRad,b=this.options;this.total===0&&this.center?(s=this.center[0],u=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(s,u,this.center[1]/2,0,p,g).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:Uu.arc(s,u,this.center[2]/2,0,{start:p,end:g,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":b.borderWidth,fill:b.fillColor||"none",stroke:b.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let s=this.chart.renderer;this.points.forEach(function(u){u.graphic&&u.hasNewShapeType()&&(u.graphic=u.graphic.destroy()),u.graphic||(u.graphic=s[u.shapeType](u.shapeArgs).add(u.series.group),u.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX(s,u,p,g){let b=this.center,T=this.radii?this.radii[p.index]||0:b[2]/2,C=g.dataLabelPosition,E=(C==null?void 0:C.distance)||0,D=Math.asin(pm((s-b[1])/(T+E),-1,1));return b[0]+Math.cos(D)*(T+E)*(u?-1:1)+(E>0?(u?-1:1)*(g.padding||0):0)}hasData(){return!!this.dataTable.rowCount}redrawPoints(){let s,u,p,g,b=this,T=b.chart;this.drawEmpty(),b.group&&!T.styledMode&&b.group.shadow(b.options.shadow),b.points.forEach(function(C){let E={};u=C.graphic,!C.isNull&&u?(g=C.shapeArgs,s=C.getTranslate(),T.styledMode||(p=b.pointAttribs(C,C.selected&&"select")),C.delayedRendering?(u.setRadialReference(b.center).attr(g).attr(s),T.styledMode||u.attr(p).attr({"stroke-linejoin":"round"}),C.delayedRendering=!1):(u.setRadialReference(b.center),T.styledMode||Yd(!0,E,p),Yd(!0,E,g,s),u.animate(E)),u.attr({visibility:C.visible?"inherit":"hidden"}),u.addClass(C.getClassName(),!0)):u&&(C.graphic=u.destroy())})}sortByAngle(s,u){s.sort(function(p,g){return p.angle!==void 0&&(g.angle-p.angle)*u})}translate(s){Gp(this,"translate"),this.generatePoints();let u=this.options,p=u.slicedOffset,g=xf(u.startAngle,u.endAngle),b=this.startAngleRad=g.start,T=(this.endAngleRad=g.end)-b,C=this.points,E=u.ignoreHiddenPoint,D=C.length,N,I,U,X,Q,le,ne,ie=0;for(s||(this.center=s=this.getCenter()),le=0;le<D;le++){ne=C[le],N=b+ie*T,ne.isValid()&&(!E||ne.visible)&&(ie+=ne.percentage/100),I=b+ie*T;let me={x:s[0],y:s[1],r:s[2]/2,innerR:s[3]/2,start:Math.round(1e3*N)/1e3,end:Math.round(1e3*I)/1e3};ne.shapeType="arc",ne.shapeArgs=me,(U=(I+N)/2)>1.5*Math.PI?U-=2*Math.PI:U<-Math.PI/2&&(U+=2*Math.PI),ne.slicedTranslation={translateX:Math.round(Math.cos(U)*p),translateY:Math.round(Math.sin(U)*p)},X=Math.cos(U)*s[2]/2,Q=Math.sin(U)*s[2]/2,ne.tooltipPos=[s[0]+.7*X,s[1]+.7*Q],ne.half=+(U<-Math.PI/2||U>Math.PI/2),ne.angle=U}Gp(this,"afterTranslate")}updateTotals(){let s=this.points,u=s.length,p=this.options.ignoreHiddenPoint,g,b,T=0;for(g=0;g<u;g++)(b=s[g]).isValid()&&(!p||b.visible)&&(T+=b.y);for(g=0,this.total=T;g<u;g++)(b=s[g]).percentage=T>0&&(b.visible||!p)?b.y/T*100:0,b.total=T}}vo.defaultOptions=Yd(nr.defaultOptions,{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.isNull?void 0:this.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}),$f(vo.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:gr.prototype.drawTracker,getCenter:Up.getCenter,getSymbol:Vp,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointAttribs:gr.prototype.pointAttribs,pointClass:Xd,requireSorting:!1,searchPoint:Vp,trackerGroups:["group","dataLabelsGroup"]}),_.registerSeriesType("pie",vo);let{composed:_h,noop:Wd}=Ue,{distribute:Hf}=Lo,{series:vf}=_,{arrayMax:bf,clamp:$p,defined:wf,pick:Kd,pushUnique:Sf,relativeLength:Qd}=li;(function(R){let s={radialDistributionY:function(T,C){var E;return(((E=C.dataLabelPosition)==null?void 0:E.top)||0)+T.distributeBox.pos},radialDistributionX:function(T,C,E,D,N){let I=N.dataLabelPosition;return T.getX(E<((I==null?void 0:I.top)||0)+2||E>((I==null?void 0:I.bottom)||0)-2?D:E,C.half,C,N)},justify:function(T,C,E,D){var N;return D[0]+(T.half?-1:1)*(E+(((N=C.dataLabelPosition)==null?void 0:N.distance)||0))},alignToPlotEdges:function(T,C,E,D){let N=T.getBBox().width;return C?N+D:E-N-D},alignToConnectors:function(T,C,E,D){let N=0,I;return T.forEach(function(U){(I=U.dataLabel.getBBox().width)>N&&(N=I)}),C?N+D:E-N-D}};function u(T,C){let E=Math.PI/2,{start:D=0,end:N=0}=T.shapeArgs||{},I=T.angle||0;C>0&&D<E&&N>E&&I>E/2&&I<1.5*E&&(I=I<=E?Math.max(E/2,(D+E)/2):Math.min(1.5*E,(E+N)/2));let{center:U,options:X}=this,Q=U[2]/2,le=Math.cos(I),ne=Math.sin(I),ie=U[0]+le*Q,me=U[1]+ne*Q,_e=Math.min((X.slicedOffset||0)+(X.borderWidth||0),C/5);return{natural:{x:ie+le*C,y:me+ne*C},computed:{},alignment:C<0?"center":T.half?"right":"left",connectorPosition:{angle:I,breakAt:{x:ie+le*_e,y:me+ne*_e},touchingSliceAt:{x:ie,y:me}},distance:C}}function p(){var ht;let T=this,C=T.points,E=T.chart,D=E.plotWidth,N=E.plotHeight,I=E.plotLeft,U=Math.round(E.chartWidth/3),X=T.center,Q=X[2]/2,le=X[1],ne=[[],[]],ie=[0,0,0,0],me=T.dataLabelPositioners,_e,Je,$e,Ze=0;T.visible&&((ht=T.hasDataLabels)!=null&&ht.call(T))&&(C.forEach(at=>{(at.dataLabels||[]).forEach(mt=>{mt.shortened&&(mt.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),mt.shortened=!1)})}),vf.prototype.drawDataLabels.apply(T),C.forEach(at=>{(at.dataLabels||[]).forEach((mt,Bt)=>{var hi;let Zt=X[2]/2,Qt=mt.options,Gt=Qd((Qt==null?void 0:Qt.distance)||0,Zt);Bt===0&&ne[at.half].push(at),!wf((hi=Qt==null?void 0:Qt.style)==null?void 0:hi.width)&&mt.getBBox().width>U&&(mt.css({width:Math.round(.7*U)+"px"}),mt.shortened=!0),mt.dataLabelPosition=this.getDataLabelPosition(at,Gt),Ze=Math.max(Ze,Gt)})}),ne.forEach((at,mt)=>{let Bt=at.length,Zt=[],Qt,Gt,hi=0,oi;Bt&&(T.sortByAngle(at,mt-.5),Ze>0&&(Qt=Math.max(0,le-Q-Ze),Gt=Math.min(le+Q+Ze,E.plotHeight),at.forEach(ji=>{(ji.dataLabels||[]).forEach(_i=>{var lr;let Di=_i.dataLabelPosition;Di&&Di.distance>0&&(Di.top=Math.max(0,le-Q-Di.distance),Di.bottom=Math.min(le+Q+Di.distance,E.plotHeight),hi=_i.getBBox().height||21,_i.lineHeight=E.renderer.fontMetrics(_i.text||_i).h+2*_i.padding,ji.distributeBox={target:(((lr=_i.dataLabelPosition)==null?void 0:lr.natural.y)||0)-Di.top+_i.lineHeight/2,size:hi,rank:ji.y},Zt.push(ji.distributeBox))})}),Hf(Zt,oi=Gt+hi-Qt,oi/5)),at.forEach(ji=>{(ji.dataLabels||[]).forEach(_i=>{let Di=_i.options||{},lr=ji.distributeBox,Bi=_i.dataLabelPosition,yr=(Bi==null?void 0:Bi.natural.y)||0,Na=Di.connectorPadding||0,_r=_i.lineHeight||21,dr=(_r-_i.getBBox().height)/2,fi=0,zi=yr,hn="inherit";if(Bi){if(Zt&&wf(lr)&&Bi.distance>0&&(lr.pos===void 0?hn="hidden":($e=lr.size,zi=me.radialDistributionY(ji,_i))),Di.justify)fi=me.justify(ji,_i,Q,X);else switch(Di.alignTo){case"connectors":fi=me.alignToConnectors(at,mt,D,I);break;case"plotEdges":fi=me.alignToPlotEdges(_i,mt,D,I);break;default:fi=me.radialDistributionX(T,ji,zi-dr,yr,_i)}if(Bi.attribs={visibility:hn,align:Bi.alignment},Bi.posAttribs={x:fi+(Di.x||0)+({left:Na,right:-Na}[Bi.alignment]||0),y:zi+(Di.y||0)-_r/2},Bi.computed.x=fi,Bi.computed.y=zi-dr,Kd(Di.crop,!0)){let pr;fi-(Je=_i.getBBox().width)<Na&&mt===1?(pr=Math.round(Je-fi+Na),ie[3]=Math.max(pr,ie[3])):fi+Je>D-Na&&mt===0&&(pr=Math.round(fi+Je-D+Na),ie[1]=Math.max(pr,ie[1])),zi-$e/2<0?ie[0]=Math.max(Math.round(-zi+$e/2),ie[0]):zi+$e/2>N&&(ie[2]=Math.max(Math.round(zi+$e/2-N),ie[2])),Bi.sideOverflow=pr}}})}))}),(bf(ie)===0||this.verifyDataLabelOverflow(ie))&&(this.placeDataLabels(),this.points.forEach(at=>{(at.dataLabels||[]).forEach(mt=>{var Gt;let{connectorColor:Bt,connectorWidth:Zt=1}=mt.options||{},Qt=mt.dataLabelPosition;if(Zt){let hi;_e=mt.connector,Qt&&Qt.distance>0?(hi=!_e,_e||(mt.connector=_e=E.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+at.colorIndex+(at.className?" "+at.className:"")).add(T.dataLabelsGroup)),E.styledMode||_e.attr({"stroke-width":Zt,stroke:Bt||at.color||"#666666"}),_e[hi?"attr":"animate"]({d:at.getConnectorPath(mt)}),_e.attr({visibility:(Gt=Qt.attribs)==null?void 0:Gt.visibility})):_e&&(mt.connector=_e.destroy())}})})))}function g(){this.points.forEach(T=>{(T.dataLabels||[]).forEach(C=>{var D,N;let E=C.dataLabelPosition;E?(E.sideOverflow&&(C.css({width:Math.max(C.getBBox().width-E.sideOverflow,0)+"px",textOverflow:((N=(D=C.options)==null?void 0:D.style)==null?void 0:N.textOverflow)||"ellipsis"}),C.shortened=!0),C.attr(E.attribs),C[C.moved?"animate":"attr"](E.posAttribs),C.moved=!0):C&&C.attr({y:-9999})}),delete T.distributeBox},this)}function b(T){let C=this.center,E=this.options,D=E.center,N=E.minSize||80,I=N,U=E.size!==null;return!U&&(D[0]!==null?I=Math.max(C[2]-Math.max(T[1],T[3]),N):(I=Math.max(C[2]-T[1]-T[3],N),C[0]+=(T[3]-T[1])/2),D[1]!==null?I=$p(I,N,C[2]-Math.max(T[0],T[2])):(I=$p(I,N,C[2]-T[0]-T[2]),C[1]+=(T[0]-T[2])/2),I<C[2]?(C[2]=I,C[3]=Math.min(E.thickness?Math.max(0,I-2*E.thickness):Math.max(0,Qd(E.innerSize||0,I)),I),this.translate(C),this.drawDataLabels&&this.drawDataLabels()):U=!0),U}R.compose=function(T){if(Au.compose(vf),Sf(_h,"PieDataLabel")){let C=T.prototype;C.dataLabelPositioners=s,C.alignDataLabel=Wd,C.drawDataLabels=p,C.getDataLabelPosition=u,C.placeDataLabels=g,C.verifyDataLabelOverflow=b}}})(We||(We={}));let Qr=We;(function(R){R.getCenterOfPoints=function(s){let u=s.reduce((p,g)=>(p.x+=g.x,p.y+=g.y,p),{x:0,y:0});return{x:u.x/s.length,y:u.y/s.length}},R.getDistanceBetweenPoints=function(s,u){return Math.sqrt(Math.pow(u.x-s.x,2)+Math.pow(u.y-s.y,2))},R.getAngleBetweenPoints=function(s,u){return Math.atan2(u.x-s.x,u.y-s.y)},R.pointInPolygon=function({x:s,y:u},p){let g=p.length,b,T,C=!1;for(b=0,T=g-1;b<g;T=b++){let[E,D]=p[b],[N,I]=p[T];D>u!=I>u&&s<(N-E)*(u-D)/(I-D)+E&&(C=!C)}return C}})(ct||(ct={}));let{pointInPolygon:Tf}=ct,{addEvent:Zf,getAlignFactor:qf,fireEvent:Xf,objectEach:Yf,pick:fm}=li;function Hp(R){let s=R.length,u=(N,I)=>!(I.x>=N.x+N.width||I.x+I.width<=N.x||I.y>=N.y+N.height||I.y+I.height<=N.y),p=(N,I)=>{for(let U of N)if(Tf({x:U[0],y:U[1]},I))return!0;return!1},g,b,T,C,E,D=!1;for(let N=0;N<s;N++)(g=R[N])&&(g.oldOpacity=g.opacity,g.newOpacity=1,g.absoluteBox=function(I){var U,X;if(I&&(!I.alignAttr||I.placed)){let Q=I.box?0:I.padding||0,le=I.alignAttr||{x:I.attr("x"),y:I.attr("y")},{height:ne,polygon:ie,width:me}=I.getBBox(),_e=qf(I.alignValue)*me;return I.width=me,I.height=ne,{x:le.x+(((U=I.parentGroup)==null?void 0:U.translateX)||0)+Q-_e,y:le.y+(((X=I.parentGroup)==null?void 0:X.translateY)||0)+Q,width:me-2*Q,height:ne-2*Q,polygon:ie}}}(g));R.sort((N,I)=>(I.labelrank||0)-(N.labelrank||0));for(let N=0;N<s;++N){C=(b=R[N])&&b.absoluteBox;let I=C==null?void 0:C.polygon;for(let U=N+1;U<s;++U){E=(T=R[U])&&T.absoluteBox;let X=!1;if(C&&E&&b!==T&&b.newOpacity!==0&&T.newOpacity!==0&&b.visibility!=="hidden"&&T.visibility!=="hidden"){let Q=E.polygon;if(I&&Q&&I!==Q?p(I,Q)&&(X=!0):u(C,E)&&(X=!0),X){let le=b.labelrank<T.labelrank?b:T,ne=le.text;le.newOpacity=0,ne!=null&&ne.element.querySelector("textPath")&&ne.hide()}}}}for(let N of R)ku(N,this)&&(D=!0);D&&Xf(this,"afterHideAllOverlappingLabels")}function ku(R,s){let u,p=!1;return R&&(u=R.newOpacity,R.oldOpacity!==u&&(R.hasClass("highcharts-data-label")?(R[u?"removeClass":"addClass"]("highcharts-data-label-hidden"),p=!0,R[R.isOld?"animate":"attr"]({opacity:u},void 0,function(){s.styledMode||R.css({pointerEvents:u?"auto":"none"})}),Xf(s,"afterHideOverlappingLabel")):R.attr({opacity:u})),R.isOld=!0),p}function Zp(){var u;let R=this,s=[];for(let p of R.labelCollectors||[])s=s.concat(p());for(let p of R.yAxis||[])p.stacking&&p.options.stackLabels&&!p.options.stackLabels.allowOverlap&&Yf(p.stacking.stacks,g=>{Yf(g,b=>{b.label&&s.push(b.label)})});for(let p of R.series||[])if(p.visible&&((u=p.hasDataLabels)!=null&&u.call(p))){let g=b=>{for(let T of b)T.visible&&(T.dataLabels||[]).forEach(C=>{var D;let E=C.options||{};C.labelrank=fm(E.labelrank,T.labelrank,(D=T.shapeArgs)==null?void 0:D.height),E.allowOverlap??Number(E.distance)>0?(C.oldOpacity=C.opacity,C.newOpacity=1,ku(C,R)):s.push(C)})};g(p.nodes||[]),g(p.points)}this.hideOverlappingLabels(s)}let bo={compose:function(R){let s=R.prototype;s.hideOverlappingLabels||(s.hideOverlappingLabels=Hp,Zf(R,"render",Zp))}},{defaultOptions:uc}=tt,{noop:Gc}=Ue,{addEvent:wo,extend:Jd,isObject:Wf,merge:ep,relativeLength:cd}=li,Kf={radius:0,scope:"stack",where:void 0},tp=Gc,qp=Gc;function Pu(R,s,u,p,g={}){let b=tp(R,s,u,p,g),{innerR:T=0,r:C=u,start:E=0,end:D=0}=g;if(g.open||!g.borderRadius)return b;let N=D-E,I=Math.sin(N/2),U=Math.max(Math.min(cd(g.borderRadius||0,C-T),(C-T)/2,C*I/(1+I)),0),X=Math.min(U,N/Math.PI*2*T),Q=b.length-1;for(;Q--;)(function(le,ne,ie){let me,_e,Je,$e=le[ne],Ze=le[ne+1];if(Ze[0]==="Z"&&(Ze=le[0]),($e[0]==="M"||$e[0]==="L")&&Ze[0]==="A"?(me=$e,_e=Ze,Je=!0):$e[0]==="A"&&(Ze[0]==="M"||Ze[0]==="L")&&(me=Ze,_e=$e),me&&_e&&_e.params){let ht=_e[1],at=_e[5],mt=_e.params,{start:Bt,end:Zt,cx:Qt,cy:Gt}=mt,hi=at?ht-ie:ht+ie,oi=hi?Math.asin(ie/hi):0,ji=at?oi:-oi,_i=Math.cos(oi)*hi;Je?(mt.start=Bt+ji,me[1]=Qt+_i*Math.cos(Bt),me[2]=Gt+_i*Math.sin(Bt),le.splice(ne+1,0,["A",ie,ie,0,0,1,Qt+ht*Math.cos(mt.start),Gt+ht*Math.sin(mt.start)])):(mt.end=Zt-ji,_e[6]=Qt+ht*Math.cos(mt.end),_e[7]=Gt+ht*Math.sin(mt.end),le.splice(ne+1,0,["A",ie,ie,0,0,1,Qt+_i*Math.cos(Zt),Gt+_i*Math.sin(Zt)])),_e[4]=Math.abs(mt.end-mt.start)<Math.PI?0:1}})(b,Q,Q>1?X:U);return b}function Mf(){var R,s;if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:u,yAxis:p}=this,g=u.stacking==="percent",b=(s=(R=uc.plotOptions)==null?void 0:R[this.type])==null?void 0:s.borderRadius,T=ip(u.borderRadius,Wf(b)?b:{}),C=p.options.reversed;for(let E of this.points){let{shapeArgs:D}=E;if(E.shapeType==="roundedRect"&&D){let{width:N=0,height:I=0,y:U=0}=D,X=U,Q=I;if(T.scope==="stack"&&E.stackTotal){let me=p.translate(g?100:E.stackTotal,!1,!0,!1,!0),_e=p.translate(u.threshold||0,!1,!0,!1,!0),Je=this.crispCol(0,Math.min(me,_e),0,Math.abs(me-_e));X=Je.y,Q=Je.height}let le=(E.negative?-1:1)*(C?-1:1)==-1,ne=T.where;!ne&&this.is("waterfall")&&Math.abs((E.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(ne="all"),ne||(ne="end");let ie=Math.min(cd(T.radius,N),N/2,ne==="all"?I/2:1/0)||0;ne==="end"&&(le&&(X-=ie),Q+=ie),Jd(D,{brBoxHeight:Q,brBoxY:X,r:ie})}}}}function ip(R,s){return Wf(R)||(R={radius:R||0}),ep(Kf,s,R)}function Cf(){let R=ip(this.options.borderRadius);for(let s of this.points){let u=s.shapeArgs;u&&(u.borderRadius=cd(R.radius,(u.r||0)-(u.innerR||0)))}}function Xp(R,s,u,p,g={}){let b=qp(R,s,u,p,g),{r:T=0,brBoxHeight:C=p,brBoxY:E=s}=g,D=s-E,N=E+C-(s+p),I=D-T>-.1?0:T,U=N-T>-.1?0:T,X=Math.max(I&&D,0),Q=Math.max(U&&N,0),le=[R+I,s],ne=[R+u-I,s],ie=[R+u,s+I],me=[R+u,s+p-U],_e=[R+u-U,s+p],Je=[R+U,s+p],$e=[R,s+p-U],Ze=[R,s+I],ht=(at,mt)=>Math.sqrt(Math.pow(at,2)-Math.pow(mt,2));if(X){let at=ht(I,I-X);le[0]-=at,ne[0]+=at,ie[1]=Ze[1]=s+I-X}if(p<I-X){let at=ht(I,I-X-p);ie[0]=me[0]=R+u-I+at,_e[0]=Math.min(ie[0],_e[0]),Je[0]=Math.max(me[0],Je[0]),$e[0]=Ze[0]=R+I-at,ie[1]=Ze[1]=s+p}if(Q){let at=ht(U,U-Q);_e[0]+=at,Je[0]-=at,me[1]=$e[1]=s+p-U+Q}if(p<U-Q){let at=ht(U,U-Q-p);ie[0]=me[0]=R+u-U+at,ne[0]=Math.min(ie[0],ne[0]),le[0]=Math.max(me[0],le[0]),$e[0]=Ze[0]=R+U-at,me[1]=$e[1]=s}return b.length=0,b.push(["M",...le],["L",...ne],["A",I,I,0,0,1,...ie],["L",...me],["A",U,U,0,0,1,..._e],["L",...Je],["A",U,U,0,0,1,...$e],["L",...Ze],["A",I,I,0,0,1,...le],["Z"]),b}let{diffObjects:ud,extend:Qf,find:mm,merge:rp,pick:np,uniqueKey:Jf}=li;(function(R){function s(p,g){let b=p.condition;(b.callback||function(){return this.chartWidth<=np(b.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=np(b.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=np(b.minWidth,0)&&this.chartHeight>=np(b.minHeight,0)}).call(this)&&g.push(p._id)}function u(p,g){let b=this.options.responsive,T=this.currentResponsive,C=[],E;!g&&b&&b.rules&&b.rules.forEach(I=>{I._id===void 0&&(I._id=Jf()),this.matchResponsiveRule(I,C)},this);let D=rp(...C.map(I=>mm((b==null?void 0:b.rules)||[],U=>U._id===I)).map(I=>I==null?void 0:I.chartOptions));D.isResponsiveOptions=!0,C=C.toString()||void 0;let N=T==null?void 0:T.ruleIds;C===N||(T&&(this.currentResponsive=void 0,this.updatingResponsive=!0,this.update(T.undoOptions,p,!0),this.updatingResponsive=!1),C?((E=ud(D,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:C,mergedOptions:D,undoOptions:E},this.updatingResponsive||this.update(D,p,!0)):this.currentResponsive=void 0)}R.compose=function(p){let g=p.prototype;return g.matchResponsiveRule||Qf(g,{matchResponsiveRule:s,setResponsive:u}),p}})(Ke||(Ke={}));let br=Ke;Ue.AST=Er,Ue.Axis=Ya,Ue.Chart=Tl,Ue.Color=ai,Ue.DataLabel=Au,Ue.DataTableCore=Da,Ue.Fx=bi,Ue.HTMLElement=eo,Ue.Legend=ch,Ue.LegendSymbol=y,Ue.OverlappingDataLabels=Ue.OverlappingDataLabels||bo,Ue.PlotLineOrBand=uu,Ue.Point=$i,Ue.Pointer=La,Ue.RendererRegistry=fs,Ue.Series=nr,Ue.SeriesRegistry=_,Ue.StackItem=zp,Ue.SVGElement=Ta,Ue.SVGRenderer=pa,Ue.Templating=Sa,Ue.Tick=Rs,Ue.Time=ye,Ue.Tooltip=rh,Ue.animate=Dr.animate,Ue.animObject=Dr.animObject,Ue.chart=Tl.chart,Ue.color=ai.parse,Ue.dateFormat=Sa.dateFormat,Ue.defaultOptions=tt.defaultOptions,Ue.distribute=Lo.distribute,Ue.format=Sa.format,Ue.getDeferredAnimation=Dr.getDeferredAnimation,Ue.getOptions=tt.getOptions,Ue.numberFormat=Sa.numberFormat,Ue.seriesType=_.seriesType,Ue.setAnimation=Dr.setAnimation,Ue.setOptions=tt.setOptions,Ue.stop=Dr.stop,Ue.time=tt.defaultTime,Ue.timers=bi.timers,{compose:function(R,s,u){let p=R.types.pie;if(!s.symbolCustomAttribs.includes("borderRadius")){let g=u.prototype.symbols;wo(R,"afterColumnTranslate",Mf,{order:9}),wo(p,"afterTranslate",Cf),s.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),tp=g.arc,qp=g.roundedRect,g.arc=Pu,g.roundedRect=Xp}},optionsToObject:ip}.compose(Ue.Series,Ue.SVGElement,Ue.SVGRenderer),nd.compose(Ue.Series.types.column),Au.compose(Ue.Series),Ju.compose(Ue.Axis),eo.compose(Ue.SVGRenderer),ch.compose(Ue.Chart),js.compose(Ue.Axis),bo.compose(Ue.Chart),Qr.compose(Ue.Series.types.pie),uu.compose(Ue.Chart,Ue.Axis),La.compose(Ue.Chart),br.compose(Ue.Chart),vu.compose(Ue.Axis,Ue.Chart,Ue.Series),Kh.compose(Ue.Axis,Ue.Chart,Ue.Series),rh.compose(Ue.Pointer),li.extend(Ue,li);let Af=Ue;return Pt.default})())}(Hm)),Hm.exports}var Rb=Db();const Lm=Ng(Rb);var Zm={exports:{}},Ib=Zm.exports,Iy;function Ob(){return Iy||(Iy=1,function(S,F){(function(Z,$){S.exports=$(Em())})(typeof self<"u"?self:Ib,function(Z){return function($){function J(B){if(ce[B])return ce[B].exports;var h=ce[B]={i:B,l:!1,exports:{}};return $[B].call(h.exports,h,h.exports,J),h.l=!0,h.exports}var ce={};return J.m=$,J.c=ce,J.d=function(B,h,oe){J.o(B,h)||Object.defineProperty(B,h,{configurable:!1,enumerable:!0,get:oe})},J.n=function(B){var h=B&&B.__esModule?function(){return B.default}:function(){return B};return J.d(h,"a",h),h},J.o=function(B,h){return Object.prototype.hasOwnProperty.call(B,h)},J.p="",J(J.s=0)}([function($,J,ce){function B(){return B=Object.assign?Object.assign.bind():function(Oe){for(var We=1;We<arguments.length;We++){var ct=arguments[We];for(var Ke in ct)Object.prototype.hasOwnProperty.call(ct,Ke)&&(Oe[Ke]=ct[Ke])}return Oe},B.apply(this,arguments)}function h(Oe){return Ve(Oe)||Te(Oe)||ge(Oe)||oe()}function oe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ge(Oe,We){if(Oe){if(typeof Oe=="string")return Ee(Oe,We);var ct=Object.prototype.toString.call(Oe).slice(8,-1);return ct==="Object"&&Oe.constructor&&(ct=Oe.constructor.name),ct==="Map"||ct==="Set"?Array.from(Oe):ct==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ct)?Ee(Oe,We):void 0}}function Te(Oe){if(typeof Symbol<"u"&&Oe[Symbol.iterator]!=null||Oe["@@iterator"]!=null)return Array.from(Oe)}function Ve(Oe){if(Array.isArray(Oe))return Ee(Oe)}function Ee(Oe,We){(We==null||We>Oe.length)&&(We=Oe.length);for(var ct=0,Ke=new Array(We);ct<We;ct++)Ke[ct]=Oe[ct];return Ke}function pe(Oe){"@babel/helpers - typeof";return(pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(We){return typeof We}:function(We){return We&&typeof Symbol=="function"&&We.constructor===Symbol&&We!==Symbol.prototype?"symbol":typeof We})(Oe)}Object.defineProperty(J,"__esModule",{value:!0}),ce.d(J,"HighchartsReact",function(){return Ie});var Se=ce(1),Ne=ce.n(Se),rt=typeof window<"u"?Se.useLayoutEffect:Se.useEffect,Ie=Object(Se.memo)(Object(Se.forwardRef)(function(Oe,We){var ct=Object(Se.useRef)(),Ke=Object(Se.useRef)(),pt=Object(Se.useRef)(Oe.constructorType),Pt=Object(Se.useRef)(Oe.highcharts);return rt(function(){function Ue(){var _t=Oe.highcharts||(typeof window>"u"?"undefined":pe(window))==="object"&&window.Highcharts,Dt=Oe.constructorType||"chart";_t?_t[Dt]?Oe.options?Ke.current=_t[Dt](ct.current,Oe.options,Oe.callback):console.warn('The "options" property was not passed.'):console.warn('The "constructorType" property is incorrect or some required module is not imported.'):console.warn('The "highcharts" property was not passed.')}if(Ke.current){if(Oe.allowChartUpdate!==!1)if(Oe.constructorType!==pt.current||Oe.highcharts!==Pt.current)pt.current=Oe.constructorType,Pt.current=Oe.highcharts,Ue();else if(!Oe.immutable&&Ke.current){var zt;(zt=Ke.current).update.apply(zt,[Oe.options].concat(h(Oe.updateArgs||[!0,!0])))}else Ue()}else Ue()},[Oe.options,Oe.allowChartUpdate,Oe.updateArgs,Oe.containerProps,Oe.highcharts,Oe.constructorType]),rt(function(){return function(){Ke.current&&(Ke.current.destroy(),Ke.current=null)}},[]),Object(Se.useImperativeHandle)(We,function(){return{get chart(){return Ke.current},container:ct}},[]),Ne.a.createElement("div",B({},Oe.containerProps,{ref:ct}))}));J.default=Ie},function($,J){$.exports=Z}])})}(Zm)),Zm.exports}var jb=Ob();const Dm=Ng(jb),Bb="_wrapperChartLostLoad_1mzpq_1",Nb={wrapperChartLostLoad:Bb},Fb=({dataupdated:S,categories:F})=>{na(),vi($=>$.country.selectedCountry),vi($=>$.country.countryName),vi($=>$.ts.selectedTs),vi($=>$.ts.selectedTsValue);const Z={chart:{type:"column",zoomType:"x",height:150,events:{load:function(){this.customIcons=[]}}},title:{text:""},xAxis:{categories:F,tickInterval:168},yAxis:{min:0,max:1250,title:{text:"MW"}},legend:{enabled:!1},credits:{enabled:!1},plotOptions:{series:{point:{events:{}}}},colors:["#FF6F59"],series:S};return H.jsx("div",{className:Nb.wrapperChartLostLoad,children:H.jsx("div",{children:H.jsx(Dm,{highcharts:Lm,options:Z})})})},Ub=({bus:S,line:F,link:Z,type:$,side:J,displaybox:ce})=>{const[B,h]=be.useState(!1),[oe,ge]=be.useState(!1),[Te,Ve]=be.useState(null),[Ee,pe]=be.useState([]),[Se,Ne]=be.useState([]),rt="/";let Ie=0,Oe=0,We=[],ct=[];be.useEffect(()=>{h(!!ce)},[ce]),be.useEffect(()=>{if(S){h(!0);const pt=`${rt}single_bus_gen_load`;fetch(pt,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({bus_name:S}).toString()}).then(Pt=>Pt.json()).then(Pt=>{Pt=Pt.data,console.log(Pt),ge(Pt),Ve("gen"),Oe=Object.values(Ee).reduce((_t,Dt)=>_t+Dt,0);const Ue=Pt.lost_load_time_series_MW;We=Object.keys(Ue).map(_t=>new Date(parseInt(_t)).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})),ct=[{name:"",data:Object.values(Ue)}],pe(ct),Ne(We)})}},[S]);const Ke=pt=>{pt.preventDefault(),h(!1)};return H.jsx("div",{children:B&&H.jsx("div",{className:Ys.wrapperNL,children:Te=="gen"&&H.jsxs("div",{children:[H.jsxs("div",{className:Ys.title,children:["Node ",oe.bus]}),H.jsx("a",{href:"#",className:Ys.close,onClick:Ke,children:H.jsx("img",{src:"images/close.png",alt:"Close"})}),H.jsxs("div",{className:Ys.rowcontainer,children:[H.jsx("div",{className:Ys.title2,children:"Carrier"}),H.jsx("div",{className:Ys.title2,children:"Generation"})]}),H.jsx("div",{className:Ys.textrow,children:Object.entries(oe.energy_by_carrier_MWh).filter(([pt])=>pt&&!pt.includes("dsr")&&!pt.includes("lost-load")).map(([pt,Pt])=>({key:pt,power:Pt})).filter(pt=>pt.power>0).sort((pt,Pt)=>Pt.power-pt.power).map(({key:pt,power:Pt})=>(Ie=Ie+Pt,H.jsxs("div",{className:`${Ys.rowbodycontainer}`,children:[H.jsx("div",{children:pt}),H.jsxs("div",{className:Ys.alignright,children:[Math.round(Pt)," MWh"]})]},pt)))}),H.jsxs("div",{className:Ys.rowcontainer2,children:[H.jsx("div",{className:Ys.title3,children:"Total node generation"}),H.jsxs("div",{className:Ys.title3,children:[Math.round(Ie)," MWh"]})]}),H.jsxs("div",{className:Ys.rowcontainer3,children:[H.jsx("div",{className:Ys.title4,children:"Total node demand"}),H.jsxs("div",{className:Ys.title4,children:[Math.round(oe.total_load_MWh)," MWh"]})]}),H.jsxs("div",{className:Ys.rowcontainer4,children:[H.jsx("div",{className:Ys.title5,children:"Total ENS"}),H.jsxs("div",{className:Ys.title5,children:[Oe," MWh"]})]}),H.jsx("div",{children:H.jsx(Fb,{dataupdated:Ee,categories:Se})})]})})})},Vb="_legend_qp4zy_1",Gb="_box_qp4zy_3",$b="_box1_qp4zy_1",Hb="_box2_qp4zy_1",Zb="_box3_qp4zy_1",Pf={legend:Vb,box:Gb,box1:$b,box2:Hb,box3:Zb},qb=()=>H.jsxs("div",{className:Pf.legend,children:[H.jsx("div",{children:"LINE FLOW:"}),H.jsx("div",{className:Pf.box,id:Pf.box3}),H.jsx("div",{children:"Normal"}),H.jsx("div",{className:Pf.box,id:Pf.box2}),H.jsx("div",{children:"High"}),H.jsx("div",{className:Pf.box,id:Pf.box1}),H.jsx("div",{children:"Critical"})]}),Xb="_legend2_1w8nv_1",Yb="_boxg_1w8nv_3",Wb="_boxr_1w8nv_5",Kb="_boxg2_1w8nv_7",Qb="_boxr2_1w8nv_9",em={legend2:Xb,boxg:Yb,boxr:Wb,boxg2:Kb,boxr2:Qb},Jb=()=>H.jsxs("div",{className:em.legend2,children:[H.jsx("div",{className:em.boxg,children:H.jsx("div",{children:"NODE ENERGY BALANCE:"})}),H.jsxs("div",{className:em.boxg,children:[H.jsx("div",{className:em.boxg2}),H.jsx("div",{children:"Normal"})]}),H.jsxs("div",{className:em.boxr,children:[H.jsx("div",{className:em.boxr2}),H.jsx("div",{children:"Lost Load"})]})]}),e1=({view:S,type:F,side:Z,displaybox:$})=>{const[J,ce]=be.useState(null),[B,h]=be.useState($),oe=be.useRef([]),ge=be.useRef([]),Te=be.useRef(!0),Ee="/generators_in_country";return be.useEffect(()=>{if(!S)return;let pe=0;return fetch(Ee).then(Se=>Se.json()).then(Se=>{const Ne=JSON.parse(Se.data[0]),rt=JSON.parse(Se.data[1]),Ie=JSON.parse(Se.data[3]);let Oe=JSON.parse(Se.data[4]);Oe=eg(Oe,"lost-load");const We=Ne.x,ct=Ne.y;Object.keys(We).forEach(Ke=>{var pt,Pt;if(((pt=rt[pe])==null?void 0:pt[0])===Ke){const Ue=We[Ke],zt=ct[Ke],_t=parseFloat(Oe[Ke]||0);Math.round(((Pt=Ie==null?void 0:Ie[0])==null?void 0:Pt[Ke])||0);const Dt=Math.max(Ne.ray_load[Ke]||1,1);let ri="rgba(181, 216, 57, 1)";_t>0?ri="rgba(250, 87, 87, 1)":_t!==0&&(ri="orange");const Yt=`point${pe}`,yi=`circle-layer${pe}`;S.getSource(Yt)||(S.addSource(Yt,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[Ue,zt]}}}),S.addLayer({id:yi,type:"circle",source:Yt,metadata:{customId:Ke},paint:{"circle-radius":Dt*1.25,"circle-color":ri,"circle-opacity":1}}),oe.current.push(Yt),ge.current.push(yi),S.on("click",yi,function(wi){var ki,qe;const gt=(ki=wi.features)==null?void 0:ki[0],It=S.queryRenderedFeatures(wi.point);if(!It.length)return;if(It[0].layer.id.startsWith("circle-layer")){gt.geometry.coordinates;const Ot=((qe=gt.layer.metadata)==null?void 0:qe.customId)||"Unknown";ce(Ot),h(!0)}}),S.on("mouseenter",yi,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",yi,()=>{S.getCanvas().style.cursor=""})),pe++}})}).catch(Se=>console.error("Failed to fetch generator data",Se)),Te.current=!0,()=>{Te.current=!1,ge.current.forEach(Se=>{S&&typeof S.getLayer=="function"&&S.getLayer(Se)&&S.removeLayer(Se)}),oe.current.forEach(Se=>{S&&typeof S.getSource=="function"&&S.getLayer(Se)&&S.removeLayer(Se),S&&S.getSource(Se)&&S.removeSource(Se)}),ge.current=[],oe.current=[]}},[S]),H.jsxs("div",{children:[H.jsx(Ub,{bus:J,line:"",link:"",type:F,side:Z,displaybox:B}),H.jsx(qb,{}),H.jsx(Jb,{})]})},t1=({view:S,type:F,side:Z,displaybox:$})=>{const[J,ce]=be.useState(null),[B,h]=be.useState($),oe=be.useRef([]),ge=be.useRef([]),Te=be.useRef(!0),Ee="/generators_in_country_attack";return be.useEffect(()=>{if(S)return fetch(Ee).then(pe=>pe.json()).then(pe=>{const Se=JSON.parse(pe.data);let Ne=0,rt="#958382",Ie=0;Se.forEach(Oe=>{Oe.attackable=="Y"?rt="#0bb6e0":rt="#958382";const We=`point${Ne}`,ct=`circle-layer${Ne}`,Ke=Oe.coordinates[0],pt=Oe.coordinates[1];Oe.ray_prod==1||Oe.ray_prod==2?Ie=8:Oe.ray_prod==3||Oe.ray_prod==4?Ie=9:Oe.ray_prod==5||Oe.ray_prod==6?Ie=10:Oe.ray_prod==7||Oe.ray_prod==8?Ie=11:(Oe.ray_prod==9||Oe.ray_prod==10)&&(Ie=12),S.getSource(We)||(S.addSource(We,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[Ke,pt]}}}),S.addLayer({id:ct,type:"circle",source:We,metadata:{customId:Oe.Id_bus},paint:{"circle-radius":Ie,"circle-color":rt,"circle-opacity":1}}),rt=="#0bb6e0"&&(S.on("click",ct,function(Pt){var Dt,ri;const Ue=(Dt=Pt.features)==null?void 0:Dt[0],zt=S.queryRenderedFeatures(Pt.point);if(!zt.length)return;if(zt[0].layer.id.startsWith("circle-layer")){Ue.geometry.coordinates;const Yt=((ri=Ue.layer.metadata)==null?void 0:ri.customId)||"Unknown";ce(Yt),h(!0)}}),S.on("mouseenter",ct,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",ct,()=>{S.getCanvas().style.cursor=""}))),Ne++,oe.current.push(We),ge.current.push(ct)})}).catch(pe=>console.error("Failed to fetch generator data",pe)),Te.current=!0,()=>{Te.current=!1,ge.current.forEach(pe=>{S.getLayer(pe)&&S.removeLayer(pe)}),oe.current.forEach(pe=>{S.getSource(pe)&&S.removeSource(pe)}),ge.current=[],oe.current=[]}},[S]),H.jsxs("div",{children:[H.jsx(Jp,{bus:J,line:"",link:"",type:F,side:Z,displaybox:B}),H.jsxs("div",{className:Yc.legendAttack,children:[H.jsxs("div",{className:Yc.boxg,children:[H.jsx("div",{className:Yc.boxg2}),H.jsx("div",{children:"Attackable"})]}),H.jsxs("div",{className:Yc.boxr,children:[H.jsx("div",{className:Yc.boxr2}),H.jsx("div",{children:"Locked"})]})]})]})},Oy=({view:S,type:F,side:Z})=>{const $=be.useRef([]),J=be.useRef([]),ce=be.useRef([]),[B,h]=be.useState(""),[oe,ge]=be.useState(!1),Te=vi(pe=>pe.attack.previousAttackActions),Ee="/generators_in_country";return be.useEffect(()=>{B&&ge(!0)},[B]),be.useEffect(()=>{if(!S)return;let pe=!1,Se=0;const Ne="#0bb6e0";return fetch(Ee).then(rt=>rt.json()).then(rt=>{if(pe)return;const Ie=JSON.parse(rt.data[0]),Oe=JSON.parse(rt.data[1]);JSON.parse(rt.data[3]);let We=eg(JSON.parse(rt.data[4]),"lost-load");const ct=Ie.x,Ke=Ie.y;Object.keys(ct).forEach(pt=>{var Yt,yi,wi;if(((Yt=Oe[Se])==null?void 0:Yt[0])!==pt)return;const Pt=ct[pt],Ue=Ke[pt];parseFloat(We[pt]||0);const zt=Math.max(((yi=Ie.ray_load)==null?void 0:yi[pt])||1,1),_t=`point${Se}`,Dt=`circle-layer${Se}`,ri=`icon-layer${Se}`;S.getSource(_t)||(S.addSource(_t,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[Pt,Ue]}}}),(wi=Te[0])!=null&&wi.some(It=>It.currentElementNode===pt)&&(S.addLayer({id:ri,type:"symbol",source:_t,layout:{"icon-image":"custom-marker","icon-size":1,"icon-anchor":"bottom"}}),ce.current.push(ri)),S.addLayer({id:Dt,type:"circle",source:_t,metadata:{customId:pt},paint:{"circle-radius":zt*2,"circle-color":Ne,"circle-opacity":1}}),S.on("click",Dt,function(It){var qe,Ot,Ht,ii;const ti=(qe=It.features)==null?void 0:qe[0],ki=S.queryRenderedFeatures(It.point)[0];if((Ot=ki==null?void 0:ki.layer)!=null&&Ot.id.startsWith("circle-layer")){const di=((ii=(Ht=ti==null?void 0:ti.layer)==null?void 0:Ht.metadata)==null?void 0:ii.customId)||"Unknown";h(di),ge(!0)}}),S.on("mouseenter",Dt,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",Dt,()=>{S.getCanvas().style.cursor=""}),$.current.push(_t),J.current.push(Dt)),Se++})}).catch(rt=>console.error("Failed to fetch generator data",rt)),()=>{pe=!0,[...J.current,...ce.current].forEach(rt=>{S.getLayer(rt)&&S.removeLayer(rt)}),$.current.forEach(rt=>{S.getSource(rt)&&S.removeSource(rt)}),J.current=[],ce.current=[],$.current=[]}},[S]),H.jsxs("div",{children:[H.jsx(Jp,{bus:B,line:"",link:"",type:F,side:Z,displaybox:oe}),H.jsxs("div",{className:Yc.legend,children:[H.jsx("p",{children:"Max"}),H.jsx("div",{className:Yc.box,id:Yc.box1}),H.jsx("div",{className:Yc.box,id:Yc.box2}),[...Array(7)].map((pe,Se)=>H.jsx("div",{className:Yc.box},Se)),H.jsx("div",{className:Yc.box,id:Yc.box10}),H.jsx("p",{children:"0%"})]})]})},k_=({bus:S,line:F,link:Z,type:$,side:J,displaybox:ce})=>{const B=na(),h=vi(Pt=>Pt.action.selectedAction),oe=vi(Pt=>Pt.action.selectedActionTemp),ge=vi(Pt=>Pt.defence.actionNumber),Te=vi(Pt=>Pt.defence.step),Ve=vi(Pt=>Pt.action.typeNewGen),[Ee,pe]=be.useState(!1),[Se,Ne]=be.useState(!1),[rt,Ie]=be.useState(null),[Oe,We]=be.useState(null);be.useEffect(()=>{Te==3&&pe(!1)},[Te]),be.useEffect(()=>{pe(!!ce)},[ce]),be.useEffect(()=>{S&&(pe(!0),We(""),Ne(S),Ie("gen"),Ve!=""&&(S.p_nom=S.p_nom))},[S]),be.useEffect(()=>{F&&(pe(!0),Ne(F),Ie("line"))},[F]),be.useEffect(()=>{Z&&(pe(!0),Ne(Z),Ie("link"))},[Z]);const ct=Pt=>{Pt.preventDefault(),pe(!1)},Ke=(Pt,Ue)=>{We(zt=>zt===Pt?null:Pt),pt(Pt,Ue)},pt=(Pt,Ue)=>{if(J=="defence"){let zt="",_t="";h==5&&(zt=Pt+" "+Ve),h==2&&typeof Pt=="object"?_t=S.name:_t=Pt,B(Am({actionId:h,type:$,name:_t,carrier:zt,value:Ue,credit:0,actionNumber:ge,defenceStep:Te}))}};return be.useEffect(()=>{J=="defence"&&oe==null&&h>0&&pe(!1)},[oe,h]),H.jsx("div",{children:Ee&&H.jsxs("div",{className:Nr.wrapperNL,children:[rt=="gen"&&H.jsxs("div",{children:[H.jsxs("h3",{className:Nr.title,children:["Node ",S.name]}),H.jsx("a",{href:"#",className:Nr.close,onClick:ct,children:H.jsx("img",{src:"images/close.png",alt:"Close"})}),H.jsxs("table",{children:[H.jsx("thead",{children:H.jsxs("tr",{children:[H.jsx("td",{children:"Carrier"}),H.jsx("td",{className:Nr.alignright,children:"Available capacity(MW)"})]})}),H.jsx("tbody",{children:H.jsx("tr",{children:H.jsx("td",{colSpan:"2",children:H.jsxs("div",{className:`${Nr.rowbodycontainer} ${Oe===S.name?Nr.active:""}`,onClick:()=>Ke(S.name,S.p_nom),children:[H.jsx("div",{children:S.name}),H.jsx("div",{children:S.p_nom})]})})})})]})]}),rt=="line"&&H.jsxs("div",{children:[H.jsxs("h3",{className:Nr.title,children:["Line ",F.name," info"]}),H.jsx("a",{href:"#",className:Nr.close,onClick:ct,children:H.jsx("img",{src:"images/close.png",alt:"Close"})}),H.jsxs("table",{children:[H.jsx("thead",{children:H.jsxs("tr",{children:[H.jsx("td",{}),H.jsx("td",{className:Nr.alignright,children:"Available capacity(MW)"})]})}),H.jsx("tbody",{children:H.jsx("tr",{children:H.jsx("td",{colSpan:"2",children:H.jsxs("div",{className:`${Nr.rowbodycontainer} ${Oe===F.name?Nr.active:""}`,onClick:()=>Ke(F.name,F.p_nom),children:[H.jsx("div",{children:F.name}),H.jsx("div",{children:F.p_nom})]})})})})]})]}),rt=="link"&&H.jsxs("div",{children:[H.jsxs("h3",{className:Nr.title,children:["Link ",Z.name," info"]}),H.jsx("a",{href:"#",className:Nr.close,onClick:ct,children:H.jsx("img",{src:"images/close.png",alt:"Close"})}),H.jsx("table",{children:H.jsx("thead",{children:H.jsxs("tr",{children:[H.jsx("td",{}),H.jsx("td",{className:Nr.alignright,children:"Available capacity(MW)"})]})})}),H.jsxs("div",{className:`${Nr.rowbodycontainer} ${Oe===Z.name?Nr.active:""}`,onClick:()=>Ke(Z.name,Z.p_nom),children:[H.jsx("div",{children:Z.name}),H.jsx("div",{children:Z.p_nom})]})]})]})})},i1=({view:S,side:F,type:Z})=>{const $=be.useRef([]),J=be.useRef([]),ce=be.useRef([]),[B,h]=be.useState(""),[oe,ge]=be.useState([]),[Te,Ve]=be.useState(!1),Ee=vi(pe=>pe.action.typeNewGen);return be.useEffect(()=>{B&&Ve(!0)},[B]),be.useEffect(()=>{if(!S)return;let pe=!1;return fetch("/js/newpp_generators.json").then(Se=>Se.json()).then(Se=>{pe||ge(Se)}).catch(Se=>console.error("Failed to fetch generator data",Se)),()=>{pe=!0}},[S]),be.useEffect(()=>{if(!S||oe.length===0)return;let pe=0;return oe.forEach(Se=>{Se.type===Ee&&Se.data.forEach(Ne=>{const{long:rt,lat:Ie,name:Oe}=Ne,We=10,ct="#0bb6e0",Ke=`point${pe}`,pt=`circle-layer${pe}`;if(!S.getSource(Ke)){S.addSource(Ke,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[rt,Ie]}}}),S.addLayer({id:pt,type:"circle",source:Ke,metadata:{customId:Oe||`Generator-${pe}`},paint:{"circle-radius":We*2,"circle-color":ct,"circle-opacity":1}});const Pt=Ue=>{var Dt,ri,Yt,yi;const zt=(Dt=Ue.features)==null?void 0:Dt[0],_t=S.queryRenderedFeatures(Ue.point)[0];(ri=_t==null?void 0:_t.layer)!=null&&ri.id.startsWith("circle-layer")&&((yi=(Yt=zt==null?void 0:zt.layer)==null?void 0:Yt.metadata)!=null&&yi.customId,h(Ne),Ve(!0))};S.on("click",pt,Pt),S.on("mouseenter",pt,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",pt,()=>{S.getCanvas().style.cursor=""}),$.current.push(Ke),J.current.push(pt)}pe++})}),()=>{[...J.current,...ce.current].forEach(Se=>{S.getLayer(Se)&&S.removeLayer(Se)}),$.current.forEach(Se=>{S.getSource(Se)&&S.removeSource(Se)}),J.current=[],ce.current=[],$.current=[]}},[S,oe,Ee]),H.jsx("div",{children:H.jsx(k_,{bus:B,line:"",link:"",type:Z,side:F,displaybox:Te})})},r1=({view:S,side:F,type:Z})=>{const $=be.useRef([]),J=be.useRef([]),ce=be.useRef([]),[B,h]=be.useState(""),[oe,ge]=be.useState([]),[Te,Ve]=be.useState(!1),[Ee,pe]=be.useState(null),[Se,Ne]=be.useState(null),rt=vi(Ie=>Ie.action.typeNewGen);return be.useEffect(()=>{B&&Ve(!0)},[B]),be.useEffect(()=>{if(!S)return;let Ie=!1;return fetch("/js/backup_generators.json").then(Oe=>Oe.json()).then(Oe=>{Ie||ge(Oe)}).catch(Oe=>console.error("Failed to fetch generator data",Oe)),()=>{Ie=!0}},[S]),be.useEffect(()=>{if(!S||oe.length===0)return;let Ie=0;return oe.forEach(Oe=>{Oe.type==="Generator"&&rt==="Generator"&&Oe.data.forEach(We=>{const{long:ct,lat:Ke,name:pt}=We,Pt=10,Ue="#0bb6e0",zt=`point${Ie}`,_t=`circle-layer${Ie}`;if(!S.getSource(zt)){S.addSource(zt,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[ct,Ke]}}}),S.addLayer({id:_t,type:"circle",source:zt,metadata:{customId:pt||`Generator-${Ie}`},paint:{"circle-radius":Pt*2,"circle-color":Ue,"circle-opacity":1}});const Dt=ri=>{var wi,gt,It,ti;const Yt=(wi=ri.features)==null?void 0:wi[0],yi=S.queryRenderedFeatures(ri.point)[0];(gt=yi==null?void 0:yi.layer)!=null&&gt.id.startsWith("circle-layer")&&((ti=(It=Yt==null?void 0:Yt.layer)==null?void 0:It.metadata)!=null&&ti.customId,h(We),Ve(!0))};S.on("click",_t,Dt),S.on("mouseenter",_t,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",_t,()=>{S.getCanvas().style.cursor=""}),$.current.push(zt),J.current.push(_t)}Ie++}),Oe.type==="Line"&&rt==="Line"&&Oe.data.forEach(We=>{const ct=We.name,Ke="#0bb6e0",pt=[We.lat1,We.long1],Pt=[We.lat2,We.long2],Ue=`line-line-${Ie}`,zt=`line-source-${Ie}`,_t={type:"Feature",properties:{name:ct},geometry:{type:"LineString",coordinates:[pt,Pt]}};S.getSource(zt)||(S.addSource(zt,{type:"geojson",data:_t}),S.addLayer({id:Ue,type:"line",source:zt,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":Ke,"line-width":4}}),S.on("click",Ue,Dt=>{var yi;(yi=Dt.features)==null||yi[0];const ri=S.queryRenderedFeatures(Dt.point);if(!ri.length)return;ri[0].layer.id.startsWith("circle-layer")||(Ne(We),Ve(!0))}),S.on("mouseenter",Ue,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",Ue,()=>{S.getCanvas().style.cursor=""})),$.current.push(zt),J.current.push(Ue),Ie++}),Oe.type==="Link"&&rt==="Link"&&Oe.data.forEach(We=>{const ct=We.name,Ke="#0bb6e0",pt=[We.lat1,We.long1],Pt=[We.lat2,We.long2],Ue=`link-line-${Ie}`,zt=`link-source-${Ie}`,_t={type:"Feature",properties:{name:ct},geometry:{type:"LineString",coordinates:[pt,Pt]}};S.getSource(zt)||(S.addSource(zt,{type:"geojson",data:_t}),S.addLayer({id:Ue,type:"line",source:zt,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":Ke,"line-width":4}}),S.on("click",Ue,Dt=>{var yi;(yi=Dt.features)==null||yi[0];const ri=S.queryRenderedFeatures(Dt.point);if(!ri.length)return;ri[0].layer.id.startsWith("circle-layer")||(pe(We),Ve(!0))}),S.on("mouseenter",Ue,()=>{S.getCanvas().style.cursor="pointer"}),S.on("mouseleave",Ue,()=>{S.getCanvas().style.cursor=""}),$.current.push(zt),J.current.push(Ue)),Ie++})}),()=>{[...J.current,...ce.current].forEach(Oe=>{S.getLayer(Oe)&&S.removeLayer(Oe)}),$.current.forEach(Oe=>{S.getSource(Oe)&&S.removeSource(Oe)}),J.current=[],ce.current=[],$.current=[]}},[S,oe,rt]),H.jsx("div",{children:H.jsx(k_,{bus:B,line:Se,link:Ee,type:Z,side:F,displaybox:Te})})},n1=({view:S})=>{const F=be.useRef([]),Z=be.useRef([]),$=be.useRef(!0),ce="/flow_between_countries";return be.useEffect(()=>{if(S)return fetch(ce).then(B=>B.json()).then(B=>{let h=JSON.parse(B.data),oe=h.countries,ge=h.flow_from_to;const Te=[{DE:[10.4515,51.1657]},{PL:[19.1451,51.9194]},{DK:[9.5018,56.2639]},{SE:[18.6435,60.1282]},{EE:[25.0237,58.5975]},{LV:[24.105,56.9462]},{FI:[24.9458,60.192]},{NO:[12.7522,64.583]},{LT:[25.2796,54.6871]}];let Ve,Ee,pe,Se,Ne,rt,Ie,Oe,We,ct,Ke,pt=0;for(let Pt in oe)if(rt=oe[Pt],ge[pt]>0?(Ve=rt[0],pe=rt[1]):(Ve=rt[1],pe=rt[0]),Ee=[],Se=[],Ie=Te.find(Ue=>Ue.hasOwnProperty(Ve)),Ee=Ie?Ie[Ve]:void 0,Oe=Te.find(Ue=>Ue.hasOwnProperty(pe)),Se=Oe?Oe[pe]:void 0,Ee!=null&&Se!=null){Ne=Math.round(Math.abs(ge[pt])/1e3),We="orange",ct=Ve+" "+pe,Ke=Math.round(Ne/300),Ke==0&&Ne>0&&(Ke=1),isNaN(Ke)&&(Ke=1);const Ue=`line-${pt}`,zt=`arrow-layer-${pt}`,_t=`line-source-${pt}`,Dt={type:"Feature",properties:{name:ct},geometry:{type:"LineString",coordinates:[Ee,Se]}};S.getSource(_t)||(S.addSource(_t,{type:"geojson",data:Dt}),S.addLayer({id:Ue,type:"line",source:_t,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":We,"line-width":Ke*4}}),S.addLayer({id:zt,type:"symbol",source:_t,layout:{"symbol-placement":"line","symbol-spacing":100,"icon-image":"arrow","icon-size":.5,"icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!0}}),F.current.push(_t),Z.current.push(Ue,zt)),pt++}}).catch(B=>console.error("Error fetching line data:",B)),$.current=!0,()=>{$.current=!1,Z.current.forEach(B=>{S.getLayer(B)&&S.removeLayer(B)}),F.current.forEach(B=>{S.getSource(B)&&S.removeSource(B)}),Z.current=[],F.current=[]}},[S]),null},a1=({view:S})=>{const[F,Z]=be.useState(""),$=be.useRef([]),J=na(),ce=vi(B=>B.action.selectedActions);return be.useRef(0),be.useEffect(()=>{$.current=F},[F]),be.useEffect(()=>{if(!S)return;const B="baltic-fill",h="baltic-fill-highlight";S.setPaintProperty(B,"fill-color","#0bb6e0"),S.getLayer(h)||S.addLayer({id:h,type:"fill",source:"baltic",paint:{"fill-color":"#FF7758","fill-opacity":1},filter:["in","ISO2",...$.current]});const oe=ge=>{var Se;S.setPaintProperty("baltic-fill","fill-color","#0bb6e0");const Te=(Se=ge.features)==null?void 0:Se[0];if(!Te)return;const Ve=Te.properties.ISO2;$.current;const Ee=Ve;S.setFilter(h,["in","ISO2",Ee]),ce.length-1,J(Am({actionId:4,type:"C",name:Ee,carrier:"",credit:0,actionNumber:0,defenceStep:0})),Z(Ee)};return S.on("click",B,oe),()=>{S.off("click",B,oe),S.getLayer(B)&&S.setPaintProperty(B,"fill-color","#594543"),S.getLayer(h)&&S.removeLayer(h)}},[S]),null},s1=({view:S})=>{na(),vi(h=>h.country.countries);const F=vi(h=>h.country.selectedCountry),Z=be.useRef(!1),$=be.useRef([]),J=be.useRef([]),ce=be.useRef([]),B=be.useRef(!0);return be.useEffect(()=>{if(S&&!(!S||Z.current))return Z.current=!0,fetch("/js/baltic_states_eurostat_info.json").then(h=>h.json()).then(h=>{let oe,ge;const Te="TOTAL_POP",Ve=h.map(Ne=>Ne[Te]),Ee=Math.min(...Ve),pe=Math.max(...Ve);let Se=0;h.forEach(Ne=>{if(Ne.CNTR_CODE==F||F==""){oe=[Ne.geometry],ge=Kv(Ne[Te],Ee,pe),Ne.DATE,Ne.t;const rt={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:oe}},Ie="polygon-source-"+Se,Oe="polygon-fill-"+Se,We="polygon-outline-"+Se;S.addSource(Ie,{type:"geojson",data:rt}),S.addLayer({id:Oe,type:"fill",source:Ie,paint:{"fill-color":ge,"fill-opacity":.4}}),S.addLayer({id:We,type:"line",source:Ie,paint:{"line-color":ge,"line-width":2}}),$.current.push(Ie),J.current.push(Oe),ce.current.push(We)}Se++})}).catch(h=>console.error("Error fetching line data:",h)),B.current=!0,()=>{S&&(J.current.forEach(h=>{try{S.getLayer(h)&&S.removeLayer(h)}catch(oe){console.warn(`Failed to remove layer ${h}`,oe)}}),ce.current.forEach(h=>{try{S.getLayer(h)&&S.removeLayer(h)}catch(oe){console.warn(`Failed to remove layer ${h}`,oe)}}),$.current.forEach(h=>{try{S.getSource(h)&&S.removeSource(h)}catch(oe){console.warn(`Failed to remove source ${h}`,oe)}}),J.current=[],ce.current=[],$.current=[])}},[S,F]),null},o1=({mycomponent:S,side:F,displaybox:Z})=>{const $=be.useRef(null),J=be.useRef(null),[ce,B]=be.useState(null),h=vi(oe=>oe.country.selectedCountry);return be.useEffect(()=>{if(!J.current){const oe=new ky.Map({container:$.current,style:{version:8,glyphs:"/font/{fontstack}/{range}.pbf",sources:{},layers:[]},center:[21,57],zoom:5,maxZoom:7,attributionControl:!1});oe.scrollZoom.disable(),oe.addControl(new ky.NavigationControl({showCompass:!1}),"top-left"),oe.on("style.load",()=>{oe.addLayer({id:"background-color",type:"background",paint:{"background-color":"#1D2224"}})}),oe.on("load",async()=>{const ge=await oe.loadImage("/images/arrow.png");oe.addImage("arrow",ge.data);const Te=await oe.loadImage("/images/attackSite.png");oe.addImage("custom-marker",Te.data);const Ve=await fetch("/europe.geojson").then(pe=>pe.json());oe.addSource("europe",{type:"geojson",data:Ve}),oe.addLayer({id:"europe-fill",type:"fill",source:"europe",paint:{"fill-color":"#39394C","fill-opacity":1}}),oe.addLayer({id:"europe-line",type:"line",source:"europe",paint:{"line-color":"#1D2224","line-width":1}});const Ee=await fetch("/europe_01.geojson").then(pe=>pe.json());oe.addSource("baltic",{type:"geojson",data:Ee}),oe.addLayer({id:"baltic-fill",type:"fill",source:"baltic",paint:{"fill-color":"#594543","fill-opacity":1}}),oe.addLayer({id:"baltic-line",type:"line",source:"baltic",paint:{"line-color":"#1D2224","line-width":2}}),oe.addSource("country-centroids",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),oe.addLayer({id:"country-labels",type:"symbol",source:"country-centroids",layout:{"text-field":["get","name"],"text-size":16,"text-font":["Open Sans Regular"],"text-anchor":"center"},paint:{"text-color":"#EEEEEE"}}),oe.addLayer({id:"baltic-line-highlight",type:"line",source:"baltic",paint:{"line-color":"#FF0000","line-width":3},filter:["==","ISO2",""]}),B(oe),J.current=oe})}return()=>{}},[]),be.useEffect(()=>{const oe=J.current;!oe||!oe.getLayer("baltic-line-highlight")||(oe.setFilter("baltic-line-highlight",["==",["get","ISO2"],h||""]),(S=="DE"||S=="DEBG"||S=="DENPP"||S=="DEL"||S=="DELK")&&(oe.getLayer("baltic-line-highlight")&&oe.removeLayer("baltic-line-highlight"),oe.getLayer("baltic-fill-highlight")&&oe.removeLayer("baltic-fill-highlight")))},[h,S]),H.jsx("div",{children:H.jsxs("div",{style:{width:"890px",height:"636px",marginTop:"10px",position:"relative",borderRadius:"0 0 10px 10px"},ref:$,children:[S==="A"&&ce&&H.jsxs(H.Fragment,{children:[H.jsx(Py,{view:ce,side:F,type:"X",displaybox:Z}),H.jsx(e1,{view:ce,side:F,type:"X",displaybox:Z}),H.jsx(Ly,{view:ce,side:F,type:"X",displaybox:Z})]}),S==="B"&&ce&&H.jsx(n1,{view:ce}),S==="D"&&ce&&H.jsx(s1,{view:ce}),S==="LK"&&ce&&H.jsx(Ly,{view:ce,type:"X",side:F,displaybox:Z}),S==="L"&&ce&&H.jsx(Py,{view:ce,type:"X",side:F,displaybox:Z}),S==="N"&&ce&&H.jsx(Oy,{view:ce,type:"N",side:F,displaybox:Z}),S==="C"&&ce&&H.jsx(a1,{view:ce}),S==="AT"&&ce&&H.jsxs(H.Fragment,{children:[H.jsx(t1,{view:ce,side:F,type:"X",displaybox:Z}),H.jsx(sb,{view:ce,side:F,type:"X",displaybox:Z}),H.jsx(ob,{view:ce,side:F,type:"X",displaybox:Z})]}),S==="DE"&&ce&&H.jsxs(H.Fragment,{children:[H.jsx(zy,{view:ce,side:F,type:"X",displaybox:Z}),H.jsx(Dy,{view:ce,side:F,type:"X",displaybox:Z}),H.jsx(Oy,{view:ce,side:F,type:"X"})]}),S==="DEBG"&&ce&&H.jsx(H.Fragment,{children:H.jsx(r1,{view:ce,side:F,type:"2"})}),S==="DENPP"&&ce&&H.jsx(H.Fragment,{children:H.jsx(i1,{view:ce,side:F,type:"5"})}),S==="DEL"&&ce&&H.jsx(H.Fragment,{children:H.jsx(zy,{view:ce,side:F,type:"3"})}),S==="DELK"&&ce&&H.jsx(H.Fragment,{children:H.jsx(Dy,{view:ce,side:F,type:"6"})})]})})},l1=()=>{const[S,F]=be.useState([]),Z="/",$=`${Z}generation_country_carrier`,J=`${Z}hydro`;be.useEffect(()=>{fetch($).then(B=>B.json()).then(B=>{let h="[",oe=[],ge=JSON.parse(B.data);for(const[Te,Ve]of Object.entries(ge)){h+='{"name": " '+Te+' ", "data": [';for(const[Ee,pe]of Object.entries(Ve))oe.push(Math.round(pe/1e3));h+=oe.toString()+"]},",oe=[]}h=h.substring(0,h.length-1),h+="]",fetch(J).then(Te=>Te.json()).then(Te=>{let Ve=JSON.parse(h),Ee=Te.gen_hydro.EE,pe=Te.gen_hydro.LT,Se=Te.gen_hydro.LV,Ne={name:"hydro",data:[Ee,pe,Se]};Ve.push(Ne);let rt=Te.phs_in.EE,Ie=Te.phs_in.LT,Oe=Te.phs_in.LV,We={name:"phs_in",data:[rt,Ie,Oe]};Ve.push(We);let ct=Te.phs_out.EE,Ke=Te.phs_out.LT,pt=Te.phs_out.LV,Pt={name:"phs_out",data:[ct,Ke,pt]};Ve.push(Pt);const Ue=Ve.filter(zt=>zt.name.trim()!=="").map(zt=>({...zt,name:zt.name.trim()}));F(Ue)})})},[]);const ce={chart:{type:"column",height:650},title:{text:""},colors:["#491581","#69CACF","#2D6A1B","#0012F5","#0012F5","#0012F5","#000000","#0012F5","#F7D046","#F7D046","#808080"],xAxis:{categories:["EE","LT","LV"]},yAxis:{title:{text:""},stackLabels:{enabled:!0}},legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0}},series:{dataLabels:{enabled:!0,formatter:function(){return this.y===0?null:this.y}}}},tooltip:{headerFormat:"<b>{category}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"},series:S};return H.jsx("article",{children:H.jsx(Dm,{highcharts:Lm,options:ce})})},c1="_mapnavigation_1jmfk_1",u1="_maptabs_1jmfk_15",h1="_maptab_1jmfk_15",d1="_active_1jmfk_41",p1="_mapdisplay_1jmfk_51",zu={mapnavigation:c1,maptabs:u1,maptab:h1,active:d1,mapdisplay:p1},dm=({side:S,step:F})=>{const[Z,$]=be.useState("A"),J=vi(h=>h.action.selectedAction),ce=vi(h=>h.action.selectedAction);be.useEffect(()=>{S=="defence"&&ce==0&&(console.log(S+" "+ce),$("A"))},[ce]),be.useEffect(()=>{S==="attack"&&F===2&&$(h=>h!=="AT"?"AT":h),S==="defence"&&$(h=>h!=="DE"?"DE":h)},[F,S]),be.useEffect(()=>{fetch("/js/action.json").then(h=>h.json()).then(h=>{let oe=null;for(const ge of h){const Te=ge.data.find(Ve=>Ve.id===J);if(Te){oe=Te;break}}oe&&oe.map&&oe.map!==Z?$(oe.map):$("A")})},[J]);const B=be.useCallback(()=>{switch(Z){case"A":case"B":case"D":case"N":case"L":case"C":case"LK":case"AT":case"DE":case"DEBG":case"DENPP":case"DEL":case"DELK":return H.jsx(o1,{mycomponent:Z,side:S});case"G":return H.jsx(l1,{side:S});default:return null}},[Z,S]);return H.jsxs("section",{className:zu.mapcolumn,children:[H.jsx("nav",{className:zu.mapnavigation,children:H.jsxs("ul",{className:zu.maptabs,children:[H.jsx("li",{className:zu.maptab,children:H.jsx("a",{onClick:()=>$("A"),className:Z==="A"?zu.active:"",children:"Electricity flow"})}),H.jsx("li",{className:zu.maptab,children:H.jsx("a",{onClick:()=>$("B"),className:Z==="B"?zu.active:"",children:"Base flow"})}),H.jsx("li",{className:zu.maptab,children:H.jsx("a",{onClick:()=>$("G"),className:Z==="G"?zu.active:"",children:"Generation mix"})}),H.jsx("li",{className:zu.maptab,children:H.jsx("a",{onClick:()=>$("D"),className:Z==="D"?zu.active:"",children:"Population & Industries"})})]})}),H.jsx("div",{className:zu.mapdisplay,children:B()})]})},f1="_wrapperAH_szl2a_1",m1="_title_szl2a_3",jy={wrapperAH:f1,title:m1},og=()=>H.jsx("div",{className:jy.wrapperAH,children:H.jsx("h3",{className:jy.title,children:"Attack History"})}),g1="_wrapperCountries_1auqs_1",y1="_title_1auqs_3",_1="_country_1auqs_5",x1="_active_1auqs_7",Nm={wrapperCountries:g1,title:y1,country:_1,active:x1},lg=()=>{const S=na(),F=vi($=>$.country.selectedCountry),Z=[{name:"Estonia",code:"EE"},{name:"Latvia",code:"LV"},{name:"Lithuania",code:"LT"}];return H.jsxs("article",{className:Nm.wrapperCountries,children:[H.jsx("h3",{className:Nm.title,children:"Affected countries"}),Z.map($=>H.jsx("div",{children:H.jsx("button",{className:`${Nm.country} ${F===$.code?Nm.active:""}`,onClick:()=>S(_v($.code)),children:$.name},$.code)},$.code))]})},v1="_wrapperChartLostLoad_1ls2e_1",b1="_title_1ls2e_3",w1="_subtitle_1ls2e_5",kg={wrapperChartLostLoad:v1,title:b1,subtitle:w1},S1=({dataupdated:S,categories:F})=>{na(),vi(J=>J.country.selectedCountry);const Z=vi(J=>J.country.countryName);vi(J=>J.ts.selectedTs),vi(J=>J.ts.selectedTsValue);const $={chart:{type:"column",zoomType:"x",height:150,events:{load:function(){this.customIcons=[]}}},title:{text:""},xAxis:{categories:F,tickInterval:168},yAxis:{min:0,max:1250,title:{text:"MW"}},legend:{enabled:!1},credits:{enabled:!1},plotOptions:{series:{point:{events:{}}}},colors:["#FF6F59"],series:S};return H.jsxs("div",{className:kg.wrapperChartLostLoad,children:[H.jsx("h3",{className:kg.title,children:"Lost Load History"}),H.jsx("p",{className:kg.subtitle,children:Z}),H.jsx("div",{children:H.jsx(Dm,{highcharts:Lm,options:$})})]})},T1="_wrapperLL_1w572_1",M1="_title_1w572_23",C1="_subtitle_1w572_25",A1="_value_1w572_27",E1="_value3_1w572_31",k1="_label2_1w572_33",P1="_label3_1w572_35",z1="_box_1w572_37",L1="_boxlast_1w572_39",pd={wrapperLL:T1,title:M1,subtitle:C1,value:A1,value3:E1,label2:k1,label3:P1,box:z1,boxlast:L1},D1=({sumTot:S,sumPerc:F})=>{const Z=vi($=>$.country.countryName);return H.jsxs("div",{className:pd.wrapperLL,children:[H.jsx("h3",{className:pd.title,children:"Lost load total"}),H.jsx("p",{className:pd.subtitle,children:Z}),H.jsxs("div",{className:pd.box,children:[H.jsx("span",{className:pd.value3,children:F}),H.jsx("span",{className:pd.label2,children:"%"})," ",H.jsx("span",{className:pd.label3,children:"of total load"})]}),H.jsxs("div",{className:pd.boxlast,children:[H.jsx("span",{className:pd.value,children:S}),"  ",H.jsx("span",{className:pd.value,children:"GWh"})]})]})},R1="_wrapperLL_vmunp_1",I1={wrapperLL:R1},cg=({chart:S})=>{const[F,Z]=be.useState([]),[$,J]=be.useState([]),[ce,B]=be.useState([]),[h,oe]=be.useState([]);na();const ge=vi(Ie=>Ie.country.selectedCountry),Te=vi(Ie=>Ie.ts.selectedTs);vi(Ie=>Ie.country.countryName);const Ee="/lost_load";let pe=0,Se=0,Ne=0,rt=[];return be.useEffect(()=>{fetch(Ee).then(Ie=>Ie.json()).then(Ie=>{const Oe=Ie.EE_loads,We=Ie.LT_loads,ct=Ie.LV_loads;let Ke=0;Ie.EE_loads&&(Ke=Oe.reduce((It,ti)=>It+ti.EE_total_load,0));let pt=0;Ie.LT_loads&&(pt=We.reduce((It,ti)=>It+ti.LT_total_load,0));let Pt=0;Ie.LV_loads&&(Pt=ct.reduce((It,ti)=>It+ti.LV_total_load,0));let Ue=[],zt=[],_t=[],Dt,ri;Ie.LV_loads;let Yt=[];Oe&&(Yt=Oe.map(It=>new Date(It.data).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}))),Z(Yt),Ie.EE_SummedValues&&(Ue=Ie.EE_SummedValues),Ie.LT_SummedValues&&(zt=Ie.LT_SummedValues),Ie.LV_SummedValues&&(_t=Ie.LV_SummedValues);const yi=Math.round(Ue.reduce((It,ti)=>It+ti,0)/1e3),wi=Math.round(zt.reduce((It,ti)=>It+ti,0)/1e3),gt=Math.round(_t.reduce((It,ti)=>It+ti,0)/1e3);switch(ge){case"":Dt=[],Ue==null&&(Ue=[]),zt==null&&(zt=[]),_t==null&&(_t=[]),ri=Math.max(Ue.length,zt.length,_t.length);for(let It=0;It<ri;It++){const ti=It<Ue.length?Ue[It]:0,ki=It<zt.length?zt[It]:0,qe=It<_t.length?_t[It]:0;Dt.push(ti+ki+qe)}rt=[{name:"Lost Loads",data:Dt}],pe=yi+wi+gt,pe>0&&(Se=Math.round((Ke+pt+Pt)/1e3),Ne=Math.round(pe*100/Se*10)/10);break;case"EE":rt=[{name:"EE_lost_loads",data:Ie.EE_SummedValues}],pe=yi,pe>0&&(Se=Math.round(Ke/1e3),Ne=Math.round(Se*100/pe*10)/10);break;case"LT":rt=[{name:"LT_lost_loads",data:Ie.LT_SummedValues}],pe=wi,pe>0&&(Se=Math.round(pt/1e3),Ne=Math.round(pe*100/Se*10)/10);break;case"LV":rt=[{name:"LV_lost_loads",data:Ie.LV_SummedValues}],pe=gt,pe>0&&(Se=Math.round(Pt/1e3),Ne=Math.round(pe*100/Se*10)/10);break;default:Dt=[],Ue=Ie.EE_SummedValues,zt=Ie.LT_SummedValues,_t=Ie.LV_SummedValues,Ue==null&&(Ue=[]),zt==null&&(zt=[]),_t==null&&(_t=[]),ri=Math.max(Ue.length,zt.length,_t.length);for(let It=0;It<ri;It++){const ti=It<Ue.length?Ue[It]:0,ki=It<zt.length?zt[It]:0,qe=It<_t.length?_t[It]:0;Dt.push(ti+ki+qe)}rt=[{name:"Lost Loads",data:Dt}],pe=yi+wi+gt,pe>0&&(Se=Math.round((Ke+pt+Pt)/1e3),Ne=Math.round(pe*100/Se*10)/10);break}J(rt),B(pe),oe(Ne)})},[ge,Te]),H.jsxs("div",{className:I1.wrapperLL,children:[H.jsx("div",{children:S&&H.jsx(S1,{dataupdated:$,categories:F})}),H.jsx("div",{children:H.jsx(D1,{sumTot:ce,sumPerc:h})})]})},O1="_wrapperChartPrice_kko6n_1",j1="_title_kko6n_3",B1="_subtitle_kko6n_5",Pg={wrapperChartPrice:O1,title:j1,subtitle:B1},N1=({dataupdated:S,categories:F})=>{const Z=na();vi(ce=>ce.country.selectedCountry),vi(ce=>ce.ts.selectedTs);const $=vi(ce=>ce.country.countryName),J={chart:{type:"line",zoomType:"x",height:150},title:{text:""},xAxis:{categories:F,tickInterval:168},yAxis:{title:{text:"€/MWh"}},legend:{enabled:!1},credits:{enabled:!1},plotOptions:{series:{point:{events:{click:function(){Z(setTs(this.x))}}}}},series:S};return H.jsxs("div",{className:Pg.wrapperChartPrice,children:[H.jsx("h3",{className:Pg.title,children:"Electricity price fluctuations"}),H.jsx("p",{className:Pg.subtitle,children:$}),H.jsx("div",{children:H.jsx(Dm,{highcharts:Lm,options:J})})]})},F1="_wrapperEP_lmjr5_1",U1="_title_lmjr5_3",V1="_subtitle_lmjr5_5",G1="_label1_lmjr5_7",$1="_value_lmjr5_9",H1="_label2_lmjr5_11",Z1="_value3_lmjr5_13",q1="_label3_lmjr5_15",X1="_box_lmjr5_17",qc={wrapperEP:F1,title:U1,subtitle:V1,label1:G1,value:$1,label2:H1,value3:Z1,label3:q1,box:X1},Y1=({pmin:S,pmax:F,pavg:Z})=>{const $=vi(J=>J.country.countryName);return H.jsxs("div",{className:qc.wrapperEP,children:[H.jsx("h3",{className:qc.title,children:"Average electricity price"}),H.jsx("p",{className:qc.subtitle,children:$}),H.jsxs("div",{className:qc.box,children:[H.jsx("span",{className:qc.label1,children:"Max"}),"  ",H.jsx("span",{className:qc.value,children:F}),"  ",H.jsx("span",{className:qc.label2,children:"€/MWh"})]}),H.jsxs("div",{children:[H.jsx("span",{className:qc.label1,children:"Min"}),"  ",H.jsx("span",{className:qc.value,children:S}),"  ",H.jsx("span",{className:qc.label2,children:"€/MWh"})]}),H.jsxs("div",{className:qc.box,children:[H.jsxs("span",{className:qc.value3,children:[Z," "]}),H.jsx("span",{className:qc.label3,children:"€/MWh"})]})]})},W1="_wrapperEE_1svxs_1",K1="_title_1svxs_3",Q1="_parent_1svxs_5",J1="_subtitle_1svxs_7",Fm={wrapperEE:W1,title:K1,parent:Q1,subtitle:J1},ew=()=>H.jsxs("div",{className:Fm.wrapperEE,children:[H.jsx("h3",{className:Fm.title,children:"Electricity price fluctuations"}),H.jsx("div",{className:Fm.parent,children:H.jsx("p",{className:Fm.subtitle,children:"Filter affected country in order to display electricity price data"})})]}),tw="_wrapperP_nkp9k_1",iw={wrapperP:tw},ug=()=>{const S=vi(Se=>Se.country.selectedCountry),F=vi(Se=>Se.ts.selectedTs),[Z,$]=be.useState([]),[J,ce]=be.useState([]),[B,h]=be.useState({pmin:0,pmax:0,pavg:0}),ge="/prices";let Te=0,Ve=0,Ee=0,pe=0;return be.useEffect(()=>{fetch(ge).then(Se=>Se.json()).then(Se=>{const Ne=JSON.parse(Se.data[1]);let rt=[],Ie=[],Oe=[],We=[],ct=[];const Ke=Ne.EE,pt=Ne.LT,Pt=Ne.LV;for(const Ue in Ke)if(Ke.hasOwnProperty(Ue)){Te=Math.round(Ke[Ue]*100)/100,Ie.push(Te);const _t=new Date(Ue).toLocaleDateString("en-GB",{day:"2-digit",month:"short"});ct.push(_t)}ce(ct);for(const Ue in pt)pt.hasOwnProperty(Ue)&&(Te=Math.round(pt[Ue]*100)/100,Oe.push(Te));for(const Ue in Pt)Pt.hasOwnProperty(Ue)&&(Te=Math.round(Pt[Ue]*100)/100,We.push(Te));switch(S){case"":Ie={name:"price_ts_ee",data:Ie},Oe={name:"price_ts_lt",data:Oe},We={name:"price_ts_lv",data:We},rt=[Ie,Oe,We],Ve=0,Ee=0,pe=0;break;case"EE":rt=[{name:"price_ts_ee",data:Ie}],Ve=Math.min(...Ie),Ee=Math.max(...Ie),pe=Ie.reduce((Ue,zt)=>Ue+zt,0)/Ie.length;break;case"LT":rt=[{name:"price_ts_lt",data:Oe}],Ve=Math.min(...Oe),Ee=Math.max(...Oe),pe=Oe.reduce((Ue,zt)=>Ue+zt,0)/Oe.length;break;case"LV":rt=[{name:"price_ts_lv",data:We}],Ve=Math.min(...We),Ee=Math.max(...We),pe=We.reduce((Ue,zt)=>Ue+zt,0)/We.length;break;default:Ie={name:"price_ts_ee",data:Ie},Oe={name:"price_ts_lt",data:Oe},We={name:"price_ts_lv",data:We},rt=[Ie,Oe,We],Ve=0,Ee=0,pe=0;break}pe=Math.round(pe*100)/100,$(rt),h({pmin:Ve,pmax:Ee,pavg:pe})})},[S,F]),H.jsxs("div",{className:iw.wrapperP,children:[S==""&&H.jsx(ew,{}),S!=""&&H.jsx(N1,{dataupdated:Z,categories:J}),S!=""&&H.jsx(Y1,{pmin:B.pmin,pmax:B.pmax,pavg:B.pavg})]})},rw="_wrapperDB_ulyt5_1",nw="_title_ulyt5_3",By={wrapperDB:rw,title:nw},hg=()=>{const S=()=>{};return H.jsx("div",{className:By.wrapperDB,children:H.jsx("a",{className:By.title,onClick:S,children:"Defence planning"})})};function aw(){const S="/";return be.useEffect(()=>{const F=`${S}restart_a`;fetch(F).then(Z=>{if(!Z.ok)throw new Error("Network response was not ok");return Z.json()}).then(Z=>{console.log("Success:",Z),location.href="/"}).catch(Z=>{console.error("Error:",Z)})}),H.jsx(lm,{store:um,children:H.jsxs("main",{className:Om.gamedashboard,children:[H.jsx("img",{src:"images/wrapper.png",className:Om.backgroundimage,alt:"Dashboard background"}),H.jsx(hm,{round1:"1",round2:"Result"}),H.jsx("div",{className:Om.dashboardcontent,children:H.jsxs("div",{className:Om.dashboardgrid,children:[H.jsx("div",{children:H.jsx(dm,{})}),H.jsxs("div",{children:[H.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[H.jsx("div",{children:H.jsx(og,{})}),H.jsx("div",{children:H.jsx(lg,{})})]}),H.jsx(cg,{chart:!0}),H.jsx(ug,{})]})]})}),H.jsx("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:H.jsx(hg,{})}),H.jsx("div",{style:{position:"absolute",bottom:"20px",zIndex:"100"},children:H.jsxs("nav",{children:[H.jsx(dp,{to:"/attack",children:"Attack"})," | ",H.jsx(dp,{to:"/defence",children:"Defence"})]})})]})})}const sw="_gamedashboard_1be73_3",ow="_backgroundimage_1be73_10",lw="_dashboardcontent_1be73_19",cw="_dashboardgrid_1be73_26",uw="_statuscolumn_1be73_30",hw="_mapcolumn_1be73_33",dw="_attackcolumn_1be73_36",pw="_deploybutton_1be73_57",Ua={gamedashboard:sw,backgroundimage:ow,dashboardcontent:lw,dashboardgrid:cw,statuscolumn:uw,mapcolumn:hw,attackcolumn:dw,deploybutton:pw};function fw(){return H.jsx(lm,{store:um,children:H.jsxs("main",{className:Ua.gamedashboard,children:[H.jsx("img",{src:"images/wrapper.png",className:Ua.backgroundimage,alt:"Dashboard background"}),H.jsx(hm,{round1:"1",round2:"Result"}),H.jsx("div",{className:Ua.dashboardcontent,children:H.jsxs("div",{className:Ua.dashboardgrid,children:[H.jsx("div",{children:H.jsx(dm,{})}),H.jsxs("div",{children:[H.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[H.jsx("div",{children:H.jsx(og,{})}),H.jsx("div",{children:H.jsx(lg,{})})]}),H.jsx(cg,{chart:!0}),H.jsx(ug,{})]})]})}),H.jsx("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:H.jsx(hg,{})}),H.jsx("div",{style:{position:"absolute",bottom:"20px",zIndex:"100"},children:H.jsxs("nav",{children:[H.jsx(dp,{to:"/start_a",children:"Attack"})," | ",H.jsx(dp,{to:"/start_d",children:"Defence"})," | ",H.jsx(dp,{to:"/restart",children:"Restart"})]})})]})})}function mw(){return H.jsx(lm,{store:um,children:H.jsxs("main",{className:Ua.gamedashboard,children:[H.jsx("img",{src:"images/wrapper.png",className:Ua.backgroundimage,alt:"Dashboard background"}),H.jsx(hm,{round1:"1",round2:"Result"}),H.jsx("div",{className:Ua.dashboardcontent,children:H.jsxs("div",{className:Ua.dashboardgrid,children:[H.jsx("div",{children:H.jsx(dm,{})}),H.jsxs("div",{children:[H.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[H.jsx("div",{children:H.jsx(og,{})}),H.jsx("div",{children:H.jsx(lg,{})})]}),H.jsx(cg,{chart:!0}),H.jsx(ug,{})]})]})}),H.jsx("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:H.jsx(hg,{})}),H.jsx("div",{children:H.jsx("nav",{children:H.jsx(dp,{className:Ua.deploybutton,to:"/attack",children:"Attack"})})})]})})}function gw(){return H.jsx(lm,{store:um,children:H.jsxs("main",{className:Ua.gamedashboard,children:[H.jsx("img",{src:"images/wrapper.png",className:Ua.backgroundimage,alt:"Dashboard background"}),H.jsx(hm,{round1:"1",round2:"Result"}),H.jsx("div",{className:Ua.dashboardcontent,children:H.jsxs("div",{className:Ua.dashboardgrid,children:[H.jsx("div",{children:H.jsx(dm,{})}),H.jsxs("div",{children:[H.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[H.jsx("div",{children:H.jsx(og,{})}),H.jsx("div",{children:H.jsx(lg,{})})]}),H.jsx(cg,{chart:!0}),H.jsx(ug,{})]})]})}),H.jsx("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:H.jsx(hg,{})}),H.jsx("div",{children:H.jsx("nav",{children:H.jsx(dp,{className:Ua.deploybutton,to:"/defence",children:"Defence"})})})]})})}const yw="_timerwidget_1pf8f_3",_w="_widgettitle_1pf8f_35",xw="_timerdisplay_1pf8f_55",vw="_timerlabel_1pf8f_73",bw="_timervalue_1pf8f_93",ww="_timeunit_1pf8f_113",zf={timerwidget:yw,widgettitle:_w,timerdisplay:xw,timerlabel:vw,timervalue:bw,timeunit:ww},Sw="_overlay_6z2t4_1",Tw="_modal_6z2t4_27",Ny={overlay:Sw,modal:Tw},Mw=({isOpen:S,onClose:F})=>S?H.jsx("div",{className:Ny.overlay,children:H.jsxs("div",{className:Ny.modal,children:[H.jsx("h2",{children:"My Modal"}),H.jsx("p",{children:"This is a modal dialog controlled by props."}),H.jsx("button",{onClick:F,children:"Close"})]})}):null,P_=()=>{const[S,F]=be.useState(!1),[Z,$]=be.useState(20*60);be.useEffect(()=>{if(Z<=0)return;const h=setInterval(()=>{$(oe=>oe-10),Z==1&&F(!0)},1e4);return()=>clearInterval(h)},[Z]);const J=h=>{const oe=Math.floor(h/60).toString().padStart(2,"0"),ge=(h%60).toString().padStart(2,"0");return{m:oe,s:ge}},{m:ce,s:B}=J(Z);return H.jsxs("article",{className:zf.timerwidget,children:[H.jsx("h2",{className:zf.widgettitle,children:"Timer"}),H.jsxs("div",{className:zf.timerdisplay,children:[H.jsx("p",{className:zf.timerlabel,children:"Remaining time"}),H.jsxs("p",{className:zf.timervalue,children:[H.jsx("span",{children:ce}),H.jsx("span",{className:zf.timeunit,children:"m"})," ",H.jsx("span",{children:B}),H.jsx("span",{className:zf.timeunit,children:"s"})]})]}),H.jsx(Mw,{isOpen:S,onClose:()=>F(!1)})]})},Cw="_creditssection_1no6r_1",Aw="_creditsheading_1no6r_25",Ew="_creditsdisplay_1no6r_37",kw="_creditslabel_1no6r_45",Pw="_creditsvalue_1no6r_55",zw="_creditsneeded_1no6r_65",Lw="_creditsafter_1no6r_73",Dw="_creditscurrent_1no6r_81",Lu={creditssection:Cw,creditsheading:Aw,creditsdisplay:Ew,creditslabel:kw,creditsvalue:Pw,creditsneeded:zw,creditsafter:Lw,creditscurrent:Dw},Rw=()=>{const S=vi($=>$.credits.creditsAttackInit),F=vi($=>$.credits.creditsAttackRemaining),Z=vi($=>$.credits.creditsAttackSpent);return H.jsxs("section",{className:Lu.creditssection,children:[H.jsx("h2",{className:Lu.creditsheading,children:"Credits"}),H.jsxs("div",{className:Lu.creditsdisplay,children:[H.jsxs("div",{className:Lu.creditscurrent,children:[H.jsx("p",{className:Lu.creditslabel,children:"Current"}),H.jsx("p",{className:Lu.creditsvalue,children:S})]}),H.jsxs("div",{className:Lu.creditsneeded,children:[H.jsx("p",{className:Lu.creditslabel,children:"Needed by this plan"}),H.jsx("p",{className:Lu.creditsvalue,children:Z||0})]}),H.jsxs("div",{className:Lu.creditsafter,children:[H.jsx("p",{className:Lu.creditslabel,children:"After attack"}),H.jsx("p",{className:Lu.creditsvalue,children:F||0})]})]})]})},Iw="_attackplan_151qr_1",Ow="_attackheading_151qr_19",jw="_attackcontent_151qr_33",Bw="_img_151qr_45",Nw="_planactions_151qr_49",Fw="_historybutton_151qr_69",Uw="_addactionbutton_151qr_71",Lf={attackplan:Iw,attackheading:Ow,attackcontent:jw,img:Bw,planactions:Nw,historybutton:Fw,addactionbutton:Uw},Vw=({sendValueUp:S})=>{const F=na(),Z=()=>{S(2)},$=()=>{F(Wg())};return H.jsxs("div",{className:Lf.attackplan,children:[H.jsxs("div",{children:[H.jsx("h2",{className:Lf.attackheading,children:"Start Attack"}),H.jsx("div",{className:Lf.attackcontent,children:H.jsx("img",{src:"/images/defense_start.png",className:Lf.img})})]}),H.jsxs("div",{className:Lf.planactions,children:[H.jsx("button",{className:Lf.historybutton,onClick:$,children:"Show history"}),H.jsx("button",{className:Lf.addactionbutton,onClick:Z,children:"Add new action"})]})]})},Gw="_wrapperDM_1x9ze_1",$w="_box_1x9ze_5",Hw="_active_1x9ze_37",Zw="_space_1x9ze_45",tm={wrapperDM:Gw,box:$w,active:Hw,space:Zw},qw=({step:S})=>H.jsxs("div",{className:tm.wrapperDM,children:[H.jsx("div",{className:`${tm.box} ${S===1?tm.active:""}`,children:"Target"}),H.jsx("div",{className:`${tm.space}`}),H.jsx("div",{className:`${tm.box} ${S===2?tm.active:""}`,children:"Level"})]}),Xw="_title_qqpsy_7",Fy={title:Xw},Yw="_wrapperData_1o6by_3",Ww="_wrapperData2_1o6by_5",Kw="_title_1o6by_7",Qw="_text_1o6by_9",fd={wrapperData:Yw,wrapperData2:Ww,title:Kw,text:Qw},Jw="_wrapperChartGeneratorTs_1v4em_1",eS="_title_1v4em_9",Uy={wrapperChartGeneratorTs:Jw,title:eS},z_=({dataupdated:S,categories:F,type:Z})=>{const $={chart:{type:"column",zoomType:"x",height:150,events:{load:function(){this.customIcons=[]}}},title:{text:""},xAxis:{categories:F,tickInterval:168},yAxis:{title:{text:"MW"}},legend:{enabled:!1},credits:{enabled:!1},colors:["#3C9BF4"],series:S};return H.jsxs("div",{className:Uy.wrapperChartGeneratorTs,children:[H.jsxs("h3",{className:Uy.title,children:[Z," History"]}),H.jsx("div",{children:H.jsx(Dm,{highcharts:Lm,options:$})})]})},tS=({gendata:S,timeseries:F})=>{const Z=Object.keys(F),J=[{name:"Generation history",data:Object.values(F)}],ce=Z.map(B=>new Date(B).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}));return H.jsxs("div",{className:fd.wrapperDAS,children:[H.jsxs("div",{className:fd.wrapperData,children:[H.jsxs("div",{className:fd.wrapperData2,children:[H.jsxs("p",{className:fd.title,children:["Node",H.jsx("br",{}),H.jsx("span",{className:fd.text,children:S.bus})]}),H.jsxs("p",{className:fd.title,children:["Carrier",H.jsx("br",{}),H.jsx("span",{className:fd.text,children:S.carrier})]})]}),H.jsx("div",{className:fd.wrapperData2,children:H.jsxs("p",{className:fd.title,children:["Nominal power",H.jsx("br",{}),H.jsxs("span",{className:fd.text,children:[Math.round(S.p_nom),"MW"]})]})})]}),H.jsx("div",{children:H.jsx(z_,{dataupdated:J,categories:ce,type:"Generator"})})]})},iS="_wrapperData_1o6by_3",rS="_wrapperData2_1o6by_5",nS="_title_1o6by_7",aS="_text_1o6by_9",op={wrapperData:iS,wrapperData2:rS,title:nS,text:aS},Vy=({gendata:S,flowseries:F,timeseries:Z})=>{const $=Z,ce=[{name:"Line history",data:F}],B=$.map(h=>new Date(h).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}));return H.jsxs("div",{className:op.wrapperDAS,children:[H.jsx("div",{className:op.wrapperData,children:H.jsxs("div",{className:op.wrapperData2,children:[H.jsx("p",{className:op.title,children:H.jsxs("span",{className:op.text,children:[S.buses.from," - ",S.buses.to]})}),H.jsxs("p",{className:op.title,children:["Length",H.jsx("br",{}),H.jsxs("span",{className:op.text,children:[Math.round(S.length),"Km."]})]}),H.jsxs("p",{className:op.title,children:["Capacity",H.jsx("br",{}),H.jsxs("span",{className:op.text,children:[Math.round(S.capacity)," MW"]})]})]})}),H.jsx("div",{children:H.jsx(z_,{dataupdated:ce,categories:B,type:"Line"})})]})},sS=()=>{const[S,F]=be.useState(!1),[Z,$]=be.useState({}),[J,ce]=be.useState([]),[B,h]=be.useState([]),oe=vi(Te=>{const Ve=Te.attack;return Ve||null}),ge="/";return be.useEffect(()=>{if(oe.currentElementNode!=""){if(oe.currentElementType2=="gen"){const Te=new URLSearchParams;Te.append("bus_name",oe.currentElementNode),Te.append("carrier",oe.currentElementCarrier);const Ve=`${ge}get_single_generator_timeseries`;fetch(Ve,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Te.toString()}).then(Ee=>{if(!Ee.ok)throw new Error("Network response was not ok");return Ee.json()}).then(Ee=>{const pe=Ee.data[oe.currentElementNode+" "+oe.currentElementCarrier];$(pe.static),ce(pe.time_series),F(!0)}).catch(Ee=>{console.error("Error:",Ee)})}if(oe.currentElementType2=="line"){const Te=new URLSearchParams;Te.append("line_name",oe.currentElementNode);const Ve=`${ge}get_single_line`;fetch(Ve,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Te.toString()}).then(Ee=>{if(!Ee.ok)throw new Error("Network response was not ok");return Ee.json()}).then(Ee=>{Ee=JSON.parse(Ee.data);const pe={capacity:Ee.capacity,length:Ee.length,avg_flow_per_day:Ee.avg_flow_per_day,max_flow:Ee.max_flow,min_flow:Ee.min_flow,buses:Ee.buses};$(pe),h(Ee.flow_series),ce(Ee.timestamps),F(!0)}).catch(Ee=>{console.error("Error:",Ee)})}if(oe.currentElementType2=="link"){const Te=new URLSearchParams;Te.append("link_name",oe.currentElementNode);const Ve=`${ge}get_single_link`;fetch(Ve,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Te.toString()}).then(Ee=>{if(!Ee.ok)throw new Error("Network response was not ok");return Ee.json()}).then(Ee=>{Ee=JSON.parse(Ee.data);const pe={capacity:Ee.capacity,length:Ee.length,avg_flow_per_day:Ee.avg_flow_per_day,max_flow:Ee.max_flow,min_flow:Ee.min_flow,buses:Ee.buses};$(pe),h(Ee.flow_series),ce(Ee.timestamps),F(!0)}).catch(Ee=>{console.error("Error:",Ee)})}}},[oe]),H.jsxs("div",{className:Fy.wrapperDAS,children:[!S&&H.jsx("h3",{className:Fy.title,children:"← Select a target on the map"}),S&&oe.currentElementType2=="gen"&&H.jsx(tS,{gendata:Z,timeseries:J}),S&&oe.currentElementType2=="line"&&H.jsx(Vy,{gendata:Z,flowseries:B,timeseries:J}),S&&oe.currentElementType2=="link"&&H.jsx(Vy,{gendata:Z,flowseries:B,timeseries:J})]})},oS="_wrapperAS_1maqp_1",lS={wrapperAS:oS},cS=()=>{const S=na(),[F,Z]=be.useState(30),[$,J]=be.useState(null),ce=h=>{Z(Number(h.target.value))},B=vi(h=>{const oe=h.attack;return oe||null});return be.useEffect(()=>{B&&fetch("/js/actionAttack.json").then(h=>h.json()).then(h=>{const oe=h.find(ge=>ge.id===1);J(oe)})},[B,F]),be.useEffect(()=>{var oe;const h=F/10-1;(oe=$==null?void 0:$.credits)==null||oe[h],S(zv(F))},[F]),H.jsxs("div",{className:lS.wrapperAS,children:[H.jsxs("p",{children:[H.jsx("label",{children:F}),"% destruction"]}),H.jsx("input",{type:"range",min:"0",max:"100",step:"10",value:F,onChange:ce}),H.jsx("hr",{}),H.jsx("hr",{})]})},uS="_attackcontent_y1hje_1",hS="_attackcontent2_y1hje_9",dS="_actionlist_y1hje_19",pS="_actionitem_y1hje_33",fS="_actiondetails_y1hje_47",mS="_actioninfo_y1hje_65",gS="_actiontitle_y1hje_73",yS="_actionlocation_y1hje_87",_S="_actioncredits_y1hje_101",xS="_deleteaction_y1hje_117",vS="_confirmDelete_y1hje_141",bS="_buttonCancel_y1hje_163",wS="_buttonAdd_y1hje_165",Xc={attackcontent:uS,attackcontent2:hS,actionlist:dS,actionitem:pS,actiondetails:fS,actioninfo:mS,actiontitle:gS,actionlocation:yS,actioncredits:_S,deleteaction:xS,confirmDelete:vS,buttonCancel:bS,buttonAdd:wS},SS=({mykey:S,sendValueUp:F})=>{console.log(S);const Z=na(),$=()=>{F(!1)},J=()=>{Z(Dv(S)),F(!1)};return H.jsxs("div",{className:Xc.confirmDelete,children:[H.jsx("button",{className:Xc.buttonCancel,onClick:$,children:"Cancel"}),H.jsx("button",{className:Xc.buttonAdd,onClick:J,children:"Confirm"})]})},TS=()=>{const[S,F]=be.useState(!1),[Z,$]=be.useState(null),J=vi(h=>h.attack.selectedAttackActions),ce=h=>{F(h)},B=h=>{$(h),F(!0)};return H.jsxs("div",{className:Xc.attackcontent,children:[S&&H.jsx(SS,{mykey:Z,sendValueUp:ce}),H.jsx("div",{className:Xc.attackcontent2,children:H.jsx("ul",{className:Xc.actionlist,children:J.map((h,oe)=>H.jsx("li",{className:Xc.actionitem,children:H.jsxs("div",{className:Xc.actiondetails,children:[H.jsxs("div",{className:Xc.actioninfo,children:[H.jsxs("h3",{className:Xc.actiontitle,children:[h.currentElementType2=="gen"?"Generator":h.currentElementType2," - ",h.currentElementPerc,"% damage"]}),H.jsxs("p",{className:Xc.actionlocation,children:[h.currentElementNode," - ",h.currentElementCarrier]}),H.jsx("p",{className:Xc.actioncredits,children:"3.500 credits cost"})]}),H.jsx("button",{className:Xc.deleteaction,onClick:()=>B(oe),children:H.jsx("img",{alt:"delete icon",src:"images/actionDelete.svg"})})]})},oe))})})]})},MS="_attackplansetup_wribo_1",CS="_attackplantitle_wribo_23",AS="_wrapperButton_wribo_31",ES="_buttonCancel_wribo_33",kS="_buttonAdd_wribo_67",PS="_planactions_wribo_105",zS="_historybutton_wribo_123",LS="_addactionbutton_wribo_125",Wp={attackplansetup:MS,attackplantitle:CS,wrapperButton:AS,buttonCancel:ES,buttonAdd:kS,planactions:PS,historybutton:zS,addactionbutton:LS},DS=({sendValueUp:S})=>{const F=na(),[Z,$]=be.useState(1),[J,ce]=be.useState(!0),[B,h]=be.useState(!1),[oe,ge]=be.useState("Select for attack"),Te=vi(rt=>{const Ie=rt.attack;return Ie||null}),Ve=vi(rt=>rt.attack.selectedAttackActions),Ee=rt=>{$(rt)},pe=()=>{if(Te!=null&&($(Z+1),ge("Save"),S(100)),Z==2){const rt={currentElementNode:Te.currentElementNode,currentElementCarrier:Te.currentElementCarrier,currentElementType:Te.currentElementType,currentElementType2:Te.currentElementType2,currentElementPerc:Te.currentElementPerc};F(Lv(rt)),F(Ay()),ge("Add new action")}Z===3&&(ge("Select for attack"),S(2),ce(!0),$(1))},Se=()=>{F(Ay()),$(1)},Ne=()=>{F(Wg())};return be.useEffect(()=>{Te.currentElementNode!=""&&ce(!1)},[Te]),be.useEffect(()=>{Ve&&Ve.length==1?h(!0):h(!1)},[Ve]),be.useEffect(()=>{Z==1&&(ce(!0),ge("Select for attack"))},[Z]),H.jsxs("div",{className:Wp.attackplansetup,children:[H.jsx("div",{className:Wp.attackplantitle,children:"Attack plan setup"}),Z<3&&H.jsx(qw,{step:Z}),Z===1&&H.jsx(sS,{sendValueUp:Ee}),Z===2&&H.jsx(cS,{}),Z===3&&H.jsx(TS,{}),Z<=2&&H.jsxs("div",{className:Wp.wrapperButton,children:[H.jsx("button",{className:Wp.buttonCancel,onClick:Se,children:"Cancel"}),H.jsx("button",{className:Wp.buttonAdd,onClick:pe,disabled:J,children:oe})]}),Z===3&&H.jsxs("div",{className:Wp.planactions,children:[H.jsx("button",{className:Wp.historybutton,onClick:Ne,children:"Show history"}),H.jsx("button",{className:Wp.addactionbutton,onClick:pe,disabled:B,children:"Add new action"})]})]})};function RS(){Jy();const S=na(),[F,Z]=be.useState(!0),$=vi(ce=>ce.attack.selectedAttackActions);be.useEffect(()=>{$.length!==0?Z(!1):Z(!0)},[$]);const J=()=>{S(Iv())};return H.jsx("button",{className:Ua.deploybutton,onClick:J,disabled:F,children:"Deploy plan"})}const IS="_confirmDeploy_11vcn_1",OS="_buttonWrapper_11vcn_3",jS="_buttonCancel_11vcn_5",BS="_buttonConfirm_11vcn_39",NS="_loaderWrapper_11vcn_73",FS="_loaderText_11vcn_77",im={confirmDeploy:IS,buttonWrapper:OS,buttonCancel:jS,buttonConfirm:BS,loaderWrapper:NS,loaderText:FS},US=()=>{const S=na(),[F,Z]=be.useState(!0),[$,J]=be.useState(!1),ce=vi(Ve=>Ve.attack.selectedAttackActions),B=vi(Ve=>Ve.attack.showConfirm),oe="/attack",ge=()=>{Z(!1),J(!1)},Te=()=>{J(!0);let Ve,Ee=[];ce.map(pe=>{Ve={def_type:pe.currentElementType2,index:pe.currentElementNode+" "+pe.currentElementCarrier,userdata:pe.currentElementPerc},Ee.push(Ve)}),fetch(oe,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)}).then(pe=>{if(!pe.ok)throw new Error("Network response was not ok");return pe.json()}).then(pe=>{location.href="/start_a"}).catch(pe=>{console.error("Error:",pe)}),S(Rv())};return be.useEffect(()=>{Z(!!B)},[B]),F?H.jsxs("div",{className:im.confirmDeploy,children:[$&&H.jsxs("div",{className:im.loaderWrapper,children:[H.jsx("div",{children:H.jsx("img",{src:"public/images/loaderAnimation.png",alt:"loader animation"})}),H.jsx("div",{className:im.loaderText,children:"Executing your 1st attack plan and gathering its effects"})]}),!$&&H.jsxs("div",{className:im.buttonWrapper,children:[H.jsx("p",{children:"Plan simulation. Are you sure to go ahead?"}),H.jsx("button",{className:im.buttonCancel,onClick:ge,children:"Cancel"}),H.jsx("button",{className:im.buttonConfirm,onClick:Te,children:"Confirm"})]})]}):null},VS="_attackHistory_1ftww_1",GS="_attackHistory2_1ftww_5",$S="_historyButton_1ftww_7",HS="_attackHistoryMenu_1ftww_9",ZS="_attackHistoryAction_1ftww_11",bm={attackHistory:VS,attackHistory2:GS,historyButton:$S,attackHistoryMenu:HS,attackHistoryAction:ZS},qS=()=>{const S=na(),F=vi(oe=>oe.attack.showHistory),[Z,$]=be.useState(null),[J,ce]=be.useState([]),B=oe=>{$(oe)},h=()=>{S(Wg())};return be.useEffect(()=>{F&&fetch("/status.json",{method:"GET",headers:{"Content-Type":"application/json"}}).then(oe=>{if(!oe.ok)throw new Error("Network response was not ok");return oe.json()}).then(oe=>{console.log("Fetched actions_attack:",oe.actions_attack),ce(oe.actions_attack)}).catch(oe=>{console.error("Error fetching status.json:",oe)})},[F]),F?H.jsxs("div",{className:bm.attackHistory,children:[H.jsx("h2",{children:"Attack History"}),H.jsxs("div",{className:bm.attackHistory2,children:[H.jsx("div",{className:bm.attackHistoryMenu,children:J.map((oe,ge)=>H.jsxs("button",{onClick:()=>B(oe),className:bm.historyButton,children:[ge+1,". Attack"]},ge))}),H.jsxs("div",{className:bm.attackHistoryAction,children:[Z&&H.jsxs("div",{style:{marginTop:"16px",padding:"12px",border:"1px solid #ccc"},children:[H.jsxs("div",{children:[H.jsx("strong",{children:"Def Type:"})," ",Z.def_type]}),H.jsxs("div",{children:[H.jsx("strong",{children:"Index:"})," ",Z.index]}),H.jsxs("div",{children:[H.jsx("strong",{children:"Userdata:"})," ",Z.userdata]})]}),H.jsx("button",{onClick:h,style:{marginTop:"12px",padding:"6px 12px"},children:"Back to plan"})]})]})]}):null};function XS(){const[S,F]=be.useState(1),[Z,$]=be.useState(null),J=ce=>{ce==100?$(!1):(F(ce),$(!0))};return H.jsx(lm,{store:um,children:H.jsxs("main",{className:Ua.gamedashboard,children:[H.jsx("img",{src:"./images/wrapper.png",className:Ua.backgroundimage,alt:"Dashboard background"}),H.jsx(hm,{round1:"1",round2:"Attack"}),H.jsxs("section",{className:Ua.dashboardcontent,children:[H.jsx(US,{}),H.jsx(qS,{}),H.jsxs("div",{className:Ua.dashboardgrid,children:[H.jsxs("aside",{className:Ua.statuscolumn,children:[H.jsx(P_,{}),H.jsx(Rw,{})]}),H.jsx("section",{className:Ua.mapcolumn,children:H.jsx(dm,{side:"attack",step:S,displaybox:Z})}),H.jsxs("section",{className:Ua.attackcolumn,children:[S==1&&H.jsx(Vw,{sendValueUp:J}),S==2&&H.jsx(DS,{sendValueUp:J,stepValue:S})]})]})]}),H.jsx("footer",{children:H.jsx(RS,{})}),H.jsx("div",{children:H.jsx("a",{href:"/",children:"Go back"})})]})})}const YS="_gamedashboard_a2o1d_5",WS="_backgroundimage_a2o1d_19",KS="_dashboardcontent_a2o1d_39",QS="_dashboardgrid_a2o1d_53",JS="_defencecolumn_a2o1d_61",rm={gamedashboard:YS,backgroundimage:WS,dashboardcontent:KS,dashboardgrid:QS,defencecolumn:JS},e2="_creditssection_1no6r_1",t2="_creditsheading_1no6r_25",i2="_creditsdisplay_1no6r_37",r2="_creditslabel_1no6r_45",n2="_creditsvalue_1no6r_55",a2="_creditsneeded_1no6r_65",s2="_creditsafter_1no6r_73",o2="_creditscurrent_1no6r_81",Du={creditssection:e2,creditsheading:t2,creditsdisplay:i2,creditslabel:r2,creditsvalue:n2,creditsneeded:a2,creditsafter:s2,creditscurrent:o2},l2=()=>{vi($=>$.country.selectedCountry);const S=vi($=>$.credits.creditsInit),F=vi($=>$.credits.creditsRemaining),Z=vi($=>$.credits.creditsSpent);return H.jsxs("section",{className:Du.creditssection,children:[H.jsx("h2",{className:Du.creditsheading,children:"Credits"}),H.jsxs("div",{className:Du.creditsdisplay,children:[H.jsxs("div",{className:Du.creditscurrent,children:[H.jsx("p",{className:Du.creditslabel,children:"Current"}),H.jsx("p",{className:Du.creditsvalue,children:S})]}),H.jsxs("div",{className:Du.creditsneeded,children:[H.jsx("p",{className:Du.creditslabel,children:"Needed by this plan"}),H.jsx("p",{className:Du.creditsvalue,children:Z||0})]}),H.jsxs("div",{className:Du.creditsafter,children:[H.jsx("p",{className:Du.creditslabel,children:"After attack"}),H.jsx("p",{className:Du.creditsvalue,children:F||0})]})]})]})},c2="_attackplan_151qr_1",u2="_attackheading_151qr_19",h2="_attackcontent_151qr_33",d2="_img_151qr_45",p2="_planactions_151qr_49",f2="_historybutton_151qr_69",m2="_addactionbutton_151qr_71",Df={attackplan:c2,attackheading:u2,attackcontent:h2,img:d2,planactions:p2,historybutton:f2,addactionbutton:m2},g2=({sendValueUp:S})=>{const F=na(),Z=()=>{S(2)},$=()=>{F(Yg())};return H.jsxs("div",{className:Df.attackplan,children:[H.jsxs("div",{children:[H.jsx("h2",{className:Df.attackheading,children:"Start Defence"}),H.jsx("div",{className:Df.attackcontent,children:H.jsx("img",{src:"/images/defense_start.png",className:Df.img})})]}),H.jsxs("div",{className:Df.planactions,children:[H.jsx("button",{className:Df.historybutton,onClick:$,children:"Show history"}),H.jsx("button",{className:Df.addactionbutton,onClick:Z,children:"Add new action"})]})]})},y2="_wrapperDAS_1hktp_1",_2="_title_1hktp_19",x2="_wrapperButton_1hktp_31",v2="_buttonCancel_1hktp_51",b2="_buttonAdd_1hktp_53",w2="_wrapperAL_1hktp_79",S2="_actionType_1hktp_83",T2="_action_1hktp_83",M2="_active_1hktp_87",lp={wrapperDAS:y2,title:_2,wrapperButton:x2,buttonCancel:v2,buttonAdd:b2,wrapperAL:w2,actionType:S2,action:T2,active:M2},C2="_wrapperDM_1x9ze_1",A2="_box_1x9ze_5",E2="_active_1x9ze_37",k2="_space_1x9ze_45",cp={wrapperDM:C2,box:A2,active:E2,space:k2},Qg=({step:S})=>H.jsxs("div",{className:cp.wrapperDM,children:[H.jsx("div",{className:`${cp.box} ${S===1?cp.active:""}`,children:"Type"}),H.jsx("div",{className:`${cp.space}`}),H.jsx("div",{className:`${cp.box} ${S===2?cp.active:""}`,children:"Site"}),H.jsx("div",{className:`${cp.space}`}),H.jsx("div",{className:`${cp.box} ${S===3?cp.active:""}`,children:"Level"})]}),P2=({sendValueUp:S})=>{const F=na(),[Z,$]=be.useState(1),[J,ce]=be.useState(null),[B,h]=be.useState(!0),[oe,ge]=be.useState([]),Te=pe=>{ce(pe),F(Jm(pe))},Ve=()=>{S(3)},Ee=()=>{$(1),ce(null)};return be.useEffect(()=>{fetch("/js/action.json").then(pe=>pe.json()).then(pe=>{ge(pe)})},[]),be.useEffect(()=>{J==null?h(!0):h(!1)},[J]),H.jsxs("div",{className:lp.wrapperDAS,children:[H.jsx("div",{className:lp.title,children:"Defence action setup"}),H.jsx(Qg,{step:Z}),H.jsx("div",{className:lp.wrapperAL,children:oe.map(pe=>H.jsxs("div",{children:[H.jsx("div",{className:lp.actionType,children:pe.type}),H.jsx("ul",{children:pe.data.map(Se=>H.jsx("li",{className:`${lp.action} ${J===Se.id?lp.active:""}`,onClick:()=>Te(Se.id),children:Se.title},Se.id))})]},pe.typeId))}),H.jsxs("div",{className:lp.wrapperButton,children:[H.jsx("button",{className:lp.buttonCancel,onClick:Ee,children:"Cancel"}),H.jsx("button",{className:lp.buttonAdd,onClick:Ve,disabled:B,children:"Select"})]})]})},z2="_wrapperAMS_ahef5_1",L2="_title_ahef5_3",D2="_wrapperDAS_ahef5_17",R2="_wrapperButton_ahef5_47",I2="_wrapperList_ahef5_49",O2="_buttonCancel_ahef5_51",j2="_buttonAdd_ahef5_53",B2="_action_ahef5_81",N2="_active_ahef5_83",md={wrapperAMS:z2,title:L2,wrapperDAS:D2,wrapperButton:R2,wrapperList:I2,buttonCancel:O2,buttonAdd:j2,action:B2,active:N2},F2=({sendValueUp:S})=>{const F=na(),Z=vi(We=>We.action.selectedActionTemp),$=vi(We=>We.action.selectedAction),J=vi(We=>We.action.selectedActions),ce=vi(We=>We.action.currentAction),[B,h]=be.useState(2),[oe,ge]=be.useState(null),[Te,Ve]=be.useState([]),[Ee,pe]=be.useState(!0),[Se,Ne]=be.useState(""),rt=We=>{F(bv(We)),ge(We)},Ie=()=>{S(4)},Oe=()=>{Gm(null),F(Gm(null)),F(Jm(null)),F(S_(J.length-1)),h(1),S(1)};return be.useEffect(()=>{F(Gm(Z)),Z==2?Ve(["Generator","Link","Line"]):Z==5?Ve(["Nuclear","CCGT"]):Ve([])},[Z]),be.useEffect(()=>{Object.keys(ce).length!==0&&(pe(!1),Ie())},[ce]),be.useEffect(()=>{switch($){case 1:Ne("Select site on map");break;case 2:Ne("Select the type");break;case 3:Ne("Select the line to increase its capacity");break;case 4:Ne("Select country in which to limit users' demand");break;case 5:Ne("Select the type of power plant");break;case 6:Ne("Select the link to increase its capacity");break}},[$]),H.jsxs("div",{className:md.wrapperDAS,children:[H.jsx("div",{className:md.title,children:"Defence action setup"}),H.jsx(Qg,{step:B}),H.jsxs("div",{className:md.wrapperAMS,children:[H.jsx("div",{className:md.title,children:Se}),H.jsx("div",{className:md.wrapperList,children:H.jsx("ul",{children:Te.map((We,ct)=>H.jsx("li",{className:`${md.action} ${We===oe?md.active:""}`,onClick:()=>rt(We),children:We},ct))})})]}),H.jsxs("div",{className:md.wrapperButton,children:[H.jsx("button",{className:md.buttonCancel,onClick:Oe,children:"Cancel"}),H.jsx("button",{className:md.buttonAdd,onClick:Ie,disabled:Ee,children:"Select"})]})]})},U2="_wrapperDS_239xt_1",V2="_title_239xt_3",G2="_percentage_239xt_7",$2="_optional_239xt_11",H2="_cost_239xt_13",Z2="_wrapperDAS_239xt_99",q2="_wrapperButton_239xt_129",X2="_buttonCancel_239xt_149",Y2="_buttonAdd_239xt_151",W2="_sliderTitle_239xt_177",K2="_details_239xt_179",Sh={wrapperDS:U2,title:V2,percentage:G2,optional:$2,cost:H2,wrapperDAS:Z2,wrapperButton:q2,buttonCancel:X2,buttonAdd:Y2,sliderTitle:W2,details:K2},Q2=({sendValueUp:S})=>{var ri;const Z=na(),[$,J]=be.useState(0),[ce,B]=be.useState(0),[h,oe]=be.useState(100),[ge,Te]=be.useState(10),[Ve,Ee]=be.useState(null),[pe,Se]=be.useState("Protection level"),[Ne,rt]=be.useState(!0),[Ie,Oe]=be.useState("%"),We=vi(Yt=>Yt.action.selectedActions),ct=vi(Yt=>Yt.action.selectedAction),Ke=vi(Yt=>Yt.action.currentAction),pt=vi(Yt=>Yt.action.typeNewGen),Pt=Yt=>{J(Number(Yt.target.value))},Ue=()=>{var gt;const Yt=Math.max(Math.floor($/10)-1,0),yi=((gt=Ve==null?void 0:Ve.credits)==null?void 0:gt[Yt])??0,wi={actionId:(Ke==null?void 0:Ke.actionId)??null,type:(Ke==null?void 0:Ke.type)??"",name:(Ke==null?void 0:Ke.name)??"",carrier:(Ke==null?void 0:Ke.carrier)??"",credit:yi,percentage:$,value:(Ke==null?void 0:Ke.value)??0};Z(Jm(null)),Z(Am({})),Z(wv(wi)),S(5)},zt=()=>{Ee(null),Z(Jm(null)),Z(Am({})),S(1)};be.useEffect(()=>{if(Ke){switch(Ke.actionId){case 1:Se(`<strong>Add protection</strong><div>&#64; ${Ke.carrier??""} (${Math.round(Ke.value)} MW)</div>`),B(0),oe(50),Te(5),Oe("%");break;case 2:Se(`<strong>Add standby/maintenance generator</strong><div>&#64; ${Ke.name??""} (${Math.round(Ke.value)} MW)</div>`),B(0),oe(100),Te(100),Oe("%");break;case 3:Se(`<strong>Increase line capacity</strong><div>&#64; Line ${Ke.name??""} (${Math.round(Ke.value)} MW)</div>`),B(0),oe(100),Te(100),Oe("%");break;case 4:let Yt="";Ke.name=="EE"&&(Yt="Estonia"),Ke.name=="LT"&&(Yt="Lithuania"),Ke.name=="LV"&&(Yt="Latvia"),Se(`<strong>Limit users's demand</strong><div>&#64; ${Yt}</div>`),B(0),oe(30),Te(10),Oe("%");break;case 5:Se(`<strong>Build new ${pt} power plant</strong><div>&#64; ${Ke.name??Ke.carrier??""} (${Math.round(Ke.value)} MW)</div>`),B(0),oe(100),Te(100),Oe("%");break;case 6:Se(`<strong>Increase link capacity</strong><div>&#64; ${Ke.name??""} (${Math.round(Ke.value)} MW)</div>`),B(1),oe(2),Te(.5),Oe("%");break;default:Se("Protection level"),B(0),oe(100),Te(10),Oe("X");break}J(0)}},[Ke,pt]),be.useEffect(()=>{const Yt=We.reduce((yi,wi)=>yi+(wi.credit??0),0);Z(Mv(Yt)),Z(Cv(Yt)),rt($<=0)},[$,We,Z]),be.useEffect(()=>{ct&&fetch("/js/action.json").then(Yt=>Yt.json()).then(Yt=>{const yi=Yt.flatMap(wi=>wi.data).find(wi=>wi.id===ct);Ee(yi??null)}).catch(Yt=>console.error("Failed to load actions:",Yt))},[ct]);const _t=Math.max(Math.floor($/10)-1,0),Dt=$>0?(ri=Ve==null?void 0:Ve.credits)==null?void 0:ri[_t]:void 0;return H.jsxs("div",{className:Sh.wrapperDAS,children:[H.jsx("div",{className:Sh.title,children:" "}),H.jsx(Qg,{step:3}),H.jsxs("div",{className:Sh.wrapperDS,children:[H.jsx("div",{className:Sh.sliderTitle,dangerouslySetInnerHTML:{__html:pe}}),H.jsxs("p",{className:Sh.percentage,children:[H.jsx("label",{children:$}),H.jsx("label",{children:Ie})]}),H.jsx("input",{type:"range",min:ce,max:h,step:ge,value:$,onChange:Pt}),H.jsx("div",{className:Sh.cost,children:Dt!==void 0&&H.jsxs("p",{children:[Dt," credits cost"]})}),ct==1&&H.jsxs(H.Fragment,{children:[H.jsx("div",{className:Sh.details,children:"Details"}),H.jsx("div",{className:Sh.optional,children:Ve&&H.jsx("span",{children:Ve.text})})]})]}),H.jsxs("div",{className:Sh.wrapperButton,children:[H.jsx("button",{className:Sh.buttonCancel,onClick:zt,children:"Cancel"}),H.jsx("button",{className:Sh.buttonAdd,onClick:Ue,disabled:Ne,children:"Select"})]})]})},J2="_wrapperNDP_c1iw4_1",eT="_title_c1iw4_3",tT="_wrapperAction_c1iw4_5",iT="_text1_c1iw4_7",rT="_text2_c1iw4_9",nT="_text3_c1iw4_11",aT="_wrapperButton_c1iw4_13",sT="_buttonCancel_c1iw4_15",oT="_buttonSave_c1iw4_17",up={wrapperNDP:J2,title:eT,wrapperAction:tT,text1:iT,text2:rT,text3:nT,wrapperButton:aT,buttonCancel:sT,buttonSave:oT},lT=({sendValueUp:S})=>{const[F,Z]=be.useState([]),$=na(),J=()=>{$(Gm(0)),$(Ev()),$(kv(2)),S(2)},ce=vi(oe=>oe.action.selectedActions),B=oe=>{$(S_(oe))},h=()=>{$(Yg())};return be.useEffect(()=>{ce&&fetch("/js/action.json").then(oe=>oe.json()).then(oe=>{const ge=oe.flatMap(Ve=>Ve.data),Te=ce.map(Ve=>{const Ee=ge.find(pe=>pe.id===Ve.actionId);return Ee?{...Ee,...Ve}:Ve});Z(Te)})},[ce]),H.jsxs("div",{className:up.wrapperNDP,children:[H.jsx("div",{className:up.title,children:"Plan setup"}),F.map((oe,ge)=>H.jsxs("div",{className:up.wrapperAction,children:[H.jsx("p",{className:up.text1,children:oe.title}),H.jsxs("p",{className:up.text2,children:["@ ",oe.name]}),H.jsxs("p",{className:up.text3,children:[oe.credit," credits"]}),H.jsx("img",{src:"/images/actionDelete.svg",alt:"Delete",onClick:()=>B(ge)})]},ge)),H.jsxs("div",{className:up.wrapperButton,children:[H.jsx("button",{className:up.buttonCancel,onClick:h,children:"Show History"}),H.jsx("button",{className:up.buttonSave,onClick:J,children:"Add new action"})]})]})},cT="_wbutton_1ejqz_1",uT="_button_1ejqz_3",Gy={wbutton:cT,button:uT},hT=()=>{const S=na(),[F,Z]=be.useState(!0),[$,J]=be.useState([]),ce=vi(h=>h.action.selectedActions);be.useEffect(()=>{ce&&(fetch("/js/action.json").then(h=>h.json()).then(h=>{const oe=h.flatMap(Te=>Te.data),ge=ce.map(Te=>{const Ve=oe.find(Ee=>Ee.id===Te.actionId);return Ve?{...Ve,...Te}:Te});J(ge)}),ce.length>0&&Z(!1))},[ce]);const B=()=>{S(Sv())};return H.jsx("div",{className:Gy.wbutton,children:H.jsx("button",{className:Gy.button,onClick:B,disabled:F,children:"Deploy plan"})})},dT="_attackHistory_1ftww_1",pT="_attackHistory2_1ftww_5",fT="_historyButton_1ftww_7",mT="_attackHistoryMenu_1ftww_9",gT="_attackHistoryAction_1ftww_11",wm={attackHistory:dT,attackHistory2:pT,historyButton:fT,attackHistoryMenu:mT,attackHistoryAction:gT},yT=()=>{const S=na(),F=vi(oe=>oe.action.showHistory),[Z,$]=be.useState(null),[J,ce]=be.useState([]),B=oe=>{$(oe[0])},h=()=>{S(Yg())};return be.useEffect(()=>{F&&fetch("/status.json",{method:"GET",headers:{"Content-Type":"application/json"}}).then(oe=>{if(!oe.ok)throw new Error("Network response was not ok");return oe.json()}).then(oe=>{ce(oe.actions_defence)}).catch(oe=>{console.error("Error fetching status.json:",oe)})},[F]),F?H.jsxs("div",{className:wm.attackHistory,children:[H.jsx("h2",{children:"Defence History"}),H.jsxs("div",{className:wm.attackHistory2,children:[H.jsx("div",{className:wm.attackHistoryMenu,children:J.map((oe,ge)=>H.jsxs("button",{onClick:()=>B(oe),className:wm.historyButton,children:[ge+1,". Defence"]},ge))}),H.jsxs("div",{className:wm.attackHistoryAction,children:[Z&&H.jsxs("div",{style:{marginTop:"16px",padding:"12px",border:"1px solid #ccc"},children:[H.jsxs("div",{children:[H.jsx("strong",{children:"Def Type:"})," ",Z.def_type]}),H.jsxs("div",{children:[H.jsx("strong",{children:"Index:"})," ",Z.gen]}),H.jsxs("div",{children:[H.jsx("strong",{children:"Userdata:"})," ",Z.userdata]})]}),H.jsx("button",{onClick:h,style:{marginTop:"12px",padding:"6px 12px"},children:"Back to plan"})]})]})]}):null},_T="_confirmDeploy_ivk9y_1",xT="_buttonWrapper_ivk9y_3",vT="_buttonCancel_ivk9y_5",bT="_buttonConfirm_ivk9y_39",wT="_loaderWrapper_ivk9y_73",ST="_loaderText_ivk9y_77",nm={confirmDeploy:_T,buttonWrapper:xT,buttonCancel:vT,buttonConfirm:bT,loaderWrapper:wT,loaderText:ST},TT=()=>{na();const[S,F]=be.useState(!0),[Z,$]=be.useState([]),[J,ce]=be.useState(!0),[B,h]=be.useState(!1),oe=vi(Ee=>Ee.action.showConfirm),ge=vi(Ee=>Ee.action.selectedActions),Te=()=>{ce(!1),h(!1)};be.useEffect(()=>{ce(!!oe)},[oe]),be.useEffect(()=>{ge&&(fetch("/js/action.json").then(Ee=>Ee.json()).then(Ee=>{const pe=Ee.flatMap(Ne=>Ne.data),Se=ge.map(Ne=>{const rt=pe.find(Ie=>Ie.id===Ne.actionId);return rt?{...rt,...Ne}:Ne});$(Se)}),ge.length>0&&F(!1))},[ge]);const Ve=()=>{h(!0);let Ee=[];Z.forEach(Ne=>{console.log(Ne);let rt=Ne.name.substr(0,2);switch(Ne.actionId){case 1:const Ie=Ne.carrier,Oe=Ne.name,We=Ie.replace(Oe,"");Ee.push({def_type:Ne.tag,bus:Ne.name,link:"",line:"",gen:Ne.carrier,country:"",carrier:We,userdata:Ne.percentage,step:Ne.defenceStep});break;case 2:(Ne.name=="EE0 7 oil"||Ne.name=="LT0 1 CCGT")&&Ee.push({def_type:Ne.tag,bus:Ne.name,link:"",line:"",gen:Ne.name,country:"",carrier:Ne.carrier,userdata:Ne.percentage,step:Ne.defenceStep}),(Ne.name=="relation/8184630+2"||Ne.name=="relation/8185455+2")&&Ee.push({def_type:Ne.tag,bus:"",link:Ne.name,line:"",gen:"",country:"",carrier:"",userdata:Ne.percentage,step:Ne.defenceStep}),Ne.name=="line 297"&&Ee.push({def_type:Ne.tag,bus:"",link:"",line:Ne.name,gen:"",country:"",carrier:"",userdata:Ne.percentage,step:Ne.defenceStep});break;case 3:Ee.push({def_type:Ne.tag,bus:"",link:"",line:Ne.name,gen:Ne.carrier,country:"",carrier:"",userdata:Ne.percentage,step:Ne.defenceStep});break;case 4:Ee.push({def_type:Ne.tag,bus:"",link:"",line:"",gen:"",country:rt,carrier:"",userdata:Ne.percentage,step:Ne.defenceStep});break;case 5:Ee.push({def_type:Ne.tag,bus:Ne.name,link:"",line:"",gen:Ne.carrier,country:"",carrier:Ne.carrier,userdata:Ne.percentage,step:Ne.defenceStep});break;case 6:Ee.push({def_type:Ne.tag,bus:"",link:Ne.name,line:"",gen:"",country:rt,carrier:"",userdata:Ne.percentage,step:Ne.defenceStep});break}}),console.log(Ee),fetch("/defence",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ee)}).then(Ne=>{if(!Ne.ok)throw new Error("Network response was not ok");return Ne.json()}).then(Ne=>{console.log(Ne),location.href="/start_d"}).catch(Ne=>{console.error("Error:",Ne)})};return J?H.jsxs("div",{className:nm.confirmDeploy,children:[B&&H.jsxs("div",{className:nm.loaderWrapper,children:[H.jsx("div",{children:H.jsx("img",{src:"public/images/loaderAnimation.png",alt:"loader animation"})}),H.jsx("div",{className:nm.loaderText,children:"Executing your 1st defence plan and gathering its effects"})]}),!B&&H.jsxs("div",{className:nm.buttonWrapper,children:[H.jsx("p",{children:"Plan simulation. Are you sure to go ahead?"}),H.jsx("button",{className:nm.buttonCancel,onClick:Te,children:"Cancel"}),H.jsx("button",{className:nm.buttonConfirm,onClick:Ve,children:"Confirm"})]})]}):null};function MT(){const[S,F]=be.useState(1),Z=$=>{F($)};return H.jsx(lm,{store:um,children:H.jsxs("main",{className:rm.gamedashboard,children:[H.jsx("img",{src:"images/wrapper.png",className:rm.backgroundimage,alt:"Dashboard background"}),H.jsx(hm,{round1:"1",round2:"Defence"}),H.jsxs("div",{className:rm.dashboardcontent,children:[H.jsx(TT,{}),H.jsx(yT,{}),H.jsxs("div",{className:rm.dashboardgrid,children:[H.jsxs("div",{children:[H.jsx(P_,{}),H.jsx(l2,{})]}),H.jsx("div",{className:rm.center_column,children:H.jsx(dm,{side:"defence"})}),H.jsxs("section",{className:rm.defencecolumn,children:[S==1&&H.jsx(g2,{sendValueUp:Z}),S==2&&H.jsx(P2,{sendValueUp:Z,stepValue:S}),S==3&&H.jsx(F2,{sendValueUp:Z}),S==4&&H.jsx(Q2,{sendValueUp:Z}),S==5&&H.jsx(lT,{sendValueUp:Z})]})]})]}),H.jsx("div",{children:H.jsx(hT,{})}),H.jsx("div",{children:H.jsx("a",{href:"/",children:"Go back"})})]})})}G_.createRoot(document.getElementById("root")).render(H.jsx(be.StrictMode,{children:H.jsx(n0,{children:H.jsxs(Rx,{children:[H.jsx(Rf,{path:"/",element:H.jsx(fw,{})}),H.jsx(Rf,{path:"/start_a",element:H.jsx(mw,{})}),H.jsx(Rf,{path:"/start_d",element:H.jsx(gw,{})}),H.jsx(Rf,{path:"/attack",element:H.jsx(XS,{})}),H.jsx(Rf,{path:"/defence",element:H.jsx(MT,{})}),H.jsx(Rf,{path:"/restart",element:H.jsx(aw,{})})]})})}));
